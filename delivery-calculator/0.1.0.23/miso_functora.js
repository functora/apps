var h$miso_functora;(()=>{var __webpack_modules__={518:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.d(__webpack_exports__2,{Gm:()=>CapacitorBarcodeScannerTypeHint,UO:()=>CapacitorBarcodeScannerScanOrientation,V7:()=>CapacitorBarcodeScannerCameraDirection});var html5_qrcode__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(863),CapacitorBarcodeScannerCameraDirection;(function(CapacitorBarcodeScannerCameraDirection2){CapacitorBarcodeScannerCameraDirection2[CapacitorBarcodeScannerCameraDirection2.BACK=1]="BACK",CapacitorBarcodeScannerCameraDirection2[CapacitorBarcodeScannerCameraDirection2.FRONT=2]="FRONT"})(CapacitorBarcodeScannerCameraDirection||(CapacitorBarcodeScannerCameraDirection={}));var CapacitorBarcodeScannerScanOrientation;(function(CapacitorBarcodeScannerScanOrientation2){CapacitorBarcodeScannerScanOrientation2[CapacitorBarcodeScannerScanOrientation2.PORTRAIT=1]="PORTRAIT",CapacitorBarcodeScannerScanOrientation2[CapacitorBarcodeScannerScanOrientation2.LANDSCAPE=2]="LANDSCAPE",CapacitorBarcodeScannerScanOrientation2[CapacitorBarcodeScannerScanOrientation2.ADAPTIVE=3]="ADAPTIVE"})(CapacitorBarcodeScannerScanOrientation||(CapacitorBarcodeScannerScanOrientation={}));var CapacitorBarcodeScannerTypeHintALLOption;(function(CapacitorBarcodeScannerTypeHintALLOption2){CapacitorBarcodeScannerTypeHintALLOption2[CapacitorBarcodeScannerTypeHintALLOption2.ALL=17]="ALL"})(CapacitorBarcodeScannerTypeHintALLOption||(CapacitorBarcodeScannerTypeHintALLOption={}));const CapacitorBarcodeScannerTypeHint=Object.assign(Object.assign({},html5_qrcode__WEBPACK_IMPORTED_MODULE_0__.Jl),CapacitorBarcodeScannerTypeHintALLOption);var CapacitorBarcodeScannerAndroidScanningLibrary;(function(CapacitorBarcodeScannerAndroidScanningLibrary2){CapacitorBarcodeScannerAndroidScanningLibrary2.ZXING="zxing",CapacitorBarcodeScannerAndroidScanningLibrary2.MLKIT="mlkit"})(CapacitorBarcodeScannerAndroidScanningLibrary||(CapacitorBarcodeScannerAndroidScanningLibrary={}))},302:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{CapacitorBarcodeScannerWeb:()=>CapacitorBarcodeScannerWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268),html5_qrcode__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__2(863),_definitions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__2(518);class CapacitorBarcodeScannerWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{async stopAndHideScanner(){console.log(window.OSBarcodeWebScanner),window.OSBarcodeWebScanner&&(await window.OSBarcodeWebScanner.stop(),window.OSBarcodeWebScanner=null),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="none"}buildScannerElement(){if(document.getElementById("cap-os-barcode-scanner-container")){document.getElementById("cap-os-barcode-scanner-container").className="scanner-container-display";return}const caposbarcodescannercontainer=document.body.appendChild(document.createElement("div"));caposbarcodescannercontainer.id="cap-os-barcode-scanner-container";const caposbarcodescannercontainerdialog=document.createElement("div");caposbarcodescannercontainerdialog.id="cap-os-barcode-scanner-container-dialog",caposbarcodescannercontainerdialog.className="scanner-dialog";const caposbarcodescannercontainerdialoginner=document.createElement("div");caposbarcodescannercontainerdialoginner.className="scanner-dialog-inner";const caposbarcodescannercontainerdialoginnerclose=document.createElement("span");caposbarcodescannercontainerdialoginnerclose.className="close-button",caposbarcodescannercontainerdialoginnerclose.innerHTML="&times;",caposbarcodescannercontainerdialoginner.appendChild(caposbarcodescannercontainerdialoginnerclose);const caposbarcodescannercontainerdialoginnercontainerp=document.createElement("p");caposbarcodescannercontainerdialoginnercontainerp.innerHTML="&nbsp;",caposbarcodescannercontainerdialoginner.appendChild(caposbarcodescannercontainerdialoginnercontainerp);const caposbarcodescannercontainerdialoginnercontainer=document.createElement("div");caposbarcodescannercontainerdialoginnercontainer.className="scanner-container-full-width",caposbarcodescannercontainerdialoginnercontainer.id="cap-os-barcode-scanner-container-scanner",caposbarcodescannercontainerdialoginner.appendChild(caposbarcodescannercontainerdialoginnercontainer),caposbarcodescannercontainerdialog.appendChild(caposbarcodescannercontainerdialoginner),caposbarcodescannercontainer.appendChild(caposbarcodescannercontainerdialog),caposbarcodescannercontainerdialoginnerclose.onclick=this.stopAndHideScanner}async scanBarcode(options){return this.buildScannerElement(),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="block",new Promise((resolve,reject)=>{var _a,_b;const param={facingMode:options.cameraDirection===1?"environment":"user",hasScannerButton:!1,scanButton:options.scanButton===void 0?!1:options.scanButton,showScanLine:!1,scanInstructions:options.scanInstructions?options.scanInstructions:"",orientation:options.scanOrientation?options.scanOrientation:_definitions__WEBPACK_IMPORTED_MODULE_2__.UO.PORTRAIT,showCameraSelection:!((_a=options.web)===null||_a===void 0)&&_a.showCameraSelection?options.web.showCameraSelection:!1,typeHint:options.hint===17?void 0:options.hint,scannerFPS:!((_b=options.web)===null||_b===void 0)&&_b.scannerFPS?options.web.scannerFPS:50},scannerElement=document.getElementById("cap-os-barcode-scanner-container-scanner");if(!scannerElement)throw new Error("Scanner Element is required for web");window.OSBarcodeWebScanner=new html5_qrcode__WEBPACK_IMPORTED_MODULE_1__.j9(scannerElement.id);const Html5QrcodeConfig={fps:param.scannerFPS,qrbox:scannerElement.getBoundingClientRect().width*(9/16)-10,aspectRatio:16/9,videoConstraints:{focusMode:"continuous",height:{min:576,ideal:1920},deviceId:void 0,facingMode:void 0}},OSBarcodeWebScannerSuccessCallback=(decodedText,_decodedResult)=>{this.stopAndHideScanner(),resolve({ScanResult:decodedText})},OSBarcodeWebScannerErrorCallback=error=>{error.indexOf("NotFoundException")===-1&&(this.stopAndHideScanner(),console.error(`[Scanner Web Error] ${error}`),reject(error))};window.OSBarcodeWebScanner.start({facingMode:param.facingMode},Html5QrcodeConfig,OSBarcodeWebScannerSuccessCallback,OSBarcodeWebScannerErrorCallback)})}}},531:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{Browser:()=>Browser,BrowserWeb:()=>BrowserWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class BrowserWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{constructor(){super(),this._lastWindow=null}async open(options){this._lastWindow=window.open(options.url,options.windowName||"_blank")}async close(){return new Promise((resolve,reject)=>{this._lastWindow!=null?(this._lastWindow.close(),this._lastWindow=null,resolve()):reject("No active window to close!")})}}const Browser=new BrowserWeb},268:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.d(__webpack_exports__2,{EA:()=>buildRequestInit,E_:()=>WebPlugin,F3:()=>registerPlugin,Ii:()=>Capacitor});/*! Capacitor: https://capacitorjs.com/ - MIT License */const createCapacitorPlatforms=win=>{const defaultPlatformMap=new Map;defaultPlatformMap.set("web",{name:"web"});const capPlatforms=win.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:defaultPlatformMap},addPlatform2=(name,platform)=>{capPlatforms.platforms.set(name,platform)},setPlatform2=name=>{capPlatforms.platforms.has(name)&&(capPlatforms.currentPlatform=capPlatforms.platforms.get(name))};return capPlatforms.addPlatform=addPlatform2,capPlatforms.setPlatform=setPlatform2,capPlatforms},CapacitorPlatforms=(win=>win.CapacitorPlatforms=createCapacitorPlatforms(win))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof __webpack_require__2.g<"u"?__webpack_require__2.g:{}),addPlatform=CapacitorPlatforms.addPlatform,setPlatform=CapacitorPlatforms.setPlatform,legacyRegisterWebPlugin=(cap,webPlugin)=>{var _a;const config=webPlugin.config,Plugins2=cap.Plugins;if(!config?.name)throw new Error('Capacitor WebPlugin is using the deprecated "registerWebPlugin()" function, but without the config. Please use "registerPlugin()" instead to register this web plugin."');console.warn(`Capacitor plugin "${config.name}" is using the deprecated "registerWebPlugin()" function`),(!Plugins2[config.name]||!((_a=config?.platforms)===null||_a===void 0)&&_a.includes(cap.getPlatform()))&&(Plugins2[config.name]=webPlugin)};var ExceptionCode;(function(ExceptionCode2){ExceptionCode2.Unimplemented="UNIMPLEMENTED",ExceptionCode2.Unavailable="UNAVAILABLE"})(ExceptionCode||(ExceptionCode={}));class CapacitorException extends Error{constructor(message,code,data){super(message),this.message=message,this.code=code,this.data=data}}const getPlatformId=win=>{var _a,_b;return win?.androidBridge?"android":!((_b=(_a=win?.webkit)===null||_a===void 0?void 0:_a.messageHandlers)===null||_b===void 0)&&_b.bridge?"ios":"web"},createCapacitor=win=>{var _a,_b,_c,_d,_e;const capCustomPlatform=win.CapacitorCustomPlatform||null,cap=win.Capacitor||{},Plugins2=cap.Plugins=cap.Plugins||{},capPlatforms=win.CapacitorPlatforms,defaultGetPlatform=()=>capCustomPlatform!==null?capCustomPlatform.name:getPlatformId(win),getPlatform=((_a=capPlatforms?.currentPlatform)===null||_a===void 0?void 0:_a.getPlatform)||defaultGetPlatform,defaultIsNativePlatform=()=>getPlatform()!=="web",isNativePlatform=((_b=capPlatforms?.currentPlatform)===null||_b===void 0?void 0:_b.isNativePlatform)||defaultIsNativePlatform,defaultIsPluginAvailable=pluginName=>{const plugin=registeredPlugins.get(pluginName);return!!(plugin?.platforms.has(getPlatform())||getPluginHeader(pluginName))},isPluginAvailable=((_c=capPlatforms?.currentPlatform)===null||_c===void 0?void 0:_c.isPluginAvailable)||defaultIsPluginAvailable,defaultGetPluginHeader=pluginName=>{var _a2;return(_a2=cap.PluginHeaders)===null||_a2===void 0?void 0:_a2.find(h=>h.name===pluginName)},getPluginHeader=((_d=capPlatforms?.currentPlatform)===null||_d===void 0?void 0:_d.getPluginHeader)||defaultGetPluginHeader,handleError=err=>win.console.error(err),pluginMethodNoop=(_target,prop,pluginName)=>Promise.reject(`${pluginName} does not have an implementation of "${prop}".`),registeredPlugins=new Map,defaultRegisterPlugin=(pluginName,jsImplementations={})=>{const registeredPlugin=registeredPlugins.get(pluginName);if(registeredPlugin)return console.warn(`Capacitor plugin "${pluginName}" already registered. Cannot register plugins twice.`),registeredPlugin.proxy;const platform=getPlatform(),pluginHeader=getPluginHeader(pluginName);let jsImplementation;const loadPluginImplementation=async()=>(!jsImplementation&&platform in jsImplementations?jsImplementation=typeof jsImplementations[platform]=="function"?jsImplementation=await jsImplementations[platform]():jsImplementation=jsImplementations[platform]:capCustomPlatform!==null&&!jsImplementation&&"web"in jsImplementations&&(jsImplementation=typeof jsImplementations.web=="function"?jsImplementation=await jsImplementations.web():jsImplementation=jsImplementations.web),jsImplementation),createPluginMethod=(impl,prop)=>{var _a2,_b2;if(pluginHeader){const methodHeader=pluginHeader?.methods.find(m=>prop===m.name);if(methodHeader)return methodHeader.rtype==="promise"?options=>cap.nativePromise(pluginName,prop.toString(),options):(options,callback)=>cap.nativeCallback(pluginName,prop.toString(),options,callback);if(impl)return(_a2=impl[prop])===null||_a2===void 0?void 0:_a2.bind(impl)}else{if(impl)return(_b2=impl[prop])===null||_b2===void 0?void 0:_b2.bind(impl);throw new CapacitorException(`"${pluginName}" plugin is not implemented on ${platform}`,ExceptionCode.Unimplemented)}},createPluginMethodWrapper=prop=>{let remove;const wrapper=(...args)=>{const p=loadPluginImplementation().then(impl=>{const fn=createPluginMethod(impl,prop);if(fn){const p2=fn(...args);return remove=p2?.remove,p2}else throw new CapacitorException(`"${pluginName}.${prop}()" is not implemented on ${platform}`,ExceptionCode.Unimplemented)});return prop==="addListener"&&(p.remove=async()=>remove()),p};return wrapper.toString=()=>`${prop.toString()}() { [capacitor code] }`,Object.defineProperty(wrapper,"name",{value:prop,writable:!1,configurable:!1}),wrapper},addListener=createPluginMethodWrapper("addListener"),removeListener=createPluginMethodWrapper("removeListener"),addListenerNative=(eventName,callback)=>{const call=addListener({eventName},callback),remove=async()=>{const callbackId=await call;removeListener({eventName,callbackId},callback)},p=new Promise(resolve=>call.then(()=>resolve({remove})));return p.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await remove()},p},proxy=new Proxy({},{get(_,prop){switch(prop){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return pluginHeader?addListenerNative:addListener;case"removeListener":return removeListener;default:return createPluginMethodWrapper(prop)}}});return Plugins2[pluginName]=proxy,registeredPlugins.set(pluginName,{name:pluginName,proxy,platforms:new Set([...Object.keys(jsImplementations),...pluginHeader?[platform]:[]])}),proxy},registerPlugin2=((_e=capPlatforms?.currentPlatform)===null||_e===void 0?void 0:_e.registerPlugin)||defaultRegisterPlugin;return cap.convertFileSrc||(cap.convertFileSrc=filePath=>filePath),cap.getPlatform=getPlatform,cap.handleError=handleError,cap.isNativePlatform=isNativePlatform,cap.isPluginAvailable=isPluginAvailable,cap.pluginMethodNoop=pluginMethodNoop,cap.registerPlugin=registerPlugin2,cap.Exception=CapacitorException,cap.DEBUG=!!cap.DEBUG,cap.isLoggingEnabled=!!cap.isLoggingEnabled,cap.platform=cap.getPlatform(),cap.isNative=cap.isNativePlatform(),cap},Capacitor=(win=>win.Capacitor=createCapacitor(win))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof __webpack_require__2.g<"u"?__webpack_require__2.g:{}),registerPlugin=Capacitor.registerPlugin,Plugins=Capacitor.Plugins,registerWebPlugin=plugin=>legacyRegisterWebPlugin(Capacitor,plugin);class WebPlugin{constructor(config){this.listeners={},this.retainedEventArguments={},this.windowListeners={},config&&(console.warn(`Capacitor WebPlugin "${config.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=config)}addListener(eventName,listenerFunc){let firstListener=!1;this.listeners[eventName]||(this.listeners[eventName]=[],firstListener=!0),this.listeners[eventName].push(listenerFunc);const windowListener=this.windowListeners[eventName];windowListener&&!windowListener.registered&&this.addWindowListener(windowListener),firstListener&&this.sendRetainedArgumentsForEvent(eventName);const remove=async()=>this.removeListener(eventName,listenerFunc);return Promise.resolve({remove})}async removeAllListeners(){this.listeners={};for(const listener in this.windowListeners)this.removeWindowListener(this.windowListeners[listener]);this.windowListeners={}}notifyListeners(eventName,data,retainUntilConsumed){const listeners=this.listeners[eventName];if(!listeners){if(retainUntilConsumed){let args=this.retainedEventArguments[eventName];args||(args=[]),args.push(data),this.retainedEventArguments[eventName]=args}return}listeners.forEach(listener=>listener(data))}hasListeners(eventName){return!!this.listeners[eventName].length}registerWindowListener(windowEventName,pluginEventName){this.windowListeners[pluginEventName]={registered:!1,windowEventName,pluginEventName,handler:event=>{this.notifyListeners(pluginEventName,event)}}}unimplemented(msg="not implemented"){return new Capacitor.Exception(msg,ExceptionCode.Unimplemented)}unavailable(msg="not available"){return new Capacitor.Exception(msg,ExceptionCode.Unavailable)}async removeListener(eventName,listenerFunc){const listeners=this.listeners[eventName];if(!listeners)return;const index=listeners.indexOf(listenerFunc);this.listeners[eventName].splice(index,1),this.listeners[eventName].length||this.removeWindowListener(this.windowListeners[eventName])}addWindowListener(handle){window.addEventListener(handle.windowEventName,handle.handler),handle.registered=!0}removeWindowListener(handle){handle&&(window.removeEventListener(handle.windowEventName,handle.handler),handle.registered=!1)}sendRetainedArgumentsForEvent(eventName){const args=this.retainedEventArguments[eventName];args&&(delete this.retainedEventArguments[eventName],args.forEach(arg=>{this.notifyListeners(eventName,arg)}))}}const WebView=null,encode=str=>encodeURIComponent(str).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),decode=str=>str.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class CapacitorCookiesPluginWeb extends WebPlugin{async getCookies(){const cookies=document.cookie,cookieMap={};return cookies.split(";").forEach(cookie=>{if(cookie.length<=0)return;let[key,value]=cookie.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");key=decode(key).trim(),value=decode(value).trim(),cookieMap[key]=value}),cookieMap}async setCookie(options){try{const encodedKey=encode(options.key),encodedValue=encode(options.value),expires=`; expires=${(options.expires||"").replace("expires=","")}`,path=(options.path||"/").replace("path=",""),domain=options.url!=null&&options.url.length>0?`domain=${options.url}`:"";document.cookie=`${encodedKey}=${encodedValue||""}${expires}; path=${path}; ${domain};`}catch(error){return Promise.reject(error)}}async deleteCookie(options){try{document.cookie=`${options.key}=; Max-Age=0`}catch(error){return Promise.reject(error)}}async clearCookies(){try{const cookies=document.cookie.split(";")||[];for(const cookie of cookies)document.cookie=cookie.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(error){return Promise.reject(error)}}async clearAllCookies(){try{await this.clearCookies()}catch(error){return Promise.reject(error)}}}const CapacitorCookies=registerPlugin("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb}),readBlobAsBase64=async blob=>new Promise((resolve,reject)=>{const reader=new FileReader;reader.onload=()=>{const base64String=reader.result;resolve(base64String.indexOf(",")>=0?base64String.split(",")[1]:base64String)},reader.onerror=error=>reject(error),reader.readAsDataURL(blob)}),normalizeHttpHeaders=(headers={})=>{const originalKeys=Object.keys(headers);return Object.keys(headers).map(k=>k.toLocaleLowerCase()).reduce((acc,key,index)=>(acc[key]=headers[originalKeys[index]],acc),{})},buildUrlParams=(params,shouldEncode=!0)=>params?Object.entries(params).reduce((accumulator,entry)=>{const[key,value]=entry;let encodedValue,item;return Array.isArray(value)?(item="",value.forEach(str=>{encodedValue=shouldEncode?encodeURIComponent(str):str,item+=`${key}=${encodedValue}&`}),item.slice(0,-1)):(encodedValue=shouldEncode?encodeURIComponent(value):value,item=`${key}=${encodedValue}`),`${accumulator}&${item}`},"").substr(1):null,buildRequestInit=(options,extra={})=>{const output=Object.assign({method:options.method||"GET",headers:options.headers},extra),type=normalizeHttpHeaders(options.headers)["content-type"]||"";if(typeof options.data=="string")output.body=options.data;else if(type.includes("application/x-www-form-urlencoded")){const params=new URLSearchParams;for(const[key,value]of Object.entries(options.data||{}))params.set(key,value);output.body=params.toString()}else if(type.includes("multipart/form-data")||options.data instanceof FormData){const form=new FormData;if(options.data instanceof FormData)options.data.forEach((value,key)=>{form.append(key,value)});else for(const key of Object.keys(options.data))form.append(key,options.data[key]);output.body=form;const headers2=new Headers(output.headers);headers2.delete("content-type"),output.headers=headers2}else(type.includes("application/json")||typeof options.data=="object")&&(output.body=JSON.stringify(options.data));return output};class CapacitorHttpPluginWeb extends WebPlugin{async request(options){const requestInit=buildRequestInit(options,options.webFetchExtra),urlParams=buildUrlParams(options.params,options.shouldEncodeUrlParams),url=urlParams?`${options.url}?${urlParams}`:options.url,response=await fetch(url,requestInit),contentType=response.headers.get("content-type")||"";let{responseType="text"}=response.ok?options:{};contentType.includes("application/json")&&(responseType="json");let data,blob;switch(responseType){case"arraybuffer":case"blob":blob=await response.blob(),data=await readBlobAsBase64(blob);break;case"json":data=await response.json();break;case"document":case"text":default:data=await response.text()}const headers={};return response.headers.forEach((value,key)=>{headers[key]=value}),{data,headers,status:response.status,url:response.url}}async get(options){return this.request(Object.assign(Object.assign({},options),{method:"GET"}))}async post(options){return this.request(Object.assign(Object.assign({},options),{method:"POST"}))}async put(options){return this.request(Object.assign(Object.assign({},options),{method:"PUT"}))}async patch(options){return this.request(Object.assign(Object.assign({},options),{method:"PATCH"}))}async delete(options){return this.request(Object.assign(Object.assign({},options),{method:"DELETE"}))}}const CapacitorHttp=registerPlugin("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb})},674:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.d(__webpack_exports__2,{Wi:()=>Encoding,__:()=>Directory});var Directory;(function(Directory2){Directory2.Documents="DOCUMENTS",Directory2.Data="DATA",Directory2.Library="LIBRARY",Directory2.Cache="CACHE",Directory2.External="EXTERNAL",Directory2.ExternalStorage="EXTERNAL_STORAGE"})(Directory||(Directory={}));var Encoding;(function(Encoding2){Encoding2.UTF8="utf8",Encoding2.ASCII="ascii",Encoding2.UTF16="utf16"})(Encoding||(Encoding={}));const FilesystemDirectory=null,FilesystemEncoding=null},522:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{FilesystemWeb:()=>FilesystemWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268),_definitions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__2(674);function resolve(path){const posix=path.split("/").filter(item=>item!=="."),newPosix=[];return posix.forEach(item=>{item===".."&&newPosix.length>0&&newPosix[newPosix.length-1]!==".."?newPosix.pop():newPosix.push(item)}),newPosix.join("/")}function isPathParent(parent,children){parent=resolve(parent),children=resolve(children);const pathsA=parent.split("/"),pathsB=children.split("/");return parent!==children&&pathsA.every((value,index)=>value===pathsB[index])}class FilesystemWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{constructor(){super(...arguments),this.DB_VERSION=1,this.DB_NAME="Disc",this._writeCmds=["add","put","delete"],this.downloadFile=async options=>{var _a,_b;const requestInit=(0,_capacitor_core__WEBPACK_IMPORTED_MODULE_0__.EA)(options,options.webFetchExtra),response=await fetch(options.url,requestInit);let blob;if(!options.progress)blob=await response.blob();else if(!response?.body)blob=new Blob;else{const reader=response.body.getReader();let bytes=0;const chunks=[],contentType=response.headers.get("content-type"),contentLength=parseInt(response.headers.get("content-length")||"0",10);for(;;){const{done,value}=await reader.read();if(done)break;chunks.push(value),bytes+=value?.length||0;const status={url:options.url,bytes,contentLength};this.notifyListeners("progress",status)}const allChunks=new Uint8Array(bytes);let position=0;for(const chunk of chunks)typeof chunk>"u"||(allChunks.set(chunk,position),position+=chunk.length);blob=new Blob([allChunks.buffer],{type:contentType||void 0})}return{path:(await this.writeFile({path:options.path,directory:(_a=options.directory)!==null&&_a!==void 0?_a:void 0,recursive:(_b=options.recursive)!==null&&_b!==void 0?_b:!1,data:blob})).uri,blob}}}async initDb(){if(this._db!==void 0)return this._db;if(!("indexedDB"in window))throw this.unavailable("This browser doesn't support IndexedDB");return new Promise((resolve2,reject)=>{const request=indexedDB.open(this.DB_NAME,this.DB_VERSION);request.onupgradeneeded=FilesystemWeb.doUpgrade,request.onsuccess=()=>{this._db=request.result,resolve2(request.result)},request.onerror=()=>reject(request.error),request.onblocked=()=>{console.warn("db blocked")}})}static doUpgrade(event){const db=event.target.result;switch(event.oldVersion){case 0:case 1:default:db.objectStoreNames.contains("FileStorage")&&db.deleteObjectStore("FileStorage"),db.createObjectStore("FileStorage",{keyPath:"path"}).createIndex("by_folder","folder")}}async dbRequest(cmd,args){const readFlag=this._writeCmds.indexOf(cmd)!==-1?"readwrite":"readonly";return this.initDb().then(conn=>new Promise((resolve2,reject)=>{const req=conn.transaction(["FileStorage"],readFlag).objectStore("FileStorage")[cmd](...args);req.onsuccess=()=>resolve2(req.result),req.onerror=()=>reject(req.error)}))}async dbIndexRequest(indexName,cmd,args){const readFlag=this._writeCmds.indexOf(cmd)!==-1?"readwrite":"readonly";return this.initDb().then(conn=>new Promise((resolve2,reject)=>{const req=conn.transaction(["FileStorage"],readFlag).objectStore("FileStorage").index(indexName)[cmd](...args);req.onsuccess=()=>resolve2(req.result),req.onerror=()=>reject(req.error)}))}getPath(directory,uriPath){const cleanedUriPath=uriPath!==void 0?uriPath.replace(/^[/]+|[/]+$/g,""):"";let fsPath="";return directory!==void 0&&(fsPath+="/"+directory),uriPath!==""&&(fsPath+="/"+cleanedUriPath),fsPath}async clear(){(await this.initDb()).transaction(["FileStorage"],"readwrite").objectStore("FileStorage").clear()}async readFile(options){const path=this.getPath(options.directory,options.path),entry=await this.dbRequest("get",[path]);if(entry===void 0)throw Error("File does not exist.");return{data:entry.content?entry.content:""}}async writeFile(options){const path=this.getPath(options.directory,options.path);let data=options.data;const encoding=options.encoding,doRecursive=options.recursive,occupiedEntry=await this.dbRequest("get",[path]);if(occupiedEntry&&occupiedEntry.type==="directory")throw Error("The supplied path is a directory.");const parentPath=path.substr(0,path.lastIndexOf("/"));if(await this.dbRequest("get",[parentPath])===void 0){const subDirIndex=parentPath.indexOf("/",1);if(subDirIndex!==-1){const parentArgPath=parentPath.substr(subDirIndex);await this.mkdir({path:parentArgPath,directory:options.directory,recursive:doRecursive})}}if(!encoding&&!(data instanceof Blob)&&(data=data.indexOf(",")>=0?data.split(",")[1]:data,!this.isBase64String(data)))throw Error("The supplied data is not valid base64 content.");const now=Date.now(),pathObj={path,folder:parentPath,type:"file",size:data instanceof Blob?data.size:data.length,ctime:now,mtime:now,content:data};return await this.dbRequest("put",[pathObj]),{uri:pathObj.path}}async appendFile(options){const path=this.getPath(options.directory,options.path);let data=options.data;const encoding=options.encoding,parentPath=path.substr(0,path.lastIndexOf("/")),now=Date.now();let ctime=now;const occupiedEntry=await this.dbRequest("get",[path]);if(occupiedEntry&&occupiedEntry.type==="directory")throw Error("The supplied path is a directory.");if(await this.dbRequest("get",[parentPath])===void 0){const subDirIndex=parentPath.indexOf("/",1);if(subDirIndex!==-1){const parentArgPath=parentPath.substr(subDirIndex);await this.mkdir({path:parentArgPath,directory:options.directory,recursive:!0})}}if(!encoding&&!this.isBase64String(data))throw Error("The supplied data is not valid base64 content.");if(occupiedEntry!==void 0){if(occupiedEntry.content instanceof Blob)throw Error("The occupied entry contains a Blob object which cannot be appended to.");occupiedEntry.content!==void 0&&!encoding?data=btoa(atob(occupiedEntry.content)+atob(data)):data=occupiedEntry.content+data,ctime=occupiedEntry.ctime}const pathObj={path,folder:parentPath,type:"file",size:data.length,ctime,mtime:now,content:data};await this.dbRequest("put",[pathObj])}async deleteFile(options){const path=this.getPath(options.directory,options.path);if(await this.dbRequest("get",[path])===void 0)throw Error("File does not exist.");if((await this.dbIndexRequest("by_folder","getAllKeys",[IDBKeyRange.only(path)])).length!==0)throw Error("Folder is not empty.");await this.dbRequest("delete",[path])}async mkdir(options){const path=this.getPath(options.directory,options.path),doRecursive=options.recursive,parentPath=path.substr(0,path.lastIndexOf("/")),depth=(path.match(/\//g)||[]).length,parentEntry=await this.dbRequest("get",[parentPath]),occupiedEntry=await this.dbRequest("get",[path]);if(depth===1)throw Error("Cannot create Root directory");if(occupiedEntry!==void 0)throw Error("Current directory does already exist.");if(!doRecursive&&depth!==2&&parentEntry===void 0)throw Error("Parent directory must exist");if(doRecursive&&depth!==2&&parentEntry===void 0){const parentArgPath=parentPath.substr(parentPath.indexOf("/",1));await this.mkdir({path:parentArgPath,directory:options.directory,recursive:doRecursive})}const now=Date.now(),pathObj={path,folder:parentPath,type:"directory",size:0,ctime:now,mtime:now};await this.dbRequest("put",[pathObj])}async rmdir(options){const{path,directory,recursive}=options,fullPath=this.getPath(directory,path),entry=await this.dbRequest("get",[fullPath]);if(entry===void 0)throw Error("Folder does not exist.");if(entry.type!=="directory")throw Error("Requested path is not a directory");const readDirResult=await this.readdir({path,directory});if(readDirResult.files.length!==0&&!recursive)throw Error("Folder is not empty");for(const entry2 of readDirResult.files){const entryPath=`${path}/${entry2.name}`;(await this.stat({path:entryPath,directory})).type==="file"?await this.deleteFile({path:entryPath,directory}):await this.rmdir({path:entryPath,directory,recursive})}await this.dbRequest("delete",[fullPath])}async readdir(options){const path=this.getPath(options.directory,options.path),entry=await this.dbRequest("get",[path]);if(options.path!==""&&entry===void 0)throw Error("Folder does not exist.");const entries=await this.dbIndexRequest("by_folder","getAllKeys",[IDBKeyRange.only(path)]);return{files:await Promise.all(entries.map(async e=>{let subEntry=await this.dbRequest("get",[e]);return subEntry===void 0&&(subEntry=await this.dbRequest("get",[e+"/"])),{name:e.substring(path.length+1),type:subEntry.type,size:subEntry.size,ctime:subEntry.ctime,mtime:subEntry.mtime,uri:subEntry.path}}))}}async getUri(options){const path=this.getPath(options.directory,options.path);let entry=await this.dbRequest("get",[path]);return entry===void 0&&(entry=await this.dbRequest("get",[path+"/"])),{uri:entry?.path||path}}async stat(options){const path=this.getPath(options.directory,options.path);let entry=await this.dbRequest("get",[path]);if(entry===void 0&&(entry=await this.dbRequest("get",[path+"/"])),entry===void 0)throw Error("Entry does not exist.");return{type:entry.type,size:entry.size,ctime:entry.ctime,mtime:entry.mtime,uri:entry.path}}async rename(options){await this._copy(options,!0)}async copy(options){return this._copy(options,!1)}async requestPermissions(){return{publicStorage:"granted"}}async checkPermissions(){return{publicStorage:"granted"}}async _copy(options,doRename=!1){let{toDirectory}=options;const{to,from,directory:fromDirectory}=options;if(!to||!from)throw Error("Both to and from must be provided");toDirectory||(toDirectory=fromDirectory);const fromPath=this.getPath(fromDirectory,from),toPath=this.getPath(toDirectory,to);if(fromPath===toPath)return{uri:toPath};if(isPathParent(fromPath,toPath))throw Error("To path cannot contain the from path");let toObj;try{toObj=await this.stat({path:to,directory:toDirectory})}catch{const toPathComponents=to.split("/");toPathComponents.pop();const toPath2=toPathComponents.join("/");if(toPathComponents.length>0&&(await this.stat({path:toPath2,directory:toDirectory})).type!=="directory")throw new Error("Parent directory of the to path is a file")}if(toObj&&toObj.type==="directory")throw new Error("Cannot overwrite a directory with a file");const fromObj=await this.stat({path:from,directory:fromDirectory}),updateTime=async(path,ctime2,mtime)=>{const fullPath=this.getPath(toDirectory,path),entry=await this.dbRequest("get",[fullPath]);entry.ctime=ctime2,entry.mtime=mtime,await this.dbRequest("put",[entry])},ctime=fromObj.ctime?fromObj.ctime:Date.now();switch(fromObj.type){case"file":{const file=await this.readFile({path:from,directory:fromDirectory});doRename&&await this.deleteFile({path:from,directory:fromDirectory});let encoding;!(file.data instanceof Blob)&&!this.isBase64String(file.data)&&(encoding=_definitions__WEBPACK_IMPORTED_MODULE_1__.Wi.UTF8);const writeResult=await this.writeFile({path:to,directory:toDirectory,data:file.data,encoding});return doRename&&await updateTime(to,ctime,fromObj.mtime),writeResult}case"directory":{if(toObj)throw Error("Cannot move a directory over an existing object");try{await this.mkdir({path:to,directory:toDirectory,recursive:!1}),doRename&&await updateTime(to,ctime,fromObj.mtime)}catch{}const contents=(await this.readdir({path:from,directory:fromDirectory})).files;for(const filename of contents)await this._copy({from:`${from}/${filename.name}`,to:`${to}/${filename.name}`,directory:fromDirectory,toDirectory},doRename);doRename&&await this.rmdir({path:from,directory:fromDirectory})}}return{uri:toPath}}isBase64String(str){try{return btoa(atob(str))==str}catch{return!1}}}FilesystemWeb._debug=!0},817:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{PreferencesWeb:()=>PreferencesWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class PreferencesWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{constructor(){super(...arguments),this.group="CapacitorStorage"}async configure({group}){typeof group=="string"&&(this.group=group)}async get(options){return{value:this.impl.getItem(this.applyPrefix(options.key))}}async set(options){this.impl.setItem(this.applyPrefix(options.key),options.value)}async remove(options){this.impl.removeItem(this.applyPrefix(options.key))}async keys(){return{keys:this.rawKeys().map(k=>k.substring(this.prefix.length))}}async clear(){for(const key of this.rawKeys())this.impl.removeItem(key)}async migrate(){var _a;const migrated=[],existing=[],oldprefix="_cap_",keys=Object.keys(this.impl).filter(k=>k.indexOf(oldprefix)===0);for(const oldkey of keys){const key=oldkey.substring(oldprefix.length),value=(_a=this.impl.getItem(oldkey))!==null&&_a!==void 0?_a:"",{value:currentValue}=await this.get({key});typeof currentValue=="string"?existing.push(key):(await this.set({key,value}),migrated.push(key))}return{migrated,existing}}async removeOld(){const oldprefix="_cap_",keys=Object.keys(this.impl).filter(k=>k.indexOf(oldprefix)===0);for(const oldkey of keys)this.impl.removeItem(oldkey)}get impl(){return window.localStorage}get prefix(){return this.group==="NativeStorage"?"":`${this.group}.`}rawKeys(){return Object.keys(this.impl).filter(k=>k.indexOf(this.prefix)===0)}applyPrefix(key){return this.prefix+key}}},878:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{ShareWeb:()=>ShareWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class ShareWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{async canShare(){return typeof navigator>"u"||!navigator.share?{value:!1}:{value:!0}}async share(options){if(typeof navigator>"u"||!navigator.share)throw this.unavailable("Share API not available in this browser");return await navigator.share({title:options.title,text:options.text,url:options.url}),{}}}},722:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{ToastWeb:()=>ToastWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class ToastWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{async show(options){if(typeof document<"u"){let duration=2e3;options.duration&&(duration=options.duration==="long"?3500:2e3);const toast=document.createElement("pwa-toast");toast.duration=duration,toast.message=options.text,document.body.appendChild(toast)}}}},223:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{H:()=>Host,b:()=>bootstrapLazy,c:()=>createEvent,f:()=>forceUpdate,g:()=>getElement,h:()=>h,p:()=>promiseResolve,r:()=>registerInstance,s:()=>setNonce});var __extends=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e2,t2){e2.__proto__=t2}||function(e2,t2){for(var n2 in t2)Object.prototype.hasOwnProperty.call(t2,n2)&&(e2[n2]=t2[n2])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),__awaiter=function(e,t,n,r){function a(e2){return e2 instanceof n?e2:new n(function(t2){t2(e2)})}return new(n||(n=Promise))(function(n2,o){function s(e2){try{l(r.next(e2))}catch(e3){o(e3)}}function i(e2){try{l(r.throw(e2))}catch(e3){o(e3)}}function l(e2){e2.done?n2(e2.value):a(e2.value).then(s,i)}l((r=r.apply(e,t||[])).next())})},__generator=function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,a,o,s;return s={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function i(e2){return function(t2){return l([e2,t2])}}function l(i2){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i2[0]&&(n=0)),n;)try{if(r=1,a&&(o=i2[0]&2?a.return:i2[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,i2[1])).done)return o;switch(a=0,o&&(i2=[i2[0]&2,o.value]),i2[0]){case 0:case 1:o=i2;break;case 4:return n.label++,{value:i2[1],done:!1};case 5:n.label++,a=i2[1],i2=[0];continue;case 7:i2=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(i2[0]===6||i2[0]===2)){n=0;continue}if(i2[0]===3&&(!o||i2[1]>o[0]&&i2[1]<o[3])){n.label=i2[1];break}if(i2[0]===6&&n.label<o[1]){n.label=o[1],o=i2;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(i2);break}o[2]&&n.ops.pop(),n.trys.pop();continue}i2=t.call(e,n)}catch(e2){i2=[6,e2],a=0}finally{r=o=0}if(i2[0]&5)throw i2[1];return{value:i2[0]?i2[1]:void 0,done:!0}}},__spreadArray=function(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},NAMESPACE="ionicpwaelements",scopeId,hostTagName,isSvgMode=!1,queuePending=!1,createTime=function(e,t){return t===void 0&&(t=""),function(){}},uniqueTime=function(e,t){return function(){}},HYDRATED_CSS="{visibility:hidden}.hydrated{visibility:inherit}",EMPTY_OBJ={},SVG_NS="http://www.w3.org/2000/svg",HTML_NS="http://www.w3.org/1999/xhtml",isDef=function(e){return e!=null},isComplexType=function(e){return e=typeof e,e==="object"||e==="function"};function queryNonceMetaTagContent(e){var t,n,r;return(r=(n=(t=e.head)===null||t===void 0?void 0:t.querySelector('meta[name="csp-nonce"]'))===null||n===void 0?void 0:n.getAttribute("content"))!==null&&r!==void 0?r:void 0}var h=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a=null,o=!1,s=!1,i=[],l=function(t2){for(var n2=0;n2<t2.length;n2++)a=t2[n2],Array.isArray(a)?l(a):a!=null&&typeof a!="boolean"&&((o=typeof e!="function"&&!isComplexType(a))&&(a=String(a)),o&&s?i[i.length-1].$text$+=a:i.push(o?newVNode(null,a):a),s=o)};if(l(n),t){var u=t.className||t.class;u&&(t.class=typeof u!="object"?u:Object.keys(u).filter(function(e2){return u[e2]}).join(" "))}var c=newVNode(e,null);return c.$attrs$=t,i.length>0&&(c.$children$=i),c},newVNode=function(e,t){var n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n},Host={},isHost=function(e){return e&&e.$tag$===Host},parsePropertyValue=function(e,t){return e!=null&&!isComplexType(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e},getElement=function(e){return getHostRef(e).$hostElement$},createEvent=function(e,t,n){var r=getElement(e);return{emit:function(e2){return emitEvent(r,t,{bubbles:!!(n&4),composed:!!(n&2),cancelable:!!(n&1),detail:e2})}}},emitEvent=function(e,t,n){var r=plt.ce(t,n);return e.dispatchEvent(r),r},rootAppliedStyles=new WeakMap,registerStyle=function(e,t,n){var r=styles.get(e);supportsConstructableStylesheets&&n?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,styles.set(e,r)},addStyle=function(e,t,n,r){var a,o=getScopeId(t),s=styles.get(o);if(e=e.nodeType===11?e:doc,s)if(typeof s=="string"){e=e.head||e;var i=rootAppliedStyles.get(e),l=void 0;if(i||rootAppliedStyles.set(e,i=new Set),!i.has(o)){{l=doc.createElement("style"),l.innerHTML=s;var u=(a=plt.$nonce$)!==null&&a!==void 0?a:queryNonceMetaTagContent(doc);u!=null&&l.setAttribute("nonce",u),e.insertBefore(l,e.querySelector("link"))}i&&i.add(o)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=__spreadArray(__spreadArray([],e.adoptedStyleSheets,!0),[s],!1));return o},attachStyles=function(e){var t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=createTime("attachStyles",t.$tagName$),o=addStyle(n.shadowRoot?n.shadowRoot:n.getRootNode(),t);r&10&&(n["s-sc"]=o,n.classList.add(o+"-h")),a()},getScopeId=function(e,t){return"sc-"+e.$tagName$},setAccessor=function(e,t,n,r,a,o){if(n!==r){var s=isMemberInElement(e,t),i=t.toLowerCase();if(t==="class"){var l=e.classList,u=parseClassList(n),c=parseClassList(r);l.remove.apply(l,u.filter(function(e2){return e2&&!c.includes(e2)})),l.add.apply(l,c.filter(function(e2){return e2&&!u.includes(e2)}))}else if(t==="style"){for(var f in n)(!r||r[f]==null)&&(f.includes("-")?e.style.removeProperty(f):e.style[f]="");for(var f in r)(!n||r[f]!==n[f])&&(f.includes("-")?e.style.setProperty(f,r[f]):e.style[f]=r[f])}else if(t==="ref")r&&r(e);else if(!s&&t[0]==="o"&&t[1]==="n")t[2]==="-"?t=t.slice(3):isMemberInElement(win,i)?t=i.slice(2):t=i[2]+t.slice(3),n&&plt.rel(e,t,n,!1),r&&plt.ael(e,t,r,!1);else{var $=isComplexType(r);if((s||$&&r!==null)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{var d=r??"";t==="list"?s=!1:(n==null||e[t]!=d)&&(e[t]=d)}}catch{}r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&e.removeAttribute(t):(!s||o&4||a)&&!$&&(r=r===!0?"":r,e.setAttribute(t,r))}}},parseClassListRegex=/\s/,parseClassList=function(e){return e?e.split(parseClassListRegex):[]},updateElement=function(e,t,n,r){var a=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,o=e&&e.$attrs$||EMPTY_OBJ,s=t.$attrs$||EMPTY_OBJ;for(r in o)r in s||setAccessor(a,r,o[r],void 0,n,t.$flags$);for(r in s)setAccessor(a,r,o[r],s[r],n,t.$flags$)},createElm=function(e,t,n,r){var a=t.$children$[n],o=0,s,i;if(a.$text$!==null)s=a.$elm$=doc.createTextNode(a.$text$);else{if(isSvgMode||(isSvgMode=a.$tag$==="svg"),s=a.$elm$=doc.createElementNS(isSvgMode?SVG_NS:HTML_NS,a.$tag$),isSvgMode&&a.$tag$==="foreignObject"&&(isSvgMode=!1),updateElement(null,a,isSvgMode),isDef(scopeId)&&s["s-si"]!==scopeId&&s.classList.add(s["s-si"]=scopeId),a.$children$)for(o=0;o<a.$children$.length;++o)i=createElm(e,a,o),i&&s.appendChild(i);a.$tag$==="svg"?isSvgMode=!1:s.tagName==="foreignObject"&&(isSvgMode=!0)}return s},addVnodes=function(e,t,n,r,a,o){var s=e,i;for(s.shadowRoot&&s.tagName===hostTagName&&(s=s.shadowRoot);a<=o;++a)r[a]&&(i=createElm(null,n,a),i&&(r[a].$elm$=i,s.insertBefore(i,t)))},removeVnodes=function(e,t,n){for(var r=t;r<=n;++r){var a=e[r];if(a){var o=a.$elm$;nullifyVNodeRefs(a),o&&o.remove()}}},updateChildren=function(e,t,n,r){for(var a=0,o=0,s=t.length-1,i=t[0],l=t[s],u=r.length-1,c=r[0],f=r[u],$;a<=s&&o<=u;)i==null?i=t[++a]:l==null?l=t[--s]:c==null?c=r[++o]:f==null?f=r[--u]:isSameVnode(i,c)?(patch(i,c),i=t[++a],c=r[++o]):isSameVnode(l,f)?(patch(l,f),l=t[--s],f=r[--u]):isSameVnode(i,f)?(patch(i,f),e.insertBefore(i.$elm$,l.$elm$.nextSibling),i=t[++a],f=r[--u]):isSameVnode(l,c)?(patch(l,c),e.insertBefore(l.$elm$,i.$elm$),l=t[--s],c=r[++o]):($=createElm(t&&t[o],n,o),c=r[++o],$&&i.$elm$.parentNode.insertBefore($,i.$elm$));a>s?addVnodes(e,r[u+1]==null?null:r[u+1].$elm$,n,r,o,u):o>u&&removeVnodes(t,a,s)},isSameVnode=function(e,t){return e.$tag$===t.$tag$},patch=function(e,t){var n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,o=t.$tag$,s=t.$text$;s===null?(isSvgMode=o==="svg"?!0:o==="foreignObject"?!1:isSvgMode,updateElement(e,t,isSvgMode),r!==null&&a!==null?updateChildren(n,r,t,a):a!==null?(e.$text$!==null&&(n.textContent=""),addVnodes(n,null,t,a,0,a.length-1)):r!==null&&removeVnodes(r,0,r.length-1),isSvgMode&&o==="svg"&&(isSvgMode=!1)):e.$text$!==s&&(n.data=s)},nullifyVNodeRefs=function(e){e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(nullifyVNodeRefs)},renderVdom=function(e,t){var n=e.$hostElement$,r=e.$vnode$||newVNode(null,null),a=isHost(t)?t:h(null,null,t);hostTagName=n.tagName,a.$tag$=null,a.$flags$|=4,e.$vnode$=a,a.$elm$=r.$elm$=n.shadowRoot||n,scopeId=n["s-sc"],patch(r,a)},attachToAncestor=function(e,t){t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise(function(t2){return e.$onRenderResolve$=t2}))},scheduleUpdate=function(e,t){if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}attachToAncestor(e,e.$ancestorComponent$);var n=function(){return dispatchHooks(e,t)};return writeTask(n)},dispatchHooks=function(e,t){var n=createTime("scheduleUpdate",e.$cmpMeta$.$tagName$),r=e.$lazyInstance$,a;return t&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map(function(e2){var t2=e2[0],n2=e2[1];return safeCall(r,t2,n2)}),e.$queuedListeners$=void 0)),n(),enqueue(a,function(){return updateComponent(e,r,t)})},enqueue=function(e,t){return isPromisey(e)?e.then(t):t()},isPromisey=function(e){return e instanceof Promise||e&&e.then&&typeof e.then=="function"},updateComponent=function(e,t,n){return __awaiter(void 0,void 0,void 0,function(){var r,a,o,s,i,l,u;return __generator(this,function(c){return a=e.$hostElement$,o=createTime("update",e.$cmpMeta$.$tagName$),s=a["s-rc"],n&&attachStyles(e),i=createTime("render",e.$cmpMeta$.$tagName$),callRender(e,t),s&&(s.map(function(e2){return e2()}),a["s-rc"]=void 0),i(),o(),l=(r=a["s-p"])!==null&&r!==void 0?r:[],u=function(){return postUpdateComponent(e)},l.length===0?u():(Promise.all(l).then(u),e.$flags$|=4,l.length=0),[2]})})},callRender=function(e,t,n){try{t=t.render(),e.$flags$&=-17,e.$flags$|=2,renderVdom(e,t)}catch(t2){consoleError(t2,e.$hostElement$)}return null},postUpdateComponent=function(e){var t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=createTime("postUpdate",t),a=e.$lazyInstance$,o=e.$ancestorComponent$;e.$flags$&64?r():(e.$flags$|=64,addHydratedFlag(n),safeCall(a,"componentDidLoad"),r(),e.$onReadyResolve$(n),o||appDidLoad()),e.$onInstanceResolve$(n),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&nextTick(function(){return scheduleUpdate(e,!1)}),e.$flags$&=-517},forceUpdate=function(e){{var t=getHostRef(e),n=t.$hostElement$.isConnected;return n&&(t.$flags$&18)===2&&scheduleUpdate(t,!1),n}},appDidLoad=function(e){addHydratedFlag(doc.documentElement),nextTick(function(){return emitEvent(win,"appload",{detail:{namespace:NAMESPACE}})})},safeCall=function(e,t,n){if(e&&e[t])try{return e[t](n)}catch(e2){consoleError(e2)}},addHydratedFlag=function(e){return e.classList.add("hydrated")},getValue=function(e,t){return getHostRef(e).$instanceValues$.get(t)},setValue=function(e,t,n,r){var a=getHostRef(e),o=a.$instanceValues$.get(t),s=a.$flags$,i=a.$lazyInstance$;n=parsePropertyValue(n,r.$members$[t][0]);var l=Number.isNaN(o)&&Number.isNaN(n),u=n!==o&&!l;(!(s&8)||o===void 0)&&u&&(a.$instanceValues$.set(t,n),i&&(s&18)===2&&scheduleUpdate(a,!1))},proxyComponent=function(e,t,n){if(t.$members$){var r=Object.entries(t.$members$),a=e.prototype;if(r.map(function(e2){var r2=e2[0],o2=e2[1][0];o2&31||n&2&&o2&32?Object.defineProperty(a,r2,{get:function(){return getValue(this,r2)},set:function(e3){setValue(this,r2,e3,t)},configurable:!0,enumerable:!0}):n&1&&o2&64&&Object.defineProperty(a,r2,{value:function(){for(var e3=[],t2=0;t2<arguments.length;t2++)e3[t2]=arguments[t2];var n2=getHostRef(this);return n2.$onInstancePromise$.then(function(){var t3;return(t3=n2.$lazyInstance$)[r2].apply(t3,e3)})}})}),n&1){var o=new Map;a.attributeChangedCallback=function(e2,t2,n2){var r2=this;plt.jmp(function(){var t3=o.get(e2);if(r2.hasOwnProperty(t3))n2=r2[t3],delete r2[t3];else if(a.hasOwnProperty(t3)&&typeof r2[t3]=="number"&&r2[t3]==n2)return;r2[t3]=n2===null&&typeof r2[t3]=="boolean"?!1:n2})},e.observedAttributes=r.filter(function(e2){var t2=e2[0],n2=e2[1];return n2[0]&15}).map(function(e2){var t2=e2[0],n2=e2[1],r2=n2[1]||t2;return o.set(r2,t2),r2})}}return e},initializeComponent=function(e,t,n,r,a){return __awaiter(void 0,void 0,void 0,function(){var e2,r2,o,s,i,l,u;return __generator(this,function(c){switch(c.label){case 0:return t.$flags$&32?[3,3]:(t.$flags$|=32,a=loadModule(n),a.then?(e2=uniqueTime(),[4,a]):[3,2]);case 1:a=c.sent(),e2(),c.label=2;case 2:a.isProxied||(proxyComponent(a,n,2),a.isProxied=!0),r2=createTime("createInstance",n.$tagName$),t.$flags$|=8;try{new a(t)}catch(e3){consoleError(e3)}t.$flags$&=-9,r2(),a.style&&(o=a.style,s=getScopeId(n),styles.has(s)||(i=createTime("registerStyles",n.$tagName$),registerStyle(s,o,!!(n.$flags$&1)),i())),c.label=3;case 3:return l=t.$ancestorComponent$,u=function(){return scheduleUpdate(t,!0)},l&&l["s-rc"]?l["s-rc"].push(u):u(),[2]}})})},connectedCallback=function(e){if(!(plt.$flags$&1)){var t=getHostRef(e),n=t.$cmpMeta$,r=createTime("connectedCallback",n.$tagName$);if(t.$flags$&1)addHostEventListeners(e,t,n.$listeners$);else{t.$flags$|=1;for(var a=e;a=a.parentNode||a.host;)if(a["s-p"]){attachToAncestor(t,t.$ancestorComponent$=a);break}n.$members$&&Object.entries(n.$members$).map(function(t2){var n2=t2[0],r2=t2[1][0];if(r2&31&&e.hasOwnProperty(n2)){var a2=e[n2];delete e[n2],e[n2]=a2}}),initializeComponent(e,t,n)}r()}},disconnectedCallback=function(e){if(!(plt.$flags$&1)){var t=getHostRef(e),n=t.$lazyInstance$;t.$rmListeners$&&(t.$rmListeners$.map(function(e2){return e2()}),t.$rmListeners$=void 0),safeCall(n,"disconnectedCallback")}},bootstrapLazy=function(e,t){t===void 0&&(t={});var n,r=createTime(),a=[],o=t.exclude||[],s=win.customElements,i=doc.head,l=i.querySelector("meta[charset]"),u=doc.createElement("style"),c=[],f,$=!0;Object.assign(plt,t),plt.$resourcesUrl$=new URL(t.resourcesUrl||"./",doc.baseURI).href,e.map(function(e2){e2[1].map(function(t2){var n2={$flags$:t2[0],$tagName$:t2[1],$members$:t2[2],$listeners$:t2[3]};n2.$members$=t2[2],n2.$listeners$=t2[3];var r2=n2.$tagName$,i2=function(e3){__extends(t3,e3);function t3(t4){var r3=e3.call(this,t4)||this;return t4=r3,registerHost(t4,n2),n2.$flags$&1&&t4.attachShadow({mode:"open"}),r3}return t3.prototype.connectedCallback=function(){var e4=this;f&&(clearTimeout(f),f=null),$?c.push(this):plt.jmp(function(){return connectedCallback(e4)})},t3.prototype.disconnectedCallback=function(){var e4=this;plt.jmp(function(){return disconnectedCallback(e4)})},t3.prototype.componentOnReady=function(){return getHostRef(this).$onReadyPromise$},t3}(HTMLElement);n2.$lazyBundleId$=e2[0],!o.includes(r2)&&!s.get(r2)&&(a.push(r2),s.define(r2,proxyComponent(i2,n2,1)))})});{u.innerHTML=a+HYDRATED_CSS,u.setAttribute("data-styles","");var d=(n=plt.$nonce$)!==null&&n!==void 0?n:queryNonceMetaTagContent(doc);d!=null&&u.setAttribute("nonce",d),i.insertBefore(u,l?l.nextSibling:i.firstChild)}$=!1,c.length?c.map(function(e2){return e2.connectedCallback()}):plt.jmp(function(){return f=setTimeout(appDidLoad,30)}),r()},addHostEventListeners=function(e,t,n,r){n&&n.map(function(n2){var r2=n2[0],a=n2[1],o=n2[2],s=getHostListenerTarget(e,r2),i=hostListenerProxy(t,o),l=hostListenerOpts(r2);plt.ael(s,a,i,l),(t.$rmListeners$=t.$rmListeners$||[]).push(function(){return plt.rel(s,a,i,l)})})},hostListenerProxy=function(e,t){return function(n){try{e.$flags$&256?e.$lazyInstance$[t](n):(e.$queuedListeners$=e.$queuedListeners$||[]).push([t,n])}catch(e2){consoleError(e2)}}},getHostListenerTarget=function(e,t){return t&16?doc.body:e},hostListenerOpts=function(e){return(e&2)!==0},setNonce=function(e){return plt.$nonce$=e},hostRefs=new WeakMap,getHostRef=function(e){return hostRefs.get(e)},registerInstance=function(e,t){return hostRefs.set(t.$lazyInstance$=e,t)},registerHost=function(e,t){var n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return n.$onInstancePromise$=new Promise(function(e2){return n.$onInstanceResolve$=e2}),n.$onReadyPromise$=new Promise(function(e2){return n.$onReadyResolve$=e2}),e["s-p"]=[],e["s-rc"]=[],addHostEventListeners(e,n,t.$listeners$),hostRefs.set(e,n)},isMemberInElement=function(e,t){return t in e},consoleError=function(e,t){return(0,console.error)(e,t)},cmpModules=new Map,loadModule=function(e,t,n){var r=e.$tagName$.replace(/-/g,"_"),a=e.$lazyBundleId$,o=cmpModules.get(a);if(o)return o[r];if(!n||!BUILD.hotModuleReplacement){var s=function(e2){return cmpModules.set(a,e2),e2[r]};switch(a){case"pwa-action-sheet":return Promise.resolve().then(__webpack_require__2.bind(__webpack_require__2,850)).then(s,consoleError);case"pwa-camera-modal":return Promise.resolve().then(__webpack_require__2.bind(__webpack_require__2,602)).then(s,consoleError);case"pwa-toast":return Promise.resolve().then(__webpack_require__2.bind(__webpack_require__2,339)).then(s,consoleError);case"pwa-camera-modal-instance":return Promise.resolve().then(__webpack_require__2.bind(__webpack_require__2,569)).then(s,consoleError);case"pwa-camera":return Promise.resolve().then(__webpack_require__2.bind(__webpack_require__2,965)).then(s,consoleError)}}return __webpack_require__2(725)("./".concat(a,".entry.js").concat("")).then(function(e2){return cmpModules.set(a,e2),e2[r]},consoleError)},styles=new Map,win=typeof window<"u"?window:{},doc=win.document||{head:{}},plt={$flags$:0,$resourcesUrl$:"",jmp:function(e){return e()},raf:function(e){return requestAnimationFrame(e)},ael:function(e,t,n,r){return e.addEventListener(t,n,r)},rel:function(e,t,n,r){return e.removeEventListener(t,n,r)},ce:function(e,t){return new CustomEvent(e,t)}},promiseResolve=function(e){return Promise.resolve(e)},supportsConstructableStylesheets=function(){try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1}(),queueDomReads=[],queueDomWrites=[],queueTask=function(e,t){return function(n){e.push(n),queuePending||(queuePending=!0,t&&plt.$flags$&4?nextTick(flush):plt.raf(flush))}},consume=function(e){for(var t=0;t<e.length;t++)try{e[t](performance.now())}catch(e2){consoleError(e2)}e.length=0},flush=function(){consume(queueDomReads),consume(queueDomWrites),(queuePending=queueDomReads.length>0)&&plt.raf(flush)},nextTick=function(e){return promiseResolve().then(e)},writeTask=queueTask(queueDomWrites,!0)},423:()=>{},824:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{setNonce:()=>_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.s});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),patchBrowser=function(){var e="file:///home/x/functora.github.io/ghcjs/miso-functora/node_modules/@ionic/pwa-elements/dist/esm-es5/ionicpwaelements.js",a={};return e!==""&&(a.resourcesUrl=new URL(".",e).href),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.p)(a)};patchBrowser().then(function(e){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.b)([["pwa-camera-modal",[[1,"pwa-camera-modal",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],present:[64],dismiss:[64]}]]],["pwa-action-sheet",[[1,"pwa-action-sheet",{header:[1],cancelable:[4],options:[16],open:[32]}]]],["pwa-toast",[[1,"pwa-toast",{message:[1],duration:[2],closing:[32]}]]],["pwa-camera",[[1,"pwa-camera",{facingMode:[1,"facing-mode"],handlePhoto:[16],hidePicker:[4,"hide-picker"],handleNoDeviceError:[16],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"],photo:[32],photoSrc:[32],showShutterOverlay:[32],flashIndex:[32],hasCamera:[32],rotation:[32],deviceError:[32]}]]],["pwa-camera-modal-instance",[[1,"pwa-camera-modal-instance",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"]},[[16,"keyup","handleBackdropKeyUp"]]]]]],e)})},428:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{defineCustomElements:()=>defineCustomElements,setNonce:()=>_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.s});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),patchEsm=function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.p)()},defineCustomElements=function(e,o){return typeof window>"u"?Promise.resolve():patchEsm().then(function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.b)([["pwa-camera-modal",[[1,"pwa-camera-modal",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],present:[64],dismiss:[64]}]]],["pwa-action-sheet",[[1,"pwa-action-sheet",{header:[1],cancelable:[4],options:[16],open:[32]}]]],["pwa-toast",[[1,"pwa-toast",{message:[1],duration:[2],closing:[32]}]]],["pwa-camera",[[1,"pwa-camera",{facingMode:[1,"facing-mode"],handlePhoto:[16],hidePicker:[4,"hide-picker"],handleNoDeviceError:[16],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"],photo:[32],photoSrc:[32],showShutterOverlay:[32],flashIndex:[32],hasCamera:[32],rotation:[32],deviceError:[32]}]]],["pwa-camera-modal-instance",[[1,"pwa-camera-modal-instance",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"]},[[16,"keyup","handleBackdropKeyUp"]]]]]],o)})}},850:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{pwa_action_sheet:()=>PWAActionSheet});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),actionSheetCss=':host{z-index:1000;position:fixed;top:0;left:0;width:100%;height:100%;display:-ms-flexbox;display:flex;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:-apple-system, BlinkMacSystemFont, "Helvetica Neue", "Roboto", sans-serif}.wrapper{-ms-flex:1;flex:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background-color:rgba(0, 0, 0, 0);-webkit-transition:400ms background-color cubic-bezier(.36,.66,.04,1);transition:400ms background-color cubic-bezier(.36,.66,.04,1)}.wrapper.open{background-color:rgba(0, 0, 0, 0.32)}.title{color:#999;height:23px;line-height:23px;padding-bottom:17px;-webkit-padding-end:16px;padding-inline-end:16px;-webkit-padding-start:16px;padding-inline-start:16px;padding-left:16px;padding-right:16px;padding-top:20px}.content{width:568px;-ms-flex-item-align:end;align-self:flex-end;background-color:#fff;-webkit-transition:400ms -webkit-transform cubic-bezier(.36,.66,.04,1);transition:400ms -webkit-transform cubic-bezier(.36,.66,.04,1);transition:400ms transform cubic-bezier(.36,.66,.04,1);transition:400ms transform cubic-bezier(.36,.66,.04,1), 400ms -webkit-transform cubic-bezier(.36,.66,.04,1);-webkit-transform:translateY(100%);transform:translateY(100%)}.wrapper.open .content{-webkit-transform:translateY(0%);transform:translateY(0%)}@media only screen and (max-width: 568px){.content{width:100%}}.action-sheet-option{cursor:pointer;height:52px;line-height:52px}.action-sheet-button{color:rgb(38, 38, 38);font-size:16px;-webkit-padding-end:16px;padding-inline-end:16px;-webkit-padding-start:16px;padding-inline-start:16px;padding-left:16px;padding-right:16px;padding-top:0px}.action-sheet-button:hover{background-color:#F6F6F6}',PWAActionSheet=function(){function e(e2){(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,e2),this.onSelection=(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"onSelection",7),this.header=void 0,this.cancelable=!0,this.options=[],this.open=!1}return e.prototype.componentDidLoad=function(){var e2=this;requestAnimationFrame(function(){e2.open=!0})},e.prototype.dismiss=function(){this.cancelable&&this.close()},e.prototype.close=function(){var e2=this;this.open=!1,setTimeout(function(){e2.el.parentNode.removeChild(e2.el)},500)},e.prototype.handleOptionClick=function(e2,t){e2.stopPropagation(),this.onSelection.emit(t),this.close()},e.prototype.render=function(){var e2=this;return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"wrapper".concat(this.open?" open":""),onClick:function(){return e2.dismiss()}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"content"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"title"},this.header),this.options.map(function(t,n){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"action-sheet-option",onClick:function(t2){return e2.handleOptionClick(t2,n)}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"action-sheet-button"},t.title))})))},Object.defineProperty(e.prototype,"el",{get:function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)},enumerable:!1,configurable:!0}),e}();PWAActionSheet.style=actionSheetCss},569:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{pwa_camera_modal_instance:()=>PWACameraModal});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),__awaiter=function(e,t,n,o){function r(e2){return e2 instanceof n?e2:new n(function(t2){t2(e2)})}return new(n||(n=Promise))(function(n2,i){function a(e2){try{s(o.next(e2))}catch(e3){i(e3)}}function c(e2){try{s(o.throw(e2))}catch(e3){i(e3)}}function s(e2){e2.done?n2(e2.value):r(e2.value).then(a,c)}s((o=o.apply(e,t||[])).next())})},__generator=function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,r,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(e2){return function(t2){return s([e2,t2])}}function s(c2){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c2[0]&&(n=0)),n;)try{if(o=1,r&&(i=c2[0]&2?r.return:c2[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c2[1])).done)return i;switch(r=0,i&&(c2=[c2[0]&2,i.value]),c2[0]){case 0:case 1:i=c2;break;case 4:return n.label++,{value:c2[1],done:!1};case 5:n.label++,r=c2[1],c2=[0];continue;case 7:c2=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c2[0]===6||c2[0]===2)){n=0;continue}if(c2[0]===3&&(!i||c2[1]>i[0]&&c2[1]<i[3])){n.label=c2[1];break}if(c2[0]===6&&n.label<i[1]){n.label=i[1],i=c2;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c2);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c2=t.call(e,n)}catch(e2){c2=[6,e2],r=0}finally{o=i=0}if(c2[0]&5)throw c2[1];return{value:c2[0]?c2[1]:void 0,done:!0}}},cameraModalInstanceCss=":host{z-index:1000;position:fixed;top:0;left:0;width:100%;height:100%;display:-ms-flexbox;display:flex;contain:strict;--inset-width:600px;--inset-height:600px}.wrapper{-ms-flex:1;flex:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background-color:rgba(0, 0, 0, 0.15)}.content{-webkit-box-shadow:0px 0px 5px rgba(0, 0, 0, 0.2);box-shadow:0px 0px 5px rgba(0, 0, 0, 0.2);width:var(--inset-width);height:var(--inset-height);max-height:100%}@media only screen and (max-width: 600px){.content{width:100%;height:100%}}",PWACameraModal=function(){function e(e2){var t=this;(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,e2),this.onPhoto=(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"onPhoto",7),this.noDeviceError=(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"noDeviceError",7),this.handlePhoto=function(e3){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t2){return this.onPhoto.emit(e3),[2]})})},this.handleNoDeviceError=function(e3){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t2){return this.noDeviceError.emit(e3),[2]})})},this.facingMode="user",this.hidePicker=!1,this.noDevicesText="No camera found",this.noDevicesButtonText="Choose image"}return e.prototype.handleBackdropClick=function(e2){e2.target!==this.el&&this.onPhoto.emit(null)},e.prototype.handleComponentClick=function(e2){e2.stopPropagation()},e.prototype.handleBackdropKeyUp=function(e2){e2.key==="Escape"&&this.onPhoto.emit(null)},e.prototype.render=function(){var e2=this;return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"wrapper",onClick:function(t){return e2.handleBackdropClick(t)}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"content"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("pwa-camera",{onClick:function(t){return e2.handleComponentClick(t)},facingMode:this.facingMode,hidePicker:this.hidePicker,handlePhoto:this.handlePhoto,handleNoDeviceError:this.handleNoDeviceError,noDevicesButtonText:this.noDevicesButtonText,noDevicesText:this.noDevicesText})))},Object.defineProperty(e.prototype,"el",{get:function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)},enumerable:!1,configurable:!0}),e}();PWACameraModal.style=cameraModalInstanceCss},602:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{pwa_camera_modal:()=>PWACameraModal});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),__awaiter=function(e,t,n,r){function i(e2){return e2 instanceof n?e2:new n(function(t2){t2(e2)})}return new(n||(n=Promise))(function(n2,o){function a(e2){try{c(r.next(e2))}catch(e3){o(e3)}}function s(e2){try{c(r.throw(e2))}catch(e3){o(e3)}}function c(e2){e2.done?n2(e2.value):i(e2.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},__generator=function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e2){return function(t2){return c([e2,t2])}}function c(s2){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s2[0]&&(n=0)),n;)try{if(r=1,i&&(o=s2[0]&2?i.return:s2[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s2[1])).done)return o;switch(i=0,o&&(s2=[s2[0]&2,o.value]),s2[0]){case 0:case 1:o=s2;break;case 4:return n.label++,{value:s2[1],done:!1};case 5:n.label++,i=s2[1],s2=[0];continue;case 7:s2=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(s2[0]===6||s2[0]===2)){n=0;continue}if(s2[0]===3&&(!o||s2[1]>o[0]&&s2[1]<o[3])){n.label=s2[1];break}if(s2[0]===6&&n.label<o[1]){n.label=o[1],o=s2;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(s2);break}o[2]&&n.ops.pop(),n.trys.pop();continue}s2=t.call(e,n)}catch(e2){s2=[6,e2],i=0}finally{r=o=0}if(s2[0]&5)throw s2[1];return{value:s2[0]?s2[1]:void 0,done:!0}}},cameraModalCss=":host{z-index:1000;position:fixed;top:0;left:0;width:100%;height:100%;display:-ms-flexbox;display:flex;contain:strict}.wrapper{-ms-flex:1;flex:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background-color:rgba(0, 0, 0, 0.15)}.content{-webkit-box-shadow:0px 0px 5px rgba(0, 0, 0, 0.2);box-shadow:0px 0px 5px rgba(0, 0, 0, 0.2);width:600px;height:600px}",PWACameraModal=function(){function e(e2){(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,e2),this.onPhoto=(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"onPhoto",7),this.noDeviceError=(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"noDeviceError",7),this.facingMode="user",this.hidePicker=!1}return e.prototype.present=function(){return __awaiter(this,void 0,void 0,function(){var e2,t=this;return __generator(this,function(n){return e2=document.createElement("pwa-camera-modal-instance"),e2.facingMode=this.facingMode,e2.hidePicker=this.hidePicker,e2.addEventListener("onPhoto",function(e3){return __awaiter(t,void 0,void 0,function(){var t2;return __generator(this,function(n2){return this._modal?(t2=e3.detail,this.onPhoto.emit(t2),[2]):[2]})})}),e2.addEventListener("noDeviceError",function(e3){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t2){return this.noDeviceError.emit(e3),[2]})})}),document.body.append(e2),this._modal=e2,[2]})})},e.prototype.dismiss=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e2){return this._modal?(this._modal&&this._modal.parentNode.removeChild(this._modal),this._modal=null,[2]):[2]})})},e.prototype.render=function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",null)},e}();PWACameraModal.style=cameraModalCss},965:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{pwa_camera:()=>CameraPWA});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),__awaiter=function(e,t,i,n){function r(e2){return e2 instanceof i?e2:new i(function(t2){t2(e2)})}return new(i||(i=Promise))(function(i2,a){function o(e2){try{c(n.next(e2))}catch(e3){a(e3)}}function s(e2){try{c(n.throw(e2))}catch(e3){a(e3)}}function c(e2){e2.done?i2(e2.value):r(e2.value).then(o,s)}c((n=n.apply(e,t||[])).next())})},__generator=function(e,t){var i={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,r,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(e2){return function(t2){return c([e2,t2])}}function c(s2){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s2[0]&&(i=0)),i;)try{if(n=1,r&&(a=s2[0]&2?r.return:s2[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s2[1])).done)return a;switch(r=0,a&&(s2=[s2[0]&2,a.value]),s2[0]){case 0:case 1:a=s2;break;case 4:return i.label++,{value:s2[1],done:!1};case 5:i.label++,r=s2[1],s2=[0];continue;case 7:s2=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(s2[0]===6||s2[0]===2)){i=0;continue}if(s2[0]===3&&(!a||s2[1]>a[0]&&s2[1]<a[3])){i.label=s2[1];break}if(s2[0]===6&&i.label<a[1]){i.label=a[1],a=s2;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s2);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s2=t.call(e,i)}catch(e2){s2=[6,e2],r=0}finally{n=a=0}if(s2[0]&5)throw s2[1];return{value:s2[0]?s2[1]:void 0,done:!0}}};/**
 * MediaStream ImageCapture polyfill
 *
 * @license
 * Copyright 2018 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ImageCapture=window.ImageCapture;typeof ImageCapture>"u"&&(ImageCapture=function(){function e(e2){var t=this;if(e2.kind!=="video")throw new DOMException("NotSupportedError");this._videoStreamTrack=e2,"readyState"in this._videoStreamTrack||(this._videoStreamTrack.readyState="live"),this._previewStream=new MediaStream([e2]),this.videoElement=document.createElement("video"),this.videoElementPlaying=new Promise(function(e3){t.videoElement.addEventListener("playing",e3)}),HTMLMediaElement?this.videoElement.srcObject=this._previewStream:this.videoElement.src=URL.createObjectURL(this._previewStream),this.videoElement.muted=!0,this.videoElement.setAttribute("playsinline",""),this.videoElement.play(),this.canvasElement=document.createElement("canvas"),this.canvas2dContext=this.canvasElement.getContext("2d")}return Object.defineProperty(e.prototype,"videoStreamTrack",{get:function(){return this._videoStreamTrack},enumerable:!1,configurable:!0}),e.prototype.getPhotoCapabilities=function(){return new Promise(function(t,i){var n={current:0,min:0,max:0};t({exposureCompensation:n,exposureMode:"none",fillLightMode:["none"],focusMode:"none",imageHeight:n,imageWidth:n,iso:n,redEyeReduction:!1,whiteBalanceMode:"none",zoom:n}),i(new DOMException("OperationError"))})},e.prototype.setOptions=function(e2){return e2===void 0&&(e2={}),new Promise(function(t,i){})},e.prototype.takePhoto=function(){var e2=this;return new Promise(function(i,n){if(e2._videoStreamTrack.readyState!=="live")return n(new DOMException("InvalidStateError"));e2.videoElementPlaying.then(function(){try{e2.canvasElement.width=e2.videoElement.videoWidth,e2.canvasElement.height=e2.videoElement.videoHeight,e2.canvas2dContext.drawImage(e2.videoElement,0,0),e2.canvasElement.toBlob(i)}catch{n(new DOMException("UnknownError"))}})})},e.prototype.grabFrame=function(){var e2=this;return new Promise(function(i,n){if(e2._videoStreamTrack.readyState!=="live")return n(new DOMException("InvalidStateError"));e2.videoElementPlaying.then(function(){try{e2.canvasElement.width=e2.videoElement.videoWidth,e2.canvasElement.height=e2.videoElement.videoHeight,e2.canvas2dContext.drawImage(e2.videoElement,0,0),i(window.createImageBitmap(e2.canvasElement))}catch{n(new DOMException("UnknownError"))}})})},e}()),window.ImageCapture=ImageCapture;var cameraCss=`:host{--header-height:4em;--footer-height:9em;--header-height-landscape:3em;--footer-height-landscape:6em;--shutter-size:6em;--icon-size-header:1.5em;--icon-size-footer:2.5em;--margin-size-header:1.5em;--margin-size-footer:2.0em;font-family:-apple-system, BlinkMacSystemFont,
    \u201CSegoe UI\u201D, \u201CRoboto\u201D, \u201CDroid Sans\u201D, \u201CHelvetica Neue\u201D, sans-serif;display:block;width:100%;height:100%}.items{-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;width:100%;height:100%;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.items .item{-ms-flex:1;flex:1;text-align:center}.items .item:first-child{text-align:left}.items .item:last-child{text-align:right}.camera-wrapper{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%}.camera-header{color:white;background-color:black;height:var(--header-height)}.camera-header .items{padding:var(--margin-size-header)}.camera-footer{position:relative;color:white;background-color:black;height:var(--footer-height)}.camera-footer .items{padding:var(--margin-size-footer)}@media (max-height: 375px){.camera-header{--header-height:var(--header-height-landscape)}.camera-footer{--footer-height:var(--footer-height-landscape)}.camera-footer .shutter{--shutter-size:4em}}.camera-video{position:relative;-ms-flex:1;flex:1;overflow:hidden;background-color:black}video{width:100%;height:100%;max-height:100%;min-height:100%;-o-object-fit:cover;object-fit:cover;background-color:black}.pick-image{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;position:absolute;left:var(--margin-size-footer);top:0;height:100%;width:var(--icon-size-footer);color:white}.pick-image input{visibility:hidden}.pick-image svg{cursor:pointer;fill:white;width:var(--icon-size-footer);height:var(--icon-size-footer)}.shutter{position:absolute;left:50%;top:50%;width:var(--shutter-size);height:var(--shutter-size);margin-top:calc(var(--shutter-size) / -2);margin-left:calc(var(--shutter-size) / -2);border-radius:100%;background-color:#c6cdd8;padding:12px;-webkit-box-sizing:border-box;box-sizing:border-box}.shutter:active .shutter-button{background-color:#9da9bb}.shutter-button{background-color:white;border-radius:100%;width:100%;height:100%}.rotate{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;position:absolute;right:var(--margin-size-footer);top:0;height:100%;width:var(--icon-size-footer);color:white}.rotate img{width:var(--icon-size-footer);height:var(--icon-size-footer)}.shutter-overlay{z-index:5;position:absolute;width:100%;height:100%;background-color:black}.error{width:100%;height:100%;color:white;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.no-device{background-color:black;-ms-flex:1;flex:1;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;color:white}.no-device label{cursor:pointer;background:#fff;border-radius:6px;padding:6px 8px;color:black}.no-device input{visibility:hidden;height:0;margin-top:16px}.accept{background-color:black;-ms-flex:1;flex:1;overflow:hidden}.accept .accept-image{width:100%;height:100%;max-height:100%;background-position:center center;background-size:cover;background-repeat:no-repeat}.close img{cursor:pointer;width:var(--icon-size-header);height:var(--icon-size-header)}.flash img{width:var(--icon-size-header);height:var(--icon-size-header)}.accept-use img{width:var(--icon-size-footer);height:var(--icon-size-footer)}.accept-cancel img{width:var(--icon-size-footer);height:var(--icon-size-footer)}.offscreen-image-render{top:0;left:0;visibility:hidden;pointer-events:none;width:100%;height:100%}`,CameraPWA=function(){function e(e2){var t=this;(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,e2),this.hasMultipleCameras=!1,this.hasFlash=!1,this.flashModes=[],this.flashMode="off",this.handlePickFile=function(e3){},this.handleShutterClick=function(e3){console.debug("shutter click"),t.capture()},this.handleRotateClick=function(e3){t.rotate()},this.handleClose=function(e3){t.handlePhoto&&t.handlePhoto(null)},this.handleFlashClick=function(e3){t.cycleFlash()},this.handleCancelPhoto=function(e3){var i=t.stream&&t.stream.getTracks()[0],n=i&&i.getConstraints();t.photo=null,t.photoSrc=null,n?t.initCamera({video:{facingMode:n.facingMode}}):t.initCamera()},this.handleAcceptPhoto=function(e3){t.handlePhoto&&t.handlePhoto(t.photo)},this.handleFileInputChange=function(e3){return __awaiter(t,void 0,void 0,function(){var t2,i,n,r;return __generator(this,function(a){switch(a.label){case 0:t2=e3.target,i=t2.files[0],a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getOrientation(i)];case 2:return n=a.sent(),console.debug("Got orientation",n),this.photoOrientation=n,[3,4];case 3:return r=a.sent(),[3,4];case 4:return this.handlePhoto&&this.handlePhoto(i),[2]}})})},this.handleVideoMetadata=function(e3){console.debug("Video metadata",e3)},this.facingMode="user",this.handlePhoto=void 0,this.hidePicker=!1,this.handleNoDeviceError=void 0,this.noDevicesText="No camera found",this.noDevicesButtonText="Choose image",this.photo=void 0,this.photoSrc=void 0,this.showShutterOverlay=!1,this.flashIndex=0,this.hasCamera=null,this.rotation=0,this.deviceError=null}return e.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e2){switch(e2.label){case 0:return this.defaultConstraints={video:{facingMode:this.facingMode}},[4,this.queryDevices()];case 1:return e2.sent(),[4,this.initCamera()];case 2:return e2.sent(),[2]}})})},e.prototype.disconnectedCallback=function(){this.stopStream(),this.photoSrc&&URL.revokeObjectURL(this.photoSrc)},e.prototype.hasImageCapture=function(){return"ImageCapture"in window},e.prototype.queryDevices=function(){return __awaiter(this,void 0,void 0,function(){var e2,t,i;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,navigator.mediaDevices.enumerateDevices()];case 1:return e2=n.sent(),t=e2.filter(function(e3){return e3.kind=="videoinput"}),this.hasCamera=!!t.length,this.hasMultipleCameras=t.length>1,[3,3];case 2:return i=n.sent(),this.deviceError=i,[3,3];case 3:return[2]}})})},e.prototype.initCamera=function(e2){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(n){switch(n.label){case 0:e2||(e2=this.defaultConstraints),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia(Object.assign({video:!0,audio:!1},e2))];case 2:return t=n.sent(),this.initStream(t),[3,4];case 3:return i=n.sent(),this.deviceError=i,this.handleNoDeviceError&&this.handleNoDeviceError(i),[3,4];case 4:return[2]}})})},e.prototype.initStream=function(e2){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.stream=e2,this.videoElement.srcObject=e2,this.hasImageCapture()?(this.imageCapture=new window.ImageCapture(e2.getVideoTracks()[0]),[4,this.initPhotoCapabilities(this.imageCapture)]):[3,2];case 1:return t.sent(),[3,3];case 2:this.deviceError="No image capture",this.handleNoDeviceError&&this.handleNoDeviceError(),t.label=3;case 3:return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.f)(this.el),[2]}})})},e.prototype.initPhotoCapabilities=function(e2){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return[4,e2.getPhotoCapabilities()];case 1:return t=i.sent(),t.fillLightMode&&t.fillLightMode.length>1&&(this.flashModes=t.fillLightMode.map(function(e3){return e3}),this.flashMode?(this.flashMode=this.flashModes[this.flashModes.indexOf(this.flashMode)]||"off",this.flashIndex=this.flashModes.indexOf(this.flashMode)||0):this.flashIndex=0),[2]}})})},e.prototype.stopStream=function(){this.videoElement&&(this.videoElement.srcObject=null),this.stream&&this.stream.getTracks().forEach(function(e2){return e2.stop()})},e.prototype.capture=function(){return __awaiter(this,void 0,void 0,function(){var e2,t;return __generator(this,function(i){switch(i.label){case 0:if(!this.hasImageCapture())return[3,5];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.imageCapture.takePhoto({fillLightMode:this.flashModes.length>1?this.flashMode:void 0})];case 2:return e2=i.sent(),[4,this.flashScreen()];case 3:return i.sent(),this.promptAccept(e2),[3,5];case 4:return t=i.sent(),console.error("Unable to take photo!",t),[3,5];case 5:return this.stopStream(),[2]}})})},e.prototype.promptAccept=function(e2){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return this.photo=e2,[4,this.getOrientation(e2)];case 1:if(t=i.sent(),console.debug("Got orientation",t),this.photoOrientation=t,t)switch(t){case 1:case 2:this.rotation=0;break;case 3:case 4:this.rotation=180;break;case 5:case 6:this.rotation=90;break;case 7:case 8:this.rotation=270;break}return this.photoSrc=URL.createObjectURL(e2),[2]}})})},e.prototype.getOrientation=function(e2){return new Promise(function(t){var i=new FileReader;i.onload=function(e3){var i2=new DataView(e3.target.result);if(i2.getUint16(0,!1)!==65496)return t(-2);for(var n=i2.byteLength,r=2;r<n;){var a=i2.getUint16(r,!1);if(r+=2,a===65505){if(i2.getUint32(r+=2,!1)!==1165519206)return t(-1);var o=i2.getUint16(r+=6,!1)===18761;r+=i2.getUint32(r+4,o);var s=i2.getUint16(r,o);r+=2;for(var c=0;c<s;c++)if(i2.getUint16(r+c*12,o)===274)return t(i2.getUint16(r+c*12+8,o))}else{if((a&65280)!==65280)break;r+=i2.getUint16(r,!1)}}return t(-1)},i.readAsArrayBuffer(e2.slice(0,64*1024))})},e.prototype.rotate=function(){this.stopStream();var e2=this.stream&&this.stream.getTracks()[0];if(e2){var t=e2.getConstraints(),i=t.facingMode;if(!i){var n=e2.getCapabilities();n.facingMode&&(i=n.facingMode[0])}i==="environment"?this.initCamera({video:{facingMode:"user"}}):this.initCamera({video:{facingMode:"environment"}})}},e.prototype.setFlashMode=function(e2){console.debug("New flash mode: ",e2),this.flashMode=e2},e.prototype.cycleFlash=function(){this.flashModes.length>0&&(this.flashIndex=(this.flashIndex+1)%this.flashModes.length,this.setFlashMode(this.flashModes[this.flashIndex]))},e.prototype.flashScreen=function(){return __awaiter(this,void 0,void 0,function(){var e2=this;return __generator(this,function(t){return[2,new Promise(function(t2,i){e2.showShutterOverlay=!0,setTimeout(function(){e2.showShutterOverlay=!1,t2()},100)})]})})},e.prototype.iconExit=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' enable-background='new 0 0 512 512' xml:space='preserve'%3E%3Cg id='Icon_5_'%3E%3Cg%3E%3Cpath fill='%23FFFFFF' d='M402.2,134L378,109.8c-1.6-1.6-4.1-1.6-5.7,0L258.8,223.4c-1.6,1.6-4.1,1.6-5.7,0L139.6,109.8 c-1.6-1.6-4.1-1.6-5.7,0L109.8,134c-1.6,1.6-1.6,4.1,0,5.7l113.5,113.5c1.6,1.6,1.6,4.1,0,5.7L109.8,372.4c-1.6,1.6-1.6,4.1,0,5.7 l24.1,24.1c1.6,1.6,4.1,1.6,5.7,0l113.5-113.5c1.6-1.6,4.1-1.6,5.7,0l113.5,113.5c1.6,1.6,4.1,1.6,5.7,0l24.1-24.1 c1.6-1.6,1.6-4.1,0-5.7L288.6,258.8c-1.6-1.6-1.6-4.1,0-5.7l113.5-113.5C403.7,138.1,403.7,135.5,402.2,134z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"},e.prototype.iconPhotos=function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 512 512"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{d:"M450.29,112H142c-34,0-62,27.51-62,61.33V418.67C80,452.49,108,480,142,480H450c34,0,62-26.18,62-60V173.33C512,139.51,484.32,112,450.29,112Zm-77.15,61.34a46,46,0,1,1-46.28,46A46.19,46.19,0,0,1,373.14,173.33Zm-231.55,276c-17,0-29.86-13.75-29.86-30.66V353.85l90.46-80.79a46.54,46.54,0,0,1,63.44,1.83L328.27,337l-113,112.33ZM480,418.67a30.67,30.67,0,0,1-30.71,30.66H259L376.08,333a46.24,46.24,0,0,1,59.44-.16L480,370.59Z"}),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{d:"M384,32H64A64,64,0,0,0,0,96V352a64.11,64.11,0,0,0,48,62V152a72,72,0,0,1,72-72H446A64.11,64.11,0,0,0,384,32Z"}))},e.prototype.iconConfirm=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' enable-background='new 0 0 512 512' xml:space='preserve'%3E%3Ccircle fill='%232CD865' cx='256' cy='256' r='256'/%3E%3Cg id='Icon_1_'%3E%3Cg%3E%3Cg%3E%3Cpath fill='%23FFFFFF' d='M208,301.4l-55.4-55.5c-1.5-1.5-4-1.6-5.6-0.1l-23.4,22.3c-1.6,1.6-1.7,4.1-0.1,5.7l81.6,81.4 c3.1,3.1,8.2,3.1,11.3,0l171.8-171.7c1.6-1.6,1.6-4.2-0.1-5.7l-23.4-22.3c-1.6-1.5-4.1-1.5-5.6,0.1L213.7,301.4 C212.1,303,209.6,303,208,301.4z'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E"},e.prototype.iconReverseCamera=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' enable-background='new 0 0 512 512' xml:space='preserve'%3E%3Cg%3E%3Cpath fill='%23FFFFFF' d='M352,0H160C72,0,0,72,0,160v192c0,88,72,160,160,160h192c88,0,160-72,160-160V160C512,72,440,0,352,0z M356.7,365.8l-3.7,3.3c-27,23.2-61.4,35.9-96.8,35.9c-72.4,0-135.8-54.7-147-125.6c-0.3-1.9-2-3.3-3.9-3.3H64 c-3.3,0-5.2-3.8-3.2-6.4l61.1-81.4c1.6-2.1,4.7-2.1,6.4-0.1l63.3,81.4c2,2.6,0.2,6.5-3.2,6.5h-40.6c-2.5,0-4.5,2.4-3.9,4.8 c11.5,51.5,59.2,90.6,112.4,90.6c26.4,0,51.8-9.7,73.7-27.9l3.1-2.5c1.6-1.3,3.9-1.1,5.3,0.3l18.5,18.6 C358.5,361.6,358.4,364.3,356.7,365.8z M451.4,245.6l-61,83.5c-1.6,2.2-4.8,2.2-6.4,0.1l-63.3-83.3c-2-2.6-0.1-6.4,3.2-6.4h40.8 c2.5,0,4.4-2.3,3.9-4.8c-5.1-24.2-17.8-46.5-36.5-63.7c-21.2-19.4-48.2-30.1-76-30.1c-26.5,0-52.6,9.7-73.7,27.3l-3.1,2.5 c-1.6,1.3-3.9,1.2-5.4-0.3l-18.5-18.5c-1.6-1.6-1.5-4.3,0.2-5.9l3.5-3.1c27-23.2,61.4-35.9,96.8-35.9c38,0,73.9,13.7,101.2,38.7 c23.2,21.1,40.3,55.2,45.7,90.1c0.3,1.9,1.9,3.4,3.9,3.4h41.3C451.4,239.2,453.3,243,451.4,245.6z'/%3E%3C/g%3E%3C/svg%3E"},e.prototype.iconRetake=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' enable-background='new 0 0 512 512' xml:space='preserve'%3E%3Ccircle fill='%23727A87' cx='256' cy='256' r='256'/%3E%3Cg id='Icon_5_'%3E%3Cg%3E%3Cpath fill='%23FFFFFF' d='M394.2,142L370,117.8c-1.6-1.6-4.1-1.6-5.7,0L258.8,223.4c-1.6,1.6-4.1,1.6-5.7,0L147.6,117.8 c-1.6-1.6-4.1-1.6-5.7,0L117.8,142c-1.6,1.6-1.6,4.1,0,5.7l105.5,105.5c1.6,1.6,1.6,4.1,0,5.7L117.8,364.4c-1.6,1.6-1.6,4.1,0,5.7 l24.1,24.1c1.6,1.6,4.1,1.6,5.7,0l105.5-105.5c1.6-1.6,4.1-1.6,5.7,0l105.5,105.5c1.6,1.6,4.1,1.6,5.7,0l24.1-24.1 c1.6-1.6,1.6-4.1,0-5.7L288.6,258.8c-1.6-1.6-1.6-4.1,0-5.7l105.5-105.5C395.7,146.1,395.7,143.5,394.2,142z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"},e.prototype.iconFlashOff=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Cg%3E%3Cpath class='st0' d='M498,483.7L42.3,28L14,56.4l149.8,149.8L91,293.8c-2.5,3-0.1,7.2,3.9,7.2h143.9c1.6,0,2.7,1.3,2.4,2.7 L197.6,507c-1,4.4,5.8,6.9,8.9,3.2l118.6-142.8L469.6,512L498,483.7z'/%3E%3Cpath class='st0' d='M449,218.2c2.5-3,0.1-7.2-3.9-7.2H301.2c-1.6,0-2.7-1.3-2.4-2.7L342.4,5c1-4.4-5.8-6.9-8.9-3.2L214.9,144.6 l161.3,161.3L449,218.2z'/%3E%3C/g%3E%3C/svg%3E"},e.prototype.iconFlashOn=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Cpath class='st0' d='M287.2,211c-1.6,0-2.7-1.3-2.4-2.7L328.4,5c1-4.4-5.8-6.9-8.9-3.2L77,293.8c-2.5,3-0.1,7.2,3.9,7.2h143.9 c1.6,0,2.7,1.3,2.4,2.7L183.6,507c-1,4.4,5.8,6.9,8.9,3.2l242.5-292c2.5-3,0.1-7.2-3.9-7.2L287.2,211L287.2,211z'/%3E%3C/svg%3E"},e.prototype.iconFlashAuto=function(){return"data:image/svg+xml,%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 512 512' style='enable-background:new 0 0 512 512;' xml:space='preserve'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Cpath class='st0' d='M287.2,211c-1.6,0-2.7-1.3-2.4-2.7L328.4,5c1-4.4-5.8-6.9-8.9-3.2L77,293.8c-2.5,3-0.1,7.2,3.9,7.2h143.9 c1.6,0,2.7,1.3,2.4,2.7L183.6,507c-1,4.4,5.8,6.9,8.9,3.2l242.5-292c2.5-3,0.1-7.2-3.9-7.2L287.2,211L287.2,211z'/%3E%3Cg%3E%3Cpath class='st0' d='M321.3,186l74-186H438l74,186h-43.5l-11.9-32.5h-80.9l-12,32.5H321.3z M415.8,47.9l-27.2,70.7h54.9l-27.2-70.7 H415.8z'/%3E%3C/g%3E%3C/svg%3E"},e.prototype.render=function(){var e2=this,t={};return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"camera-wrapper"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"camera-header"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("section",{class:"items"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"item close",onClick:function(t2){return e2.handleClose(t2)}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconExit()})),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"item flash",onClick:function(t2){return e2.handleFlashClick(t2)}},this.flashModes.length>0&&(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",null,this.flashMode=="off"?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconFlashOff()}):"",this.flashMode=="auto"?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconFlashAuto()}):"",this.flashMode=="flash"?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconFlashOn()}):"")))),(this.hasCamera===!1||!!this.deviceError)&&(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"no-device"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("h2",null,this.noDevicesText),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("label",{htmlFor:"_pwa-elements-camera-input"},this.noDevicesButtonText),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{type:"file",id:"_pwa-elements-camera-input",onChange:this.handleFileInputChange,accept:"image/*",class:"select-file-button"})),this.photoSrc?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"accept"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"accept-image",style:Object.assign({backgroundImage:"url(".concat(this.photoSrc,")")},t)})):(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"camera-video"},this.showShutterOverlay&&(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"shutter-overlay"}),this.hasImageCapture()?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("video",{ref:function(t2){return e2.videoElement=t2},onLoadedMetaData:this.handleVideoMetadata,autoplay:!0,playsinline:!0}):(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("canvas",{ref:function(t2){return e2.canvasElement=t2},width:"100%",height:"100%"}),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("canvas",{class:"offscreen-image-render",ref:function(t2){return e2.offscreenCanvas=t2},width:"100%",height:"100%"})),this.hasCamera&&(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"camera-footer"},this.photo?(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("section",{class:"items"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"item accept-cancel",onClick:function(t2){return e2.handleCancelPhoto(t2)}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconRetake()})),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"item accept-use",onClick:function(t2){return e2.handleAcceptPhoto(t2)}},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconConfirm()}))):[!this.hidePicker&&(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"pick-image",onClick:this.handlePickFile},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("label",{htmlFor:"_pwa-elements-file-pick"},this.iconPhotos()),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{type:"file",id:"_pwa-elements-file-pick",onChange:this.handleFileInputChange,accept:"image/*",class:"pick-image-button"})),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"shutter",onClick:this.handleShutterClick},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"shutter-button"})),(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"rotate",onClick:this.handleRotateClick},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("img",{src:this.iconReverseCamera()}))]))},Object.defineProperty(e,"assetsDirs",{get:function(){return["icons"]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"el",{get:function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)},enumerable:!1,configurable:!0}),e}();CameraPWA.style=cameraCss},339:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{pwa_toast:()=>PWAToast});var _index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(223),toastCss=':host{position:fixed;bottom:20px;left:0;right:0;display:-ms-flexbox;display:flex;opacity:0}:host(.in){-webkit-transition:opacity 300ms;transition:opacity 300ms;opacity:1}:host(.out){-webkit-transition:opacity 1s;transition:opacity 1s;opacity:0}.wrapper{-ms-flex:1;flex:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.toast{font-family:-apple-system, system-ui, "Helvetica Neue", Roboto, sans-serif;background-color:#eee;color:black;border-radius:5px;padding:10px 15px;font-size:14px;font-weight:500;-webkit-box-shadow:0px 1px 2px rgba(0, 0, 0, 0.20);box-shadow:0px 1px 2px rgba(0, 0, 0, 0.20)}',PWAToast=function(){function t(t2){(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,t2),this.message=void 0,this.duration=2e3,this.closing=null}return t.prototype.hostData=function(){var t2={out:!!this.closing};return this.closing!==null&&(t2.in=!this.closing),{class:t2}},t.prototype.componentDidLoad=function(){var t2=this;setTimeout(function(){t2.closing=!1}),setTimeout(function(){t2.close()},this.duration)},t.prototype.close=function(){var t2=this;this.closing=!0,setTimeout(function(){t2.el.parentNode.removeChild(t2.el)},1e3)},t.prototype.__stencil_render=function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"wrapper"},(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"toast"},this.message))},Object.defineProperty(t.prototype,"el",{get:function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return(0,_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_1c5c47b4_js__WEBPACK_IMPORTED_MODULE_0__.H,this.hostData(),this.__stencil_render())},t}();PWAToast.style=toastCss},725:(module,__unused_webpack_exports,__webpack_require__2)=>{var map={"./":[423,7,112],"./index":[423,7,112],"./index-1c5c47b4":[223,9],"./index-1c5c47b4.js":[223,9],"./index.js":[423,7,112],"./ionicpwaelements":[824,9,112],"./ionicpwaelements.js":[824,9,112],"./loader":[428,9],"./loader.js":[428,9],"./pwa-action-sheet.entry":[850,9,112],"./pwa-action-sheet.entry.js":[850,9,112],"./pwa-camera-modal-instance.entry":[569,9,112],"./pwa-camera-modal-instance.entry.js":[569,9,112],"./pwa-camera-modal.entry":[602,9,112],"./pwa-camera-modal.entry.js":[602,9,112],"./pwa-camera.entry":[965,9,112],"./pwa-camera.entry.js":[965,9,112],"./pwa-toast.entry":[339,9,112],"./pwa-toast.entry.js":[339,9,112]};function webpackAsyncContext(req){if(!__webpack_require__2.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return Promise.all(ids.slice(2).map(__webpack_require__2.e)).then(()=>__webpack_require__2.t(id,ids[1]|16))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id=725,module.exports=webpackAsyncContext},389:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{OttRemitPlayInstallReferrerWeb:()=>OttRemitPlayInstallReferrerWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class OttRemitPlayInstallReferrerWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{getReferrerDetails(){throw new Error("Method not implemented.")}}},208:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__2),__webpack_require__2.d(__webpack_exports__2,{WebviewPrintWeb:()=>WebviewPrintWeb});var _capacitor_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__2(268);class WebviewPrintWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_0__.E_{async print(options){const documentTitleTemp=document.title;return document.title=options.name,window.onafterprint=()=>document.title=documentTitleTemp,window.print()}}},453:function(module){/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */(function(global,factory){module.exports=factory()})(this,function(){"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _defineProperty(obj,key,value){return key=_toPropertyKey(key),key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _toPrimitive(input,hint){if(typeof input!="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==void 0){var res=prim.call(input,hint||"default");if(typeof res!="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key=="symbol"?key:String(key)}var canvasToBlob={exports:{}};(function(module2){typeof window>"u"||function(window2){var CanvasPrototype=window2.HTMLCanvasElement&&window2.HTMLCanvasElement.prototype,hasBlobConstructor=window2.Blob&&function(){try{return!!new Blob}catch{return!1}}(),hasArrayBufferViewSupport=hasBlobConstructor&&window2.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),BlobBuilder=window2.BlobBuilder||window2.WebKitBlobBuilder||window2.MozBlobBuilder||window2.MSBlobBuilder,dataURIPattern=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,dataURLtoBlob=(hasBlobConstructor||BlobBuilder)&&window2.atob&&window2.ArrayBuffer&&window2.Uint8Array&&function(dataURI){var matches,mediaType,isBase64,dataString,byteString,arrayBuffer,intArray,i,bb;if(matches=dataURI.match(dataURIPattern),!matches)throw new Error("invalid data URI");for(mediaType=matches[2]?matches[1]:"text/plain"+(matches[3]||";charset=US-ASCII"),isBase64=!!matches[4],dataString=dataURI.slice(matches[0].length),isBase64?byteString=atob(dataString):byteString=decodeURIComponent(dataString),arrayBuffer=new ArrayBuffer(byteString.length),intArray=new Uint8Array(arrayBuffer),i=0;i<byteString.length;i+=1)intArray[i]=byteString.charCodeAt(i);return hasBlobConstructor?new Blob([hasArrayBufferViewSupport?intArray:arrayBuffer],{type:mediaType}):(bb=new BlobBuilder,bb.append(arrayBuffer),bb.getBlob(mediaType))};window2.HTMLCanvasElement&&!CanvasPrototype.toBlob&&(CanvasPrototype.mozGetAsFile?CanvasPrototype.toBlob=function(callback,type,quality){var self2=this;setTimeout(function(){quality&&CanvasPrototype.toDataURL&&dataURLtoBlob?callback(dataURLtoBlob(self2.toDataURL(type,quality))):callback(self2.mozGetAsFile("blob",type))})}:CanvasPrototype.toDataURL&&dataURLtoBlob&&(CanvasPrototype.msToBlob?CanvasPrototype.toBlob=function(callback,type,quality){var self2=this;setTimeout(function(){(type&&type!=="image/png"||quality)&&CanvasPrototype.toDataURL&&dataURLtoBlob?callback(dataURLtoBlob(self2.toDataURL(type,quality))):callback(self2.msToBlob(type))})}:CanvasPrototype.toBlob=function(callback,type,quality){var self2=this;setTimeout(function(){callback(dataURLtoBlob(self2.toDataURL(type,quality)))})})),module2.exports?module2.exports=dataURLtoBlob:window2.dataURLtoBlob=dataURLtoBlob}(window)})(canvasToBlob);var toBlob=canvasToBlob.exports,isBlob=function(value){return typeof Blob>"u"?!1:value instanceof Blob||Object.prototype.toString.call(value)==="[object Blob]"},DEFAULTS={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},IS_BROWSER=typeof window<"u"&&typeof window.document<"u",WINDOW=IS_BROWSER?window:{},isPositiveNumber=function(value){return value>0&&value<1/0},slice=Array.prototype.slice;function toArray(value){return Array.from?Array.from(value):slice.call(value)}var REGEXP_IMAGE_TYPE=/^image\/.+$/;function isImageType(value){return REGEXP_IMAGE_TYPE.test(value)}function imageTypeToExtension(value){var extension=isImageType(value)?value.substr(6):"";return extension==="jpeg"&&(extension="jpg"),".".concat(extension)}var fromCharCode=String.fromCharCode;function getStringFromCharCode(dataView,start,length){var str="",i;for(length+=start,i=start;i<length;i+=1)str+=fromCharCode(dataView.getUint8(i));return str}var btoa2=WINDOW.btoa;function arrayBufferToDataURL(arrayBuffer,mimeType){for(var chunks=[],chunkSize=8192,uint8=new Uint8Array(arrayBuffer);uint8.length>0;)chunks.push(fromCharCode.apply(null,toArray(uint8.subarray(0,chunkSize)))),uint8=uint8.subarray(chunkSize);return"data:".concat(mimeType,";base64,").concat(btoa2(chunks.join("")))}function resetAndGetOrientation(arrayBuffer){var dataView=new DataView(arrayBuffer),orientation;try{var littleEndian,app1Start,ifdStart;if(dataView.getUint8(0)===255&&dataView.getUint8(1)===216)for(var length=dataView.byteLength,offset=2;offset+1<length;){if(dataView.getUint8(offset)===255&&dataView.getUint8(offset+1)===225){app1Start=offset;break}offset+=1}if(app1Start){var exifIDCode=app1Start+4,tiffOffset=app1Start+10;if(getStringFromCharCode(dataView,exifIDCode,4)==="Exif"){var endianness=dataView.getUint16(tiffOffset);if(littleEndian=endianness===18761,(littleEndian||endianness===19789)&&dataView.getUint16(tiffOffset+2,littleEndian)===42){var firstIFDOffset=dataView.getUint32(tiffOffset+4,littleEndian);firstIFDOffset>=8&&(ifdStart=tiffOffset+firstIFDOffset)}}}if(ifdStart){var _length=dataView.getUint16(ifdStart,littleEndian),_offset,i;for(i=0;i<_length;i+=1)if(_offset=ifdStart+i*12+2,dataView.getUint16(_offset,littleEndian)===274){_offset+=8,orientation=dataView.getUint16(_offset,littleEndian),dataView.setUint16(_offset,1,littleEndian);break}}}catch{orientation=1}return orientation}function parseOrientation(orientation){var rotate=0,scaleX=1,scaleY=1;switch(orientation){case 2:scaleX=-1;break;case 3:rotate=-180;break;case 4:scaleY=-1;break;case 5:rotate=90,scaleY=-1;break;case 6:rotate=90;break;case 7:rotate=90,scaleX=-1;break;case 8:rotate=-90;break}return{rotate,scaleX,scaleY}}var REGEXP_DECIMALS=/\.\d*(?:0|9){12}\d*$/;function normalizeDecimalNumber(value){var times=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return REGEXP_DECIMALS.test(value)?Math.round(value*times)/times:value}function getAdjustedSizes(_ref){var aspectRatio=_ref.aspectRatio,height=_ref.height,width=_ref.width,type=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",isValidWidth=isPositiveNumber(width),isValidHeight=isPositiveNumber(height);if(isValidWidth&&isValidHeight){var adjustedWidth=height*aspectRatio;(type==="contain"||type==="none")&&adjustedWidth>width||type==="cover"&&adjustedWidth<width?height=width/aspectRatio:width=height*aspectRatio}else isValidWidth?height=width/aspectRatio:isValidHeight&&(width=height*aspectRatio);return{width,height}}function getExif(arrayBuffer){for(var array=toArray(new Uint8Array(arrayBuffer)),length=array.length,segments=[],start=0;start+3<length;){var value=array[start],next=array[start+1];if(value===255&&next===218)break;if(value===255&&next===216)start+=2;else{var offset=array[start+2]*256+array[start+3],end=start+offset+2,segment=array.slice(start,end);segments.push(segment),start=end}}return segments.reduce(function(exifArray,current){return current[0]===255&&current[1]===225?exifArray.concat(current):exifArray},[])}function insertExif(arrayBuffer,exifArray){var array=toArray(new Uint8Array(arrayBuffer));if(array[2]!==255||array[3]!==224)return arrayBuffer;var app0Length=array[4]*256+array[5],newArrayBuffer=[255,216].concat(exifArray,array.slice(4+app0Length));return new Uint8Array(newArrayBuffer)}var ArrayBuffer$1=WINDOW.ArrayBuffer,FileReader2=WINDOW.FileReader,URL2=WINDOW.URL||WINDOW.webkitURL,REGEXP_EXTENSION=/\.\w+$/,AnotherCompressor=WINDOW.Compressor,Compressor=function(){function Compressor2(file,options){_classCallCheck(this,Compressor2),this.file=file,this.exif=[],this.image=new Image,this.options=_objectSpread2(_objectSpread2({},DEFAULTS),options),this.aborted=!1,this.result=null,this.init()}return _createClass(Compressor2,[{key:"init",value:function(){var _this=this,file=this.file,options=this.options;if(!isBlob(file)){this.fail(new Error("The first argument must be a File or Blob object."));return}var mimeType=file.type;if(!isImageType(mimeType)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!URL2||!FileReader2){this.fail(new Error("The current browser does not support image compression."));return}ArrayBuffer$1||(options.checkOrientation=!1,options.retainExif=!1);var isJPEGImage=mimeType==="image/jpeg",checkOrientation=isJPEGImage&&options.checkOrientation,retainExif=isJPEGImage&&options.retainExif;if(URL2&&!checkOrientation&&!retainExif)this.load({url:URL2.createObjectURL(file)});else{var reader=new FileReader2;this.reader=reader,reader.onload=function(_ref){var target=_ref.target,result=target.result,data={},orientation=1;checkOrientation&&(orientation=resetAndGetOrientation(result),orientation>1&&_extends(data,parseOrientation(orientation))),retainExif&&(_this.exif=getExif(result)),checkOrientation||retainExif?!URL2||orientation>1?data.url=arrayBufferToDataURL(result,mimeType):data.url=URL2.createObjectURL(file):data.url=result,_this.load(data)},reader.onabort=function(){_this.fail(new Error("Aborted to read the image with FileReader."))},reader.onerror=function(){_this.fail(new Error("Failed to read the image with FileReader."))},reader.onloadend=function(){_this.reader=null},checkOrientation||retainExif?reader.readAsArrayBuffer(file):reader.readAsDataURL(file)}}},{key:"load",value:function(data){var _this2=this,file=this.file,image=this.image;image.onload=function(){_this2.draw(_objectSpread2(_objectSpread2({},data),{},{naturalWidth:image.naturalWidth,naturalHeight:image.naturalHeight}))},image.onabort=function(){_this2.fail(new Error("Aborted to load the image."))},image.onerror=function(){_this2.fail(new Error("Failed to load the image."))},WINDOW.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent)&&(image.crossOrigin="anonymous"),image.alt=file.name,image.src=data.url}},{key:"draw",value:function(_ref2){var _this3=this,naturalWidth=_ref2.naturalWidth,naturalHeight=_ref2.naturalHeight,_ref2$rotate=_ref2.rotate,rotate=_ref2$rotate===void 0?0:_ref2$rotate,_ref2$scaleX=_ref2.scaleX,scaleX=_ref2$scaleX===void 0?1:_ref2$scaleX,_ref2$scaleY=_ref2.scaleY,scaleY=_ref2$scaleY===void 0?1:_ref2$scaleY,file=this.file,image=this.image,options=this.options,canvas=document.createElement("canvas"),context=canvas.getContext("2d"),is90DegreesRotated=Math.abs(rotate)%180===90,resizable=(options.resize==="contain"||options.resize==="cover")&&isPositiveNumber(options.width)&&isPositiveNumber(options.height),maxWidth=Math.max(options.maxWidth,0)||1/0,maxHeight=Math.max(options.maxHeight,0)||1/0,minWidth=Math.max(options.minWidth,0)||0,minHeight=Math.max(options.minHeight,0)||0,aspectRatio=naturalWidth/naturalHeight,width=options.width,height=options.height;if(is90DegreesRotated){var _ref3=[maxHeight,maxWidth];maxWidth=_ref3[0],maxHeight=_ref3[1];var _ref4=[minHeight,minWidth];minWidth=_ref4[0],minHeight=_ref4[1];var _ref5=[height,width];width=_ref5[0],height=_ref5[1]}resizable&&(aspectRatio=width/height);var _getAdjustedSizes=getAdjustedSizes({aspectRatio,width:maxWidth,height:maxHeight},"contain");maxWidth=_getAdjustedSizes.width,maxHeight=_getAdjustedSizes.height;var _getAdjustedSizes2=getAdjustedSizes({aspectRatio,width:minWidth,height:minHeight},"cover");if(minWidth=_getAdjustedSizes2.width,minHeight=_getAdjustedSizes2.height,resizable){var _getAdjustedSizes3=getAdjustedSizes({aspectRatio,width,height},options.resize);width=_getAdjustedSizes3.width,height=_getAdjustedSizes3.height}else{var _getAdjustedSizes4=getAdjustedSizes({aspectRatio,width,height}),_getAdjustedSizes4$wi=_getAdjustedSizes4.width;width=_getAdjustedSizes4$wi===void 0?naturalWidth:_getAdjustedSizes4$wi;var _getAdjustedSizes4$he=_getAdjustedSizes4.height;height=_getAdjustedSizes4$he===void 0?naturalHeight:_getAdjustedSizes4$he}width=Math.floor(normalizeDecimalNumber(Math.min(Math.max(width,minWidth),maxWidth))),height=Math.floor(normalizeDecimalNumber(Math.min(Math.max(height,minHeight),maxHeight)));var destX=-width/2,destY=-height/2,destWidth=width,destHeight=height,params=[];if(resizable){var srcX=0,srcY=0,srcWidth=naturalWidth,srcHeight=naturalHeight,_getAdjustedSizes5=getAdjustedSizes({aspectRatio,width:naturalWidth,height:naturalHeight},{contain:"cover",cover:"contain"}[options.resize]);srcWidth=_getAdjustedSizes5.width,srcHeight=_getAdjustedSizes5.height,srcX=(naturalWidth-srcWidth)/2,srcY=(naturalHeight-srcHeight)/2,params.push(srcX,srcY,srcWidth,srcHeight)}if(params.push(destX,destY,destWidth,destHeight),is90DegreesRotated){var _ref6=[height,width];width=_ref6[0],height=_ref6[1]}canvas.width=width,canvas.height=height,isImageType(options.mimeType)||(options.mimeType=file.type);var fillStyle="transparent";file.size>options.convertSize&&options.convertTypes.indexOf(options.mimeType)>=0&&(options.mimeType="image/jpeg");var isJPEGImage=options.mimeType==="image/jpeg";if(isJPEGImage&&(fillStyle="#fff"),context.fillStyle=fillStyle,context.fillRect(0,0,width,height),options.beforeDraw&&options.beforeDraw.call(this,context,canvas),!this.aborted&&(context.save(),context.translate(width/2,height/2),context.rotate(rotate*Math.PI/180),context.scale(scaleX,scaleY),context.drawImage.apply(context,[image].concat(params)),context.restore(),options.drew&&options.drew.call(this,context,canvas),!this.aborted)){var callback=function(blob){if(!_this3.aborted){var done=function(result){return _this3.done({naturalWidth,naturalHeight,result})};if(blob&&isJPEGImage&&options.retainExif&&_this3.exif&&_this3.exif.length>0){var next=function(arrayBuffer){return done(toBlob(arrayBufferToDataURL(insertExif(arrayBuffer,_this3.exif),options.mimeType)))};if(blob.arrayBuffer)blob.arrayBuffer().then(next).catch(function(){_this3.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var reader=new FileReader2;_this3.reader=reader,reader.onload=function(_ref7){var target=_ref7.target;next(target.result)},reader.onabort=function(){_this3.fail(new Error("Aborted to read the compressed image with FileReader."))},reader.onerror=function(){_this3.fail(new Error("Failed to read the compressed image with FileReader."))},reader.onloadend=function(){_this3.reader=null},reader.readAsArrayBuffer(blob)}}else done(blob)}};canvas.toBlob?canvas.toBlob(callback,options.mimeType,options.quality):callback(toBlob(canvas.toDataURL(options.mimeType,options.quality)))}}},{key:"done",value:function(_ref8){var naturalWidth=_ref8.naturalWidth,naturalHeight=_ref8.naturalHeight,result=_ref8.result,file=this.file,image=this.image,options=this.options;if(URL2&&image.src.indexOf("blob:")===0&&URL2.revokeObjectURL(image.src),result)if(options.strict&&!options.retainExif&&result.size>file.size&&options.mimeType===file.type&&!(options.width>naturalWidth||options.height>naturalHeight||options.minWidth>naturalWidth||options.minHeight>naturalHeight||options.maxWidth<naturalWidth||options.maxHeight<naturalHeight))result=file;else{var date=new Date;result.lastModified=date.getTime(),result.lastModifiedDate=date,result.name=file.name,result.name&&result.type!==file.type&&(result.name=result.name.replace(REGEXP_EXTENSION,imageTypeToExtension(result.type)))}else result=file;this.result=result,options.success&&options.success.call(this,result)}},{key:"fail",value:function(err){var options=this.options;if(options.error)options.error.call(this,err);else throw err}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=AnotherCompressor,Compressor2}},{key:"setDefaults",value:function(options){_extends(DEFAULTS,options)}}]),Compressor2}();return Compressor})},491:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeDataUriToBuffer=void 0;const makeDataUriToBuffer=convert=>uri=>{if(uri=String(uri),!/^data:/i.test(uri))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');uri=uri.replace(/\r?\n/g,"");const firstComma=uri.indexOf(",");if(firstComma===-1||firstComma<=4)throw new TypeError("malformed data: URI");const meta=uri.substring(5,firstComma).split(";");let charset="",base64=!1;const type=meta[0]||"text/plain";let typeFull=type;for(let i=1;i<meta.length;i++)meta[i]==="base64"?base64=!0:meta[i]&&(typeFull+=`;${meta[i]}`,meta[i].indexOf("charset=")===0&&(charset=meta[i].substring(8)));!meta[0]&&!charset.length&&(typeFull+=";charset=US-ASCII",charset="US-ASCII");const data=unescape(uri.substring(firstComma+1)),buffer=base64?convert.base64ToArrayBuffer(data):convert.stringToBuffer(data);return{type,typeFull,charset,buffer}};exports.makeDataUriToBuffer=makeDataUriToBuffer},40:(__unused_webpack_module,exports,__webpack_require__2)=>{"use strict";var __webpack_unused_export__;__webpack_unused_export__={value:!0},exports.C=void 0;const common_1=__webpack_require__2(491);function base64ToArrayBuffer(base64){const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bytes=[];for(let i=0;i<base64.length;i+=4){const idx0=chars.indexOf(base64.charAt(i)),idx1=chars.indexOf(base64.charAt(i+1)),idx2=base64.charAt(i+2)==="="?0:chars.indexOf(base64.charAt(i+2)),idx3=base64.charAt(i+3)==="="?0:chars.indexOf(base64.charAt(i+3)),bin0=idx0<<2|idx1>>4,bin1=(idx1&15)<<4|idx2>>2,bin2=(idx2&3)<<6|idx3;bytes.push(bin0),base64.charAt(i+2)!=="="&&bytes.push(bin1),base64.charAt(i+3)!=="="&&bytes.push(bin2)}const buffer=new ArrayBuffer(bytes.length);return new Uint8Array(buffer).set(bytes),buffer}function stringToBuffer(str){const buffer=new ArrayBuffer(str.length),view=new Uint8Array(buffer);for(let i=0;i<str.length;i++)view[i]=str.charCodeAt(i);return buffer}exports.C=(0,common_1.makeDataUriToBuffer)({stringToBuffer,base64ToArrayBuffer})},287:function(module,exports,__webpack_require__2){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(a,b){__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=b,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__=="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==void 0&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)})(this,function(){"use strict";function b(a2,b2){return typeof b2>"u"?b2={autoBom:!1}:typeof b2!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),b2={autoBom:!b2}),b2.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a2.type)?new Blob(["\uFEFF",a2],{type:a2.type}):a2}function c(a2,b2,c2){var d2=new XMLHttpRequest;d2.open("GET",a2),d2.responseType="blob",d2.onload=function(){g(d2.response,b2,c2)},d2.onerror=function(){console.error("could not download file")},d2.send()}function d(a2){var b2=new XMLHttpRequest;b2.open("HEAD",a2,!1);try{b2.send()}catch{}return 200<=b2.status&&299>=b2.status}function e(a2){try{a2.dispatchEvent(new MouseEvent("click"))}catch{var b2=document.createEvent("MouseEvents");b2.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a2.dispatchEvent(b2)}}var f=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof __webpack_require__2.g=="object"&&__webpack_require__2.g.global===__webpack_require__2.g?__webpack_require__2.g:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||(typeof window!="object"||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b2,g2,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g2=g2||b2.name||"download",j.download=g2,j.rel="noopener",typeof b2=="string"?(j.href=b2,j.origin===location.origin?e(j):d(j.href)?c(b2,g2,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b2),setTimeout(function(){i.revokeObjectURL(j.href)},4e4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f2,g2,h){if(g2=g2||f2.name||"download",typeof f2!="string")navigator.msSaveOrOpenBlob(b(f2,h),g2);else if(d(f2))c(f2,g2,h);else{var i=document.createElement("a");i.href=f2,i.target="_blank",setTimeout(function(){e(i)})}}:function(b2,d2,e2,g2){if(g2=g2||open("","_blank"),g2&&(g2.document.title=g2.document.body.innerText="downloading..."),typeof b2=="string")return c(b2,d2,e2);var h=b2.type==="application/octet-stream",i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var a2=k.result;a2=j?a2:a2.replace(/^data:[^;]*;/,"data:attachment/file;"),g2?g2.location.href=a2:location=a2,g2=null},k.readAsDataURL(b2)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b2);g2?g2.location=m:location.href=m,g2=null,setTimeout(function(){l.revokeObjectURL(m)},4e4)}});f.saveAs=g.saveAs=g,module.exports=g})},863:(__unused_webpack_module,__webpack_exports__2,__webpack_require__2)=>{"use strict";__webpack_require__2.d(__webpack_exports__2,{j9:()=>Html5Qrcode,Jl:()=>Html5QrcodeSupportedFormats});var Html5QrcodeSupportedFormats;(function(Html5QrcodeSupportedFormats2){Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.QR_CODE=0]="QR_CODE",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.AZTEC=1]="AZTEC",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.CODABAR=2]="CODABAR",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.CODE_39=3]="CODE_39",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.CODE_93=4]="CODE_93",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.CODE_128=5]="CODE_128",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.DATA_MATRIX=6]="DATA_MATRIX",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.MAXICODE=7]="MAXICODE",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.ITF=8]="ITF",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.EAN_13=9]="EAN_13",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.EAN_8=10]="EAN_8",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.PDF_417=11]="PDF_417",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.RSS_14=12]="RSS_14",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.RSS_EXPANDED=13]="RSS_EXPANDED",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.UPC_A=14]="UPC_A",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.UPC_E=15]="UPC_E",Html5QrcodeSupportedFormats2[Html5QrcodeSupportedFormats2.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Html5QrcodeSupportedFormats||(Html5QrcodeSupportedFormats={}));var html5QrcodeSupportedFormatsTextMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"QR_CODE"],[Html5QrcodeSupportedFormats.AZTEC,"AZTEC"],[Html5QrcodeSupportedFormats.CODABAR,"CODABAR"],[Html5QrcodeSupportedFormats.CODE_39,"CODE_39"],[Html5QrcodeSupportedFormats.CODE_93,"CODE_93"],[Html5QrcodeSupportedFormats.CODE_128,"CODE_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"DATA_MATRIX"],[Html5QrcodeSupportedFormats.MAXICODE,"MAXICODE"],[Html5QrcodeSupportedFormats.ITF,"ITF"],[Html5QrcodeSupportedFormats.EAN_13,"EAN_13"],[Html5QrcodeSupportedFormats.EAN_8,"EAN_8"],[Html5QrcodeSupportedFormats.PDF_417,"PDF_417"],[Html5QrcodeSupportedFormats.RSS_14,"RSS_14"],[Html5QrcodeSupportedFormats.RSS_EXPANDED,"RSS_EXPANDED"],[Html5QrcodeSupportedFormats.UPC_A,"UPC_A"],[Html5QrcodeSupportedFormats.UPC_E,"UPC_E"],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),DecodedTextType;(function(DecodedTextType2){DecodedTextType2[DecodedTextType2.UNKNOWN=0]="UNKNOWN",DecodedTextType2[DecodedTextType2.URL=1]="URL"})(DecodedTextType||(DecodedTextType={}));function isValidHtml5QrcodeSupportedFormats(format){return Object.values(Html5QrcodeSupportedFormats).includes(format)}var Html5QrcodeScanType;(function(Html5QrcodeScanType2){Html5QrcodeScanType2[Html5QrcodeScanType2.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",Html5QrcodeScanType2[Html5QrcodeScanType2.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Html5QrcodeScanType||(Html5QrcodeScanType={}));var Html5QrcodeConstants=function(){function Html5QrcodeConstants2(){}return Html5QrcodeConstants2.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",Html5QrcodeConstants2.SCAN_DEFAULT_FPS=2,Html5QrcodeConstants2.DEFAULT_DISABLE_FLIP=!1,Html5QrcodeConstants2.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,Html5QrcodeConstants2.DEFAULT_SUPPORTED_SCAN_TYPE=[Html5QrcodeScanType.SCAN_TYPE_CAMERA,Html5QrcodeScanType.SCAN_TYPE_FILE],Html5QrcodeConstants2}(),QrcodeResultFormat=function(){function QrcodeResultFormat2(format,formatName){this.format=format,this.formatName=formatName}return QrcodeResultFormat2.prototype.toString=function(){return this.formatName},QrcodeResultFormat2.create=function(format){if(!html5QrcodeSupportedFormatsTextMap.has(format))throw"".concat(format," not in html5QrcodeSupportedFormatsTextMap");return new QrcodeResultFormat2(format,html5QrcodeSupportedFormatsTextMap.get(format))},QrcodeResultFormat2}(),Html5QrcodeResultFactory=function(){function Html5QrcodeResultFactory2(){}return Html5QrcodeResultFactory2.createFromText=function(decodedText){var qrcodeResult={text:decodedText};return{decodedText,result:qrcodeResult}},Html5QrcodeResultFactory2.createFromQrcodeResult=function(qrcodeResult){return{decodedText:qrcodeResult.text,result:qrcodeResult}},Html5QrcodeResultFactory2}(),Html5QrcodeErrorTypes;(function(Html5QrcodeErrorTypes2){Html5QrcodeErrorTypes2[Html5QrcodeErrorTypes2.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",Html5QrcodeErrorTypes2[Html5QrcodeErrorTypes2.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",Html5QrcodeErrorTypes2[Html5QrcodeErrorTypes2.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Html5QrcodeErrorTypes||(Html5QrcodeErrorTypes={}));var Html5QrcodeErrorFactory=function(){function Html5QrcodeErrorFactory2(){}return Html5QrcodeErrorFactory2.createFrom=function(error){return{errorMessage:error,type:Html5QrcodeErrorTypes.UNKWOWN_ERROR}},Html5QrcodeErrorFactory2}(),BaseLoggger=function(){function BaseLoggger2(verbose){this.verbose=verbose}return BaseLoggger2.prototype.log=function(message){this.verbose&&console.log(message)},BaseLoggger2.prototype.warn=function(message){this.verbose&&console.warn(message)},BaseLoggger2.prototype.logError=function(message,isExperimental){(this.verbose||isExperimental===!0)&&console.error(message)},BaseLoggger2.prototype.logErrors=function(errors){if(errors.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(errors)},BaseLoggger2}();function isNullOrUndefined(obj){return typeof obj>"u"||obj===null}function clip(value,minValue,maxValue){return value>maxValue?maxValue:value<minValue?minValue:value}var Html5QrcodeStrings=function(){function Html5QrcodeStrings2(){}return Html5QrcodeStrings2.codeParseError=function(exception){return"QR code parse error, error = ".concat(exception)},Html5QrcodeStrings2.errorGettingUserMedia=function(error){return"Error getting userMedia, error = ".concat(error)},Html5QrcodeStrings2.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},Html5QrcodeStrings2.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},Html5QrcodeStrings2.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},Html5QrcodeStrings2.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},Html5QrcodeStrings2.scannerPaused=function(){return"Scanner paused"},Html5QrcodeStrings2}(),Html5QrcodeScannerStrings=function(){function Html5QrcodeScannerStrings2(){}return Html5QrcodeScannerStrings2.scanningStatus=function(){return"Scanning"},Html5QrcodeScannerStrings2.idleStatus=function(){return"Idle"},Html5QrcodeScannerStrings2.errorStatus=function(){return"Error"},Html5QrcodeScannerStrings2.permissionStatus=function(){return"Permission"},Html5QrcodeScannerStrings2.noCameraFoundErrorStatus=function(){return"No Cameras"},Html5QrcodeScannerStrings2.lastMatch=function(decodedText){return"Last Match: ".concat(decodedText)},Html5QrcodeScannerStrings2.codeScannerTitle=function(){return"Code Scanner"},Html5QrcodeScannerStrings2.cameraPermissionTitle=function(){return"Request Camera Permissions"},Html5QrcodeScannerStrings2.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},Html5QrcodeScannerStrings2.noCameraFound=function(){return"No camera found"},Html5QrcodeScannerStrings2.scanButtonStopScanningText=function(){return"Stop Scanning"},Html5QrcodeScannerStrings2.scanButtonStartScanningText=function(){return"Start Scanning"},Html5QrcodeScannerStrings2.torchOnButton=function(){return"Switch On Torch"},Html5QrcodeScannerStrings2.torchOffButton=function(){return"Switch Off Torch"},Html5QrcodeScannerStrings2.torchOnFailedMessage=function(){return"Failed to turn on torch"},Html5QrcodeScannerStrings2.torchOffFailedMessage=function(){return"Failed to turn off torch"},Html5QrcodeScannerStrings2.scanButtonScanningStarting=function(){return"Launching Camera..."},Html5QrcodeScannerStrings2.textIfCameraScanSelected=function(){return"Scan an Image File"},Html5QrcodeScannerStrings2.textIfFileScanSelected=function(){return"Scan using camera directly"},Html5QrcodeScannerStrings2.selectCamera=function(){return"Select Camera"},Html5QrcodeScannerStrings2.fileSelectionChooseImage=function(){return"Choose Image"},Html5QrcodeScannerStrings2.fileSelectionChooseAnother=function(){return"Choose Another"},Html5QrcodeScannerStrings2.fileSelectionNoImageSelected=function(){return"No image choosen"},Html5QrcodeScannerStrings2.anonymousCameraPrefix=function(){return"Anonymous Camera"},Html5QrcodeScannerStrings2.dragAndDropMessage=function(){return"Or drop an image to scan"},Html5QrcodeScannerStrings2.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},Html5QrcodeScannerStrings2.zoom=function(){return"zoom"},Html5QrcodeScannerStrings2.loadingImage=function(){return"Loading image..."},Html5QrcodeScannerStrings2.cameraScanAltText=function(){return"Camera based scan"},Html5QrcodeScannerStrings2.fileScanAltText=function(){return"Fule based scan"},Html5QrcodeScannerStrings2}(),LibraryInfoStrings=function(){function LibraryInfoStrings2(){}return LibraryInfoStrings2.poweredBy=function(){return"Powered by "},LibraryInfoStrings2.reportIssues=function(){return"Report issues"},LibraryInfoStrings2}(),VideoConstraintsUtil=function(){function VideoConstraintsUtil2(){}return VideoConstraintsUtil2.isMediaStreamConstraintsValid=function(videoConstraints,logger){if(typeof videoConstraints!="object"){var typeofVideoConstraints=typeof videoConstraints;return logger.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(typeofVideoConstraints,"."),!0),!1}for(var bannedKeys=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],bannedkeysSet=new Set(bannedKeys),keysInVideoConstraints=Object.keys(videoConstraints),_i=0,keysInVideoConstraints_1=keysInVideoConstraints;_i<keysInVideoConstraints_1.length;_i++){var key=keysInVideoConstraints_1[_i];if(bannedkeysSet.has(key))return logger.logError("".concat(key," is not supported videoConstaints."),!0),!1}return!0},VideoConstraintsUtil2}(),zxing_js_umd=__webpack_require__2(221),ZXingHtml5QrcodeDecoder=function(){function ZXingHtml5QrcodeDecoder2(requestedFormats,verbose,logger){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,zxing_js_umd.BarcodeFormat.QR_CODE],[Html5QrcodeSupportedFormats.AZTEC,zxing_js_umd.BarcodeFormat.AZTEC],[Html5QrcodeSupportedFormats.CODABAR,zxing_js_umd.BarcodeFormat.CODABAR],[Html5QrcodeSupportedFormats.CODE_39,zxing_js_umd.BarcodeFormat.CODE_39],[Html5QrcodeSupportedFormats.CODE_93,zxing_js_umd.BarcodeFormat.CODE_93],[Html5QrcodeSupportedFormats.CODE_128,zxing_js_umd.BarcodeFormat.CODE_128],[Html5QrcodeSupportedFormats.DATA_MATRIX,zxing_js_umd.BarcodeFormat.DATA_MATRIX],[Html5QrcodeSupportedFormats.MAXICODE,zxing_js_umd.BarcodeFormat.MAXICODE],[Html5QrcodeSupportedFormats.ITF,zxing_js_umd.BarcodeFormat.ITF],[Html5QrcodeSupportedFormats.EAN_13,zxing_js_umd.BarcodeFormat.EAN_13],[Html5QrcodeSupportedFormats.EAN_8,zxing_js_umd.BarcodeFormat.EAN_8],[Html5QrcodeSupportedFormats.PDF_417,zxing_js_umd.BarcodeFormat.PDF_417],[Html5QrcodeSupportedFormats.RSS_14,zxing_js_umd.BarcodeFormat.RSS_14],[Html5QrcodeSupportedFormats.RSS_EXPANDED,zxing_js_umd.BarcodeFormat.RSS_EXPANDED],[Html5QrcodeSupportedFormats.UPC_A,zxing_js_umd.BarcodeFormat.UPC_A],[Html5QrcodeSupportedFormats.UPC_E,zxing_js_umd.BarcodeFormat.UPC_E],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,zxing_js_umd.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!zxing_js_umd)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=verbose,this.logger=logger;var formats=this.createZXingFormats(requestedFormats),hints=new Map;hints.set(zxing_js_umd.DecodeHintType.POSSIBLE_FORMATS,formats),hints.set(zxing_js_umd.DecodeHintType.TRY_HARDER,!1),this.hints=hints}return ZXingHtml5QrcodeDecoder2.prototype.decodeAsync=function(canvas){var _this=this;return new Promise(function(resolve,reject){try{resolve(_this.decode(canvas))}catch(error){reject(error)}})},ZXingHtml5QrcodeDecoder2.prototype.decode=function(canvas){var zxingDecoder=new zxing_js_umd.MultiFormatReader(this.verbose,this.hints),luminanceSource=new zxing_js_umd.HTMLCanvasElementLuminanceSource(canvas),binaryBitmap=new zxing_js_umd.BinaryBitmap(new zxing_js_umd.HybridBinarizer(luminanceSource)),result=zxingDecoder.decode(binaryBitmap);return{text:result.text,format:QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(result.format)),debugData:this.createDebugData()}},ZXingHtml5QrcodeDecoder2.prototype.createReverseFormatMap=function(){var result=new Map;return this.formatMap.forEach(function(value,key,_){result.set(value,key)}),result},ZXingHtml5QrcodeDecoder2.prototype.toHtml5QrcodeSupportedFormats=function(zxingFormat){if(!this.reverseFormatMap.has(zxingFormat))throw"reverseFormatMap doesn't have ".concat(zxingFormat);return this.reverseFormatMap.get(zxingFormat)},ZXingHtml5QrcodeDecoder2.prototype.createZXingFormats=function(requestedFormats){for(var zxingFormats=[],_i=0,requestedFormats_1=requestedFormats;_i<requestedFormats_1.length;_i++){var requestedFormat=requestedFormats_1[_i];this.formatMap.has(requestedFormat)?zxingFormats.push(this.formatMap.get(requestedFormat)):this.logger.logError("".concat(requestedFormat," is not supported by")+"ZXingHtml5QrcodeShim")}return zxingFormats},ZXingHtml5QrcodeDecoder2.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},ZXingHtml5QrcodeDecoder2}(),__awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},BarcodeDetectorDelegate=function(){function BarcodeDetectorDelegate2(requestedFormats,verbose,logger){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"qr_code"],[Html5QrcodeSupportedFormats.AZTEC,"aztec"],[Html5QrcodeSupportedFormats.CODABAR,"codabar"],[Html5QrcodeSupportedFormats.CODE_39,"code_39"],[Html5QrcodeSupportedFormats.CODE_93,"code_93"],[Html5QrcodeSupportedFormats.CODE_128,"code_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"data_matrix"],[Html5QrcodeSupportedFormats.ITF,"itf"],[Html5QrcodeSupportedFormats.EAN_13,"ean_13"],[Html5QrcodeSupportedFormats.EAN_8,"ean_8"],[Html5QrcodeSupportedFormats.PDF_417,"pdf417"],[Html5QrcodeSupportedFormats.UPC_A,"upc_a"],[Html5QrcodeSupportedFormats.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!BarcodeDetectorDelegate2.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=verbose,this.logger=logger;var formats=this.createBarcodeDetectorFormats(requestedFormats);if(this.detector=new BarcodeDetector(formats),!this.detector)throw"BarcodeDetector detector not supported"}return BarcodeDetectorDelegate2.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var dummyDetector=new BarcodeDetector({formats:["qr_code"]});return typeof dummyDetector<"u"},BarcodeDetectorDelegate2.prototype.decodeAsync=function(canvas){return __awaiter(this,void 0,void 0,function(){var barcodes,largestBarcode;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.detector.detect(canvas)];case 1:if(barcodes=_a.sent(),!barcodes||barcodes.length===0)throw"No barcode or QR code detected.";return largestBarcode=this.selectLargestBarcode(barcodes),[2,{text:largestBarcode.rawValue,format:QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(largestBarcode.format)),debugData:this.createDebugData()}]}})})},BarcodeDetectorDelegate2.prototype.selectLargestBarcode=function(barcodes){for(var largestBarcode=null,maxArea=0,_i=0,barcodes_1=barcodes;_i<barcodes_1.length;_i++){var barcode=barcodes_1[_i],area=barcode.boundingBox.width*barcode.boundingBox.height;area>maxArea&&(maxArea=area,largestBarcode=barcode)}if(!largestBarcode)throw"No largest barcode found";return largestBarcode},BarcodeDetectorDelegate2.prototype.createBarcodeDetectorFormats=function(requestedFormats){for(var formats=[],_i=0,requestedFormats_1=requestedFormats;_i<requestedFormats_1.length;_i++){var requestedFormat=requestedFormats_1[_i];this.formatMap.has(requestedFormat)?formats.push(this.formatMap.get(requestedFormat)):this.logger.warn("".concat(requestedFormat," is not supported by")+"BarcodeDetectorDelegate")}return{formats}},BarcodeDetectorDelegate2.prototype.toHtml5QrcodeSupportedFormats=function(barcodeDetectorFormat){if(!this.reverseFormatMap.has(barcodeDetectorFormat))throw"reverseFormatMap doesn't have ".concat(barcodeDetectorFormat);return this.reverseFormatMap.get(barcodeDetectorFormat)},BarcodeDetectorDelegate2.prototype.createReverseFormatMap=function(){var result=new Map;return this.formatMap.forEach(function(value,key,_){result.set(value,key)}),result},BarcodeDetectorDelegate2.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},BarcodeDetectorDelegate2}(),code_decoder_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},code_decoder_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},Html5QrcodeShim=function(){function Html5QrcodeShim2(requestedFormats,useBarCodeDetectorIfSupported,verbose,logger){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=verbose,useBarCodeDetectorIfSupported&&BarcodeDetectorDelegate.isSupported()?(this.primaryDecoder=new BarcodeDetectorDelegate(requestedFormats,verbose,logger),this.secondaryDecoder=new ZXingHtml5QrcodeDecoder(requestedFormats,verbose,logger)):this.primaryDecoder=new ZXingHtml5QrcodeDecoder(requestedFormats,verbose,logger)}return Html5QrcodeShim2.prototype.decodeAsync=function(canvas){return code_decoder_awaiter(this,void 0,void 0,function(){var startTime;return code_decoder_generator(this,function(_a){switch(_a.label){case 0:startTime=performance.now(),_a.label=1;case 1:return _a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(canvas)];case 2:return[2,_a.sent()];case 3:return this.possiblyLogPerformance(startTime),[7];case 4:return[2]}})})},Html5QrcodeShim2.prototype.decodeRobustlyAsync=function(canvas){return code_decoder_awaiter(this,void 0,void 0,function(){var startTime,error_1;return code_decoder_generator(this,function(_a){switch(_a.label){case 0:startTime=performance.now(),_a.label=1;case 1:return _a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(canvas)];case 2:return[2,_a.sent()];case 3:if(error_1=_a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(canvas)];throw error_1;case 4:return this.possiblyLogPerformance(startTime),[7];case 5:return[2]}})})},Html5QrcodeShim2.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},Html5QrcodeShim2.prototype.possiblyLogPerformance=function(startTime){if(this.verbose){var executionTime=performance.now()-startTime;this.executionResults.push(executionTime),this.executions++,this.possiblyFlushPerformanceReport()}},Html5QrcodeShim2.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var sum=0,_i=0,_a=this.executionResults;_i<_a.length;_i++){var executionTime=_a[_i];sum+=executionTime}var mean=sum/this.executionResults.length;console.log("".concat(mean," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},Html5QrcodeShim2}(),__extends=function(){var extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2}||function(d2,b2){for(var p in b2)Object.prototype.hasOwnProperty.call(b2,p)&&(d2[p]=b2[p])},extendStatics(d,b)};return function(d,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}(),core_impl_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},core_impl_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},AbstractCameraCapability=function(){function AbstractCameraCapability2(name,track){this.name=name,this.track=track}return AbstractCameraCapability2.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},AbstractCameraCapability2.prototype.apply=function(value){var constraint={};constraint[this.name]=value;var constraints={advanced:[constraint]};return this.track.applyConstraints(constraints)},AbstractCameraCapability2.prototype.value=function(){var settings=this.track.getSettings();if(this.name in settings){var settingValue=settings[this.name];return settingValue}return null},AbstractCameraCapability2}(),AbstractRangeCameraCapability=function(_super){__extends(AbstractRangeCameraCapability2,_super);function AbstractRangeCameraCapability2(name,track){return _super.call(this,name,track)||this}return AbstractRangeCameraCapability2.prototype.min=function(){return this.getCapabilities().min},AbstractRangeCameraCapability2.prototype.max=function(){return this.getCapabilities().max},AbstractRangeCameraCapability2.prototype.step=function(){return this.getCapabilities().step},AbstractRangeCameraCapability2.prototype.apply=function(value){var constraint={};constraint[this.name]=value;var constraints={advanced:[constraint]};return this.track.applyConstraints(constraints)},AbstractRangeCameraCapability2.prototype.getCapabilities=function(){this.failIfNotSupported();var capabilities=this.track.getCapabilities(),capability=capabilities[this.name];return{min:capability.min,max:capability.max,step:capability.step}},AbstractRangeCameraCapability2.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},AbstractRangeCameraCapability2}(AbstractCameraCapability),ZoomFeatureImpl=function(_super){__extends(ZoomFeatureImpl2,_super);function ZoomFeatureImpl2(track){return _super.call(this,"zoom",track)||this}return ZoomFeatureImpl2}(AbstractRangeCameraCapability),TorchFeatureImpl=function(_super){__extends(TorchFeatureImpl2,_super);function TorchFeatureImpl2(track){return _super.call(this,"torch",track)||this}return TorchFeatureImpl2}(AbstractCameraCapability),CameraCapabilitiesImpl=function(){function CameraCapabilitiesImpl2(track){this.track=track}return CameraCapabilitiesImpl2.prototype.zoomFeature=function(){return new ZoomFeatureImpl(this.track)},CameraCapabilitiesImpl2.prototype.torchFeature=function(){return new TorchFeatureImpl(this.track)},CameraCapabilitiesImpl2}(),RenderedCameraImpl=function(){function RenderedCameraImpl2(parentElement,mediaStream,callbacks){this.isClosed=!1,this.parentElement=parentElement,this.mediaStream=mediaStream,this.callbacks=callbacks,this.surface=this.createVideoElement(this.parentElement.clientWidth),parentElement.append(this.surface)}return RenderedCameraImpl2.prototype.createVideoElement=function(width){var videoElement=document.createElement("video");return videoElement.style.width="".concat(width,"px"),videoElement.style.display="block",videoElement.muted=!0,videoElement.setAttribute("muted","true"),videoElement.playsInline=!0,videoElement},RenderedCameraImpl2.prototype.setupSurface=function(){var _this=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var onVideoStart=function(){var videoWidth=_this.surface.clientWidth,videoHeight=_this.surface.clientHeight;_this.callbacks.onRenderSurfaceReady(videoWidth,videoHeight),_this.surface.removeEventListener("playing",onVideoStart)};this.surface.addEventListener("playing",onVideoStart),this.surface.srcObject=this.mediaStream,this.surface.play()},RenderedCameraImpl2.create=function(parentElement,mediaStream,options,callbacks){return core_impl_awaiter(this,void 0,void 0,function(){var renderedCamera,aspectRatioConstraint;return core_impl_generator(this,function(_a){switch(_a.label){case 0:return renderedCamera=new RenderedCameraImpl2(parentElement,mediaStream,callbacks),options.aspectRatio?(aspectRatioConstraint={aspectRatio:options.aspectRatio},[4,renderedCamera.getFirstTrackOrFail().applyConstraints(aspectRatioConstraint)]):[3,2];case 1:_a.sent(),_a.label=2;case 2:return renderedCamera.setupSurface(),[2,renderedCamera]}})})},RenderedCameraImpl2.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},RenderedCameraImpl2.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},RenderedCameraImpl2.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},RenderedCameraImpl2.prototype.resume=function(onResumeCallback){this.failIfClosed();var $this=this,onVideoResume=function(){setTimeout(onResumeCallback,200),$this.surface.removeEventListener("playing",onVideoResume)};this.surface.addEventListener("playing",onVideoResume),this.surface.play()},RenderedCameraImpl2.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},RenderedCameraImpl2.prototype.getSurface=function(){return this.failIfClosed(),this.surface},RenderedCameraImpl2.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},RenderedCameraImpl2.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},RenderedCameraImpl2.prototype.applyVideoConstraints=function(constraints){return core_impl_awaiter(this,void 0,void 0,function(){return core_impl_generator(this,function(_a){if("aspectRatio"in constraints)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(constraints)]})})},RenderedCameraImpl2.prototype.close=function(){if(this.isClosed)return Promise.resolve();var $this=this;return new Promise(function(resolve,_){var tracks=$this.mediaStream.getVideoTracks(),tracksToClose=tracks.length,tracksClosed=0;$this.mediaStream.getVideoTracks().forEach(function(videoTrack){$this.mediaStream.removeTrack(videoTrack),videoTrack.stop(),++tracksClosed,tracksClosed>=tracksToClose&&($this.isClosed=!0,$this.parentElement.removeChild($this.surface),resolve())})})},RenderedCameraImpl2.prototype.getCapabilities=function(){return new CameraCapabilitiesImpl(this.getFirstTrackOrFail())},RenderedCameraImpl2}(),CameraImpl=function(){function CameraImpl2(mediaStream){this.mediaStream=mediaStream}return CameraImpl2.prototype.render=function(parentElement,options,callbacks){return core_impl_awaiter(this,void 0,void 0,function(){return core_impl_generator(this,function(_a){return[2,RenderedCameraImpl.create(parentElement,this.mediaStream,options,callbacks)]})})},CameraImpl2.create=function(videoConstraints){return core_impl_awaiter(this,void 0,void 0,function(){var constraints,mediaStream;return core_impl_generator(this,function(_a){switch(_a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return constraints={audio:!1,video:videoConstraints},[4,navigator.mediaDevices.getUserMedia(constraints)];case 1:return mediaStream=_a.sent(),[2,new CameraImpl2(mediaStream)]}})})},CameraImpl2}(),factories_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},factories_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},CameraFactory=function(){function CameraFactory2(){}return CameraFactory2.failIfNotSupported=function(){return factories_awaiter(this,void 0,void 0,function(){return factories_generator(this,function(_a){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new CameraFactory2]})})},CameraFactory2.prototype.create=function(videoConstraints){return factories_awaiter(this,void 0,void 0,function(){return factories_generator(this,function(_a){return[2,CameraImpl.create(videoConstraints)]})})},CameraFactory2}(),retriever_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},retriever_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},CameraRetriever=function(){function CameraRetriever2(){}return CameraRetriever2.retrieve=function(){if(navigator.mediaDevices)return CameraRetriever2.getCamerasFromMediaDevices();var mst=MediaStreamTrack;return MediaStreamTrack&&mst.getSources?CameraRetriever2.getCamerasFromMediaStreamTrack():CameraRetriever2.rejectWithError()},CameraRetriever2.rejectWithError=function(){var errorMessage=Html5QrcodeStrings.unableToQuerySupportedDevices();return CameraRetriever2.isHttpsOrLocalhost()||(errorMessage=Html5QrcodeStrings.insecureContextCameraQueryError()),Promise.reject(errorMessage)},CameraRetriever2.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var host=location.host.split(":")[0];return host==="127.0.0.1"||host==="localhost"},CameraRetriever2.getCamerasFromMediaDevices=function(){return retriever_awaiter(this,void 0,void 0,function(){var closeActiveStreams,mediaStream,devices,results,_i,devices_1,device;return retriever_generator(this,function(_a){switch(_a.label){case 0:return closeActiveStreams=function(stream){for(var tracks=stream.getVideoTracks(),_i2=0,tracks_1=tracks;_i2<tracks_1.length;_i2++){var track=tracks_1[_i2];track.enabled=!1,track.stop(),stream.removeTrack(track)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return mediaStream=_a.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(devices=_a.sent(),results=[],_i=0,devices_1=devices;_i<devices_1.length;_i++)device=devices_1[_i],device.kind==="videoinput"&&results.push({id:device.deviceId,label:device.label});return closeActiveStreams(mediaStream),[2,results]}})})},CameraRetriever2.getCamerasFromMediaStreamTrack=function(){return new Promise(function(resolve,_){var callback=function(sourceInfos){for(var results=[],_i=0,sourceInfos_1=sourceInfos;_i<sourceInfos_1.length;_i++){var sourceInfo=sourceInfos_1[_i];sourceInfo.kind==="video"&&results.push({id:sourceInfo.id,label:sourceInfo.label})}resolve(results)},mst=MediaStreamTrack;mst.getSources(callback)})},CameraRetriever2}(),Html5QrcodeScannerState;(function(Html5QrcodeScannerState2){Html5QrcodeScannerState2[Html5QrcodeScannerState2.UNKNOWN=0]="UNKNOWN",Html5QrcodeScannerState2[Html5QrcodeScannerState2.NOT_STARTED=1]="NOT_STARTED",Html5QrcodeScannerState2[Html5QrcodeScannerState2.SCANNING=2]="SCANNING",Html5QrcodeScannerState2[Html5QrcodeScannerState2.PAUSED=3]="PAUSED"})(Html5QrcodeScannerState||(Html5QrcodeScannerState={}));var StateManagerImpl=function(){function StateManagerImpl2(){this.state=Html5QrcodeScannerState.NOT_STARTED,this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN}return StateManagerImpl2.prototype.directTransition=function(newState){this.failIfTransitionOngoing(),this.validateTransition(newState),this.state=newState},StateManagerImpl2.prototype.startTransition=function(newState){return this.failIfTransitionOngoing(),this.validateTransition(newState),this.onGoingTransactionNewState=newState,this},StateManagerImpl2.prototype.execute=function(){if(this.onGoingTransactionNewState===Html5QrcodeScannerState.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var tempNewState=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN,this.directTransition(tempNewState)},StateManagerImpl2.prototype.cancel=function(){if(this.onGoingTransactionNewState===Html5QrcodeScannerState.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN},StateManagerImpl2.prototype.getState=function(){return this.state},StateManagerImpl2.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Html5QrcodeScannerState.UNKNOWN)throw"Cannot transition to a new state, already under transition"},StateManagerImpl2.prototype.validateTransition=function(newState){switch(this.state){case Html5QrcodeScannerState.UNKNOWN:throw"Transition from unknown is not allowed";case Html5QrcodeScannerState.NOT_STARTED:this.failIfNewStateIs(newState,[Html5QrcodeScannerState.PAUSED]);break;case Html5QrcodeScannerState.SCANNING:break;case Html5QrcodeScannerState.PAUSED:break}},StateManagerImpl2.prototype.failIfNewStateIs=function(newState,disallowedStatesToTransition){for(var _i=0,disallowedStatesToTransition_1=disallowedStatesToTransition;_i<disallowedStatesToTransition_1.length;_i++){var disallowedState=disallowedStatesToTransition_1[_i];if(newState===disallowedState)throw"Cannot transition from ".concat(this.state," to ").concat(newState)}},StateManagerImpl2}(),StateManagerProxy=function(){function StateManagerProxy2(stateManager){this.stateManager=stateManager}return StateManagerProxy2.prototype.startTransition=function(newState){return this.stateManager.startTransition(newState)},StateManagerProxy2.prototype.directTransition=function(newState){this.stateManager.directTransition(newState)},StateManagerProxy2.prototype.getState=function(){return this.stateManager.getState()},StateManagerProxy2.prototype.canScanFile=function(){return this.stateManager.getState()===Html5QrcodeScannerState.NOT_STARTED},StateManagerProxy2.prototype.isScanning=function(){return this.stateManager.getState()!==Html5QrcodeScannerState.NOT_STARTED},StateManagerProxy2.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Html5QrcodeScannerState.SCANNING},StateManagerProxy2.prototype.isPaused=function(){return this.stateManager.getState()===Html5QrcodeScannerState.PAUSED},StateManagerProxy2}(),StateManagerFactory=function(){function StateManagerFactory2(){}return StateManagerFactory2.create=function(){return new StateManagerProxy(new StateManagerImpl)},StateManagerFactory2}(),html5_qrcode_extends=function(){var extendStatics=function(d,b){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2}||function(d2,b2){for(var p in b2)Object.prototype.hasOwnProperty.call(b2,p)&&(d2[p]=b2[p])},extendStatics(d,b)};return function(d,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}(),Constants=function(_super){html5_qrcode_extends(Constants2,_super);function Constants2(){return _super!==null&&_super.apply(this,arguments)||this}return Constants2.DEFAULT_WIDTH=300,Constants2.DEFAULT_WIDTH_OFFSET=2,Constants2.FILE_SCAN_MIN_HEIGHT=300,Constants2.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,Constants2.MIN_QR_BOX_SIZE=50,Constants2.SHADED_LEFT=1,Constants2.SHADED_RIGHT=2,Constants2.SHADED_TOP=3,Constants2.SHADED_BOTTOM=4,Constants2.SHADED_REGION_ELEMENT_ID="qr-shaded-region",Constants2.VERBOSE=!1,Constants2.BORDER_SHADER_DEFAULT_COLOR="#ffffff",Constants2.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",Constants2}(Html5QrcodeConstants),InternalHtml5QrcodeConfig=function(){function InternalHtml5QrcodeConfig2(config,logger){this.logger=logger,this.fps=Constants.SCAN_DEFAULT_FPS,config?(config.fps&&(this.fps=config.fps),this.disableFlip=config.disableFlip===!0,this.qrbox=config.qrbox,this.aspectRatio=config.aspectRatio,this.videoConstraints=config.videoConstraints):this.disableFlip=Constants.DEFAULT_DISABLE_FLIP}return InternalHtml5QrcodeConfig2.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?VideoConstraintsUtil.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},InternalHtml5QrcodeConfig2.prototype.isShadedBoxEnabled=function(){return!isNullOrUndefined(this.qrbox)},InternalHtml5QrcodeConfig2.create=function(config,logger){return new InternalHtml5QrcodeConfig2(config,logger)},InternalHtml5QrcodeConfig2}(),Html5Qrcode=function(){function Html5Qrcode2(elementId,configOrVerbosityFlag){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(elementId))throw"HTML Element with id=".concat(elementId," not found");this.elementId=elementId,this.verbose=!1;var experimentalFeatureConfig,configObject;typeof configOrVerbosityFlag=="boolean"?this.verbose=configOrVerbosityFlag===!0:configOrVerbosityFlag&&(configObject=configOrVerbosityFlag,this.verbose=configObject.verbose===!0,experimentalFeatureConfig=configObject.experimentalFeatures),this.logger=new BaseLoggger(this.verbose),this.qrcode=new Html5QrcodeShim(this.getSupportedFormats(configOrVerbosityFlag),this.getUseBarCodeDetectorIfSupported(configObject),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=StateManagerFactory.create()}return Html5Qrcode2.prototype.start=function(cameraIdOrConfig,configuration,qrCodeSuccessCallback,qrCodeErrorCallback){var _this=this;if(!cameraIdOrConfig)throw"cameraIdOrConfig is required";if(!qrCodeSuccessCallback||typeof qrCodeSuccessCallback!="function")throw"qrCodeSuccessCallback is required and should be a function.";var qrCodeErrorCallbackInternal;qrCodeErrorCallback?qrCodeErrorCallbackInternal=qrCodeErrorCallback:qrCodeErrorCallbackInternal=this.verbose?this.logger.log:function(){};var internalConfig=InternalHtml5QrcodeConfig.create(configuration,this.logger);this.clearElement();var videoConstraintsAvailableAndValid=!1;internalConfig.videoConstraints&&(internalConfig.isMediaStreamConstraintsValid()?videoConstraintsAvailableAndValid=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var areVideoConstraintsEnabled=videoConstraintsAvailableAndValid,element=document.getElementById(this.elementId),rootElementWidth=element.clientWidth?element.clientWidth:Constants.DEFAULT_WIDTH;element.style.position="relative",this.shouldScan=!0,this.element=element;var $this=this,toScanningStateChangeTransaction=this.stateManagerProxy.startTransition(Html5QrcodeScannerState.SCANNING);return new Promise(function(resolve,reject){var videoConstraints=areVideoConstraintsEnabled?internalConfig.videoConstraints:$this.createVideoConstraints(cameraIdOrConfig);if(!videoConstraints){toScanningStateChangeTransaction.cancel(),reject("videoConstraints should be defined");return}var cameraRenderingOptions={};(!areVideoConstraintsEnabled||internalConfig.aspectRatio)&&(cameraRenderingOptions.aspectRatio=internalConfig.aspectRatio);var renderingCallbacks={onRenderSurfaceReady:function(viewfinderWidth,viewfinderHeight){$this.setupUi(viewfinderWidth,viewfinderHeight,internalConfig),$this.isScanning=!0,$this.foreverScan(internalConfig,qrCodeSuccessCallback,qrCodeErrorCallbackInternal)}};CameraFactory.failIfNotSupported().then(function(factory){factory.create(videoConstraints).then(function(camera){return camera.render(_this.element,cameraRenderingOptions,renderingCallbacks).then(function(renderedCamera){$this.renderedCamera=renderedCamera,toScanningStateChangeTransaction.execute(),resolve(null)}).catch(function(error){toScanningStateChangeTransaction.cancel(),reject(error)})}).catch(function(error){toScanningStateChangeTransaction.cancel(),reject(Html5QrcodeStrings.errorGettingUserMedia(error))})}).catch(function(_){toScanningStateChangeTransaction.cancel(),reject(Html5QrcodeStrings.cameraStreamingNotSupported())})})},Html5Qrcode2.prototype.pause=function(shouldPauseVideo){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Html5QrcodeScannerState.PAUSED),this.showPausedState(),(isNullOrUndefined(shouldPauseVideo)||shouldPauseVideo!==!0)&&(shouldPauseVideo=!1),shouldPauseVideo&&this.renderedCamera&&this.renderedCamera.pause()},Html5Qrcode2.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var $this=this,transitionToScanning=function(){$this.stateManagerProxy.directTransition(Html5QrcodeScannerState.SCANNING),$this.hidePausedState()};if(!this.renderedCamera.isPaused()){transitionToScanning();return}this.renderedCamera.resume(function(){transitionToScanning()})},Html5Qrcode2.prototype.getState=function(){return this.stateManagerProxy.getState()},Html5Qrcode2.prototype.stop=function(){var _this=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var toStoppedStateTransaction=this.stateManagerProxy.startTransition(Html5QrcodeScannerState.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var removeQrRegion=function(){if(_this.element){var childElement=document.getElementById(Constants.SHADED_REGION_ELEMENT_ID);childElement&&_this.element.removeChild(childElement)}},$this=this;return this.renderedCamera.close().then(function(){return $this.renderedCamera=null,$this.element&&($this.element.removeChild($this.canvasElement),$this.canvasElement=null),removeQrRegion(),$this.qrRegion&&($this.qrRegion=null),$this.context&&($this.context=null),toStoppedStateTransaction.execute(),$this.hidePausedState(),$this.isScanning=!1,Promise.resolve()})},Html5Qrcode2.prototype.scanFile=function(imageFile,showImage){return this.scanFileV2(imageFile,showImage).then(function(html5qrcodeResult){return html5qrcodeResult.decodedText})},Html5Qrcode2.prototype.scanFileV2=function(imageFile,showImage){var _this=this;if(!imageFile||!(imageFile instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(isNullOrUndefined(showImage)&&(showImage=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(resolve,reject){_this.possiblyCloseLastScanImageFile(),_this.clearElement(),_this.lastScanImageFile=URL.createObjectURL(imageFile);var inputImage=new Image;inputImage.onload=function(){var imageWidth=inputImage.width,imageHeight=inputImage.height,element=document.getElementById(_this.elementId),containerWidth=element.clientWidth?element.clientWidth:Constants.DEFAULT_WIDTH,containerHeight=Math.max(element.clientHeight?element.clientHeight:imageHeight,Constants.FILE_SCAN_MIN_HEIGHT),config=_this.computeCanvasDrawConfig(imageWidth,imageHeight,containerWidth,containerHeight);if(showImage){var visibleCanvas=_this.createCanvasElement(containerWidth,containerHeight,"qr-canvas-visible");visibleCanvas.style.display="inline-block",element.appendChild(visibleCanvas);var context_1=visibleCanvas.getContext("2d");if(!context_1)throw"Unable to get 2d context from canvas";context_1.canvas.width=containerWidth,context_1.canvas.height=containerHeight,context_1.drawImage(inputImage,0,0,imageWidth,imageHeight,config.x,config.y,config.width,config.height)}var padding=Constants.FILE_SCAN_HIDDEN_CANVAS_PADDING,hiddenImageWidth=Math.max(inputImage.width,config.width),hiddenImageHeight=Math.max(inputImage.height,config.height),hiddenCanvasWidth=hiddenImageWidth+2*padding,hiddenCanvasHeight=hiddenImageHeight+2*padding,hiddenCanvas=_this.createCanvasElement(hiddenCanvasWidth,hiddenCanvasHeight);element.appendChild(hiddenCanvas);var context=hiddenCanvas.getContext("2d");if(!context)throw"Unable to get 2d context from canvas";context.canvas.width=hiddenCanvasWidth,context.canvas.height=hiddenCanvasHeight,context.drawImage(inputImage,0,0,imageWidth,imageHeight,padding,padding,hiddenImageWidth,hiddenImageHeight);try{_this.qrcode.decodeRobustlyAsync(hiddenCanvas).then(function(result){resolve(Html5QrcodeResultFactory.createFromQrcodeResult(result))}).catch(reject)}catch(exception){reject("QR code parse error, error = ".concat(exception))}},inputImage.onerror=reject,inputImage.onabort=reject,inputImage.onstalled=reject,inputImage.onsuspend=reject,inputImage.src=URL.createObjectURL(imageFile)})},Html5Qrcode2.prototype.clear=function(){this.clearElement()},Html5Qrcode2.getCameras=function(){return CameraRetriever.retrieve()},Html5Qrcode2.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},Html5Qrcode2.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},Html5Qrcode2.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},Html5Qrcode2.prototype.applyVideoConstraints=function(videoConstaints){if(videoConstaints){if(!VideoConstraintsUtil.isMediaStreamConstraintsValid(videoConstaints,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(videoConstaints)},Html5Qrcode2.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},Html5Qrcode2.prototype.getSupportedFormats=function(configOrVerbosityFlag){var allFormats=[Html5QrcodeSupportedFormats.QR_CODE,Html5QrcodeSupportedFormats.AZTEC,Html5QrcodeSupportedFormats.CODABAR,Html5QrcodeSupportedFormats.CODE_39,Html5QrcodeSupportedFormats.CODE_93,Html5QrcodeSupportedFormats.CODE_128,Html5QrcodeSupportedFormats.DATA_MATRIX,Html5QrcodeSupportedFormats.MAXICODE,Html5QrcodeSupportedFormats.ITF,Html5QrcodeSupportedFormats.EAN_13,Html5QrcodeSupportedFormats.EAN_8,Html5QrcodeSupportedFormats.PDF_417,Html5QrcodeSupportedFormats.RSS_14,Html5QrcodeSupportedFormats.RSS_EXPANDED,Html5QrcodeSupportedFormats.UPC_A,Html5QrcodeSupportedFormats.UPC_E,Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION];if(!configOrVerbosityFlag||typeof configOrVerbosityFlag=="boolean"||!configOrVerbosityFlag.formatsToSupport)return allFormats;if(!Array.isArray(configOrVerbosityFlag.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(configOrVerbosityFlag.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var supportedFormats=[],_i=0,_a=configOrVerbosityFlag.formatsToSupport;_i<_a.length;_i++){var format=_a[_i];isValidHtml5QrcodeSupportedFormats(format)?supportedFormats.push(format):this.logger.warn("Invalid format: ".concat(format," passed in config, ignoring."))}if(supportedFormats.length===0)throw"None of formatsToSupport match supported values.";return supportedFormats},Html5Qrcode2.prototype.getUseBarCodeDetectorIfSupported=function(config){if(isNullOrUndefined(config))return!0;if(!isNullOrUndefined(config.useBarCodeDetectorIfSupported))return config.useBarCodeDetectorIfSupported!==!1;if(isNullOrUndefined(config.experimentalFeatures))return!0;var experimentalFeatures=config.experimentalFeatures;return isNullOrUndefined(experimentalFeatures.useBarCodeDetectorIfSupported)?!0:experimentalFeatures.useBarCodeDetectorIfSupported!==!1},Html5Qrcode2.prototype.validateQrboxSize=function(viewfinderWidth,viewfinderHeight,internalConfig){var _this=this,qrboxSize=internalConfig.qrbox;this.validateQrboxConfig(qrboxSize);var qrDimensions=this.toQrdimensions(viewfinderWidth,viewfinderHeight,qrboxSize),validateMinSize=function(size){if(size<Constants.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Constants.MIN_QR_BOX_SIZE,"px.")},correctWidthBasedOnRootElementSize=function(configWidth){return configWidth>viewfinderWidth&&(_this.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),configWidth=viewfinderWidth),configWidth};validateMinSize(qrDimensions.width),validateMinSize(qrDimensions.height),qrDimensions.width=correctWidthBasedOnRootElementSize(qrDimensions.width)},Html5Qrcode2.prototype.validateQrboxConfig=function(qrboxSize){if(typeof qrboxSize!="number"&&typeof qrboxSize!="function"&&(qrboxSize.width===void 0||qrboxSize.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},Html5Qrcode2.prototype.toQrdimensions=function(viewfinderWidth,viewfinderHeight,qrboxSize){if(typeof qrboxSize=="number")return{width:qrboxSize,height:qrboxSize};if(typeof qrboxSize=="function")try{return qrboxSize(viewfinderWidth,viewfinderHeight)}catch(error){throw new Error("qrbox config was passed as a function but it failed with unknown error"+error)}return qrboxSize},Html5Qrcode2.prototype.setupUi=function(viewfinderWidth,viewfinderHeight,internalConfig){internalConfig.isShadedBoxEnabled()&&this.validateQrboxSize(viewfinderWidth,viewfinderHeight,internalConfig);var qrboxSize=isNullOrUndefined(internalConfig.qrbox)?{width:viewfinderWidth,height:viewfinderHeight}:internalConfig.qrbox;this.validateQrboxConfig(qrboxSize);var qrDimensions=this.toQrdimensions(viewfinderWidth,viewfinderHeight,qrboxSize);qrDimensions.height>viewfinderHeight&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var shouldShadingBeApplied=internalConfig.isShadedBoxEnabled()&&qrDimensions.height<=viewfinderHeight,defaultQrRegion={x:0,y:0,width:viewfinderWidth,height:viewfinderHeight},qrRegion=shouldShadingBeApplied?this.getShadedRegionBounds(viewfinderWidth,viewfinderHeight,qrDimensions):defaultQrRegion,canvasElement=this.createCanvasElement(qrRegion.width,qrRegion.height),contextAttributes={willReadFrequently:!0},context=canvasElement.getContext("2d",contextAttributes);context.canvas.width=qrRegion.width,context.canvas.height=qrRegion.height,this.element.append(canvasElement),shouldShadingBeApplied&&this.possiblyInsertShadingElement(this.element,viewfinderWidth,viewfinderHeight,qrDimensions),this.createScannerPausedUiElement(this.element),this.qrRegion=qrRegion,this.context=context,this.canvasElement=canvasElement},Html5Qrcode2.prototype.createScannerPausedUiElement=function(rootElement){var scannerPausedUiElement=document.createElement("div");scannerPausedUiElement.innerText=Html5QrcodeStrings.scannerPaused(),scannerPausedUiElement.style.display="none",scannerPausedUiElement.style.position="absolute",scannerPausedUiElement.style.top="0px",scannerPausedUiElement.style.zIndex="1",scannerPausedUiElement.style.background="rgba(9, 9, 9, 0.46)",scannerPausedUiElement.style.color="#FFECEC",scannerPausedUiElement.style.textAlign="center",scannerPausedUiElement.style.width="100%",rootElement.appendChild(scannerPausedUiElement),this.scannerPausedUiElement=scannerPausedUiElement},Html5Qrcode2.prototype.scanContext=function(qrCodeSuccessCallback,qrCodeErrorCallback){var _this=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(result){return qrCodeSuccessCallback(result.text,Html5QrcodeResultFactory.createFromQrcodeResult(result)),_this.possiblyUpdateShaders(!0),!0}).catch(function(error){_this.possiblyUpdateShaders(!1);var errorMessage=Html5QrcodeStrings.codeParseError(error);return qrCodeErrorCallback(errorMessage,Html5QrcodeErrorFactory.createFrom(errorMessage)),!1})},Html5Qrcode2.prototype.foreverScan=function(internalConfig,qrCodeSuccessCallback,qrCodeErrorCallback){var _this=this;if(this.shouldScan&&this.renderedCamera){var videoElement=this.renderedCamera.getSurface(),widthRatio=videoElement.videoWidth/videoElement.clientWidth,heightRatio=videoElement.videoHeight/videoElement.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var sWidthOffset=this.qrRegion.width*widthRatio,sHeightOffset=this.qrRegion.height*heightRatio,sxOffset=this.qrRegion.x*widthRatio,syOffset=this.qrRegion.y*heightRatio;this.context.drawImage(videoElement,sxOffset,syOffset,sWidthOffset,sHeightOffset,0,0,this.qrRegion.width,this.qrRegion.height);var triggerNextScan=function(){_this.foreverScanTimeout=setTimeout(function(){_this.foreverScan(internalConfig,qrCodeSuccessCallback,qrCodeErrorCallback)},_this.getTimeoutFps(internalConfig.fps))};this.scanContext(qrCodeSuccessCallback,qrCodeErrorCallback).then(function(isSuccessfull){!isSuccessfull&&internalConfig.disableFlip!==!0?(_this.context.translate(_this.context.canvas.width,0),_this.context.scale(-1,1),_this.scanContext(qrCodeSuccessCallback,qrCodeErrorCallback).finally(function(){triggerNextScan()})):triggerNextScan()}).catch(function(error){_this.logger.logError("Error happend while scanning context",error),triggerNextScan()})}},Html5Qrcode2.prototype.createVideoConstraints=function(cameraIdOrConfig){if(typeof cameraIdOrConfig=="string")return{deviceId:{exact:cameraIdOrConfig}};if(typeof cameraIdOrConfig=="object"){var facingModeKey="facingMode",deviceIdKey="deviceId",allowedFacingModeValues_1={user:!0,environment:!0},exactKey="exact",isValidFacingModeValue=function(value){if(value in allowedFacingModeValues_1)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(value,"'")},keys=Object.keys(cameraIdOrConfig);if(keys.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(keys.length," keys");var key=Object.keys(cameraIdOrConfig)[0];if(key!==facingModeKey&&key!==deviceIdKey)throw"Only '".concat(facingModeKey,"' and '").concat(deviceIdKey,"' ")+" are supported for 'cameraIdOrConfig'";if(key===facingModeKey){var facingMode=cameraIdOrConfig.facingMode;if(typeof facingMode=="string"){if(isValidFacingModeValue(facingMode))return{facingMode}}else if(typeof facingMode=="object")if(exactKey in facingMode){if(isValidFacingModeValue(facingMode["".concat(exactKey)]))return{facingMode:{exact:facingMode["".concat(exactKey)]}}}else throw"'facingMode' should be string or object with"+" ".concat(exactKey," as key.");else{var type_1=typeof facingMode;throw"Invalid type of 'facingMode' = ".concat(type_1)}}else{var deviceId=cameraIdOrConfig.deviceId;if(typeof deviceId=="string")return{deviceId};if(typeof deviceId=="object"){if(exactKey in deviceId)return{deviceId:{exact:deviceId["".concat(exactKey)]}};throw"'deviceId' should be string or object with"+" ".concat(exactKey," as key.")}else{var type_2=typeof deviceId;throw"Invalid type of 'deviceId' = ".concat(type_2)}}}var type=typeof cameraIdOrConfig;throw"Invalid type of 'cameraIdOrConfig' = ".concat(type)},Html5Qrcode2.prototype.computeCanvasDrawConfig=function(imageWidth,imageHeight,containerWidth,containerHeight){if(imageWidth<=containerWidth&&imageHeight<=containerHeight){var xoffset=(containerWidth-imageWidth)/2,yoffset=(containerHeight-imageHeight)/2;return{x:xoffset,y:yoffset,width:imageWidth,height:imageHeight}}else{var formerImageWidth=imageWidth,formerImageHeight=imageHeight;return imageWidth>containerWidth&&(imageHeight=containerWidth/imageWidth*imageHeight,imageWidth=containerWidth),imageHeight>containerHeight&&(imageWidth=containerHeight/imageHeight*imageWidth,imageHeight=containerHeight),this.logger.log("Image downsampled from "+"".concat(formerImageWidth,"X").concat(formerImageHeight)+" to ".concat(imageWidth,"X").concat(imageHeight,".")),this.computeCanvasDrawConfig(imageWidth,imageHeight,containerWidth,containerHeight)}},Html5Qrcode2.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var element=document.getElementById(this.elementId);element&&(element.innerHTML="")},Html5Qrcode2.prototype.possiblyUpdateShaders=function(qrMatch){this.qrMatch!==qrMatch&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(shader){shader.style.backgroundColor=qrMatch?Constants.BORDER_SHADER_MATCH_COLOR:Constants.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=qrMatch)},Html5Qrcode2.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},Html5Qrcode2.prototype.createCanvasElement=function(width,height,customId){var canvasWidth=width,canvasHeight=height,canvasElement=document.createElement("canvas");return canvasElement.style.width="".concat(canvasWidth,"px"),canvasElement.style.height="".concat(canvasHeight,"px"),canvasElement.style.display="none",canvasElement.id=isNullOrUndefined(customId)?"qr-canvas":customId,canvasElement},Html5Qrcode2.prototype.getShadedRegionBounds=function(width,height,qrboxSize){if(qrboxSize.width>width||qrboxSize.height>height)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(width-qrboxSize.width)/2,y:(height-qrboxSize.height)/2,width:qrboxSize.width,height:qrboxSize.height}},Html5Qrcode2.prototype.possiblyInsertShadingElement=function(element,width,height,qrboxSize){if(!(width-qrboxSize.width<1||height-qrboxSize.height<1)){var shadingElement=document.createElement("div");shadingElement.style.position="absolute";var rightLeftBorderSize=(width-qrboxSize.width)/2,topBottomBorderSize=(height-qrboxSize.height)/2;if(shadingElement.style.borderLeft="".concat(rightLeftBorderSize,"px solid rgba(0, 0, 0, 0.48)"),shadingElement.style.borderRight="".concat(rightLeftBorderSize,"px solid rgba(0, 0, 0, 0.48)"),shadingElement.style.borderTop="".concat(topBottomBorderSize,"px solid rgba(0, 0, 0, 0.48)"),shadingElement.style.borderBottom="".concat(topBottomBorderSize,"px solid rgba(0, 0, 0, 0.48)"),shadingElement.style.boxSizing="border-box",shadingElement.style.top="0px",shadingElement.style.bottom="0px",shadingElement.style.left="0px",shadingElement.style.right="0px",shadingElement.id="".concat(Constants.SHADED_REGION_ELEMENT_ID),width-qrboxSize.width<11||height-qrboxSize.height<11)this.hasBorderShaders=!1;else{var smallSize=5,largeSize=40;this.insertShaderBorders(shadingElement,largeSize,smallSize,-smallSize,null,0,!0),this.insertShaderBorders(shadingElement,largeSize,smallSize,-smallSize,null,0,!1),this.insertShaderBorders(shadingElement,largeSize,smallSize,null,-smallSize,0,!0),this.insertShaderBorders(shadingElement,largeSize,smallSize,null,-smallSize,0,!1),this.insertShaderBorders(shadingElement,smallSize,largeSize+smallSize,-smallSize,null,-smallSize,!0),this.insertShaderBorders(shadingElement,smallSize,largeSize+smallSize,null,-smallSize,-smallSize,!0),this.insertShaderBorders(shadingElement,smallSize,largeSize+smallSize,-smallSize,null,-smallSize,!1),this.insertShaderBorders(shadingElement,smallSize,largeSize+smallSize,null,-smallSize,-smallSize,!1),this.hasBorderShaders=!0}element.append(shadingElement)}},Html5Qrcode2.prototype.insertShaderBorders=function(shaderElem,width,height,top,bottom,side,isLeft){var elem=document.createElement("div");elem.style.position="absolute",elem.style.backgroundColor=Constants.BORDER_SHADER_DEFAULT_COLOR,elem.style.width="".concat(width,"px"),elem.style.height="".concat(height,"px"),top!==null&&(elem.style.top="".concat(top,"px")),bottom!==null&&(elem.style.bottom="".concat(bottom,"px")),isLeft?elem.style.left="".concat(side,"px"):elem.style.right="".concat(side,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(elem),shaderElem.appendChild(elem)},Html5Qrcode2.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},Html5Qrcode2.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},Html5Qrcode2.prototype.getTimeoutFps=function(fps){return 1e3/fps},Html5Qrcode2}(),SVG_XML_PREFIX="data:image/svg+xml;base64,",ASSET_CAMERA_SCAN=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",ASSET_FILE_SCAN=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",ASSET_INFO_ICON_16PX=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",ASSET_CLOSE_ICON_16PX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",PersistedDataFactory=function(){function PersistedDataFactory2(){}return PersistedDataFactory2.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},PersistedDataFactory2}(),PersistedDataManager=function(){function PersistedDataManager2(){this.data=PersistedDataFactory.createDefault();var data=localStorage.getItem(PersistedDataManager2.LOCAL_STORAGE_KEY);data?this.data=JSON.parse(data):this.reset()}return PersistedDataManager2.prototype.hasCameraPermissions=function(){return this.data.hasPermission},PersistedDataManager2.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},PersistedDataManager2.prototype.setHasPermission=function(hasPermission){this.data.hasPermission=hasPermission,this.flush()},PersistedDataManager2.prototype.setLastUsedCameraId=function(lastUsedCameraId){this.data.lastUsedCameraId=lastUsedCameraId,this.flush()},PersistedDataManager2.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},PersistedDataManager2.prototype.reset=function(){this.data=PersistedDataFactory.createDefault(),this.flush()},PersistedDataManager2.prototype.flush=function(){localStorage.setItem(PersistedDataManager2.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},PersistedDataManager2.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",PersistedDataManager2}(),LibraryInfoDiv=function(){function LibraryInfoDiv2(){this.infoDiv=document.createElement("div")}return LibraryInfoDiv2.prototype.renderInto=function(parent){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=LibraryInfoStrings.poweredBy();var projectLink=document.createElement("a");projectLink.innerText="ScanApp",projectLink.href="https://scanapp.org",projectLink.target="new",projectLink.style.color="white",this.infoDiv.appendChild(projectLink);var breakElemFirst=document.createElement("br"),breakElemSecond=document.createElement("br");this.infoDiv.appendChild(breakElemFirst),this.infoDiv.appendChild(breakElemSecond);var reportIssueLink=document.createElement("a");reportIssueLink.innerText=LibraryInfoStrings.reportIssues(),reportIssueLink.href="https://github.com/mebjas/html5-qrcode/issues",reportIssueLink.target="new",reportIssueLink.style.color="white",this.infoDiv.appendChild(reportIssueLink),parent.appendChild(this.infoDiv)},LibraryInfoDiv2.prototype.show=function(){this.infoDiv.style.display="block"},LibraryInfoDiv2.prototype.hide=function(){this.infoDiv.style.display="none"},LibraryInfoDiv2}(),LibraryInfoIcon=function(){function LibraryInfoIcon2(onTapIn,onTapOut){this.isShowingInfoIcon=!0,this.onTapIn=onTapIn,this.onTapOut=onTapOut,this.infoIcon=document.createElement("img")}return LibraryInfoIcon2.prototype.renderInto=function(parent){var _this=this;this.infoIcon.alt="Info icon",this.infoIcon.src=ASSET_INFO_ICON_16PX,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(_){return _this.onHoverIn()},this.infoIcon.onmouseout=function(_){return _this.onHoverOut()},this.infoIcon.onclick=function(_){return _this.onClick()},parent.appendChild(this.infoIcon)},LibraryInfoIcon2.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},LibraryInfoIcon2.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},LibraryInfoIcon2.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=ASSET_CLOSE_ICON_16PX,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=ASSET_INFO_ICON_16PX,this.infoIcon.style.opacity="0.6")},LibraryInfoIcon2}(),LibraryInfoContainer=function(){function LibraryInfoContainer2(){var _this=this;this.infoDiv=new LibraryInfoDiv,this.infoIcon=new LibraryInfoIcon(function(){_this.infoDiv.show()},function(){_this.infoDiv.hide()})}return LibraryInfoContainer2.prototype.renderInto=function(parent){this.infoDiv.renderInto(parent),this.infoIcon.renderInto(parent)},LibraryInfoContainer2}(),permissions_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},permissions_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},CameraPermissions=function(){function CameraPermissions2(){}return CameraPermissions2.hasPermissions=function(){return permissions_awaiter(this,void 0,void 0,function(){var devices,_i,devices_1,device;return permissions_generator(this,function(_a){switch(_a.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(devices=_a.sent(),_i=0,devices_1=devices;_i<devices_1.length;_i++)if(device=devices_1[_i],device.kind==="videoinput"&&device.label)return[2,!0];return[2,!1]}})})},CameraPermissions2}(),ScanTypeSelector=function(){function ScanTypeSelector2(supportedScanTypes){this.supportedScanTypes=this.validateAndReturnScanTypes(supportedScanTypes)}return ScanTypeSelector2.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},ScanTypeSelector2.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},ScanTypeSelector2.prototype.isCameraScanRequired=function(){for(var _i=0,_a=this.supportedScanTypes;_i<_a.length;_i++){var scanType=_a[_i];if(ScanTypeSelector2.isCameraScanType(scanType))return!0}return!1},ScanTypeSelector2.isCameraScanType=function(scanType){return scanType===Html5QrcodeScanType.SCAN_TYPE_CAMERA},ScanTypeSelector2.isFileScanType=function(scanType){return scanType===Html5QrcodeScanType.SCAN_TYPE_FILE},ScanTypeSelector2.prototype.validateAndReturnScanTypes=function(supportedScanTypes){if(!supportedScanTypes||supportedScanTypes.length===0)return Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE;var maxExpectedValues=Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(supportedScanTypes.length>maxExpectedValues)throw"Max ".concat(maxExpectedValues," values expected for ")+"supportedScanTypes";for(var _i=0,supportedScanTypes_1=supportedScanTypes;_i<supportedScanTypes_1.length;_i++){var scanType=supportedScanTypes_1[_i];if(!Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE.includes(scanType))throw"Unsupported scan type ".concat(scanType)}return supportedScanTypes},ScanTypeSelector2}(),PublicUiElementIdAndClasses=function(){function PublicUiElementIdAndClasses2(){}return PublicUiElementIdAndClasses2.ALL_ELEMENT_CLASS="html5-qrcode-element",PublicUiElementIdAndClasses2.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",PublicUiElementIdAndClasses2.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",PublicUiElementIdAndClasses2.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",PublicUiElementIdAndClasses2.TORCH_BUTTON_ID="html5-qrcode-button-torch",PublicUiElementIdAndClasses2.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",PublicUiElementIdAndClasses2.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",PublicUiElementIdAndClasses2.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",PublicUiElementIdAndClasses2.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",PublicUiElementIdAndClasses2.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",PublicUiElementIdAndClasses2.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",PublicUiElementIdAndClasses2}(),BaseUiElementFactory=function(){function BaseUiElementFactory2(){}return BaseUiElementFactory2.createElement=function(elementType,elementId){var element=document.createElement(elementType);return element.id=elementId,element.classList.add(PublicUiElementIdAndClasses.ALL_ELEMENT_CLASS),elementType==="button"&&element.setAttribute("type","button"),element},BaseUiElementFactory2}(),torch_button_awaiter=function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},torch_button_generator=function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=op[0]&2?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[op[0]&2,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}},TorchController=function(){function TorchController2(torchCapability,buttonController,onTorchActionFailureCallback){this.isTorchOn=!1,this.torchCapability=torchCapability,this.buttonController=buttonController,this.onTorchActionFailureCallback=onTorchActionFailureCallback}return TorchController2.prototype.isTorchEnabled=function(){return this.isTorchOn},TorchController2.prototype.flipState=function(){return torch_button_awaiter(this,void 0,void 0,function(){var isTorchOnExpected,error_1;return torch_button_generator(this,function(_a){switch(_a.label){case 0:this.buttonController.disable(),isTorchOnExpected=!this.isTorchOn,_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,this.torchCapability.apply(isTorchOnExpected)];case 2:return _a.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),isTorchOnExpected),[3,4];case 3:return error_1=_a.sent(),this.propagateFailure(isTorchOnExpected,error_1),this.buttonController.enable(),[3,4];case 4:return[2]}})})},TorchController2.prototype.updateUiBasedOnLatestSettings=function(isTorchOn,isTorchOnExpected){isTorchOn===isTorchOnExpected?(this.buttonController.setText(isTorchOnExpected?Html5QrcodeScannerStrings.torchOffButton():Html5QrcodeScannerStrings.torchOnButton()),this.isTorchOn=isTorchOnExpected):this.propagateFailure(isTorchOnExpected),this.buttonController.enable()},TorchController2.prototype.propagateFailure=function(isTorchOnExpected,error){var errorMessage=isTorchOnExpected?Html5QrcodeScannerStrings.torchOnFailedMessage():Html5QrcodeScannerStrings.torchOffFailedMessage();error&&(errorMessage+="; Error = "+error),this.onTorchActionFailureCallback(errorMessage)},TorchController2.prototype.reset=function(){this.isTorchOn=!1},TorchController2}(),TorchButton=function(){function TorchButton2(torchCapability,onTorchActionFailureCallback){this.onTorchActionFailureCallback=onTorchActionFailureCallback,this.torchButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.TORCH_BUTTON_ID),this.torchController=new TorchController(torchCapability,this,onTorchActionFailureCallback)}return TorchButton2.prototype.render=function(parentElement,torchButtonOptions){var _this=this;this.torchButton.innerText=Html5QrcodeScannerStrings.torchOnButton(),this.torchButton.style.display=torchButtonOptions.display,this.torchButton.style.marginLeft=torchButtonOptions.marginLeft;var $this=this;this.torchButton.addEventListener("click",function(_){return torch_button_awaiter(_this,void 0,void 0,function(){return torch_button_generator(this,function(_a){switch(_a.label){case 0:return[4,$this.torchController.flipState()];case 1:return _a.sent(),$this.torchController.isTorchEnabled()?($this.torchButton.classList.remove(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_OFF),$this.torchButton.classList.add(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_ON)):($this.torchButton.classList.remove(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_ON),$this.torchButton.classList.add(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),parentElement.appendChild(this.torchButton)},TorchButton2.prototype.updateTorchCapability=function(torchCapability){this.torchController=new TorchController(torchCapability,this,this.onTorchActionFailureCallback)},TorchButton2.prototype.getTorchButton=function(){return this.torchButton},TorchButton2.prototype.hide=function(){this.torchButton.style.display="none"},TorchButton2.prototype.show=function(){this.torchButton.style.display="inline-block"},TorchButton2.prototype.disable=function(){this.torchButton.disabled=!0},TorchButton2.prototype.enable=function(){this.torchButton.disabled=!1},TorchButton2.prototype.setText=function(text){this.torchButton.innerText=text},TorchButton2.prototype.reset=function(){this.torchButton.innerText=Html5QrcodeScannerStrings.torchOnButton(),this.torchController.reset()},TorchButton2.create=function(parentElement,torchCapability,torchButtonOptions,onTorchActionFailureCallback){var button=new TorchButton2(torchCapability,onTorchActionFailureCallback);return button.render(parentElement,torchButtonOptions),button},TorchButton2}(),FileSelectionUi=function(){function FileSelectionUi2(parentElement,showOnRender,onFileSelected){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=showOnRender?"block":"none",parentElement.appendChild(this.fileBasedScanRegion);var fileScanLabel=document.createElement("label");fileScanLabel.setAttribute("for",this.getFileScanInputId()),fileScanLabel.style.display="inline-block",this.fileBasedScanRegion.appendChild(fileScanLabel),this.fileSelectionButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(_){fileScanLabel.click()}),fileScanLabel.append(this.fileSelectionButton),this.fileScanInput=BaseUiElementFactory.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",fileScanLabel.appendChild(this.fileScanInput);var $this=this;this.fileScanInput.addEventListener("change",function(e){if(!(e==null||e.target==null)){var target=e.target;if(!(target.files&&target.files.length===0)){var fileList=target.files,file=fileList[0],fileName=file.name;$this.setImageNameToButton(fileName),onFileSelected(file)}}});var dragAndDropMessage=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(dragAndDropMessage),this.fileBasedScanRegion.addEventListener("dragenter",function(event){$this.fileBasedScanRegion.style.border=$this.fileBasedScanRegionActiveBorder(),event.stopPropagation(),event.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(event){$this.fileBasedScanRegion.style.border=$this.fileBasedScanRegionDefaultBorder(),event.stopPropagation(),event.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(event){$this.fileBasedScanRegion.style.border=$this.fileBasedScanRegionActiveBorder(),event.stopPropagation(),event.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(event){event.stopPropagation(),event.preventDefault(),$this.fileBasedScanRegion.style.border=$this.fileBasedScanRegionDefaultBorder();var dataTransfer=event.dataTransfer;if(dataTransfer){var files=dataTransfer.files;if(!files||files.length===0)return;for(var isAnyFileImage=!1,i=0;i<files.length;++i){var file=files.item(i);if(file){var imageType=/image.*/;if(file.type.match(imageType)){isAnyFileImage=!0;var fileName=file.name;$this.setImageNameToButton(fileName),onFileSelected(file),dragAndDropMessage.innerText=Html5QrcodeScannerStrings.dragAndDropMessage();break}}}isAnyFileImage||(dragAndDropMessage.innerText=Html5QrcodeScannerStrings.dragAndDropMessageOnlyImages())}})}return FileSelectionUi2.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},FileSelectionUi2.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},FileSelectionUi2.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},FileSelectionUi2.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},FileSelectionUi2.prototype.createFileBasedScanRegion=function(){var fileBasedScanRegion=document.createElement("div");return fileBasedScanRegion.style.textAlign="center",fileBasedScanRegion.style.margin="auto",fileBasedScanRegion.style.width="80%",fileBasedScanRegion.style.maxWidth="600px",fileBasedScanRegion.style.border=this.fileBasedScanRegionDefaultBorder(),fileBasedScanRegion.style.padding="10px",fileBasedScanRegion.style.marginBottom="10px",fileBasedScanRegion},FileSelectionUi2.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},FileSelectionUi2.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},FileSelectionUi2.prototype.createDragAndDropMessage=function(){var dragAndDropMessage=document.createElement("div");return dragAndDropMessage.innerText=Html5QrcodeScannerStrings.dragAndDropMessage(),dragAndDropMessage.style.fontWeight="400",dragAndDropMessage},FileSelectionUi2.prototype.setImageNameToButton=function(imageFileName){var MAX_CHARS=20;if(imageFileName.length>MAX_CHARS){var start8Chars=imageFileName.substring(0,8),length_1=imageFileName.length,last8Chars=imageFileName.substring(length_1-8,length_1);imageFileName="".concat(start8Chars,"....").concat(last8Chars)}var newText=Html5QrcodeScannerStrings.fileSelectionChooseAnother()+" - "+imageFileName;this.fileSelectionButton.innerText=newText},FileSelectionUi2.prototype.setInitialValueToButton=function(){var initialText=Html5QrcodeScannerStrings.fileSelectionChooseImage()+" - "+Html5QrcodeScannerStrings.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=initialText},FileSelectionUi2.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},FileSelectionUi2.create=function(parentElement,showOnRender,onFileSelected){var button=new FileSelectionUi2(parentElement,showOnRender,onFileSelected);return button},FileSelectionUi2}(),CameraSelectionUi=function(){function CameraSelectionUi2(cameras){this.selectElement=BaseUiElementFactory.createElement("select",PublicUiElementIdAndClasses.CAMERA_SELECTION_SELECT_ID),this.cameras=cameras,this.options=[]}return CameraSelectionUi2.prototype.render=function(parentElement){var cameraSelectionContainer=document.createElement("span");cameraSelectionContainer.style.marginRight="10px";var numCameras=this.cameras.length;if(numCameras===0)throw new Error("No cameras found");if(numCameras===1)cameraSelectionContainer.style.display="none";else{var selectCameraString=Html5QrcodeScannerStrings.selectCamera();cameraSelectionContainer.innerText="".concat(selectCameraString," (").concat(this.cameras.length,")  ")}for(var anonymousCameraId=1,_i=0,_a=this.cameras;_i<_a.length;_i++){var camera=_a[_i],value=camera.id,name_1=camera.label==null?value:camera.label;(!name_1||name_1==="")&&(name_1=[Html5QrcodeScannerStrings.anonymousCameraPrefix(),anonymousCameraId++].join(" "));var option=document.createElement("option");option.value=value,option.innerText=name_1,this.options.push(option),this.selectElement.appendChild(option)}cameraSelectionContainer.appendChild(this.selectElement),parentElement.appendChild(cameraSelectionContainer)},CameraSelectionUi2.prototype.disable=function(){this.selectElement.disabled=!0},CameraSelectionUi2.prototype.isDisabled=function(){return this.selectElement.disabled===!0},CameraSelectionUi2.prototype.enable=function(){this.selectElement.disabled=!1},CameraSelectionUi2.prototype.getValue=function(){return this.selectElement.value},CameraSelectionUi2.prototype.hasValue=function(value){for(var _i=0,_a=this.options;_i<_a.length;_i++){var option=_a[_i];if(option.value===value)return!0}return!1},CameraSelectionUi2.prototype.setValue=function(value){if(!this.hasValue(value))throw new Error("".concat(value," is not present in the camera list."));this.selectElement.value=value},CameraSelectionUi2.prototype.hasSingleItem=function(){return this.cameras.length===1},CameraSelectionUi2.prototype.numCameras=function(){return this.cameras.length},CameraSelectionUi2.create=function(parentElement,cameras){var cameraSelectUi=new CameraSelectionUi2(cameras);return cameraSelectUi.render(parentElement),cameraSelectUi},CameraSelectionUi2}(),CameraZoomUi=function(){function CameraZoomUi2(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=BaseUiElementFactory.createElement("input",PublicUiElementIdAndClasses.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return CameraZoomUi2.prototype.render=function(parentElement,renderOnCreate){this.zoomElementContainer.style.display=renderOnCreate?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",parentElement.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var zoomString=Html5QrcodeScannerStrings.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(zoomString),this.rangeText.style.marginRight="10px";var $this=this;this.rangeInput.addEventListener("input",function(){return $this.onValueChange()}),this.rangeInput.addEventListener("change",function(){return $this.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},CameraZoomUi2.prototype.onValueChange=function(){var zoomString=Html5QrcodeScannerStrings.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(zoomString),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},CameraZoomUi2.prototype.setValues=function(minValue,maxValue,defaultValue,step){this.rangeInput.min=minValue.toString(),this.rangeInput.max=maxValue.toString(),this.rangeInput.step=step.toString(),this.rangeInput.value=defaultValue.toString(),this.onValueChange()},CameraZoomUi2.prototype.show=function(){this.zoomElementContainer.style.display="block"},CameraZoomUi2.prototype.hide=function(){this.zoomElementContainer.style.display="none"},CameraZoomUi2.prototype.setOnCameraZoomValueChangeCallback=function(onChangeCallback){this.onChangeCallback=onChangeCallback},CameraZoomUi2.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},CameraZoomUi2.create=function(parentElement,renderOnCreate){var cameraZoomUi=new CameraZoomUi2;return cameraZoomUi.render(parentElement,renderOnCreate),cameraZoomUi},CameraZoomUi2}(),Html5QrcodeScannerStatus;(function(Html5QrcodeScannerStatus2){Html5QrcodeScannerStatus2[Html5QrcodeScannerStatus2.STATUS_DEFAULT=0]="STATUS_DEFAULT",Html5QrcodeScannerStatus2[Html5QrcodeScannerStatus2.STATUS_SUCCESS=1]="STATUS_SUCCESS",Html5QrcodeScannerStatus2[Html5QrcodeScannerStatus2.STATUS_WARNING=2]="STATUS_WARNING",Html5QrcodeScannerStatus2[Html5QrcodeScannerStatus2.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Html5QrcodeScannerStatus||(Html5QrcodeScannerStatus={}));function toHtml5QrcodeCameraScanConfig(config){return{fps:config.fps,qrbox:config.qrbox,aspectRatio:config.aspectRatio,disableFlip:config.disableFlip,videoConstraints:config.videoConstraints}}function toHtml5QrcodeFullConfig(config,verbose){return{formatsToSupport:config.formatsToSupport,useBarCodeDetectorIfSupported:config.useBarCodeDetectorIfSupported,experimentalFeatures:config.experimentalFeatures,verbose}}var Html5QrcodeScanner=function(){function Html5QrcodeScanner2(elementId,config,verbose){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=elementId,this.config=this.createConfig(config),this.verbose=verbose===!0,!document.getElementById(elementId))throw"HTML Element with id=".concat(elementId," not found");this.scanTypeSelector=new ScanTypeSelector(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new BaseLoggger(this.verbose),this.persistedDataManager=new PersistedDataManager,config.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return Html5QrcodeScanner2.prototype.render=function(qrCodeSuccessCallback,qrCodeErrorCallback){var _this=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(decodedText,result){if(qrCodeSuccessCallback)qrCodeSuccessCallback(decodedText,result);else{if(_this.lastMatchFound===decodedText)return;_this.lastMatchFound=decodedText,_this.setHeaderMessage(Html5QrcodeScannerStrings.lastMatch(decodedText),Html5QrcodeScannerStatus.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(errorMessage,error){qrCodeErrorCallback&&qrCodeErrorCallback(errorMessage,error)};var container=document.getElementById(this.elementId);if(!container)throw"HTML Element with id=".concat(this.elementId," not found");container.innerHTML="",this.createBasicLayout(container),this.html5Qrcode=new Html5Qrcode(this.getScanRegionId(),toHtml5QrcodeFullConfig(this.config,this.verbose))},Html5QrcodeScanner2.prototype.pause=function(shouldPauseVideo){(isNullOrUndefined(shouldPauseVideo)||shouldPauseVideo!==!0)&&(shouldPauseVideo=!1),this.getHtml5QrcodeOrFail().pause(shouldPauseVideo)},Html5QrcodeScanner2.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},Html5QrcodeScanner2.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},Html5QrcodeScanner2.prototype.clear=function(){var _this=this,emptyHtmlContainer=function(){var mainContainer=document.getElementById(_this.elementId);mainContainer&&(mainContainer.innerHTML="",_this.resetBasicLayout(mainContainer))};return this.html5Qrcode?new Promise(function(resolve,reject){if(!_this.html5Qrcode){resolve();return}_this.html5Qrcode.isScanning?_this.html5Qrcode.stop().then(function(_){if(!_this.html5Qrcode){resolve();return}_this.html5Qrcode.clear(),emptyHtmlContainer(),resolve()}).catch(function(error){_this.verbose&&_this.logger.logError("Unable to stop qrcode scanner",error),reject(error)}):(_this.html5Qrcode.clear(),emptyHtmlContainer(),resolve())}):Promise.resolve()},Html5QrcodeScanner2.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},Html5QrcodeScanner2.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},Html5QrcodeScanner2.prototype.applyVideoConstraints=function(videoConstaints){return this.getHtml5QrcodeOrFail().applyVideoConstraints(videoConstaints)},Html5QrcodeScanner2.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},Html5QrcodeScanner2.prototype.createConfig=function(config){return config?(config.fps||(config.fps=Html5QrcodeConstants.SCAN_DEFAULT_FPS),config.rememberLastUsedCamera!==!Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(config.rememberLastUsedCamera=Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED),config.supportedScanTypes||(config.supportedScanTypes=Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE),config):{fps:Html5QrcodeConstants.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE}},Html5QrcodeScanner2.prototype.createBasicLayout=function(parent){parent.style.position="relative",parent.style.padding="0px",parent.style.border="1px solid silver",this.createHeader(parent);var qrCodeScanRegion=document.createElement("div"),scanRegionId=this.getScanRegionId();qrCodeScanRegion.id=scanRegionId,qrCodeScanRegion.style.width="100%",qrCodeScanRegion.style.minHeight="100px",qrCodeScanRegion.style.textAlign="center",parent.appendChild(qrCodeScanRegion),ScanTypeSelector.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var qrCodeDashboard=document.createElement("div"),dashboardId=this.getDashboardId();qrCodeDashboard.id=dashboardId,qrCodeDashboard.style.width="100%",parent.appendChild(qrCodeDashboard),this.setupInitialDashboard(qrCodeDashboard)},Html5QrcodeScanner2.prototype.resetBasicLayout=function(mainContainer){mainContainer.style.border="none"},Html5QrcodeScanner2.prototype.setupInitialDashboard=function(dashboard){this.createSection(dashboard),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},Html5QrcodeScanner2.prototype.createHeader=function(dashboard){var header=document.createElement("div");header.style.textAlign="left",header.style.margin="0px",dashboard.appendChild(header);var libraryInfo=new LibraryInfoContainer;libraryInfo.renderInto(header);var headerMessageContainer=document.createElement("div");headerMessageContainer.id=this.getHeaderMessageContainerId(),headerMessageContainer.style.display="none",headerMessageContainer.style.textAlign="center",headerMessageContainer.style.fontSize="14px",headerMessageContainer.style.padding="2px 10px",headerMessageContainer.style.margin="4px",headerMessageContainer.style.borderTop="1px solid #f6f6f6",header.appendChild(headerMessageContainer)},Html5QrcodeScanner2.prototype.createSection=function(dashboard){var section=document.createElement("div");section.id=this.getDashboardSectionId(),section.style.width="100%",section.style.padding="10px 0px 10px 0px",section.style.textAlign="left",dashboard.appendChild(section)},Html5QrcodeScanner2.prototype.createCameraListUi=function(scpCameraScanRegion,requestPermissionContainer,requestPermissionButton){var $this=this;$this.showHideScanTypeSwapLink(!1),$this.setHeaderMessage(Html5QrcodeScannerStrings.cameraPermissionRequesting());var createPermissionButtonIfNotExists=function(){requestPermissionButton||$this.createPermissionButton(scpCameraScanRegion,requestPermissionContainer)};Html5Qrcode.getCameras().then(function(cameras){$this.persistedDataManager.setHasPermission(!0),$this.showHideScanTypeSwapLink(!0),$this.resetHeaderMessage(),cameras&&cameras.length>0?(scpCameraScanRegion.removeChild(requestPermissionContainer),$this.renderCameraSelection(cameras)):($this.setHeaderMessage(Html5QrcodeScannerStrings.noCameraFound(),Html5QrcodeScannerStatus.STATUS_WARNING),createPermissionButtonIfNotExists())}).catch(function(error){$this.persistedDataManager.setHasPermission(!1),requestPermissionButton?requestPermissionButton.disabled=!1:createPermissionButtonIfNotExists(),$this.setHeaderMessage(error,Html5QrcodeScannerStatus.STATUS_WARNING),$this.showHideScanTypeSwapLink(!0)})},Html5QrcodeScanner2.prototype.createPermissionButton=function(scpCameraScanRegion,requestPermissionContainer){var $this=this,requestPermissionButton=BaseUiElementFactory.createElement("button",this.getCameraPermissionButtonId());requestPermissionButton.innerText=Html5QrcodeScannerStrings.cameraPermissionTitle(),requestPermissionButton.addEventListener("click",function(){requestPermissionButton.disabled=!0,$this.createCameraListUi(scpCameraScanRegion,requestPermissionContainer,requestPermissionButton)}),requestPermissionContainer.appendChild(requestPermissionButton)},Html5QrcodeScanner2.prototype.createPermissionsUi=function(scpCameraScanRegion,requestPermissionContainer){var $this=this;if(ScanTypeSelector.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){CameraPermissions.hasPermissions().then(function(hasPermissions){hasPermissions?$this.createCameraListUi(scpCameraScanRegion,requestPermissionContainer):($this.persistedDataManager.setHasPermission(!1),$this.createPermissionButton(scpCameraScanRegion,requestPermissionContainer))}).catch(function(_){$this.persistedDataManager.setHasPermission(!1),$this.createPermissionButton(scpCameraScanRegion,requestPermissionContainer)});return}this.createPermissionButton(scpCameraScanRegion,requestPermissionContainer)},Html5QrcodeScanner2.prototype.createSectionControlPanel=function(){var section=document.getElementById(this.getDashboardSectionId()),sectionControlPanel=document.createElement("div");section.appendChild(sectionControlPanel);var scpCameraScanRegion=document.createElement("div");scpCameraScanRegion.id=this.getDashboardSectionCameraScanRegionId(),scpCameraScanRegion.style.display=ScanTypeSelector.isCameraScanType(this.currentScanType)?"block":"none",sectionControlPanel.appendChild(scpCameraScanRegion);var requestPermissionContainer=document.createElement("div");requestPermissionContainer.style.textAlign="center",scpCameraScanRegion.appendChild(requestPermissionContainer),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(scpCameraScanRegion,requestPermissionContainer),this.renderFileScanUi(sectionControlPanel)},Html5QrcodeScanner2.prototype.renderFileScanUi=function(parent){var showOnRender=ScanTypeSelector.isFileScanType(this.currentScanType),$this=this,onFileSelected=function(file){if(!$this.html5Qrcode)throw"html5Qrcode not defined";ScanTypeSelector.isFileScanType($this.currentScanType)&&($this.setHeaderMessage(Html5QrcodeScannerStrings.loadingImage()),$this.html5Qrcode.scanFileV2(file,!0).then(function(html5qrcodeResult){$this.resetHeaderMessage(),$this.qrCodeSuccessCallback(html5qrcodeResult.decodedText,html5qrcodeResult)}).catch(function(error){$this.setHeaderMessage(error,Html5QrcodeScannerStatus.STATUS_WARNING),$this.qrCodeErrorCallback(error,Html5QrcodeErrorFactory.createFrom(error))}))};this.fileSelectionUi=FileSelectionUi.create(parent,showOnRender,onFileSelected)},Html5QrcodeScanner2.prototype.renderCameraSelection=function(cameras){var _this=this,$this=this,scpCameraScanRegion=document.getElementById(this.getDashboardSectionCameraScanRegionId());scpCameraScanRegion.style.textAlign="center";var cameraZoomUi=CameraZoomUi.create(scpCameraScanRegion,!1),renderCameraZoomUiIfSupported=function(cameraCapabilities){var zoomCapability=cameraCapabilities.zoomFeature();if(zoomCapability.isSupported()){cameraZoomUi.setOnCameraZoomValueChangeCallback(function(zoomValue){zoomCapability.apply(zoomValue)});var defaultZoom=1;_this.config.defaultZoomValueIfSupported&&(defaultZoom=_this.config.defaultZoomValueIfSupported),defaultZoom=clip(defaultZoom,zoomCapability.min(),zoomCapability.max()),cameraZoomUi.setValues(zoomCapability.min(),zoomCapability.max(),defaultZoom,zoomCapability.step()),cameraZoomUi.show()}},cameraSelectUi=CameraSelectionUi.create(scpCameraScanRegion,cameras),cameraActionContainer=document.createElement("span"),cameraActionStartButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.CAMERA_START_BUTTON_ID);cameraActionStartButton.innerText=Html5QrcodeScannerStrings.scanButtonStartScanningText(),cameraActionContainer.appendChild(cameraActionStartButton);var cameraActionStopButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.CAMERA_STOP_BUTTON_ID);cameraActionStopButton.innerText=Html5QrcodeScannerStrings.scanButtonStopScanningText(),cameraActionStopButton.style.display="none",cameraActionStopButton.disabled=!0,cameraActionContainer.appendChild(cameraActionStopButton);var torchButton,createAndShowTorchButtonIfSupported=function(cameraCapabilities){if(!cameraCapabilities.torchFeature().isSupported()){torchButton&&torchButton.hide();return}torchButton?torchButton.updateTorchCapability(cameraCapabilities.torchFeature()):torchButton=TorchButton.create(cameraActionContainer,cameraCapabilities.torchFeature(),{display:"none",marginLeft:"5px"},function(errorMessage){$this.setHeaderMessage(errorMessage,Html5QrcodeScannerStatus.STATUS_WARNING)}),torchButton.show()};scpCameraScanRegion.appendChild(cameraActionContainer);var resetCameraActionStartButton=function(shouldShow){shouldShow||(cameraActionStartButton.style.display="none"),cameraActionStartButton.innerText=Html5QrcodeScannerStrings.scanButtonStartScanningText(),cameraActionStartButton.style.opacity="1",cameraActionStartButton.disabled=!1,shouldShow&&(cameraActionStartButton.style.display="inline-block")};if(cameraActionStartButton.addEventListener("click",function(_){cameraActionStartButton.innerText=Html5QrcodeScannerStrings.scanButtonScanningStarting(),cameraSelectUi.disable(),cameraActionStartButton.disabled=!0,cameraActionStartButton.style.opacity="0.5",_this.scanTypeSelector.hasMoreThanOneScanType()&&$this.showHideScanTypeSwapLink(!1),$this.resetHeaderMessage();var cameraId2=cameraSelectUi.getValue();$this.persistedDataManager.setLastUsedCameraId(cameraId2),$this.html5Qrcode.start(cameraId2,toHtml5QrcodeCameraScanConfig($this.config),$this.qrCodeSuccessCallback,$this.qrCodeErrorCallback).then(function(_2){cameraActionStopButton.disabled=!1,cameraActionStopButton.style.display="inline-block",resetCameraActionStartButton(!1);var cameraCapabilities=$this.html5Qrcode.getRunningTrackCameraCapabilities();_this.config.showTorchButtonIfSupported===!0&&createAndShowTorchButtonIfSupported(cameraCapabilities),_this.config.showZoomSliderIfSupported===!0&&renderCameraZoomUiIfSupported(cameraCapabilities)}).catch(function(error){$this.showHideScanTypeSwapLink(!0),cameraSelectUi.enable(),resetCameraActionStartButton(!0),$this.setHeaderMessage(error,Html5QrcodeScannerStatus.STATUS_WARNING)})}),cameraSelectUi.hasSingleItem()&&cameraActionStartButton.click(),cameraActionStopButton.addEventListener("click",function(_){if(!$this.html5Qrcode)throw"html5Qrcode not defined";cameraActionStopButton.disabled=!0,$this.html5Qrcode.stop().then(function(_2){_this.scanTypeSelector.hasMoreThanOneScanType()&&$this.showHideScanTypeSwapLink(!0),cameraSelectUi.enable(),cameraActionStartButton.disabled=!1,cameraActionStopButton.style.display="none",cameraActionStartButton.style.display="inline-block",torchButton&&(torchButton.reset(),torchButton.hide()),cameraZoomUi.removeOnCameraZoomValueChangeCallback(),cameraZoomUi.hide(),$this.insertCameraScanImageToScanRegion()}).catch(function(error){cameraActionStopButton.disabled=!1,$this.setHeaderMessage(error,Html5QrcodeScannerStatus.STATUS_WARNING)})}),$this.persistedDataManager.getLastUsedCameraId()){var cameraId=$this.persistedDataManager.getLastUsedCameraId();cameraSelectUi.hasValue(cameraId)?(cameraSelectUi.setValue(cameraId),cameraActionStartButton.click()):$this.persistedDataManager.resetLastUsedCameraId()}},Html5QrcodeScanner2.prototype.createSectionSwap=function(){var $this=this,TEXT_IF_CAMERA_SCAN_SELECTED=Html5QrcodeScannerStrings.textIfCameraScanSelected(),TEXT_IF_FILE_SCAN_SELECTED=Html5QrcodeScannerStrings.textIfFileScanSelected(),section=document.getElementById(this.getDashboardSectionId()),switchContainer=document.createElement("div");switchContainer.style.textAlign="center";var switchScanTypeLink=BaseUiElementFactory.createElement("span",this.getDashboardSectionSwapLinkId());switchScanTypeLink.style.textDecoration="underline",switchScanTypeLink.style.cursor="pointer",switchScanTypeLink.innerText=ScanTypeSelector.isCameraScanType(this.currentScanType)?TEXT_IF_CAMERA_SCAN_SELECTED:TEXT_IF_FILE_SCAN_SELECTED,switchScanTypeLink.addEventListener("click",function(){if(!$this.sectionSwapAllowed){$this.verbose&&$this.logger.logError("Section swap called when not allowed");return}$this.resetHeaderMessage(),$this.fileSelectionUi.resetValue(),$this.sectionSwapAllowed=!1,ScanTypeSelector.isCameraScanType($this.currentScanType)?($this.clearScanRegion(),$this.getCameraScanRegion().style.display="none",$this.fileSelectionUi.show(),switchScanTypeLink.innerText=TEXT_IF_FILE_SCAN_SELECTED,$this.currentScanType=Html5QrcodeScanType.SCAN_TYPE_FILE,$this.insertFileScanImageToScanRegion()):($this.clearScanRegion(),$this.getCameraScanRegion().style.display="block",$this.fileSelectionUi.hide(),switchScanTypeLink.innerText=TEXT_IF_CAMERA_SCAN_SELECTED,$this.currentScanType=Html5QrcodeScanType.SCAN_TYPE_CAMERA,$this.insertCameraScanImageToScanRegion(),$this.startCameraScanIfPermissionExistsOnSwap()),$this.sectionSwapAllowed=!0}),switchContainer.appendChild(switchScanTypeLink),section.appendChild(switchContainer)},Html5QrcodeScanner2.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var _this=this,$this=this;if(this.persistedDataManager.hasCameraPermissions()){CameraPermissions.hasPermissions().then(function(hasPermissions){if(hasPermissions){var permissionButton=document.getElementById($this.getCameraPermissionButtonId());if(!permissionButton)throw _this.logger.logError("Permission button not found, fail;"),"Permission button not found";permissionButton.click()}else $this.persistedDataManager.setHasPermission(!1)}).catch(function(_){$this.persistedDataManager.setHasPermission(!1)});return}},Html5QrcodeScanner2.prototype.resetHeaderMessage=function(){var messageDiv=document.getElementById(this.getHeaderMessageContainerId());messageDiv.style.display="none"},Html5QrcodeScanner2.prototype.setHeaderMessage=function(messageText,scannerStatus){scannerStatus||(scannerStatus=Html5QrcodeScannerStatus.STATUS_DEFAULT);var messageDiv=this.getHeaderMessageDiv();switch(messageDiv.innerText=messageText,messageDiv.style.display="block",scannerStatus){case Html5QrcodeScannerStatus.STATUS_SUCCESS:messageDiv.style.background="rgba(106, 175, 80, 0.26)",messageDiv.style.color="#477735";break;case Html5QrcodeScannerStatus.STATUS_WARNING:messageDiv.style.background="rgba(203, 36, 49, 0.14)",messageDiv.style.color="#cb2431";break;case Html5QrcodeScannerStatus.STATUS_DEFAULT:default:messageDiv.style.background="rgba(0, 0, 0, 0)",messageDiv.style.color="rgb(17, 17, 17)";break}},Html5QrcodeScanner2.prototype.showHideScanTypeSwapLink=function(shouldDisplay){this.scanTypeSelector.hasMoreThanOneScanType()&&(shouldDisplay!==!0&&(shouldDisplay=!1),this.sectionSwapAllowed=shouldDisplay,this.getDashboardSectionSwapLink().style.display=shouldDisplay?"inline-block":"none")},Html5QrcodeScanner2.prototype.insertCameraScanImageToScanRegion=function(){var $this=this,qrCodeScanRegion=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){qrCodeScanRegion.innerHTML="<br>",qrCodeScanRegion.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(_){qrCodeScanRegion.innerHTML="<br>",qrCodeScanRegion.appendChild($this.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=ASSET_CAMERA_SCAN,this.cameraScanImage.alt=Html5QrcodeScannerStrings.cameraScanAltText()},Html5QrcodeScanner2.prototype.insertFileScanImageToScanRegion=function(){var $this=this,qrCodeScanRegion=document.getElementById(this.getScanRegionId());if(this.fileScanImage){qrCodeScanRegion.innerHTML="<br>",qrCodeScanRegion.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(_){qrCodeScanRegion.innerHTML="<br>",qrCodeScanRegion.appendChild($this.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=ASSET_FILE_SCAN,this.fileScanImage.alt=Html5QrcodeScannerStrings.fileScanAltText()},Html5QrcodeScanner2.prototype.clearScanRegion=function(){var qrCodeScanRegion=document.getElementById(this.getScanRegionId());qrCodeScanRegion.innerHTML=""},Html5QrcodeScanner2.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},Html5QrcodeScanner2.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},Html5QrcodeScanner2.prototype.getDashboardSectionSwapLinkId=function(){return PublicUiElementIdAndClasses.SCAN_TYPE_CHANGE_ANCHOR_ID},Html5QrcodeScanner2.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},Html5QrcodeScanner2.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},Html5QrcodeScanner2.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},Html5QrcodeScanner2.prototype.getCameraPermissionButtonId=function(){return PublicUiElementIdAndClasses.CAMERA_PERMISSION_BUTTON_ID},Html5QrcodeScanner2.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},Html5QrcodeScanner2.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},Html5QrcodeScanner2.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},Html5QrcodeScanner2}()},221:function(__unused_webpack_module,exports,__webpack_require__2){(function(global,factory){factory(exports)})(this,function(exports2){"use strict";function isNullOrUndefined(obj){return obj==null}var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}function fixProto(target,prototype){var setPrototypeOf=Object.setPrototypeOf;setPrototypeOf?setPrototypeOf(target,prototype):target.__proto__=prototype}function fixStack(target,fn){fn===void 0&&(fn=target.constructor);var captureStackTrace=Error.captureStackTrace;captureStackTrace&&captureStackTrace(target,fn)}var CustomError=function(_super){__extends(CustomError2,_super);function CustomError2(message){var _newTarget=this.constructor,_this=_super.call(this,message)||this;return Object.defineProperty(_this,"name",{value:_newTarget.name,enumerable:!1}),fixProto(_this,_newTarget.prototype),fixStack(_this),_this}return CustomError2}(Error);class Exception extends CustomError{constructor(message=void 0){super(message),this.message=message}getKind(){return this.constructor.kind}}Exception.kind="Exception";class ArgumentException extends Exception{}ArgumentException.kind="ArgumentException";class IllegalArgumentException extends Exception{}IllegalArgumentException.kind="IllegalArgumentException";class BinaryBitmap{constructor(binarizer){if(this.binarizer=binarizer,binarizer===null)throw new IllegalArgumentException("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(y,row){return this.binarizer.getBlackRow(y,row)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(left,top,width,height){const newSource=this.binarizer.getLuminanceSource().crop(left,top,width,height);return new BinaryBitmap(this.binarizer.createBinarizer(newSource))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const newSource=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new BinaryBitmap(this.binarizer.createBinarizer(newSource))}rotateCounterClockwise45(){const newSource=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new BinaryBitmap(this.binarizer.createBinarizer(newSource))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class ChecksumException extends Exception{static getChecksumInstance(){return new ChecksumException}}ChecksumException.kind="ChecksumException";class Binarizer{constructor(source){this.source=source}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class System{static arraycopy(src,srcPos,dest,destPos,length){for(;length--;)dest[destPos++]=src[srcPos++]}static currentTimeMillis(){return Date.now()}}class IndexOutOfBoundsException extends Exception{}IndexOutOfBoundsException.kind="IndexOutOfBoundsException";class ArrayIndexOutOfBoundsException extends IndexOutOfBoundsException{constructor(index=void 0,message=void 0){super(message),this.index=index,this.message=message}}ArrayIndexOutOfBoundsException.kind="ArrayIndexOutOfBoundsException";class Arrays{static fill(a,val){for(let i=0,len=a.length;i<len;i++)a[i]=val}static fillWithin(a,fromIndex,toIndex,val){Arrays.rangeCheck(a.length,fromIndex,toIndex);for(let i=fromIndex;i<toIndex;i++)a[i]=val}static rangeCheck(arrayLength,fromIndex,toIndex){if(fromIndex>toIndex)throw new IllegalArgumentException("fromIndex("+fromIndex+") > toIndex("+toIndex+")");if(fromIndex<0)throw new ArrayIndexOutOfBoundsException(fromIndex);if(toIndex>arrayLength)throw new ArrayIndexOutOfBoundsException(toIndex)}static asList(...args){return args}static create(rows,cols,value){return Array.from({length:rows}).map(x=>Array.from({length:cols}).fill(value))}static createInt32Array(rows,cols,value){return Array.from({length:rows}).map(x=>Int32Array.from({length:cols}).fill(value))}static equals(first,second){if(!first||!second||!first.length||!second.length||first.length!==second.length)return!1;for(let i=0,length=first.length;i<length;i++)if(first[i]!==second[i])return!1;return!0}static hashCode(a){if(a===null)return 0;let result=1;for(const element of a)result=31*result+element;return result}static fillUint8Array(a,value){for(let i=0;i!==a.length;i++)a[i]=value}static copyOf(original,newLength){return original.slice(0,newLength)}static copyOfUint8Array(original,newLength){if(original.length<=newLength){const newArray=new Uint8Array(newLength);return newArray.set(original),newArray}return original.slice(0,newLength)}static copyOfRange(original,from,to){const newLength=to-from,copy=new Int32Array(newLength);return System.arraycopy(original,from,copy,0,newLength),copy}static binarySearch(ar,el,comparator){comparator===void 0&&(comparator=Arrays.numberComparator);let m=0,n=ar.length-1;for(;m<=n;){const k=n+m>>1,cmp=comparator(el,ar[k]);if(cmp>0)m=k+1;else if(cmp<0)n=k-1;else return k}return-m-1}static numberComparator(a,b){return a-b}}class Integer{static numberOfTrailingZeros(i){let y;if(i===0)return 32;let n=31;return y=i<<16,y!==0&&(n-=16,i=y),y=i<<8,y!==0&&(n-=8,i=y),y=i<<4,y!==0&&(n-=4,i=y),y=i<<2,y!==0&&(n-=2,i=y),n-(i<<1>>>31)}static numberOfLeadingZeros(i){if(i===0)return 32;let n=1;return i>>>16||(n+=16,i<<=16),i>>>24||(n+=8,i<<=8),i>>>28||(n+=4,i<<=4),i>>>30||(n+=2,i<<=2),n-=i>>>31,n}static toHexString(i){return i.toString(16)}static toBinaryString(intNumber){return String(parseInt(String(intNumber),2))}static bitCount(i){return i=i-(i>>>1&1431655765),i=(i&858993459)+(i>>>2&858993459),i=i+(i>>>4)&252645135,i=i+(i>>>8),i=i+(i>>>16),i&63}static truncDivision(dividend,divisor){return Math.trunc(dividend/divisor)}static parseInt(num,radix=void 0){return parseInt(num,radix)}}Integer.MIN_VALUE_32_BITS=-2147483648,Integer.MAX_VALUE=Number.MAX_SAFE_INTEGER;class BitArray{constructor(size,bits){size===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=size,bits==null?this.bits=BitArray.makeArray(size):this.bits=bits)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(size){if(size>this.bits.length*32){const newBits=BitArray.makeArray(size);System.arraycopy(this.bits,0,newBits,0,this.bits.length),this.bits=newBits}}get(i){return(this.bits[Math.floor(i/32)]&1<<(i&31))!==0}set(i){this.bits[Math.floor(i/32)]|=1<<(i&31)}flip(i){this.bits[Math.floor(i/32)]^=1<<(i&31)}getNextSet(from){const size=this.size;if(from>=size)return size;const bits=this.bits;let bitsOffset=Math.floor(from/32),currentBits=bits[bitsOffset];currentBits&=~((1<<(from&31))-1);const length=bits.length;for(;currentBits===0;){if(++bitsOffset===length)return size;currentBits=bits[bitsOffset]}const result=bitsOffset*32+Integer.numberOfTrailingZeros(currentBits);return result>size?size:result}getNextUnset(from){const size=this.size;if(from>=size)return size;const bits=this.bits;let bitsOffset=Math.floor(from/32),currentBits=~bits[bitsOffset];currentBits&=~((1<<(from&31))-1);const length=bits.length;for(;currentBits===0;){if(++bitsOffset===length)return size;currentBits=~bits[bitsOffset]}const result=bitsOffset*32+Integer.numberOfTrailingZeros(currentBits);return result>size?size:result}setBulk(i,newBits){this.bits[Math.floor(i/32)]=newBits}setRange(start,end){if(end<start||start<0||end>this.size)throw new IllegalArgumentException;if(end===start)return;end--;const firstInt=Math.floor(start/32),lastInt=Math.floor(end/32),bits=this.bits;for(let i=firstInt;i<=lastInt;i++){const firstBit=i>firstInt?0:start&31,mask=(2<<(i<lastInt?31:end&31))-(1<<firstBit);bits[i]|=mask}}clear(){const max=this.bits.length,bits=this.bits;for(let i=0;i<max;i++)bits[i]=0}isRange(start,end,value){if(end<start||start<0||end>this.size)throw new IllegalArgumentException;if(end===start)return!0;end--;const firstInt=Math.floor(start/32),lastInt=Math.floor(end/32),bits=this.bits;for(let i=firstInt;i<=lastInt;i++){const firstBit=i>firstInt?0:start&31,mask=(2<<(i<lastInt?31:end&31))-(1<<firstBit)&4294967295;if((bits[i]&mask)!==(value?mask:0))return!1}return!0}appendBit(bit){this.ensureCapacity(this.size+1),bit&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(value,numBits){if(numBits<0||numBits>32)throw new IllegalArgumentException("Num bits must be between 0 and 32");this.ensureCapacity(this.size+numBits);for(let numBitsLeft=numBits;numBitsLeft>0;numBitsLeft--)this.appendBit((value>>numBitsLeft-1&1)===1)}appendBitArray(other){const otherSize=other.size;this.ensureCapacity(this.size+otherSize);for(let i=0;i<otherSize;i++)this.appendBit(other.get(i))}xor(other){if(this.size!==other.size)throw new IllegalArgumentException("Sizes don't match");const bits=this.bits;for(let i=0,length=bits.length;i<length;i++)bits[i]^=other.bits[i]}toBytes(bitOffset,array,offset,numBytes){for(let i=0;i<numBytes;i++){let theByte=0;for(let j=0;j<8;j++)this.get(bitOffset)&&(theByte|=1<<7-j),bitOffset++;array[offset+i]=theByte}}getBitArray(){return this.bits}reverse(){const newBits=new Int32Array(this.bits.length),len=Math.floor((this.size-1)/32),oldBitsLen=len+1,bits=this.bits;for(let i=0;i<oldBitsLen;i++){let x=bits[i];x=x>>1&1431655765|(x&1431655765)<<1,x=x>>2&858993459|(x&858993459)<<2,x=x>>4&252645135|(x&252645135)<<4,x=x>>8&16711935|(x&16711935)<<8,x=x>>16&65535|(x&65535)<<16,newBits[len-i]=x}if(this.size!==oldBitsLen*32){const leftOffset=oldBitsLen*32-this.size;let currentInt=newBits[0]>>>leftOffset;for(let i=1;i<oldBitsLen;i++){const nextInt=newBits[i];currentInt|=nextInt<<32-leftOffset,newBits[i-1]=currentInt,currentInt=nextInt>>>leftOffset}newBits[oldBitsLen-1]=currentInt}this.bits=newBits}static makeArray(size){return new Int32Array(Math.floor((size+31)/32))}equals(o){if(!(o instanceof BitArray))return!1;const other=o;return this.size===other.size&&Arrays.equals(this.bits,other.bits)}hashCode(){return 31*this.size+Arrays.hashCode(this.bits)}toString(){let result="";for(let i=0,size=this.size;i<size;i++)i&7||(result+=" "),result+=this.get(i)?"X":".";return result}clone(){return new BitArray(this.size,this.bits.slice())}}var DecodeHintType;(function(DecodeHintType2){DecodeHintType2[DecodeHintType2.OTHER=0]="OTHER",DecodeHintType2[DecodeHintType2.PURE_BARCODE=1]="PURE_BARCODE",DecodeHintType2[DecodeHintType2.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",DecodeHintType2[DecodeHintType2.TRY_HARDER=3]="TRY_HARDER",DecodeHintType2[DecodeHintType2.CHARACTER_SET=4]="CHARACTER_SET",DecodeHintType2[DecodeHintType2.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",DecodeHintType2[DecodeHintType2.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",DecodeHintType2[DecodeHintType2.ASSUME_GS1=7]="ASSUME_GS1",DecodeHintType2[DecodeHintType2.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",DecodeHintType2[DecodeHintType2.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",DecodeHintType2[DecodeHintType2.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(DecodeHintType||(DecodeHintType={}));var DecodeHintType$1=DecodeHintType;class FormatException extends Exception{static getFormatInstance(){return new FormatException}}FormatException.kind="FormatException";var CharacterSetValueIdentifiers;(function(CharacterSetValueIdentifiers2){CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Cp437=0]="Cp437",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_1=1]="ISO8859_1",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_2=2]="ISO8859_2",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_3=3]="ISO8859_3",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_4=4]="ISO8859_4",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_5=5]="ISO8859_5",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_6=6]="ISO8859_6",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_7=7]="ISO8859_7",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_8=8]="ISO8859_8",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_9=9]="ISO8859_9",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_10=10]="ISO8859_10",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_11=11]="ISO8859_11",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_13=12]="ISO8859_13",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_14=13]="ISO8859_14",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_15=14]="ISO8859_15",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ISO8859_16=15]="ISO8859_16",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.SJIS=16]="SJIS",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Cp1250=17]="Cp1250",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Cp1251=18]="Cp1251",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Cp1252=19]="Cp1252",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Cp1256=20]="Cp1256",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.UTF8=22]="UTF8",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.ASCII=23]="ASCII",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.Big5=24]="Big5",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.GB18030=25]="GB18030",CharacterSetValueIdentifiers2[CharacterSetValueIdentifiers2.EUC_KR=26]="EUC_KR"})(CharacterSetValueIdentifiers||(CharacterSetValueIdentifiers={}));class CharacterSetECI{constructor(valueIdentifier,valuesParam,name,...otherEncodingNames){this.valueIdentifier=valueIdentifier,this.name=name,typeof valuesParam=="number"?this.values=Int32Array.from([valuesParam]):this.values=valuesParam,this.otherEncodingNames=otherEncodingNames,CharacterSetECI.VALUE_IDENTIFIER_TO_ECI.set(valueIdentifier,this),CharacterSetECI.NAME_TO_ECI.set(name,this);const values=this.values;for(let i=0,length=values.length;i!==length;i++){const v=values[i];CharacterSetECI.VALUES_TO_ECI.set(v,this)}for(const otherName of otherEncodingNames)CharacterSetECI.NAME_TO_ECI.set(otherName,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(value){if(value<0||value>=900)throw new FormatException("incorect value");const characterSet=CharacterSetECI.VALUES_TO_ECI.get(value);if(characterSet===void 0)throw new FormatException("incorect value");return characterSet}static getCharacterSetECIByName(name){const characterSet=CharacterSetECI.NAME_TO_ECI.get(name);if(characterSet===void 0)throw new FormatException("incorect value");return characterSet}equals(o){if(!(o instanceof CharacterSetECI))return!1;const other=o;return this.getName()===other.getName()}}CharacterSetECI.VALUE_IDENTIFIER_TO_ECI=new Map,CharacterSetECI.VALUES_TO_ECI=new Map,CharacterSetECI.NAME_TO_ECI=new Map,CharacterSetECI.Cp437=new CharacterSetECI(CharacterSetValueIdentifiers.Cp437,Int32Array.from([0,2]),"Cp437"),CharacterSetECI.ISO8859_1=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),CharacterSetECI.ISO8859_2=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),CharacterSetECI.ISO8859_3=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),CharacterSetECI.ISO8859_4=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),CharacterSetECI.ISO8859_5=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),CharacterSetECI.ISO8859_6=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),CharacterSetECI.ISO8859_7=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),CharacterSetECI.ISO8859_8=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),CharacterSetECI.ISO8859_9=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),CharacterSetECI.ISO8859_10=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),CharacterSetECI.ISO8859_11=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),CharacterSetECI.ISO8859_13=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),CharacterSetECI.ISO8859_14=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),CharacterSetECI.ISO8859_15=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),CharacterSetECI.ISO8859_16=new CharacterSetECI(CharacterSetValueIdentifiers.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),CharacterSetECI.SJIS=new CharacterSetECI(CharacterSetValueIdentifiers.SJIS,20,"SJIS","Shift_JIS"),CharacterSetECI.Cp1250=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1250,21,"Cp1250","windows-1250"),CharacterSetECI.Cp1251=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1251,22,"Cp1251","windows-1251"),CharacterSetECI.Cp1252=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1252,23,"Cp1252","windows-1252"),CharacterSetECI.Cp1256=new CharacterSetECI(CharacterSetValueIdentifiers.Cp1256,24,"Cp1256","windows-1256"),CharacterSetECI.UnicodeBigUnmarked=new CharacterSetECI(CharacterSetValueIdentifiers.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),CharacterSetECI.UTF8=new CharacterSetECI(CharacterSetValueIdentifiers.UTF8,26,"UTF8","UTF-8"),CharacterSetECI.ASCII=new CharacterSetECI(CharacterSetValueIdentifiers.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),CharacterSetECI.Big5=new CharacterSetECI(CharacterSetValueIdentifiers.Big5,28,"Big5"),CharacterSetECI.GB18030=new CharacterSetECI(CharacterSetValueIdentifiers.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),CharacterSetECI.EUC_KR=new CharacterSetECI(CharacterSetValueIdentifiers.EUC_KR,30,"EUC_KR","EUC-KR");class UnsupportedOperationException extends Exception{}UnsupportedOperationException.kind="UnsupportedOperationException";class StringEncoding{static decode(bytes,encoding){const encodingName=this.encodingName(encoding);return this.customDecoder?this.customDecoder(bytes,encodingName):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(encodingName)?this.decodeFallback(bytes,encodingName):new TextDecoder(encodingName).decode(bytes)}static shouldDecodeOnFallback(encodingName){return!StringEncoding.isBrowser()&&encodingName==="ISO-8859-1"}static encode(s,encoding){const encodingName=this.encodingName(encoding);return this.customEncoder?this.customEncoder(s,encodingName):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(encoding){return typeof encoding=="string"?encoding:encoding.getName()}static encodingCharacterSet(encoding){return encoding instanceof CharacterSetECI?encoding:CharacterSetECI.getCharacterSetECIByName(encoding)}static decodeFallback(bytes,encoding){const characterSet=this.encodingCharacterSet(encoding);if(StringEncoding.isDecodeFallbackSupported(characterSet)){let s="";for(let i=0,length=bytes.length;i<length;i++){let h=bytes[i].toString(16);h.length<2&&(h="0"+h),s+="%"+h}return decodeURIComponent(s)}if(characterSet.equals(CharacterSetECI.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(bytes.buffer));throw new UnsupportedOperationException(`Encoding ${this.encodingName(encoding)} not supported by fallback.`)}static isDecodeFallbackSupported(characterSet){return characterSet.equals(CharacterSetECI.UTF8)||characterSet.equals(CharacterSetECI.ISO8859_1)||characterSet.equals(CharacterSetECI.ASCII)}static encodeFallback(s){const charList=btoa(unescape(encodeURIComponent(s))).split(""),uintArray=[];for(let i=0;i<charList.length;i++)uintArray.push(charList[i].charCodeAt(0));return new Uint8Array(uintArray)}}class StringUtils{static castAsNonUtf8Char(code,encoding=null){const e=encoding?encoding.getName():this.ISO88591;return StringEncoding.decode(new Uint8Array([code]),e)}static guessEncoding(bytes,hints){if(hints!=null&&hints.get(DecodeHintType$1.CHARACTER_SET)!==void 0)return hints.get(DecodeHintType$1.CHARACTER_SET).toString();const length=bytes.length;let canBeISO88591=!0,canBeShiftJIS=!0,canBeUTF8=!0,utf8BytesLeft=0,utf2BytesChars=0,utf3BytesChars=0,utf4BytesChars=0,sjisBytesLeft=0,sjisKatakanaChars=0,sjisCurKatakanaWordLength=0,sjisCurDoubleBytesWordLength=0,sjisMaxKatakanaWordLength=0,sjisMaxDoubleBytesWordLength=0,isoHighOther=0;const utf8bom=bytes.length>3&&bytes[0]===239&&bytes[1]===187&&bytes[2]===191;for(let i=0;i<length&&(canBeISO88591||canBeShiftJIS||canBeUTF8);i++){const value=bytes[i]&255;canBeUTF8&&(utf8BytesLeft>0?value&128?utf8BytesLeft--:canBeUTF8=!1:value&128&&(value&64?(utf8BytesLeft++,value&32?(utf8BytesLeft++,value&16?(utf8BytesLeft++,value&8?canBeUTF8=!1:utf4BytesChars++):utf3BytesChars++):utf2BytesChars++):canBeUTF8=!1)),canBeISO88591&&(value>127&&value<160?canBeISO88591=!1:value>159&&(value<192||value===215||value===247)&&isoHighOther++),canBeShiftJIS&&(sjisBytesLeft>0?value<64||value===127||value>252?canBeShiftJIS=!1:sjisBytesLeft--:value===128||value===160||value>239?canBeShiftJIS=!1:value>160&&value<224?(sjisKatakanaChars++,sjisCurDoubleBytesWordLength=0,sjisCurKatakanaWordLength++,sjisCurKatakanaWordLength>sjisMaxKatakanaWordLength&&(sjisMaxKatakanaWordLength=sjisCurKatakanaWordLength)):value>127?(sjisBytesLeft++,sjisCurKatakanaWordLength=0,sjisCurDoubleBytesWordLength++,sjisCurDoubleBytesWordLength>sjisMaxDoubleBytesWordLength&&(sjisMaxDoubleBytesWordLength=sjisCurDoubleBytesWordLength)):(sjisCurKatakanaWordLength=0,sjisCurDoubleBytesWordLength=0))}return canBeUTF8&&utf8BytesLeft>0&&(canBeUTF8=!1),canBeShiftJIS&&sjisBytesLeft>0&&(canBeShiftJIS=!1),canBeUTF8&&(utf8bom||utf2BytesChars+utf3BytesChars+utf4BytesChars>0)?StringUtils.UTF8:canBeShiftJIS&&(StringUtils.ASSUME_SHIFT_JIS||sjisMaxKatakanaWordLength>=3||sjisMaxDoubleBytesWordLength>=3)?StringUtils.SHIFT_JIS:canBeISO88591&&canBeShiftJIS?sjisMaxKatakanaWordLength===2&&sjisKatakanaChars===2||isoHighOther*10>=length?StringUtils.SHIFT_JIS:StringUtils.ISO88591:canBeISO88591?StringUtils.ISO88591:canBeShiftJIS?StringUtils.SHIFT_JIS:canBeUTF8?StringUtils.UTF8:StringUtils.PLATFORM_DEFAULT_ENCODING}static format(append,...args){let i=-1;function callback(exp,p0,p1,p2,p3,p4){if(exp==="%%")return"%";if(args[++i]===void 0)return;exp=p2?parseInt(p2.substr(1)):void 0;let base=p3?parseInt(p3.substr(1)):void 0,val;switch(p4){case"s":val=args[i];break;case"c":val=args[i][0];break;case"f":val=parseFloat(args[i]).toFixed(exp);break;case"p":val=parseFloat(args[i]).toPrecision(exp);break;case"e":val=parseFloat(args[i]).toExponential(exp);break;case"x":val=parseInt(args[i]).toString(base||16);break;case"d":val=parseFloat(parseInt(args[i],base||10).toPrecision(exp)).toFixed(0);break}val=typeof val=="object"?JSON.stringify(val):(+val).toString(base);let size=parseInt(p1),ch=p1&&p1[0]+""=="0"?"0":" ";for(;val.length<size;)val=p0!==void 0?val+ch:ch+val;return val}let regex=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return append.replace(regex,callback)}static getBytes(str,encoding){return StringEncoding.encode(str,encoding)}static getCharCode(str,index=0){return str.charCodeAt(index)}static getCharAt(charCode){return String.fromCharCode(charCode)}}StringUtils.SHIFT_JIS=CharacterSetECI.SJIS.getName(),StringUtils.GB2312="GB2312",StringUtils.ISO88591=CharacterSetECI.ISO8859_1.getName(),StringUtils.EUC_JP="EUC_JP",StringUtils.UTF8=CharacterSetECI.UTF8.getName(),StringUtils.PLATFORM_DEFAULT_ENCODING=StringUtils.UTF8,StringUtils.ASSUME_SHIFT_JIS=!1;class StringBuilder{constructor(value=""){this.value=value}enableDecoding(encoding){return this.encoding=encoding,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=StringUtils.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(str,offset,len){for(let i=offset;offset<offset+len;i++)this.append(str[i]);return this}length(){return this.value.length}charAt(n){return this.value.charAt(n)}deleteCharAt(n){this.value=this.value.substr(0,n)+this.value.substring(n+1)}setCharAt(n,c){this.value=this.value.substr(0,n)+c+this.value.substr(n+1)}substring(start,end){return this.value.substring(start,end)}setLengthToZero(){this.value=""}toString(){return this.value}insert(n,c){this.value=this.value.substr(0,n)+c+this.value.substr(n+c.length)}}class BitMatrix{constructor(width,height,rowSize,bits){if(this.width=width,this.height=height,this.rowSize=rowSize,this.bits=bits,height==null&&(height=width),this.height=height,width<1||height<1)throw new IllegalArgumentException("Both dimensions must be greater than 0");rowSize==null&&(rowSize=Math.floor((width+31)/32)),this.rowSize=rowSize,bits==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(image){const height=image.length,width=image[0].length,bits=new BitMatrix(width,height);for(let i=0;i<height;i++){const imageI=image[i];for(let j=0;j<width;j++)imageI[j]&&bits.set(j,i)}return bits}static parseFromString(stringRepresentation,setString,unsetString){if(stringRepresentation===null)throw new IllegalArgumentException("stringRepresentation cannot be null");const bits=new Array(stringRepresentation.length);let bitsPos=0,rowStartPos=0,rowLength=-1,nRows=0,pos=0;for(;pos<stringRepresentation.length;)if(stringRepresentation.charAt(pos)===`
`||stringRepresentation.charAt(pos)==="\r"){if(bitsPos>rowStartPos){if(rowLength===-1)rowLength=bitsPos-rowStartPos;else if(bitsPos-rowStartPos!==rowLength)throw new IllegalArgumentException("row lengths do not match");rowStartPos=bitsPos,nRows++}pos++}else if(stringRepresentation.substring(pos,pos+setString.length)===setString)pos+=setString.length,bits[bitsPos]=!0,bitsPos++;else if(stringRepresentation.substring(pos,pos+unsetString.length)===unsetString)pos+=unsetString.length,bits[bitsPos]=!1,bitsPos++;else throw new IllegalArgumentException("illegal character encountered: "+stringRepresentation.substring(pos));if(bitsPos>rowStartPos){if(rowLength===-1)rowLength=bitsPos-rowStartPos;else if(bitsPos-rowStartPos!==rowLength)throw new IllegalArgumentException("row lengths do not match");nRows++}const matrix=new BitMatrix(rowLength,nRows);for(let i=0;i<bitsPos;i++)bits[i]&&matrix.set(Math.floor(i%rowLength),Math.floor(i/rowLength));return matrix}get(x,y){const offset=y*this.rowSize+Math.floor(x/32);return(this.bits[offset]>>>(x&31)&1)!==0}set(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]|=1<<(x&31)&4294967295}unset(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]&=~(1<<(x&31)&4294967295)}flip(x,y){const offset=y*this.rowSize+Math.floor(x/32);this.bits[offset]^=1<<(x&31)&4294967295}xor(mask){if(this.width!==mask.getWidth()||this.height!==mask.getHeight()||this.rowSize!==mask.getRowSize())throw new IllegalArgumentException("input matrix dimensions do not match");const rowArray=new BitArray(Math.floor(this.width/32)+1),rowSize=this.rowSize,bits=this.bits;for(let y=0,height=this.height;y<height;y++){const offset=y*rowSize,row=mask.getRow(y,rowArray).getBitArray();for(let x=0;x<rowSize;x++)bits[offset+x]^=row[x]}}clear(){const bits=this.bits,max=bits.length;for(let i=0;i<max;i++)bits[i]=0}setRegion(left,top,width,height){if(top<0||left<0)throw new IllegalArgumentException("Left and top must be nonnegative");if(height<1||width<1)throw new IllegalArgumentException("Height and width must be at least 1");const right=left+width,bottom=top+height;if(bottom>this.height||right>this.width)throw new IllegalArgumentException("The region must fit inside the matrix");const rowSize=this.rowSize,bits=this.bits;for(let y=top;y<bottom;y++){const offset=y*rowSize;for(let x=left;x<right;x++)bits[offset+Math.floor(x/32)]|=1<<(x&31)&4294967295}}getRow(y,row){row==null||row.getSize()<this.width?row=new BitArray(this.width):row.clear();const rowSize=this.rowSize,bits=this.bits,offset=y*rowSize;for(let x=0;x<rowSize;x++)row.setBulk(x*32,bits[offset+x]);return row}setRow(y,row){System.arraycopy(row.getBitArray(),0,this.bits,y*this.rowSize,this.rowSize)}rotate180(){const width=this.getWidth(),height=this.getHeight();let topRow=new BitArray(width),bottomRow=new BitArray(width);for(let i=0,length=Math.floor((height+1)/2);i<length;i++)topRow=this.getRow(i,topRow),bottomRow=this.getRow(height-1-i,bottomRow),topRow.reverse(),bottomRow.reverse(),this.setRow(i,bottomRow),this.setRow(height-1-i,topRow)}getEnclosingRectangle(){const width=this.width,height=this.height,rowSize=this.rowSize,bits=this.bits;let left=width,top=height,right=-1,bottom=-1;for(let y=0;y<height;y++)for(let x32=0;x32<rowSize;x32++){const theBits=bits[y*rowSize+x32];if(theBits!==0){if(y<top&&(top=y),y>bottom&&(bottom=y),x32*32<left){let bit=0;for(;!(theBits<<31-bit&4294967295);)bit++;x32*32+bit<left&&(left=x32*32+bit)}if(x32*32+31>right){let bit=31;for(;!(theBits>>>bit);)bit--;x32*32+bit>right&&(right=x32*32+bit)}}}return right<left||bottom<top?null:Int32Array.from([left,top,right-left+1,bottom-top+1])}getTopLeftOnBit(){const rowSize=this.rowSize,bits=this.bits;let bitsOffset=0;for(;bitsOffset<bits.length&&bits[bitsOffset]===0;)bitsOffset++;if(bitsOffset===bits.length)return null;const y=bitsOffset/rowSize;let x=bitsOffset%rowSize*32;const theBits=bits[bitsOffset];let bit=0;for(;!(theBits<<31-bit&4294967295);)bit++;return x+=bit,Int32Array.from([x,y])}getBottomRightOnBit(){const rowSize=this.rowSize,bits=this.bits;let bitsOffset=bits.length-1;for(;bitsOffset>=0&&bits[bitsOffset]===0;)bitsOffset--;if(bitsOffset<0)return null;const y=Math.floor(bitsOffset/rowSize);let x=Math.floor(bitsOffset%rowSize)*32;const theBits=bits[bitsOffset];let bit=31;for(;!(theBits>>>bit);)bit--;return x+=bit,Int32Array.from([x,y])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(o){if(!(o instanceof BitMatrix))return!1;const other=o;return this.width===other.width&&this.height===other.height&&this.rowSize===other.rowSize&&Arrays.equals(this.bits,other.bits)}hashCode(){let hash=this.width;return hash=31*hash+this.width,hash=31*hash+this.height,hash=31*hash+this.rowSize,hash=31*hash+Arrays.hashCode(this.bits),hash}toString(setString="X ",unsetString="  ",lineSeparator=`
`){return this.buildToString(setString,unsetString,lineSeparator)}buildToString(setString,unsetString,lineSeparator){let result=new StringBuilder;for(let y=0,height=this.height;y<height;y++){for(let x=0,width=this.width;x<width;x++)result.append(this.get(x,y)?setString:unsetString);result.append(lineSeparator)}return result.toString()}clone(){return new BitMatrix(this.width,this.height,this.rowSize,this.bits.slice())}}class NotFoundException extends Exception{static getNotFoundInstance(){return new NotFoundException}}NotFoundException.kind="NotFoundException";class GlobalHistogramBinarizer extends Binarizer{constructor(source){super(source),this.luminances=GlobalHistogramBinarizer.EMPTY,this.buckets=new Int32Array(GlobalHistogramBinarizer.LUMINANCE_BUCKETS)}getBlackRow(y,row){const source=this.getLuminanceSource(),width=source.getWidth();row==null||row.getSize()<width?row=new BitArray(width):row.clear(),this.initArrays(width);const localLuminances=source.getRow(y,this.luminances),localBuckets=this.buckets;for(let x=0;x<width;x++)localBuckets[(localLuminances[x]&255)>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++;const blackPoint=GlobalHistogramBinarizer.estimateBlackPoint(localBuckets);if(width<3)for(let x=0;x<width;x++)(localLuminances[x]&255)<blackPoint&&row.set(x);else{let left=localLuminances[0]&255,center=localLuminances[1]&255;for(let x=1;x<width-1;x++){const right=localLuminances[x+1]&255;(center*4-left-right)/2<blackPoint&&row.set(x),left=center,center=right}}return row}getBlackMatrix(){const source=this.getLuminanceSource(),width=source.getWidth(),height=source.getHeight(),matrix=new BitMatrix(width,height);this.initArrays(width);const localBuckets=this.buckets;for(let y=1;y<5;y++){const row=Math.floor(height*y/5),localLuminances2=source.getRow(row,this.luminances),right=Math.floor(width*4/5);for(let x=Math.floor(width/5);x<right;x++){const pixel=localLuminances2[x]&255;localBuckets[pixel>>GlobalHistogramBinarizer.LUMINANCE_SHIFT]++}}const blackPoint=GlobalHistogramBinarizer.estimateBlackPoint(localBuckets),localLuminances=source.getMatrix();for(let y=0;y<height;y++){const offset=y*width;for(let x=0;x<width;x++)(localLuminances[offset+x]&255)<blackPoint&&matrix.set(x,y)}return matrix}createBinarizer(source){return new GlobalHistogramBinarizer(source)}initArrays(luminanceSize){this.luminances.length<luminanceSize&&(this.luminances=new Uint8ClampedArray(luminanceSize));const buckets=this.buckets;for(let x=0;x<GlobalHistogramBinarizer.LUMINANCE_BUCKETS;x++)buckets[x]=0}static estimateBlackPoint(buckets){const numBuckets=buckets.length;let maxBucketCount=0,firstPeak=0,firstPeakSize=0;for(let x=0;x<numBuckets;x++)buckets[x]>firstPeakSize&&(firstPeak=x,firstPeakSize=buckets[x]),buckets[x]>maxBucketCount&&(maxBucketCount=buckets[x]);let secondPeak=0,secondPeakScore=0;for(let x=0;x<numBuckets;x++){const distanceToBiggest=x-firstPeak,score=buckets[x]*distanceToBiggest*distanceToBiggest;score>secondPeakScore&&(secondPeak=x,secondPeakScore=score)}if(firstPeak>secondPeak){const temp=firstPeak;firstPeak=secondPeak,secondPeak=temp}if(secondPeak-firstPeak<=numBuckets/16)throw new NotFoundException;let bestValley=secondPeak-1,bestValleyScore=-1;for(let x=secondPeak-1;x>firstPeak;x--){const fromFirst=x-firstPeak,score=fromFirst*fromFirst*(secondPeak-x)*(maxBucketCount-buckets[x]);score>bestValleyScore&&(bestValley=x,bestValleyScore=score)}return bestValley<<GlobalHistogramBinarizer.LUMINANCE_SHIFT}}GlobalHistogramBinarizer.LUMINANCE_BITS=5,GlobalHistogramBinarizer.LUMINANCE_SHIFT=8-GlobalHistogramBinarizer.LUMINANCE_BITS,GlobalHistogramBinarizer.LUMINANCE_BUCKETS=1<<GlobalHistogramBinarizer.LUMINANCE_BITS,GlobalHistogramBinarizer.EMPTY=Uint8ClampedArray.from([0]);class HybridBinarizer extends GlobalHistogramBinarizer{constructor(source){super(source),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const source=this.getLuminanceSource(),width=source.getWidth(),height=source.getHeight();if(width>=HybridBinarizer.MINIMUM_DIMENSION&&height>=HybridBinarizer.MINIMUM_DIMENSION){const luminances=source.getMatrix();let subWidth=width>>HybridBinarizer.BLOCK_SIZE_POWER;width&HybridBinarizer.BLOCK_SIZE_MASK&&subWidth++;let subHeight=height>>HybridBinarizer.BLOCK_SIZE_POWER;height&HybridBinarizer.BLOCK_SIZE_MASK&&subHeight++;const blackPoints=HybridBinarizer.calculateBlackPoints(luminances,subWidth,subHeight,width,height),newMatrix=new BitMatrix(width,height);HybridBinarizer.calculateThresholdForBlock(luminances,subWidth,subHeight,width,height,blackPoints,newMatrix),this.matrix=newMatrix}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(source){return new HybridBinarizer(source)}static calculateThresholdForBlock(luminances,subWidth,subHeight,width,height,blackPoints,matrix){const maxYOffset=height-HybridBinarizer.BLOCK_SIZE,maxXOffset=width-HybridBinarizer.BLOCK_SIZE;for(let y=0;y<subHeight;y++){let yoffset=y<<HybridBinarizer.BLOCK_SIZE_POWER;yoffset>maxYOffset&&(yoffset=maxYOffset);const top=HybridBinarizer.cap(y,2,subHeight-3);for(let x=0;x<subWidth;x++){let xoffset=x<<HybridBinarizer.BLOCK_SIZE_POWER;xoffset>maxXOffset&&(xoffset=maxXOffset);const left=HybridBinarizer.cap(x,2,subWidth-3);let sum=0;for(let z=-2;z<=2;z++){const blackRow=blackPoints[top+z];sum+=blackRow[left-2]+blackRow[left-1]+blackRow[left]+blackRow[left+1]+blackRow[left+2]}const average=sum/25;HybridBinarizer.thresholdBlock(luminances,xoffset,yoffset,average,width,matrix)}}}static cap(value,min,max){return value<min?min:value>max?max:value}static thresholdBlock(luminances,xoffset,yoffset,threshold,stride,matrix){for(let y=0,offset=yoffset*stride+xoffset;y<HybridBinarizer.BLOCK_SIZE;y++,offset+=stride)for(let x=0;x<HybridBinarizer.BLOCK_SIZE;x++)(luminances[offset+x]&255)<=threshold&&matrix.set(xoffset+x,yoffset+y)}static calculateBlackPoints(luminances,subWidth,subHeight,width,height){const maxYOffset=height-HybridBinarizer.BLOCK_SIZE,maxXOffset=width-HybridBinarizer.BLOCK_SIZE,blackPoints=new Array(subHeight);for(let y=0;y<subHeight;y++){blackPoints[y]=new Int32Array(subWidth);let yoffset=y<<HybridBinarizer.BLOCK_SIZE_POWER;yoffset>maxYOffset&&(yoffset=maxYOffset);for(let x=0;x<subWidth;x++){let xoffset=x<<HybridBinarizer.BLOCK_SIZE_POWER;xoffset>maxXOffset&&(xoffset=maxXOffset);let sum=0,min=255,max=0;for(let yy=0,offset=yoffset*width+xoffset;yy<HybridBinarizer.BLOCK_SIZE;yy++,offset+=width){for(let xx=0;xx<HybridBinarizer.BLOCK_SIZE;xx++){const pixel=luminances[offset+xx]&255;sum+=pixel,pixel<min&&(min=pixel),pixel>max&&(max=pixel)}if(max-min>HybridBinarizer.MIN_DYNAMIC_RANGE)for(yy++,offset+=width;yy<HybridBinarizer.BLOCK_SIZE;yy++,offset+=width)for(let xx=0;xx<HybridBinarizer.BLOCK_SIZE;xx++)sum+=luminances[offset+xx]&255}let average=sum>>HybridBinarizer.BLOCK_SIZE_POWER*2;if(max-min<=HybridBinarizer.MIN_DYNAMIC_RANGE&&(average=min/2,y>0&&x>0)){const averageNeighborBlackPoint=(blackPoints[y-1][x]+2*blackPoints[y][x-1]+blackPoints[y-1][x-1])/4;min<averageNeighborBlackPoint&&(average=averageNeighborBlackPoint)}blackPoints[y][x]=average}}return blackPoints}}HybridBinarizer.BLOCK_SIZE_POWER=3,HybridBinarizer.BLOCK_SIZE=1<<HybridBinarizer.BLOCK_SIZE_POWER,HybridBinarizer.BLOCK_SIZE_MASK=HybridBinarizer.BLOCK_SIZE-1,HybridBinarizer.MINIMUM_DIMENSION=HybridBinarizer.BLOCK_SIZE*5,HybridBinarizer.MIN_DYNAMIC_RANGE=24;class LuminanceSource{constructor(width,height){this.width=width,this.height=height}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(left,top,width,height){throw new UnsupportedOperationException("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new UnsupportedOperationException("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new UnsupportedOperationException("This luminance source does not support rotation by 45 degrees.")}toString(){const row=new Uint8ClampedArray(this.width);let result=new StringBuilder;for(let y=0;y<this.height;y++){const sourceRow=this.getRow(y,row);for(let x=0;x<this.width;x++){const luminance=sourceRow[x]&255;let c;luminance<64?c="#":luminance<128?c="+":luminance<192?c=".":c=" ",result.append(c)}result.append(`
`)}return result.toString()}}class InvertedLuminanceSource extends LuminanceSource{constructor(delegate){super(delegate.getWidth(),delegate.getHeight()),this.delegate=delegate}getRow(y,row){const sourceRow=this.delegate.getRow(y,row),width=this.getWidth();for(let i=0;i<width;i++)sourceRow[i]=255-(sourceRow[i]&255);return sourceRow}getMatrix(){const matrix=this.delegate.getMatrix(),length=this.getWidth()*this.getHeight(),invertedMatrix=new Uint8ClampedArray(length);for(let i=0;i<length;i++)invertedMatrix[i]=255-(matrix[i]&255);return invertedMatrix}isCropSupported(){return this.delegate.isCropSupported()}crop(left,top,width,height){return new InvertedLuminanceSource(this.delegate.crop(left,top,width,height))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new InvertedLuminanceSource(this.delegate.rotateCounterClockwise45())}}class HTMLCanvasElementLuminanceSource extends LuminanceSource{constructor(canvas){super(canvas.width,canvas.height),this.canvas=canvas,this.tempCanvasElement=null,this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(canvas)}static makeBufferFromCanvasImageData(canvas){const imageData=canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height);return HTMLCanvasElementLuminanceSource.toGrayscaleBuffer(imageData.data,canvas.width,canvas.height)}static toGrayscaleBuffer(imageBuffer,width,height){const grayscaleBuffer=new Uint8ClampedArray(width*height);for(let i=0,j=0,length=imageBuffer.length;i<length;i+=4,j++){let gray;if(imageBuffer[i+3]===0)gray=255;else{const pixelR=imageBuffer[i],pixelG=imageBuffer[i+1],pixelB=imageBuffer[i+2];gray=306*pixelR+601*pixelG+117*pixelB+512>>10}grayscaleBuffer[j]=gray}return grayscaleBuffer}getRow(y,row){if(y<0||y>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+y);const width=this.getWidth(),start=y*width;return row===null?row=this.buffer.slice(start,start+width):(row.length<width&&(row=new Uint8ClampedArray(width)),row.set(this.buffer.slice(start,start+width))),row}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(left,top,width,height){return super.crop(left,top,width,height),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const tempCanvasElement=this.canvas.ownerDocument.createElement("canvas");tempCanvasElement.width=this.canvas.width,tempCanvasElement.height=this.canvas.height,this.tempCanvasElement=tempCanvasElement}return this.tempCanvasElement}rotate(angle){const tempCanvasElement=this.getTempCanvasElement(),tempContext=tempCanvasElement.getContext("2d"),angleRadians=angle*HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS,width=this.canvas.width,height=this.canvas.height,newWidth=Math.ceil(Math.abs(Math.cos(angleRadians))*width+Math.abs(Math.sin(angleRadians))*height),newHeight=Math.ceil(Math.abs(Math.sin(angleRadians))*width+Math.abs(Math.cos(angleRadians))*height);return tempCanvasElement.width=newWidth,tempCanvasElement.height=newHeight,tempContext.translate(newWidth/2,newHeight/2),tempContext.rotate(angleRadians),tempContext.drawImage(this.canvas,width/-2,height/-2),this.buffer=HTMLCanvasElementLuminanceSource.makeBufferFromCanvasImageData(tempCanvasElement),this}invert(){return new InvertedLuminanceSource(this)}}HTMLCanvasElementLuminanceSource.DEGREE_TO_RADIANS=Math.PI/180;class VideoInputDevice{constructor(deviceId,label,groupId){this.deviceId=deviceId,this.label=label,this.kind="videoinput",this.groupId=groupId||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var __awaiter=(globalThis||__webpack_require__2.g||self||window||void 0)&&(globalThis||__webpack_require__2.g||self||window||void 0).__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};class BrowserCodeReader{constructor(reader,timeBetweenScansMillis=500,_hints){this.reader=reader,this.timeBetweenScansMillis=timeBetweenScansMillis,this._hints=_hints,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(millis){this._timeBetweenDecodingAttempts=millis<0?0:millis}set hints(hints){this._hints=hints||null}get hints(){return this._hints}listVideoInputDevices(){return __awaiter(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const devices=yield navigator.mediaDevices.enumerateDevices(),videoDevices=[];for(const device of devices){const kind=device.kind==="video"?"videoinput":device.kind;if(kind!=="videoinput")continue;const deviceId=device.deviceId||device.id,label=device.label||`Video device ${videoDevices.length+1}`,groupId=device.groupId,videoDevice={deviceId,label,kind,groupId};videoDevices.push(videoDevice)}return videoDevices})}getVideoInputDevices(){return __awaiter(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(d=>new VideoInputDevice(d.deviceId,d.label))})}findDeviceById(deviceId){return __awaiter(this,void 0,void 0,function*(){const devices=yield this.listVideoInputDevices();return devices?devices.find(x=>x.deviceId===deviceId):null})}decodeFromInputVideoDevice(deviceId,videoSource){return __awaiter(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(deviceId,videoSource)})}decodeOnceFromVideoDevice(deviceId,videoSource){return __awaiter(this,void 0,void 0,function*(){this.reset();let videoConstraints;deviceId?videoConstraints={deviceId:{exact:deviceId}}:videoConstraints={facingMode:"environment"};const constraints={video:videoConstraints};return yield this.decodeOnceFromConstraints(constraints,videoSource)})}decodeOnceFromConstraints(constraints,videoSource){return __awaiter(this,void 0,void 0,function*(){const stream=yield navigator.mediaDevices.getUserMedia(constraints);return yield this.decodeOnceFromStream(stream,videoSource)})}decodeOnceFromStream(stream,videoSource){return __awaiter(this,void 0,void 0,function*(){this.reset();const video=yield this.attachStreamToVideo(stream,videoSource);return yield this.decodeOnce(video)})}decodeFromInputVideoDeviceContinuously(deviceId,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(deviceId,videoSource,callbackFn)})}decodeFromVideoDevice(deviceId,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){let videoConstraints;deviceId?videoConstraints={deviceId:{exact:deviceId}}:videoConstraints={facingMode:"environment"};const constraints={video:videoConstraints};return yield this.decodeFromConstraints(constraints,videoSource,callbackFn)})}decodeFromConstraints(constraints,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){const stream=yield navigator.mediaDevices.getUserMedia(constraints);return yield this.decodeFromStream(stream,videoSource,callbackFn)})}decodeFromStream(stream,videoSource,callbackFn){return __awaiter(this,void 0,void 0,function*(){this.reset();const video=yield this.attachStreamToVideo(stream,videoSource);return yield this.decodeContinuously(video,callbackFn)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(stream,videoSource){return __awaiter(this,void 0,void 0,function*(){const videoElement=this.prepareVideoElement(videoSource);return this.addVideoSource(videoElement,stream),this.videoElement=videoElement,this.stream=stream,yield this.playVideoOnLoadAsync(videoElement),videoElement})}playVideoOnLoadAsync(videoElement){return new Promise((resolve,reject)=>this.playVideoOnLoad(videoElement,()=>resolve()))}playVideoOnLoad(element,callbackFn){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(element),element.addEventListener("ended",this.videoEndedListener),element.addEventListener("canplay",this.videoCanPlayListener),element.addEventListener("playing",callbackFn),this.tryPlayVideo(element)}isVideoPlaying(video){return video.currentTime>0&&!video.paused&&!video.ended&&video.readyState>2}tryPlayVideo(videoElement){return __awaiter(this,void 0,void 0,function*(){if(this.isVideoPlaying(videoElement)){console.warn("Trying to play video that is already playing.");return}try{yield videoElement.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(mediaElementId,type){const mediaElement=document.getElementById(mediaElementId);if(!mediaElement)throw new ArgumentException(`element with id '${mediaElementId}' not found`);if(mediaElement.nodeName.toLowerCase()!==type.toLowerCase())throw new ArgumentException(`element with id '${mediaElementId}' must be an ${type} element`);return mediaElement}decodeFromImage(source,url){if(!source&&!url)throw new ArgumentException("either imageElement with a src set or an url must be provided");return url&&!source?this.decodeFromImageUrl(url):this.decodeFromImageElement(source)}decodeFromVideo(source,url){if(!source&&!url)throw new ArgumentException("Either an element with a src set or an URL must be provided");return url&&!source?this.decodeFromVideoUrl(url):this.decodeFromVideoElement(source)}decodeFromVideoContinuously(source,url,callbackFn){if(source===void 0&&url===void 0)throw new ArgumentException("Either an element with a src set or an URL must be provided");return url&&!source?this.decodeFromVideoUrlContinuously(url,callbackFn):this.decodeFromVideoElementContinuously(source,callbackFn)}decodeFromImageElement(source){if(!source)throw new ArgumentException("An image element must be provided.");this.reset();const element=this.prepareImageElement(source);this.imageElement=element;let task;return this.isImageLoaded(element)?task=this.decodeOnce(element,!1,!0):task=this._decodeOnLoadImage(element),task}decodeFromVideoElement(source){const element=this._decodeFromVideoElementSetup(source);return this._decodeOnLoadVideo(element)}decodeFromVideoElementContinuously(source,callbackFn){const element=this._decodeFromVideoElementSetup(source);return this._decodeOnLoadVideoContinuously(element,callbackFn)}_decodeFromVideoElementSetup(source){if(!source)throw new ArgumentException("A video element must be provided.");this.reset();const element=this.prepareVideoElement(source);return this.videoElement=element,element}decodeFromImageUrl(url){if(!url)throw new ArgumentException("An URL must be provided.");this.reset();const element=this.prepareImageElement();this.imageElement=element;const decodeTask=this._decodeOnLoadImage(element);return element.src=url,decodeTask}decodeFromVideoUrl(url){if(!url)throw new ArgumentException("An URL must be provided.");this.reset();const element=this.prepareVideoElement(),decodeTask=this.decodeFromVideoElement(element);return element.src=url,decodeTask}decodeFromVideoUrlContinuously(url,callbackFn){if(!url)throw new ArgumentException("An URL must be provided.");this.reset();const element=this.prepareVideoElement(),decodeTask=this.decodeFromVideoElementContinuously(element,callbackFn);return element.src=url,decodeTask}_decodeOnLoadImage(element){return new Promise((resolve,reject)=>{this.imageLoadedListener=()=>this.decodeOnce(element,!1,!0).then(resolve,reject),element.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(videoElement){return __awaiter(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(videoElement),yield this.decodeOnce(videoElement)})}_decodeOnLoadVideoContinuously(videoElement,callbackFn){return __awaiter(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(videoElement),this.decodeContinuously(videoElement,callbackFn)})}isImageLoaded(img){return!(!img.complete||img.naturalWidth===0)}prepareImageElement(imageSource){let imageElement;return typeof imageSource>"u"&&(imageElement=document.createElement("img"),imageElement.width=200,imageElement.height=200),typeof imageSource=="string"&&(imageElement=this.getMediaElement(imageSource,"img")),imageSource instanceof HTMLImageElement&&(imageElement=imageSource),imageElement}prepareVideoElement(videoSource){let videoElement;return!videoSource&&typeof document<"u"&&(videoElement=document.createElement("video"),videoElement.width=200,videoElement.height=200),typeof videoSource=="string"&&(videoElement=this.getMediaElement(videoSource,"video")),videoSource instanceof HTMLVideoElement&&(videoElement=videoSource),videoElement.setAttribute("autoplay","true"),videoElement.setAttribute("muted","true"),videoElement.setAttribute("playsinline","true"),videoElement}decodeOnce(element,retryIfNotFound=!0,retryIfChecksumOrFormatError=!0){this._stopAsyncDecode=!1;const loop=(resolve,reject)=>{if(this._stopAsyncDecode){reject(new NotFoundException("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const result=this.decode(element);resolve(result)}catch(e){const ifNotFound=retryIfNotFound&&e instanceof NotFoundException,ifChecksumOrFormat=(e instanceof ChecksumException||e instanceof FormatException)&&retryIfChecksumOrFormatError;if(ifNotFound||ifChecksumOrFormat)return setTimeout(loop,this._timeBetweenDecodingAttempts,resolve,reject);reject(e)}};return new Promise((resolve,reject)=>loop(resolve,reject))}decodeContinuously(element,callbackFn){this._stopContinuousDecode=!1;const loop=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const result=this.decode(element);callbackFn(result,null),setTimeout(loop,this.timeBetweenScansMillis)}catch(e){callbackFn(null,e);const isChecksumOrFormatError=e instanceof ChecksumException||e instanceof FormatException,isNotFound=e instanceof NotFoundException;(isChecksumOrFormatError||isNotFound)&&setTimeout(loop,this._timeBetweenDecodingAttempts)}};loop()}decode(element){const binaryBitmap=this.createBinaryBitmap(element);return this.decodeBitmap(binaryBitmap)}_isHTMLVideoElement(mediaElement){return mediaElement.videoWidth!==0}drawFrameOnCanvas(srcElement,dimensions,canvasElementContext){dimensions||(dimensions={sx:0,sy:0,sWidth:srcElement.videoWidth,sHeight:srcElement.videoHeight,dx:0,dy:0,dWidth:srcElement.videoWidth,dHeight:srcElement.videoHeight}),canvasElementContext||(canvasElementContext=this.captureCanvasContext),canvasElementContext.drawImage(srcElement,dimensions.sx,dimensions.sy,dimensions.sWidth,dimensions.sHeight,dimensions.dx,dimensions.dy,dimensions.dWidth,dimensions.dHeight)}drawImageOnCanvas(srcElement,dimensions,canvasElementContext=this.captureCanvasContext){dimensions||(dimensions={sx:0,sy:0,sWidth:srcElement.naturalWidth,sHeight:srcElement.naturalHeight,dx:0,dy:0,dWidth:srcElement.naturalWidth,dHeight:srcElement.naturalHeight}),canvasElementContext||(canvasElementContext=this.captureCanvasContext),canvasElementContext.drawImage(srcElement,dimensions.sx,dimensions.sy,dimensions.sWidth,dimensions.sHeight,dimensions.dx,dimensions.dy,dimensions.dWidth,dimensions.dHeight)}createBinaryBitmap(mediaElement){const ctx=this.getCaptureCanvasContext(mediaElement);this._isHTMLVideoElement(mediaElement)?this.drawFrameOnCanvas(mediaElement):this.drawImageOnCanvas(mediaElement);const canvas=this.getCaptureCanvas(mediaElement),luminanceSource=new HTMLCanvasElementLuminanceSource(canvas),hybridBinarizer=new HybridBinarizer(luminanceSource);return new BinaryBitmap(hybridBinarizer)}getCaptureCanvasContext(mediaElement){if(!this.captureCanvasContext){const ctx=this.getCaptureCanvas(mediaElement).getContext("2d");this.captureCanvasContext=ctx}return this.captureCanvasContext}getCaptureCanvas(mediaElement){if(!this.captureCanvas){const elem=this.createCaptureCanvas(mediaElement);this.captureCanvas=elem}return this.captureCanvas}decodeBitmap(binaryBitmap){return this.reader.decode(binaryBitmap,this._hints)}createCaptureCanvas(mediaElement){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const canvasElement=document.createElement("canvas");let width,height;return typeof mediaElement<"u"&&(mediaElement instanceof HTMLVideoElement?(width=mediaElement.videoWidth,height=mediaElement.videoHeight):mediaElement instanceof HTMLImageElement&&(width=mediaElement.naturalWidth||mediaElement.width,height=mediaElement.naturalHeight||mediaElement.height)),canvasElement.style.width=width+"px",canvasElement.style.height=height+"px",canvasElement.width=width,canvasElement.height=height,canvasElement}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(t=>t.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(videoElement,stream){try{videoElement.srcObject=stream}catch{videoElement.src=URL.createObjectURL(stream)}}cleanVideoSource(videoElement){try{videoElement.srcObject=null}catch{videoElement.src=""}this.videoElement.removeAttribute("src")}}class Result{constructor(text,rawBytes,numBits=rawBytes==null?0:8*rawBytes.length,resultPoints,format,timestamp=System.currentTimeMillis()){this.text=text,this.rawBytes=rawBytes,this.numBits=numBits,this.resultPoints=resultPoints,this.format=format,this.timestamp=timestamp,this.text=text,this.rawBytes=rawBytes,numBits==null?this.numBits=rawBytes==null?0:8*rawBytes.length:this.numBits=numBits,this.resultPoints=resultPoints,this.format=format,this.resultMetadata=null,timestamp==null?this.timestamp=System.currentTimeMillis():this.timestamp=timestamp}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(type,value){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(type,value)}putAllMetadata(metadata){metadata!==null&&(this.resultMetadata===null?this.resultMetadata=metadata:this.resultMetadata=new Map(metadata))}addResultPoints(newPoints){const oldPoints=this.resultPoints;if(oldPoints===null)this.resultPoints=newPoints;else if(newPoints!==null&&newPoints.length>0){const allPoints=new Array(oldPoints.length+newPoints.length);System.arraycopy(oldPoints,0,allPoints,0,oldPoints.length),System.arraycopy(newPoints,0,allPoints,oldPoints.length,newPoints.length),this.resultPoints=allPoints}}getTimestamp(){return this.timestamp}toString(){return this.text}}var BarcodeFormat;(function(BarcodeFormat2){BarcodeFormat2[BarcodeFormat2.AZTEC=0]="AZTEC",BarcodeFormat2[BarcodeFormat2.CODABAR=1]="CODABAR",BarcodeFormat2[BarcodeFormat2.CODE_39=2]="CODE_39",BarcodeFormat2[BarcodeFormat2.CODE_93=3]="CODE_93",BarcodeFormat2[BarcodeFormat2.CODE_128=4]="CODE_128",BarcodeFormat2[BarcodeFormat2.DATA_MATRIX=5]="DATA_MATRIX",BarcodeFormat2[BarcodeFormat2.EAN_8=6]="EAN_8",BarcodeFormat2[BarcodeFormat2.EAN_13=7]="EAN_13",BarcodeFormat2[BarcodeFormat2.ITF=8]="ITF",BarcodeFormat2[BarcodeFormat2.MAXICODE=9]="MAXICODE",BarcodeFormat2[BarcodeFormat2.PDF_417=10]="PDF_417",BarcodeFormat2[BarcodeFormat2.QR_CODE=11]="QR_CODE",BarcodeFormat2[BarcodeFormat2.RSS_14=12]="RSS_14",BarcodeFormat2[BarcodeFormat2.RSS_EXPANDED=13]="RSS_EXPANDED",BarcodeFormat2[BarcodeFormat2.UPC_A=14]="UPC_A",BarcodeFormat2[BarcodeFormat2.UPC_E=15]="UPC_E",BarcodeFormat2[BarcodeFormat2.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(BarcodeFormat||(BarcodeFormat={}));var BarcodeFormat$1=BarcodeFormat,ResultMetadataType;(function(ResultMetadataType2){ResultMetadataType2[ResultMetadataType2.OTHER=0]="OTHER",ResultMetadataType2[ResultMetadataType2.ORIENTATION=1]="ORIENTATION",ResultMetadataType2[ResultMetadataType2.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",ResultMetadataType2[ResultMetadataType2.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",ResultMetadataType2[ResultMetadataType2.ISSUE_NUMBER=4]="ISSUE_NUMBER",ResultMetadataType2[ResultMetadataType2.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",ResultMetadataType2[ResultMetadataType2.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",ResultMetadataType2[ResultMetadataType2.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",ResultMetadataType2[ResultMetadataType2.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",ResultMetadataType2[ResultMetadataType2.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",ResultMetadataType2[ResultMetadataType2.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ResultMetadataType||(ResultMetadataType={}));var ResultMetadataType$1=ResultMetadataType;class DecoderResult{constructor(rawBytes,text,byteSegments,ecLevel,structuredAppendSequenceNumber=-1,structuredAppendParity=-1){this.rawBytes=rawBytes,this.text=text,this.byteSegments=byteSegments,this.ecLevel=ecLevel,this.structuredAppendSequenceNumber=structuredAppendSequenceNumber,this.structuredAppendParity=structuredAppendParity,this.numBits=rawBytes==null?0:8*rawBytes.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(numBits){this.numBits=numBits}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(errorsCorrected){this.errorsCorrected=errorsCorrected}getErasures(){return this.erasures}setErasures(erasures){this.erasures=erasures}getOther(){return this.other}setOther(other){this.other=other}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class AbstractGenericGF{exp(a){return this.expTable[a]}log(a){if(a===0)throw new IllegalArgumentException;return this.logTable[a]}static addOrSubtract(a,b){return a^b}}class GenericGFPoly{constructor(field,coefficients){if(coefficients.length===0)throw new IllegalArgumentException;this.field=field;const coefficientsLength=coefficients.length;if(coefficientsLength>1&&coefficients[0]===0){let firstNonZero=1;for(;firstNonZero<coefficientsLength&&coefficients[firstNonZero]===0;)firstNonZero++;firstNonZero===coefficientsLength?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(coefficientsLength-firstNonZero),System.arraycopy(coefficients,firstNonZero,this.coefficients,0,this.coefficients.length))}else this.coefficients=coefficients}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(degree){return this.coefficients[this.coefficients.length-1-degree]}evaluateAt(a){if(a===0)return this.getCoefficient(0);const coefficients=this.coefficients;let result;if(a===1){result=0;for(let i=0,length=coefficients.length;i!==length;i++){const coefficient=coefficients[i];result=AbstractGenericGF.addOrSubtract(result,coefficient)}return result}result=coefficients[0];const size=coefficients.length,field=this.field;for(let i=1;i<size;i++)result=AbstractGenericGF.addOrSubtract(field.multiply(a,result),coefficients[i]);return result}addOrSubtract(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero())return other;if(other.isZero())return this;let smallerCoefficients=this.coefficients,largerCoefficients=other.coefficients;if(smallerCoefficients.length>largerCoefficients.length){const temp=smallerCoefficients;smallerCoefficients=largerCoefficients,largerCoefficients=temp}let sumDiff=new Int32Array(largerCoefficients.length);const lengthDiff=largerCoefficients.length-smallerCoefficients.length;System.arraycopy(largerCoefficients,0,sumDiff,0,lengthDiff);for(let i=lengthDiff;i<largerCoefficients.length;i++)sumDiff[i]=AbstractGenericGF.addOrSubtract(smallerCoefficients[i-lengthDiff],largerCoefficients[i]);return new GenericGFPoly(this.field,sumDiff)}multiply(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero()||other.isZero())return this.field.getZero();const aCoefficients=this.coefficients,aLength=aCoefficients.length,bCoefficients=other.coefficients,bLength=bCoefficients.length,product=new Int32Array(aLength+bLength-1),field=this.field;for(let i=0;i<aLength;i++){const aCoeff=aCoefficients[i];for(let j=0;j<bLength;j++)product[i+j]=AbstractGenericGF.addOrSubtract(product[i+j],field.multiply(aCoeff,bCoefficients[j]))}return new GenericGFPoly(field,product)}multiplyScalar(scalar){if(scalar===0)return this.field.getZero();if(scalar===1)return this;const size=this.coefficients.length,field=this.field,product=new Int32Array(size),coefficients=this.coefficients;for(let i=0;i<size;i++)product[i]=field.multiply(coefficients[i],scalar);return new GenericGFPoly(field,product)}multiplyByMonomial(degree,coefficient){if(degree<0)throw new IllegalArgumentException;if(coefficient===0)return this.field.getZero();const coefficients=this.coefficients,size=coefficients.length,product=new Int32Array(size+degree),field=this.field;for(let i=0;i<size;i++)product[i]=field.multiply(coefficients[i],coefficient);return new GenericGFPoly(field,product)}divide(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(other.isZero())throw new IllegalArgumentException("Divide by 0");const field=this.field;let quotient=field.getZero(),remainder=this;const denominatorLeadingTerm=other.getCoefficient(other.getDegree()),inverseDenominatorLeadingTerm=field.inverse(denominatorLeadingTerm);for(;remainder.getDegree()>=other.getDegree()&&!remainder.isZero();){const degreeDifference=remainder.getDegree()-other.getDegree(),scale=field.multiply(remainder.getCoefficient(remainder.getDegree()),inverseDenominatorLeadingTerm),term=other.multiplyByMonomial(degreeDifference,scale),iterationQuotient=field.buildMonomial(degreeDifference,scale);quotient=quotient.addOrSubtract(iterationQuotient),remainder=remainder.addOrSubtract(term)}return[quotient,remainder]}toString(){let result="";for(let degree=this.getDegree();degree>=0;degree--){let coefficient=this.getCoefficient(degree);if(coefficient!==0){if(coefficient<0?(result+=" - ",coefficient=-coefficient):result.length>0&&(result+=" + "),degree===0||coefficient!==1){const alphaPower=this.field.log(coefficient);alphaPower===0?result+="1":alphaPower===1?result+="a":(result+="a^",result+=alphaPower)}degree!==0&&(degree===1?result+="x":(result+="x^",result+=degree))}}return result}}class ArithmeticException extends Exception{}ArithmeticException.kind="ArithmeticException";class GenericGF extends AbstractGenericGF{constructor(primitive,size,generatorBase){super(),this.primitive=primitive,this.size=size,this.generatorBase=generatorBase;const expTable=new Int32Array(size);let x=1;for(let i=0;i<size;i++)expTable[i]=x,x*=2,x>=size&&(x^=primitive,x&=size-1);this.expTable=expTable;const logTable=new Int32Array(size);for(let i=0;i<size-1;i++)logTable[expTable[i]]=i;this.logTable=logTable,this.zero=new GenericGFPoly(this,Int32Array.from([0])),this.one=new GenericGFPoly(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(degree,coefficient){if(degree<0)throw new IllegalArgumentException;if(coefficient===0)return this.zero;const coefficients=new Int32Array(degree+1);return coefficients[0]=coefficient,new GenericGFPoly(this,coefficients)}inverse(a){if(a===0)throw new ArithmeticException;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,b){return a===0||b===0?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+Integer.toHexString(this.primitive)+","+this.size+")"}equals(o){return o===this}}GenericGF.AZTEC_DATA_12=new GenericGF(4201,4096,1),GenericGF.AZTEC_DATA_10=new GenericGF(1033,1024,1),GenericGF.AZTEC_DATA_6=new GenericGF(67,64,1),GenericGF.AZTEC_PARAM=new GenericGF(19,16,1),GenericGF.QR_CODE_FIELD_256=new GenericGF(285,256,0),GenericGF.DATA_MATRIX_FIELD_256=new GenericGF(301,256,1),GenericGF.AZTEC_DATA_8=GenericGF.DATA_MATRIX_FIELD_256,GenericGF.MAXICODE_FIELD_64=GenericGF.AZTEC_DATA_6;class ReedSolomonException extends Exception{}ReedSolomonException.kind="ReedSolomonException";class IllegalStateException extends Exception{}IllegalStateException.kind="IllegalStateException";class ReedSolomonDecoder{constructor(field){this.field=field}decode(received,twoS){const field=this.field,poly=new GenericGFPoly(field,received),syndromeCoefficients=new Int32Array(twoS);let noError=!0;for(let i=0;i<twoS;i++){const evalResult=poly.evaluateAt(field.exp(i+field.getGeneratorBase()));syndromeCoefficients[syndromeCoefficients.length-1-i]=evalResult,evalResult!==0&&(noError=!1)}if(noError)return;const syndrome=new GenericGFPoly(field,syndromeCoefficients),sigmaOmega=this.runEuclideanAlgorithm(field.buildMonomial(twoS,1),syndrome,twoS),sigma=sigmaOmega[0],omega=sigmaOmega[1],errorLocations=this.findErrorLocations(sigma),errorMagnitudes=this.findErrorMagnitudes(omega,errorLocations);for(let i=0;i<errorLocations.length;i++){const position=received.length-1-field.log(errorLocations[i]);if(position<0)throw new ReedSolomonException("Bad error location");received[position]=GenericGF.addOrSubtract(received[position],errorMagnitudes[i])}}runEuclideanAlgorithm(a,b,R){if(a.getDegree()<b.getDegree()){const temp=a;a=b,b=temp}const field=this.field;let rLast=a,r=b,tLast=field.getZero(),t=field.getOne();for(;r.getDegree()>=(R/2|0);){let rLastLast=rLast,tLastLast=tLast;if(rLast=r,tLast=t,rLast.isZero())throw new ReedSolomonException("r_{i-1} was zero");r=rLastLast;let q=field.getZero();const denominatorLeadingTerm=rLast.getCoefficient(rLast.getDegree()),dltInverse=field.inverse(denominatorLeadingTerm);for(;r.getDegree()>=rLast.getDegree()&&!r.isZero();){const degreeDiff=r.getDegree()-rLast.getDegree(),scale=field.multiply(r.getCoefficient(r.getDegree()),dltInverse);q=q.addOrSubtract(field.buildMonomial(degreeDiff,scale)),r=r.addOrSubtract(rLast.multiplyByMonomial(degreeDiff,scale))}if(t=q.multiply(tLast).addOrSubtract(tLastLast),r.getDegree()>=rLast.getDegree())throw new IllegalStateException("Division algorithm failed to reduce polynomial?")}const sigmaTildeAtZero=t.getCoefficient(0);if(sigmaTildeAtZero===0)throw new ReedSolomonException("sigmaTilde(0) was zero");const inverse=field.inverse(sigmaTildeAtZero),sigma=t.multiplyScalar(inverse),omega=r.multiplyScalar(inverse);return[sigma,omega]}findErrorLocations(errorLocator){const numErrors=errorLocator.getDegree();if(numErrors===1)return Int32Array.from([errorLocator.getCoefficient(1)]);const result=new Int32Array(numErrors);let e=0;const field=this.field;for(let i=1;i<field.getSize()&&e<numErrors;i++)errorLocator.evaluateAt(i)===0&&(result[e]=field.inverse(i),e++);if(e!==numErrors)throw new ReedSolomonException("Error locator degree does not match number of roots");return result}findErrorMagnitudes(errorEvaluator,errorLocations){const s=errorLocations.length,result=new Int32Array(s),field=this.field;for(let i=0;i<s;i++){const xiInverse=field.inverse(errorLocations[i]);let denominator=1;for(let j=0;j<s;j++)if(i!==j){const term=field.multiply(errorLocations[j],xiInverse),termPlus1=term&1?term&-2:term|1;denominator=field.multiply(denominator,termPlus1)}result[i]=field.multiply(errorEvaluator.evaluateAt(xiInverse),field.inverse(denominator)),field.getGeneratorBase()!==0&&(result[i]=field.multiply(result[i],xiInverse))}return result}}var Table;(function(Table2){Table2[Table2.UPPER=0]="UPPER",Table2[Table2.LOWER=1]="LOWER",Table2[Table2.MIXED=2]="MIXED",Table2[Table2.DIGIT=3]="DIGIT",Table2[Table2.PUNCT=4]="PUNCT",Table2[Table2.BINARY=5]="BINARY"})(Table||(Table={}));class Decoder{decode(detectorResult){this.ddata=detectorResult;let matrix=detectorResult.getBits(),rawbits=this.extractBits(matrix),correctedBits=this.correctBits(rawbits),rawBytes=Decoder.convertBoolArrayToByteArray(correctedBits),result=Decoder.getEncodedData(correctedBits),decoderResult=new DecoderResult(rawBytes,result,null,null);return decoderResult.setNumBits(correctedBits.length),decoderResult}static highLevelDecode(correctedBits){return this.getEncodedData(correctedBits)}static getEncodedData(correctedBits){let endIndex=correctedBits.length,latchTable=Table.UPPER,shiftTable=Table.UPPER,result="",index=0;for(;index<endIndex;)if(shiftTable===Table.BINARY){if(endIndex-index<5)break;let length=Decoder.readCode(correctedBits,index,5);if(index+=5,length===0){if(endIndex-index<11)break;length=Decoder.readCode(correctedBits,index,11)+31,index+=11}for(let charCount=0;charCount<length;charCount++){if(endIndex-index<8){index=endIndex;break}const code=Decoder.readCode(correctedBits,index,8);result+=StringUtils.castAsNonUtf8Char(code),index+=8}shiftTable=latchTable}else{let size=shiftTable===Table.DIGIT?4:5;if(endIndex-index<size)break;let code=Decoder.readCode(correctedBits,index,size);index+=size;let str=Decoder.getCharacter(shiftTable,code);str.startsWith("CTRL_")?(latchTable=shiftTable,shiftTable=Decoder.getTable(str.charAt(5)),str.charAt(6)==="L"&&(latchTable=shiftTable)):(result+=str,shiftTable=latchTable)}return result}static getTable(t){switch(t){case"L":return Table.LOWER;case"P":return Table.PUNCT;case"M":return Table.MIXED;case"D":return Table.DIGIT;case"B":return Table.BINARY;case"U":default:return Table.UPPER}}static getCharacter(table,code){switch(table){case Table.UPPER:return Decoder.UPPER_TABLE[code];case Table.LOWER:return Decoder.LOWER_TABLE[code];case Table.MIXED:return Decoder.MIXED_TABLE[code];case Table.PUNCT:return Decoder.PUNCT_TABLE[code];case Table.DIGIT:return Decoder.DIGIT_TABLE[code];default:throw new IllegalStateException("Bad table")}}correctBits(rawbits){let gf,codewordSize;this.ddata.getNbLayers()<=2?(codewordSize=6,gf=GenericGF.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(codewordSize=8,gf=GenericGF.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(codewordSize=10,gf=GenericGF.AZTEC_DATA_10):(codewordSize=12,gf=GenericGF.AZTEC_DATA_12);let numDataCodewords=this.ddata.getNbDatablocks(),numCodewords=rawbits.length/codewordSize;if(numCodewords<numDataCodewords)throw new FormatException;let offset=rawbits.length%codewordSize,dataWords=new Int32Array(numCodewords);for(let i=0;i<numCodewords;i++,offset+=codewordSize)dataWords[i]=Decoder.readCode(rawbits,offset,codewordSize);try{new ReedSolomonDecoder(gf).decode(dataWords,numCodewords-numDataCodewords)}catch(ex){throw new FormatException(ex)}let mask=(1<<codewordSize)-1,stuffedBits=0;for(let i=0;i<numDataCodewords;i++){let dataWord=dataWords[i];if(dataWord===0||dataWord===mask)throw new FormatException;(dataWord===1||dataWord===mask-1)&&stuffedBits++}let correctedBits=new Array(numDataCodewords*codewordSize-stuffedBits),index=0;for(let i=0;i<numDataCodewords;i++){let dataWord=dataWords[i];if(dataWord===1||dataWord===mask-1)correctedBits.fill(dataWord>1,index,index+codewordSize-1),index+=codewordSize-1;else for(let bit=codewordSize-1;bit>=0;--bit)correctedBits[index++]=(dataWord&1<<bit)!==0}return correctedBits}extractBits(matrix){let compact=this.ddata.isCompact(),layers=this.ddata.getNbLayers(),baseMatrixSize=(compact?11:14)+layers*4,alignmentMap=new Int32Array(baseMatrixSize),rawbits=new Array(this.totalBitsInLayer(layers,compact));if(compact)for(let i=0;i<alignmentMap.length;i++)alignmentMap[i]=i;else{let matrixSize=baseMatrixSize+1+2*Integer.truncDivision(Integer.truncDivision(baseMatrixSize,2)-1,15),origCenter=baseMatrixSize/2,center=Integer.truncDivision(matrixSize,2);for(let i=0;i<origCenter;i++){let newOffset=i+Integer.truncDivision(i,15);alignmentMap[origCenter-i-1]=center-newOffset-1,alignmentMap[origCenter+i]=center+newOffset+1}}for(let i=0,rowOffset=0;i<layers;i++){let rowSize=(layers-i)*4+(compact?9:12),low=i*2,high=baseMatrixSize-1-low;for(let j=0;j<rowSize;j++){let columnOffset=j*2;for(let k=0;k<2;k++)rawbits[rowOffset+columnOffset+k]=matrix.get(alignmentMap[low+k],alignmentMap[low+j]),rawbits[rowOffset+2*rowSize+columnOffset+k]=matrix.get(alignmentMap[low+j],alignmentMap[high-k]),rawbits[rowOffset+4*rowSize+columnOffset+k]=matrix.get(alignmentMap[high-k],alignmentMap[high-j]),rawbits[rowOffset+6*rowSize+columnOffset+k]=matrix.get(alignmentMap[high-j],alignmentMap[low+k])}rowOffset+=rowSize*8}return rawbits}static readCode(rawbits,startIndex,length){let res=0;for(let i=startIndex;i<startIndex+length;i++)res<<=1,rawbits[i]&&(res|=1);return res}static readByte(rawbits,startIndex){let n=rawbits.length-startIndex;return n>=8?Decoder.readCode(rawbits,startIndex,8):Decoder.readCode(rawbits,startIndex,n)<<8-n}static convertBoolArrayToByteArray(boolArr){let byteArr=new Uint8Array((boolArr.length+7)/8);for(let i=0;i<byteArr.length;i++)byteArr[i]=Decoder.readByte(boolArr,8*i);return byteArr}totalBitsInLayer(layers,compact){return((compact?88:112)+16*layers)*layers}}Decoder.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Decoder.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Decoder.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Decoder.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Decoder.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class MathUtils{constructor(){}static round(d){return d===NaN?0:d<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:d>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:d+(d<0?-.5:.5)|0}static distance(aX,aY,bX,bY){const xDiff=aX-bX,yDiff=aY-bY;return Math.sqrt(xDiff*xDiff+yDiff*yDiff)}static sum(array){let count=0;for(let i=0,length=array.length;i!==length;i++){const a=array[i];count+=a}return count}}class Float{static floatToIntBits(f){return f}}Float.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ResultPoint{constructor(x,y){this.x=x,this.y=y}getX(){return this.x}getY(){return this.y}equals(other){if(other instanceof ResultPoint){const otherPoint=other;return this.x===otherPoint.x&&this.y===otherPoint.y}return!1}hashCode(){return 31*Float.floatToIntBits(this.x)+Float.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(patterns){const zeroOneDistance=this.distance(patterns[0],patterns[1]),oneTwoDistance=this.distance(patterns[1],patterns[2]),zeroTwoDistance=this.distance(patterns[0],patterns[2]);let pointA,pointB,pointC;if(oneTwoDistance>=zeroOneDistance&&oneTwoDistance>=zeroTwoDistance?(pointB=patterns[0],pointA=patterns[1],pointC=patterns[2]):zeroTwoDistance>=oneTwoDistance&&zeroTwoDistance>=zeroOneDistance?(pointB=patterns[1],pointA=patterns[0],pointC=patterns[2]):(pointB=patterns[2],pointA=patterns[0],pointC=patterns[1]),this.crossProductZ(pointA,pointB,pointC)<0){const temp=pointA;pointA=pointC,pointC=temp}patterns[0]=pointA,patterns[1]=pointB,patterns[2]=pointC}static distance(pattern1,pattern2){return MathUtils.distance(pattern1.x,pattern1.y,pattern2.x,pattern2.y)}static crossProductZ(pointA,pointB,pointC){const bX=pointB.x,bY=pointB.y;return(pointC.x-bX)*(pointA.y-bY)-(pointC.y-bY)*(pointA.x-bX)}}class DetectorResult{constructor(bits,points){this.bits=bits,this.points=points}getBits(){return this.bits}getPoints(){return this.points}}class AztecDetectorResult extends DetectorResult{constructor(bits,points,compact,nbDatablocks,nbLayers){super(bits,points),this.compact=compact,this.nbDatablocks=nbDatablocks,this.nbLayers=nbLayers}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class WhiteRectangleDetector{constructor(image,initSize,x,y){this.image=image,this.height=image.getHeight(),this.width=image.getWidth(),initSize==null&&(initSize=WhiteRectangleDetector.INIT_SIZE),x==null&&(x=image.getWidth()/2|0),y==null&&(y=image.getHeight()/2|0);const halfsize=initSize/2|0;if(this.leftInit=x-halfsize,this.rightInit=x+halfsize,this.upInit=y-halfsize,this.downInit=y+halfsize,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new NotFoundException}detect(){let left=this.leftInit,right=this.rightInit,up=this.upInit,down=this.downInit,sizeExceeded=!1,aBlackPointFoundOnBorder=!0,atLeastOneBlackPointFoundOnBorder=!1,atLeastOneBlackPointFoundOnRight=!1,atLeastOneBlackPointFoundOnBottom=!1,atLeastOneBlackPointFoundOnLeft=!1,atLeastOneBlackPointFoundOnTop=!1;const width=this.width,height=this.height;for(;aBlackPointFoundOnBorder;){aBlackPointFoundOnBorder=!1;let rightBorderNotWhite=!0;for(;(rightBorderNotWhite||!atLeastOneBlackPointFoundOnRight)&&right<width;)rightBorderNotWhite=this.containsBlackPoint(up,down,right,!1),rightBorderNotWhite?(right++,aBlackPointFoundOnBorder=!0,atLeastOneBlackPointFoundOnRight=!0):atLeastOneBlackPointFoundOnRight||right++;if(right>=width){sizeExceeded=!0;break}let bottomBorderNotWhite=!0;for(;(bottomBorderNotWhite||!atLeastOneBlackPointFoundOnBottom)&&down<height;)bottomBorderNotWhite=this.containsBlackPoint(left,right,down,!0),bottomBorderNotWhite?(down++,aBlackPointFoundOnBorder=!0,atLeastOneBlackPointFoundOnBottom=!0):atLeastOneBlackPointFoundOnBottom||down++;if(down>=height){sizeExceeded=!0;break}let leftBorderNotWhite=!0;for(;(leftBorderNotWhite||!atLeastOneBlackPointFoundOnLeft)&&left>=0;)leftBorderNotWhite=this.containsBlackPoint(up,down,left,!1),leftBorderNotWhite?(left--,aBlackPointFoundOnBorder=!0,atLeastOneBlackPointFoundOnLeft=!0):atLeastOneBlackPointFoundOnLeft||left--;if(left<0){sizeExceeded=!0;break}let topBorderNotWhite=!0;for(;(topBorderNotWhite||!atLeastOneBlackPointFoundOnTop)&&up>=0;)topBorderNotWhite=this.containsBlackPoint(left,right,up,!0),topBorderNotWhite?(up--,aBlackPointFoundOnBorder=!0,atLeastOneBlackPointFoundOnTop=!0):atLeastOneBlackPointFoundOnTop||up--;if(up<0){sizeExceeded=!0;break}aBlackPointFoundOnBorder&&(atLeastOneBlackPointFoundOnBorder=!0)}if(!sizeExceeded&&atLeastOneBlackPointFoundOnBorder){const maxSize=right-left;let z=null;for(let i=1;z===null&&i<maxSize;i++)z=this.getBlackPointOnSegment(left,down-i,left+i,down);if(z==null)throw new NotFoundException;let t=null;for(let i=1;t===null&&i<maxSize;i++)t=this.getBlackPointOnSegment(left,up+i,left+i,up);if(t==null)throw new NotFoundException;let x=null;for(let i=1;x===null&&i<maxSize;i++)x=this.getBlackPointOnSegment(right,up+i,right-i,up);if(x==null)throw new NotFoundException;let y=null;for(let i=1;y===null&&i<maxSize;i++)y=this.getBlackPointOnSegment(right,down-i,right-i,down);if(y==null)throw new NotFoundException;return this.centerEdges(y,z,x,t)}else throw new NotFoundException}getBlackPointOnSegment(aX,aY,bX,bY){const dist=MathUtils.round(MathUtils.distance(aX,aY,bX,bY)),xStep=(bX-aX)/dist,yStep=(bY-aY)/dist,image=this.image;for(let i=0;i<dist;i++){const x=MathUtils.round(aX+i*xStep),y=MathUtils.round(aY+i*yStep);if(image.get(x,y))return new ResultPoint(x,y)}return null}centerEdges(y,z,x,t){const yi=y.getX(),yj=y.getY(),zi=z.getX(),zj=z.getY(),xi=x.getX(),xj=x.getY(),ti=t.getX(),tj=t.getY(),CORR=WhiteRectangleDetector.CORR;return yi<this.width/2?[new ResultPoint(ti-CORR,tj+CORR),new ResultPoint(zi+CORR,zj+CORR),new ResultPoint(xi-CORR,xj-CORR),new ResultPoint(yi+CORR,yj-CORR)]:[new ResultPoint(ti+CORR,tj+CORR),new ResultPoint(zi+CORR,zj-CORR),new ResultPoint(xi-CORR,xj+CORR),new ResultPoint(yi-CORR,yj-CORR)]}containsBlackPoint(a,b,fixed,horizontal){const image=this.image;if(horizontal){for(let x=a;x<=b;x++)if(image.get(x,fixed))return!0}else for(let y=a;y<=b;y++)if(image.get(fixed,y))return!0;return!1}}WhiteRectangleDetector.INIT_SIZE=10,WhiteRectangleDetector.CORR=1;class GridSampler{static checkAndNudgePoints(image,points){const width=image.getWidth(),height=image.getHeight();let nudged=!0;for(let offset=0;offset<points.length&&nudged;offset+=2){const x=Math.floor(points[offset]),y=Math.floor(points[offset+1]);if(x<-1||x>width||y<-1||y>height)throw new NotFoundException;nudged=!1,x===-1?(points[offset]=0,nudged=!0):x===width&&(points[offset]=width-1,nudged=!0),y===-1?(points[offset+1]=0,nudged=!0):y===height&&(points[offset+1]=height-1,nudged=!0)}nudged=!0;for(let offset=points.length-2;offset>=0&&nudged;offset-=2){const x=Math.floor(points[offset]),y=Math.floor(points[offset+1]);if(x<-1||x>width||y<-1||y>height)throw new NotFoundException;nudged=!1,x===-1?(points[offset]=0,nudged=!0):x===width&&(points[offset]=width-1,nudged=!0),y===-1?(points[offset+1]=0,nudged=!0):y===height&&(points[offset+1]=height-1,nudged=!0)}}}class PerspectiveTransform{constructor(a11,a21,a31,a12,a22,a32,a13,a23,a33){this.a11=a11,this.a21=a21,this.a31=a31,this.a12=a12,this.a22=a22,this.a32=a32,this.a13=a13,this.a23=a23,this.a33=a33}static quadrilateralToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3,x0p,y0p,x1p,y1p,x2p,y2p,x3p,y3p){const qToS=PerspectiveTransform.quadrilateralToSquare(x0,y0,x1,y1,x2,y2,x3,y3);return PerspectiveTransform.squareToQuadrilateral(x0p,y0p,x1p,y1p,x2p,y2p,x3p,y3p).times(qToS)}transformPoints(points){const max=points.length,a11=this.a11,a12=this.a12,a13=this.a13,a21=this.a21,a22=this.a22,a23=this.a23,a31=this.a31,a32=this.a32,a33=this.a33;for(let i=0;i<max;i+=2){const x=points[i],y=points[i+1],denominator=a13*x+a23*y+a33;points[i]=(a11*x+a21*y+a31)/denominator,points[i+1]=(a12*x+a22*y+a32)/denominator}}transformPointsWithValues(xValues,yValues){const a11=this.a11,a12=this.a12,a13=this.a13,a21=this.a21,a22=this.a22,a23=this.a23,a31=this.a31,a32=this.a32,a33=this.a33,n=xValues.length;for(let i=0;i<n;i++){const x=xValues[i],y=yValues[i],denominator=a13*x+a23*y+a33;xValues[i]=(a11*x+a21*y+a31)/denominator,yValues[i]=(a12*x+a22*y+a32)/denominator}}static squareToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3){const dx3=x0-x1+x2-x3,dy3=y0-y1+y2-y3;if(dx3===0&&dy3===0)return new PerspectiveTransform(x1-x0,x2-x1,x0,y1-y0,y2-y1,y0,0,0,1);{const dx1=x1-x2,dx2=x3-x2,dy1=y1-y2,dy2=y3-y2,denominator=dx1*dy2-dx2*dy1,a13=(dx3*dy2-dx2*dy3)/denominator,a23=(dx1*dy3-dx3*dy1)/denominator;return new PerspectiveTransform(x1-x0+a13*x1,x3-x0+a23*x3,x0,y1-y0+a13*y1,y3-y0+a23*y3,y0,a13,a23,1)}}static quadrilateralToSquare(x0,y0,x1,y1,x2,y2,x3,y3){return PerspectiveTransform.squareToQuadrilateral(x0,y0,x1,y1,x2,y2,x3,y3).buildAdjoint()}buildAdjoint(){return new PerspectiveTransform(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(other){return new PerspectiveTransform(this.a11*other.a11+this.a21*other.a12+this.a31*other.a13,this.a11*other.a21+this.a21*other.a22+this.a31*other.a23,this.a11*other.a31+this.a21*other.a32+this.a31*other.a33,this.a12*other.a11+this.a22*other.a12+this.a32*other.a13,this.a12*other.a21+this.a22*other.a22+this.a32*other.a23,this.a12*other.a31+this.a22*other.a32+this.a32*other.a33,this.a13*other.a11+this.a23*other.a12+this.a33*other.a13,this.a13*other.a21+this.a23*other.a22+this.a33*other.a23,this.a13*other.a31+this.a23*other.a32+this.a33*other.a33)}}class DefaultGridSampler extends GridSampler{sampleGrid(image,dimensionX,dimensionY,p1ToX,p1ToY,p2ToX,p2ToY,p3ToX,p3ToY,p4ToX,p4ToY,p1FromX,p1FromY,p2FromX,p2FromY,p3FromX,p3FromY,p4FromX,p4FromY){const transform=PerspectiveTransform.quadrilateralToQuadrilateral(p1ToX,p1ToY,p2ToX,p2ToY,p3ToX,p3ToY,p4ToX,p4ToY,p1FromX,p1FromY,p2FromX,p2FromY,p3FromX,p3FromY,p4FromX,p4FromY);return this.sampleGridWithTransform(image,dimensionX,dimensionY,transform)}sampleGridWithTransform(image,dimensionX,dimensionY,transform){if(dimensionX<=0||dimensionY<=0)throw new NotFoundException;const bits=new BitMatrix(dimensionX,dimensionY),points=new Float32Array(2*dimensionX);for(let y=0;y<dimensionY;y++){const max=points.length,iValue=y+.5;for(let x=0;x<max;x+=2)points[x]=x/2+.5,points[x+1]=iValue;transform.transformPoints(points),GridSampler.checkAndNudgePoints(image,points);try{for(let x=0;x<max;x+=2)image.get(Math.floor(points[x]),Math.floor(points[x+1]))&&bits.set(x/2,y)}catch{throw new NotFoundException}}return bits}}class GridSamplerInstance{static setGridSampler(newGridSampler){GridSamplerInstance.gridSampler=newGridSampler}static getInstance(){return GridSamplerInstance.gridSampler}}GridSamplerInstance.gridSampler=new DefaultGridSampler;class Point{constructor(x,y){this.x=x,this.y=y}toResultPoint(){return new ResultPoint(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Detector{constructor(image){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=image}detect(){return this.detectMirror(!1)}detectMirror(isMirror){let pCenter=this.getMatrixCenter(),bullsEyeCorners=this.getBullsEyeCorners(pCenter);if(isMirror){let temp=bullsEyeCorners[0];bullsEyeCorners[0]=bullsEyeCorners[2],bullsEyeCorners[2]=temp}this.extractParameters(bullsEyeCorners);let bits=this.sampleGrid(this.image,bullsEyeCorners[this.shift%4],bullsEyeCorners[(this.shift+1)%4],bullsEyeCorners[(this.shift+2)%4],bullsEyeCorners[(this.shift+3)%4]),corners=this.getMatrixCornerPoints(bullsEyeCorners);return new AztecDetectorResult(bits,corners,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(bullsEyeCorners){if(!this.isValidPoint(bullsEyeCorners[0])||!this.isValidPoint(bullsEyeCorners[1])||!this.isValidPoint(bullsEyeCorners[2])||!this.isValidPoint(bullsEyeCorners[3]))throw new NotFoundException;let length=2*this.nbCenterLayers,sides=new Int32Array([this.sampleLine(bullsEyeCorners[0],bullsEyeCorners[1],length),this.sampleLine(bullsEyeCorners[1],bullsEyeCorners[2],length),this.sampleLine(bullsEyeCorners[2],bullsEyeCorners[3],length),this.sampleLine(bullsEyeCorners[3],bullsEyeCorners[0],length)]);this.shift=this.getRotation(sides,length);let parameterData=0;for(let i=0;i<4;i++){let side=sides[(this.shift+i)%4];this.compact?(parameterData<<=7,parameterData+=side>>1&127):(parameterData<<=10,parameterData+=(side>>2&992)+(side>>1&31))}let correctedData=this.getCorrectedParameterData(parameterData,this.compact);this.compact?(this.nbLayers=(correctedData>>6)+1,this.nbDataBlocks=(correctedData&63)+1):(this.nbLayers=(correctedData>>11)+1,this.nbDataBlocks=(correctedData&2047)+1)}getRotation(sides,length){let cornerBits=0;sides.forEach((side,idx,arr)=>{let t=(side>>length-2<<1)+(side&1);cornerBits=(cornerBits<<3)+t}),cornerBits=((cornerBits&1)<<11)+(cornerBits>>1);for(let shift=0;shift<4;shift++)if(Integer.bitCount(cornerBits^this.EXPECTED_CORNER_BITS[shift])<=2)return shift;throw new NotFoundException}getCorrectedParameterData(parameterData,compact){let numCodewords,numDataCodewords;compact?(numCodewords=7,numDataCodewords=2):(numCodewords=10,numDataCodewords=4);let numECCodewords=numCodewords-numDataCodewords,parameterWords=new Int32Array(numCodewords);for(let i=numCodewords-1;i>=0;--i)parameterWords[i]=parameterData&15,parameterData>>=4;try{new ReedSolomonDecoder(GenericGF.AZTEC_PARAM).decode(parameterWords,numECCodewords)}catch{throw new NotFoundException}let result=0;for(let i=0;i<numDataCodewords;i++)result=(result<<4)+parameterWords[i];return result}getBullsEyeCorners(pCenter){let pina=pCenter,pinb=pCenter,pinc=pCenter,pind=pCenter,color=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let pouta=this.getFirstDifferent(pina,color,1,-1),poutb=this.getFirstDifferent(pinb,color,1,1),poutc=this.getFirstDifferent(pinc,color,-1,1),poutd=this.getFirstDifferent(pind,color,-1,-1);if(this.nbCenterLayers>2){let q=this.distancePoint(poutd,pouta)*this.nbCenterLayers/(this.distancePoint(pind,pina)*(this.nbCenterLayers+2));if(q<.75||q>1.25||!this.isWhiteOrBlackRectangle(pouta,poutb,poutc,poutd))break}pina=pouta,pinb=poutb,pinc=poutc,pind=poutd,color=!color}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new NotFoundException;this.compact=this.nbCenterLayers===5;let pinax=new ResultPoint(pina.getX()+.5,pina.getY()-.5),pinbx=new ResultPoint(pinb.getX()+.5,pinb.getY()+.5),pincx=new ResultPoint(pinc.getX()-.5,pinc.getY()+.5),pindx=new ResultPoint(pind.getX()-.5,pind.getY()-.5);return this.expandSquare([pinax,pinbx,pincx,pindx],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let pointA,pointB,pointC,pointD;try{let cornerPoints=new WhiteRectangleDetector(this.image).detect();pointA=cornerPoints[0],pointB=cornerPoints[1],pointC=cornerPoints[2],pointD=cornerPoints[3]}catch{let cx2=this.image.getWidth()/2,cy2=this.image.getHeight()/2;pointA=this.getFirstDifferent(new Point(cx2+7,cy2-7),!1,1,-1).toResultPoint(),pointB=this.getFirstDifferent(new Point(cx2+7,cy2+7),!1,1,1).toResultPoint(),pointC=this.getFirstDifferent(new Point(cx2-7,cy2+7),!1,-1,1).toResultPoint(),pointD=this.getFirstDifferent(new Point(cx2-7,cy2-7),!1,-1,-1).toResultPoint()}let cx=MathUtils.round((pointA.getX()+pointD.getX()+pointB.getX()+pointC.getX())/4),cy=MathUtils.round((pointA.getY()+pointD.getY()+pointB.getY()+pointC.getY())/4);try{let cornerPoints=new WhiteRectangleDetector(this.image,15,cx,cy).detect();pointA=cornerPoints[0],pointB=cornerPoints[1],pointC=cornerPoints[2],pointD=cornerPoints[3]}catch{pointA=this.getFirstDifferent(new Point(cx+7,cy-7),!1,1,-1).toResultPoint(),pointB=this.getFirstDifferent(new Point(cx+7,cy+7),!1,1,1).toResultPoint(),pointC=this.getFirstDifferent(new Point(cx-7,cy+7),!1,-1,1).toResultPoint(),pointD=this.getFirstDifferent(new Point(cx-7,cy-7),!1,-1,-1).toResultPoint()}return cx=MathUtils.round((pointA.getX()+pointD.getX()+pointB.getX()+pointC.getX())/4),cy=MathUtils.round((pointA.getY()+pointD.getY()+pointB.getY()+pointC.getY())/4),new Point(cx,cy)}getMatrixCornerPoints(bullsEyeCorners){return this.expandSquare(bullsEyeCorners,2*this.nbCenterLayers,this.getDimension())}sampleGrid(image,topLeft,topRight,bottomRight,bottomLeft){let sampler=GridSamplerInstance.getInstance(),dimension=this.getDimension(),low=dimension/2-this.nbCenterLayers,high=dimension/2+this.nbCenterLayers;return sampler.sampleGrid(image,dimension,dimension,low,low,high,low,high,high,low,high,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRight.getX(),bottomRight.getY(),bottomLeft.getX(),bottomLeft.getY())}sampleLine(p1,p2,size){let result=0,d=this.distanceResultPoint(p1,p2),moduleSize=d/size,px=p1.getX(),py=p1.getY(),dx=moduleSize*(p2.getX()-p1.getX())/d,dy=moduleSize*(p2.getY()-p1.getY())/d;for(let i=0;i<size;i++)this.image.get(MathUtils.round(px+i*dx),MathUtils.round(py+i*dy))&&(result|=1<<size-i-1);return result}isWhiteOrBlackRectangle(p1,p2,p3,p4){let corr=3;p1=new Point(p1.getX()-corr,p1.getY()+corr),p2=new Point(p2.getX()-corr,p2.getY()-corr),p3=new Point(p3.getX()+corr,p3.getY()-corr),p4=new Point(p4.getX()+corr,p4.getY()+corr);let cInit=this.getColor(p4,p1);if(cInit===0)return!1;let c=this.getColor(p1,p2);return c!==cInit||(c=this.getColor(p2,p3),c!==cInit)?!1:(c=this.getColor(p3,p4),c===cInit)}getColor(p1,p2){let d=this.distancePoint(p1,p2),dx=(p2.getX()-p1.getX())/d,dy=(p2.getY()-p1.getY())/d,error=0,px=p1.getX(),py=p1.getY(),colorModel=this.image.get(p1.getX(),p1.getY()),iMax=Math.ceil(d);for(let i=0;i<iMax;i++)px+=dx,py+=dy,this.image.get(MathUtils.round(px),MathUtils.round(py))!==colorModel&&error++;let errRatio=error/d;return errRatio>.1&&errRatio<.9?0:errRatio<=.1===colorModel?1:-1}getFirstDifferent(init,color,dx,dy){let x=init.getX()+dx,y=init.getY()+dy;for(;this.isValid(x,y)&&this.image.get(x,y)===color;)x+=dx,y+=dy;for(x-=dx,y-=dy;this.isValid(x,y)&&this.image.get(x,y)===color;)x+=dx;for(x-=dx;this.isValid(x,y)&&this.image.get(x,y)===color;)y+=dy;return y-=dy,new Point(x,y)}expandSquare(cornerPoints,oldSide,newSide){let ratio=newSide/(2*oldSide),dx=cornerPoints[0].getX()-cornerPoints[2].getX(),dy=cornerPoints[0].getY()-cornerPoints[2].getY(),centerx=(cornerPoints[0].getX()+cornerPoints[2].getX())/2,centery=(cornerPoints[0].getY()+cornerPoints[2].getY())/2,result0=new ResultPoint(centerx+ratio*dx,centery+ratio*dy),result2=new ResultPoint(centerx-ratio*dx,centery-ratio*dy);dx=cornerPoints[1].getX()-cornerPoints[3].getX(),dy=cornerPoints[1].getY()-cornerPoints[3].getY(),centerx=(cornerPoints[1].getX()+cornerPoints[3].getX())/2,centery=(cornerPoints[1].getY()+cornerPoints[3].getY())/2;let result1=new ResultPoint(centerx+ratio*dx,centery+ratio*dy),result3=new ResultPoint(centerx-ratio*dx,centery-ratio*dy);return[result0,result1,result2,result3]}isValid(x,y){return x>=0&&x<this.image.getWidth()&&y>0&&y<this.image.getHeight()}isValidPoint(point){let x=MathUtils.round(point.getX()),y=MathUtils.round(point.getY());return this.isValid(x,y)}distancePoint(a,b){return MathUtils.distance(a.getX(),a.getY(),b.getX(),b.getY())}distanceResultPoint(a,b){return MathUtils.distance(a.getX(),a.getY(),b.getX(),b.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Integer.truncDivision(this.nbLayers-4,8)+1)+15}}class AztecReader{decode(image,hints=null){let exception=null,detector=new Detector(image.getBlackMatrix()),points=null,decoderResult=null;try{let detectorResult=detector.detectMirror(!1);points=detectorResult.getPoints(),this.reportFoundResultPoints(hints,points),decoderResult=new Decoder().decode(detectorResult)}catch(e){exception=e}if(decoderResult==null)try{let detectorResult=detector.detectMirror(!0);points=detectorResult.getPoints(),this.reportFoundResultPoints(hints,points),decoderResult=new Decoder().decode(detectorResult)}catch(e){throw exception??e}let result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),decoderResult.getNumBits(),points,BarcodeFormat$1.AZTEC,System.currentTimeMillis()),byteSegments=decoderResult.getByteSegments();byteSegments!=null&&result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);let ecLevel=decoderResult.getECLevel();return ecLevel!=null&&result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel),result}reportFoundResultPoints(hints,points){if(hints!=null){let rpcb=hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);rpcb!=null&&points.forEach((point,idx,arr)=>{rpcb.foundPossibleResultPoint(point)})}}reset(){}}class BrowserAztecCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new AztecReader,timeBetweenScansMillis)}}class OneDReader{decode(image,hints){try{return this.doDecode(image,hints)}catch{if(hints&&hints.get(DecodeHintType$1.TRY_HARDER)===!0&&image.isRotateSupported()){const rotatedImage=image.rotateCounterClockwise(),result=this.doDecode(rotatedImage,hints),metadata=result.getResultMetadata();let orientation=270;metadata!==null&&metadata.get(ResultMetadataType$1.ORIENTATION)===!0&&(orientation=orientation+metadata.get(ResultMetadataType$1.ORIENTATION)%360),result.putMetadata(ResultMetadataType$1.ORIENTATION,orientation);const points=result.getResultPoints();if(points!==null){const height=rotatedImage.getHeight();for(let i=0;i<points.length;i++)points[i]=new ResultPoint(height-points[i].getY()-1,points[i].getX())}return result}else throw new NotFoundException}}reset(){}doDecode(image,hints){const width=image.getWidth(),height=image.getHeight();let row=new BitArray(width);const tryHarder=hints&&hints.get(DecodeHintType$1.TRY_HARDER)===!0,rowStep=Math.max(1,height>>(tryHarder?8:5));let maxLines;tryHarder?maxLines=height:maxLines=15;const middle=Math.trunc(height/2);for(let x=0;x<maxLines;x++){const rowStepsAboveOrBelow=Math.trunc((x+1)/2),isAbove=(x&1)===0,rowNumber=middle+rowStep*(isAbove?rowStepsAboveOrBelow:-rowStepsAboveOrBelow);if(rowNumber<0||rowNumber>=height)break;try{row=image.getBlackRow(rowNumber,row)}catch{continue}for(let attempt=0;attempt<2;attempt++){if(attempt===1&&(row.reverse(),hints&&hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK)===!0)){const newHints=new Map;hints.forEach((hint,key)=>newHints.set(key,hint)),newHints.delete(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK),hints=newHints}try{const result=this.decodeRow(rowNumber,row,hints);if(attempt===1){result.putMetadata(ResultMetadataType$1.ORIENTATION,180);const points=result.getResultPoints();points!==null&&(points[0]=new ResultPoint(width-points[0].getX()-1,points[0].getY()),points[1]=new ResultPoint(width-points[1].getX()-1,points[1].getY()))}return result}catch{}}}throw new NotFoundException}static recordPattern(row,start,counters){const numCounters=counters.length;for(let index=0;index<numCounters;index++)counters[index]=0;const end=row.getSize();if(start>=end)throw new NotFoundException;let isWhite=!row.get(start),counterPosition=0,i=start;for(;i<end;){if(row.get(i)!==isWhite)counters[counterPosition]++;else{if(++counterPosition===numCounters)break;counters[counterPosition]=1,isWhite=!isWhite}i++}if(!(counterPosition===numCounters||counterPosition===numCounters-1&&i===end))throw new NotFoundException}static recordPatternInReverse(row,start,counters){let numTransitionsLeft=counters.length,last=row.get(start);for(;start>0&&numTransitionsLeft>=0;)row.get(--start)!==last&&(numTransitionsLeft--,last=!last);if(numTransitionsLeft>=0)throw new NotFoundException;OneDReader.recordPattern(row,start+1,counters)}static patternMatchVariance(counters,pattern,maxIndividualVariance){const numCounters=counters.length;let total=0,patternLength=0;for(let i=0;i<numCounters;i++)total+=counters[i],patternLength+=pattern[i];if(total<patternLength)return Number.POSITIVE_INFINITY;const unitBarWidth=total/patternLength;maxIndividualVariance*=unitBarWidth;let totalVariance=0;for(let x=0;x<numCounters;x++){const counter=counters[x],scaledPattern=pattern[x]*unitBarWidth,variance=counter>scaledPattern?counter-scaledPattern:scaledPattern-counter;if(variance>maxIndividualVariance)return Number.POSITIVE_INFINITY;totalVariance+=variance}return totalVariance/total}}class Code128Reader extends OneDReader{static findStartPattern(row){const width=row.getSize(),rowOffset=row.getNextSet(0);let counterPosition=0,counters=Int32Array.from([0,0,0,0,0,0]),patternStart=rowOffset,isWhite=!1;const patternLength=6;for(let i=rowOffset;i<width;i++)if(row.get(i)!==isWhite)counters[counterPosition]++;else{if(counterPosition===patternLength-1){let bestVariance=Code128Reader.MAX_AVG_VARIANCE,bestMatch=-1;for(let startCode=Code128Reader.CODE_START_A;startCode<=Code128Reader.CODE_START_C;startCode++){const variance=OneDReader.patternMatchVariance(counters,Code128Reader.CODE_PATTERNS[startCode],Code128Reader.MAX_INDIVIDUAL_VARIANCE);variance<bestVariance&&(bestVariance=variance,bestMatch=startCode)}if(bestMatch>=0&&row.isRange(Math.max(0,patternStart-(i-patternStart)/2),patternStart,!1))return Int32Array.from([patternStart,i,bestMatch]);patternStart+=counters[0]+counters[1],counters=counters.slice(2,counters.length-1),counters[counterPosition-1]=0,counters[counterPosition]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}static decodeCode(row,counters,rowOffset){OneDReader.recordPattern(row,rowOffset,counters);let bestVariance=Code128Reader.MAX_AVG_VARIANCE,bestMatch=-1;for(let d=0;d<Code128Reader.CODE_PATTERNS.length;d++){const pattern=Code128Reader.CODE_PATTERNS[d],variance=this.patternMatchVariance(counters,pattern,Code128Reader.MAX_INDIVIDUAL_VARIANCE);variance<bestVariance&&(bestVariance=variance,bestMatch=d)}if(bestMatch>=0)return bestMatch;throw new NotFoundException}decodeRow(rowNumber,row,hints){const convertFNC1=hints&&hints.get(DecodeHintType$1.ASSUME_GS1)===!0,startPatternInfo=Code128Reader.findStartPattern(row),startCode=startPatternInfo[2];let currentRawCodesIndex=0;const rawCodes=new Uint8Array(20);rawCodes[currentRawCodesIndex++]=startCode;let codeSet;switch(startCode){case Code128Reader.CODE_START_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_START_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_START_C:codeSet=Code128Reader.CODE_CODE_C;break;default:throw new FormatException}let done=!1,isNextShifted=!1,result="",lastStart=startPatternInfo[0],nextStart=startPatternInfo[1];const counters=Int32Array.from([0,0,0,0,0,0]);let lastCode=0,code=0,checksumTotal=startCode,multiplier=0,lastCharacterWasPrintable=!0,upperMode=!1,shiftUpperMode=!1;for(;!done;){const unshift=isNextShifted;switch(isNextShifted=!1,lastCode=code,code=Code128Reader.decodeCode(row,counters,nextStart),rawCodes[currentRawCodesIndex++]=code,code!==Code128Reader.CODE_STOP&&(lastCharacterWasPrintable=!0),code!==Code128Reader.CODE_STOP&&(multiplier++,checksumTotal+=multiplier*code),lastStart=nextStart,nextStart+=counters.reduce((previous,current)=>previous+current,0),code){case Code128Reader.CODE_START_A:case Code128Reader.CODE_START_B:case Code128Reader.CODE_START_C:throw new FormatException}switch(codeSet){case Code128Reader.CODE_CODE_A:if(code<64)shiftUpperMode===upperMode?result+=String.fromCharCode(32+code):result+=String.fromCharCode(32+code+128),shiftUpperMode=!1;else if(code<96)shiftUpperMode===upperMode?result+=String.fromCharCode(code-64):result+=String.fromCharCode(code+64),shiftUpperMode=!1;else switch(code!==Code128Reader.CODE_STOP&&(lastCharacterWasPrintable=!1),code){case Code128Reader.CODE_FNC_1:convertFNC1&&(result.length===0?result+="]C1":result+="");break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_A:!upperMode&&shiftUpperMode?(upperMode=!0,shiftUpperMode=!1):upperMode&&shiftUpperMode?(upperMode=!1,shiftUpperMode=!1):shiftUpperMode=!0;break;case Code128Reader.CODE_SHIFT:isNextShifted=!0,codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_CODE_C:codeSet=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:done=!0;break}break;case Code128Reader.CODE_CODE_B:if(code<96)shiftUpperMode===upperMode?result+=String.fromCharCode(32+code):result+=String.fromCharCode(32+code+128),shiftUpperMode=!1;else switch(code!==Code128Reader.CODE_STOP&&(lastCharacterWasPrintable=!1),code){case Code128Reader.CODE_FNC_1:convertFNC1&&(result.length===0?result+="]C1":result+="");break;case Code128Reader.CODE_FNC_2:case Code128Reader.CODE_FNC_3:break;case Code128Reader.CODE_FNC_4_B:!upperMode&&shiftUpperMode?(upperMode=!0,shiftUpperMode=!1):upperMode&&shiftUpperMode?(upperMode=!1,shiftUpperMode=!1):shiftUpperMode=!0;break;case Code128Reader.CODE_SHIFT:isNextShifted=!0,codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_C:codeSet=Code128Reader.CODE_CODE_C;break;case Code128Reader.CODE_STOP:done=!0;break}break;case Code128Reader.CODE_CODE_C:if(code<100)code<10&&(result+="0"),result+=code;else switch(code!==Code128Reader.CODE_STOP&&(lastCharacterWasPrintable=!1),code){case Code128Reader.CODE_FNC_1:convertFNC1&&(result.length===0?result+="]C1":result+="");break;case Code128Reader.CODE_CODE_A:codeSet=Code128Reader.CODE_CODE_A;break;case Code128Reader.CODE_CODE_B:codeSet=Code128Reader.CODE_CODE_B;break;case Code128Reader.CODE_STOP:done=!0;break}break}unshift&&(codeSet=codeSet===Code128Reader.CODE_CODE_A?Code128Reader.CODE_CODE_B:Code128Reader.CODE_CODE_A)}const lastPatternSize=nextStart-lastStart;if(nextStart=row.getNextUnset(nextStart),!row.isRange(nextStart,Math.min(row.getSize(),nextStart+(nextStart-lastStart)/2),!1))throw new NotFoundException;if(checksumTotal-=multiplier*lastCode,checksumTotal%103!==lastCode)throw new ChecksumException;const resultLength=result.length;if(resultLength===0)throw new NotFoundException;resultLength>0&&lastCharacterWasPrintable&&(codeSet===Code128Reader.CODE_CODE_C?result=result.substring(0,resultLength-2):result=result.substring(0,resultLength-1));const left=(startPatternInfo[1]+startPatternInfo[0])/2,right=lastStart+lastPatternSize/2,rawCodesSize=rawCodes.length,rawBytes=new Uint8Array(rawCodesSize);for(let i=0;i<rawCodesSize;i++)rawBytes[i]=rawCodes[i];const points=[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)];return new Result(result,rawBytes,0,points,BarcodeFormat$1.CODE_128,new Date().getTime())}}Code128Reader.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Code128Reader.MAX_AVG_VARIANCE=.25,Code128Reader.MAX_INDIVIDUAL_VARIANCE=.7,Code128Reader.CODE_SHIFT=98,Code128Reader.CODE_CODE_C=99,Code128Reader.CODE_CODE_B=100,Code128Reader.CODE_CODE_A=101,Code128Reader.CODE_FNC_1=102,Code128Reader.CODE_FNC_2=97,Code128Reader.CODE_FNC_3=96,Code128Reader.CODE_FNC_4_A=101,Code128Reader.CODE_FNC_4_B=100,Code128Reader.CODE_START_A=103,Code128Reader.CODE_START_B=104,Code128Reader.CODE_START_C=105,Code128Reader.CODE_STOP=106;class Code39Reader extends OneDReader{constructor(usingCheckDigit=!1,extendedMode=!1){super(),this.usingCheckDigit=usingCheckDigit,this.extendedMode=extendedMode,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(rowNumber,row,hints){let theCounters=this.counters;theCounters.fill(0),this.decodeRowResult="";let start=Code39Reader.findAsteriskPattern(row,theCounters),nextStart=row.getNextSet(start[1]),end=row.getSize(),decodedChar,lastStart;do{Code39Reader.recordPattern(row,nextStart,theCounters);let pattern=Code39Reader.toNarrowWidePattern(theCounters);if(pattern<0)throw new NotFoundException;decodedChar=Code39Reader.patternToChar(pattern),this.decodeRowResult+=decodedChar,lastStart=nextStart;for(let counter of theCounters)nextStart+=counter;nextStart=row.getNextSet(nextStart)}while(decodedChar!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let lastPatternSize=0;for(let counter of theCounters)lastPatternSize+=counter;let whiteSpaceAfterEnd=nextStart-lastStart-lastPatternSize;if(nextStart!==end&&whiteSpaceAfterEnd*2<lastPatternSize)throw new NotFoundException;if(this.usingCheckDigit){let max=this.decodeRowResult.length-1,total=0;for(let i=0;i<max;i++)total+=Code39Reader.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(i));if(this.decodeRowResult.charAt(max)!==Code39Reader.ALPHABET_STRING.charAt(total%43))throw new ChecksumException;this.decodeRowResult=this.decodeRowResult.substring(0,max)}if(this.decodeRowResult.length===0)throw new NotFoundException;let resultString;this.extendedMode?resultString=Code39Reader.decodeExtended(this.decodeRowResult):resultString=this.decodeRowResult;let left=(start[1]+start[0])/2,right=lastStart+lastPatternSize/2;return new Result(resultString,null,0,[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)],BarcodeFormat$1.CODE_39,new Date().getTime())}static findAsteriskPattern(row,counters){let width=row.getSize(),rowOffset=row.getNextSet(0),counterPosition=0,patternStart=rowOffset,isWhite=!1,patternLength=counters.length;for(let i=rowOffset;i<width;i++)if(row.get(i)!==isWhite)counters[counterPosition]++;else{if(counterPosition===patternLength-1){if(this.toNarrowWidePattern(counters)===Code39Reader.ASTERISK_ENCODING&&row.isRange(Math.max(0,patternStart-Math.floor((i-patternStart)/2)),patternStart,!1))return[patternStart,i];patternStart+=counters[0]+counters[1],counters.copyWithin(0,2,2+counterPosition-1),counters[counterPosition-1]=0,counters[counterPosition]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}static toNarrowWidePattern(counters){let numCounters=counters.length,maxNarrowCounter=0,wideCounters;do{let minCounter=2147483647;for(let counter of counters)counter<minCounter&&counter>maxNarrowCounter&&(minCounter=counter);maxNarrowCounter=minCounter,wideCounters=0;let totalWideCountersWidth=0,pattern=0;for(let i=0;i<numCounters;i++){let counter=counters[i];counter>maxNarrowCounter&&(pattern|=1<<numCounters-1-i,wideCounters++,totalWideCountersWidth+=counter)}if(wideCounters===3){for(let i=0;i<numCounters&&wideCounters>0;i++){let counter=counters[i];if(counter>maxNarrowCounter&&(wideCounters--,counter*2>=totalWideCountersWidth))return-1}return pattern}}while(wideCounters>3);return-1}static patternToChar(pattern){for(let i=0;i<Code39Reader.CHARACTER_ENCODINGS.length;i++)if(Code39Reader.CHARACTER_ENCODINGS[i]===pattern)return Code39Reader.ALPHABET_STRING.charAt(i);if(pattern===Code39Reader.ASTERISK_ENCODING)return"*";throw new NotFoundException}static decodeExtended(encoded){let length=encoded.length,decoded="";for(let i=0;i<length;i++){let c=encoded.charAt(i);if(c==="+"||c==="$"||c==="%"||c==="/"){let next=encoded.charAt(i+1),decodedChar="\0";switch(c){case"+":if(next>="A"&&next<="Z")decodedChar=String.fromCharCode(next.charCodeAt(0)+32);else throw new FormatException;break;case"$":if(next>="A"&&next<="Z")decodedChar=String.fromCharCode(next.charCodeAt(0)-64);else throw new FormatException;break;case"%":if(next>="A"&&next<="E")decodedChar=String.fromCharCode(next.charCodeAt(0)-38);else if(next>="F"&&next<="J")decodedChar=String.fromCharCode(next.charCodeAt(0)-11);else if(next>="K"&&next<="O")decodedChar=String.fromCharCode(next.charCodeAt(0)+16);else if(next>="P"&&next<="T")decodedChar=String.fromCharCode(next.charCodeAt(0)+43);else if(next==="U")decodedChar="\0";else if(next==="V")decodedChar="@";else if(next==="W")decodedChar="`";else if(next==="X"||next==="Y"||next==="Z")decodedChar="\x7F";else throw new FormatException;break;case"/":if(next>="A"&&next<="O")decodedChar=String.fromCharCode(next.charCodeAt(0)-32);else if(next==="Z")decodedChar=":";else throw new FormatException;break}decoded+=decodedChar,i++}else decoded+=c}return decoded}}Code39Reader.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Code39Reader.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Code39Reader.ASTERISK_ENCODING=148;class ITFReader extends OneDReader{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(rowNumber,row,hints){let startRange=this.decodeStart(row),endRange=this.decodeEnd(row),result=new StringBuilder;ITFReader.decodeMiddle(row,startRange[1],endRange[0],result);let resultString=result.toString(),allowedLengths=null;hints!=null&&(allowedLengths=hints.get(DecodeHintType$1.ALLOWED_LENGTHS)),allowedLengths==null&&(allowedLengths=ITFReader.DEFAULT_ALLOWED_LENGTHS);let length=resultString.length,lengthOK=!1,maxAllowedLength=0;for(let value of allowedLengths){if(length===value){lengthOK=!0;break}value>maxAllowedLength&&(maxAllowedLength=value)}if(!lengthOK&&length>maxAllowedLength&&(lengthOK=!0),!lengthOK)throw new FormatException;const points=[new ResultPoint(startRange[1],rowNumber),new ResultPoint(endRange[0],rowNumber)];return new Result(resultString,null,0,points,BarcodeFormat$1.ITF,new Date().getTime())}static decodeMiddle(row,payloadStart,payloadEnd,resultString){let counterDigitPair=new Int32Array(10),counterBlack=new Int32Array(5),counterWhite=new Int32Array(5);for(counterDigitPair.fill(0),counterBlack.fill(0),counterWhite.fill(0);payloadStart<payloadEnd;){OneDReader.recordPattern(row,payloadStart,counterDigitPair);for(let k=0;k<5;k++){let twoK=2*k;counterBlack[k]=counterDigitPair[twoK],counterWhite[k]=counterDigitPair[twoK+1]}let bestMatch=ITFReader.decodeDigit(counterBlack);resultString.append(bestMatch.toString()),bestMatch=this.decodeDigit(counterWhite),resultString.append(bestMatch.toString()),counterDigitPair.forEach(function(counterDigit){payloadStart+=counterDigit})}}decodeStart(row){let endStart=ITFReader.skipWhiteSpace(row),startPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.START_PATTERN);return this.narrowLineWidth=(startPattern[1]-startPattern[0])/4,this.validateQuietZone(row,startPattern[0]),startPattern}validateQuietZone(row,startPattern){let quietCount=this.narrowLineWidth*10;quietCount=quietCount<startPattern?quietCount:startPattern;for(let i=startPattern-1;quietCount>0&&i>=0&&!row.get(i);i--)quietCount--;if(quietCount!==0)throw new NotFoundException}static skipWhiteSpace(row){const width=row.getSize(),endStart=row.getNextSet(0);if(endStart===width)throw new NotFoundException;return endStart}decodeEnd(row){row.reverse();try{let endStart=ITFReader.skipWhiteSpace(row),endPattern;try{endPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.END_PATTERN_REVERSED[0])}catch(error){error instanceof NotFoundException&&(endPattern=ITFReader.findGuardPattern(row,endStart,ITFReader.END_PATTERN_REVERSED[1]))}this.validateQuietZone(row,endPattern[0]);let temp=endPattern[0];return endPattern[0]=row.getSize()-endPattern[1],endPattern[1]=row.getSize()-temp,endPattern}finally{row.reverse()}}static findGuardPattern(row,rowOffset,pattern){let patternLength=pattern.length,counters=new Int32Array(patternLength),width=row.getSize(),isWhite=!1,counterPosition=0,patternStart=rowOffset;counters.fill(0);for(let x=rowOffset;x<width;x++)if(row.get(x)!==isWhite)counters[counterPosition]++;else{if(counterPosition===patternLength-1){if(OneDReader.patternMatchVariance(counters,pattern,ITFReader.MAX_INDIVIDUAL_VARIANCE)<ITFReader.MAX_AVG_VARIANCE)return[patternStart,x];patternStart+=counters[0]+counters[1],System.arraycopy(counters,2,counters,0,counterPosition-1),counters[counterPosition-1]=0,counters[counterPosition]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}static decodeDigit(counters){let bestVariance=ITFReader.MAX_AVG_VARIANCE,bestMatch=-1,max=ITFReader.PATTERNS.length;for(let i=0;i<max;i++){let pattern=ITFReader.PATTERNS[i],variance=OneDReader.patternMatchVariance(counters,pattern,ITFReader.MAX_INDIVIDUAL_VARIANCE);variance<bestVariance?(bestVariance=variance,bestMatch=i):variance===bestVariance&&(bestMatch=-1)}if(bestMatch>=0)return bestMatch%10;throw new NotFoundException}}ITFReader.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ITFReader.MAX_AVG_VARIANCE=.38,ITFReader.MAX_INDIVIDUAL_VARIANCE=.5,ITFReader.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ITFReader.START_PATTERN=Int32Array.from([1,1,1,1]),ITFReader.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class AbstractUPCEANReader extends OneDReader{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(row){let foundStart=!1,startRange,nextStart=0,counters=Int32Array.from([0,0,0]);for(;!foundStart;){counters=Int32Array.from([0,0,0]),startRange=AbstractUPCEANReader.findGuardPattern(row,nextStart,!1,this.START_END_PATTERN,counters);let start=startRange[0];nextStart=startRange[1];let quietStart=start-(nextStart-start);quietStart>=0&&(foundStart=row.isRange(quietStart,start,!1))}return startRange}static checkChecksum(s){return AbstractUPCEANReader.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let length=s.length;if(length===0)return!1;let check=parseInt(s.charAt(length-1),10);return AbstractUPCEANReader.getStandardUPCEANChecksum(s.substring(0,length-1))===check}static getStandardUPCEANChecksum(s){let length=s.length,sum=0;for(let i=length-1;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-48;if(digit<0||digit>9)throw new FormatException;sum+=digit}sum*=3;for(let i=length-2;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-48;if(digit<0||digit>9)throw new FormatException;sum+=digit}return(1e3-sum)%10}static decodeEnd(row,endStart){return AbstractUPCEANReader.findGuardPattern(row,endStart,!1,AbstractUPCEANReader.START_END_PATTERN,new Int32Array(AbstractUPCEANReader.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(row,rowOffset,whiteFirst,pattern){return this.findGuardPattern(row,rowOffset,whiteFirst,pattern,new Int32Array(pattern.length))}static findGuardPattern(row,rowOffset,whiteFirst,pattern,counters){let width=row.getSize();rowOffset=whiteFirst?row.getNextUnset(rowOffset):row.getNextSet(rowOffset);let counterPosition=0,patternStart=rowOffset,patternLength=pattern.length,isWhite=whiteFirst;for(let x=rowOffset;x<width;x++)if(row.get(x)!==isWhite)counters[counterPosition]++;else{if(counterPosition===patternLength-1){if(OneDReader.patternMatchVariance(counters,pattern,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE)<AbstractUPCEANReader.MAX_AVG_VARIANCE)return Int32Array.from([patternStart,x]);patternStart+=counters[0]+counters[1];let slice=counters.slice(2,counters.length-1);for(let i=0;i<counterPosition-1;i++)counters[i]=slice[i];counters[counterPosition-1]=0,counters[counterPosition]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}static decodeDigit(row,counters,rowOffset,patterns){this.recordPattern(row,rowOffset,counters);let bestVariance=this.MAX_AVG_VARIANCE,bestMatch=-1,max=patterns.length;for(let i=0;i<max;i++){let pattern=patterns[i],variance=OneDReader.patternMatchVariance(counters,pattern,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE);variance<bestVariance&&(bestVariance=variance,bestMatch=i)}if(bestMatch>=0)return bestMatch;throw new NotFoundException}}AbstractUPCEANReader.MAX_AVG_VARIANCE=.48,AbstractUPCEANReader.MAX_INDIVIDUAL_VARIANCE=.7,AbstractUPCEANReader.START_END_PATTERN=Int32Array.from([1,1,1]),AbstractUPCEANReader.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),AbstractUPCEANReader.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),AbstractUPCEANReader.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class UPCEANExtension5Support{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(rowNumber,row,extensionStartRange){let result=this.decodeRowStringBuffer,end=this.decodeMiddle(row,extensionStartRange,result),resultString=result.toString(),extensionData=UPCEANExtension5Support.parseExtensionString(resultString),resultPoints=[new ResultPoint((extensionStartRange[0]+extensionStartRange[1])/2,rowNumber),new ResultPoint(end,rowNumber)],extensionResult=new Result(resultString,null,0,resultPoints,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());return extensionData!=null&&extensionResult.putAllMetadata(extensionData),extensionResult}decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let end=row.getSize(),rowOffset=startRange[1],lgPatternFound=0;for(let x=0;x<5&&rowOffset<end;x++){let bestMatch=AbstractUPCEANReader.decodeDigit(row,counters,rowOffset,AbstractUPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(48+bestMatch%10);for(let counter of counters)rowOffset+=counter;bestMatch>=10&&(lgPatternFound|=1<<4-x),x!==4&&(rowOffset=row.getNextSet(rowOffset),rowOffset=row.getNextUnset(rowOffset))}if(resultString.length!==5)throw new NotFoundException;let checkDigit=this.determineCheckDigit(lgPatternFound);if(UPCEANExtension5Support.extensionChecksum(resultString.toString())!==checkDigit)throw new NotFoundException;return rowOffset}static extensionChecksum(s){let length=s.length,sum=0;for(let i=length-2;i>=0;i-=2)sum+=s.charAt(i).charCodeAt(0)-48;sum*=3;for(let i=length-1;i>=0;i-=2)sum+=s.charAt(i).charCodeAt(0)-48;return sum*=3,sum%10}determineCheckDigit(lgPatternFound){for(let d=0;d<10;d++)if(lgPatternFound===this.CHECK_DIGIT_ENCODINGS[d])return d;throw new NotFoundException}static parseExtensionString(raw){if(raw.length!==5)return null;let value=UPCEANExtension5Support.parseExtension5String(raw);return value==null?null:new Map([[ResultMetadataType$1.SUGGESTED_PRICE,value]])}static parseExtension5String(raw){let currency;switch(raw.charAt(0)){case"0":currency="\xA3";break;case"5":currency="$";break;case"9":switch(raw){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}currency="";break;default:currency="";break}let rawAmount=parseInt(raw.substring(1)),unitsString=(rawAmount/100).toString(),hundredths=rawAmount%100,hundredthsString=hundredths<10?"0"+hundredths:hundredths.toString();return currency+unitsString+"."+hundredthsString}}class UPCEANExtension2Support{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(rowNumber,row,extensionStartRange){let result=this.decodeRowStringBuffer,end=this.decodeMiddle(row,extensionStartRange,result),resultString=result.toString(),extensionData=UPCEANExtension2Support.parseExtensionString(resultString),resultPoints=[new ResultPoint((extensionStartRange[0]+extensionStartRange[1])/2,rowNumber),new ResultPoint(end,rowNumber)],extensionResult=new Result(resultString,null,0,resultPoints,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());return extensionData!=null&&extensionResult.putAllMetadata(extensionData),extensionResult}decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let end=row.getSize(),rowOffset=startRange[1],checkParity=0;for(let x=0;x<2&&rowOffset<end;x++){let bestMatch=AbstractUPCEANReader.decodeDigit(row,counters,rowOffset,AbstractUPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(48+bestMatch%10);for(let counter of counters)rowOffset+=counter;bestMatch>=10&&(checkParity|=1<<1-x),x!==1&&(rowOffset=row.getNextSet(rowOffset),rowOffset=row.getNextUnset(rowOffset))}if(resultString.length!==2)throw new NotFoundException;if(parseInt(resultString.toString())%4!==checkParity)throw new NotFoundException;return rowOffset}static parseExtensionString(raw){return raw.length!==2?null:new Map([[ResultMetadataType$1.ISSUE_NUMBER,parseInt(raw)]])}}class UPCEANExtensionSupport{static decodeRow(rowNumber,row,rowOffset){let extensionStartRange=AbstractUPCEANReader.findGuardPattern(row,rowOffset,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new UPCEANExtension5Support().decodeRow(rowNumber,row,extensionStartRange)}catch{return new UPCEANExtension2Support().decodeRow(rowNumber,row,extensionStartRange)}}}UPCEANExtensionSupport.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class UPCEANReader extends AbstractUPCEANReader{constructor(){super(),this.decodeRowStringBuffer="",UPCEANReader.L_AND_G_PATTERNS=UPCEANReader.L_PATTERNS.map(arr=>Int32Array.from(arr));for(let i=10;i<20;i++){let widths=UPCEANReader.L_PATTERNS[i-10],reversedWidths=new Int32Array(widths.length);for(let j=0;j<widths.length;j++)reversedWidths[j]=widths[widths.length-j-1];UPCEANReader.L_AND_G_PATTERNS[i]=reversedWidths}}decodeRow(rowNumber,row,hints){let startGuardRange=UPCEANReader.findStartGuardPattern(row),resultPointCallback=hints==null?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(resultPointCallback!=null){const resultPoint2=new ResultPoint((startGuardRange[0]+startGuardRange[1])/2,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint2)}let budello=this.decodeMiddle(row,startGuardRange,this.decodeRowStringBuffer),endStart=budello.rowOffset,result=budello.resultString;if(resultPointCallback!=null){const resultPoint2=new ResultPoint(endStart,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint2)}let endRange=this.decodeEnd(row,endStart);if(resultPointCallback!=null){const resultPoint2=new ResultPoint((endRange[0]+endRange[1])/2,rowNumber);resultPointCallback.foundPossibleResultPoint(resultPoint2)}let end=endRange[1],quietEnd=end+(end-endRange[0]);if(quietEnd>=row.getSize()||!row.isRange(end,quietEnd,!1))throw new NotFoundException;let resultString=result.toString();if(resultString.length<8)throw new FormatException;if(!UPCEANReader.checkChecksum(resultString))throw new ChecksumException;let left=(startGuardRange[1]+startGuardRange[0])/2,right=(endRange[1]+endRange[0])/2,format=this.getBarcodeFormat(),resultPoint=[new ResultPoint(left,rowNumber),new ResultPoint(right,rowNumber)],decodeResult=new Result(resultString,null,0,resultPoint,format,new Date().getTime()),extensionLength=0;try{let extensionResult=UPCEANExtensionSupport.decodeRow(rowNumber,row,endRange[1]);decodeResult.putMetadata(ResultMetadataType$1.UPC_EAN_EXTENSION,extensionResult.getText()),decodeResult.putAllMetadata(extensionResult.getResultMetadata()),decodeResult.addResultPoints(extensionResult.getResultPoints()),extensionLength=extensionResult.getText().length}catch{}let allowedExtensions=hints==null?null:hints.get(DecodeHintType$1.ALLOWED_EAN_EXTENSIONS);if(allowedExtensions!=null){let valid=!1;for(let length in allowedExtensions)if(extensionLength.toString()===length){valid=!0;break}if(!valid)throw new NotFoundException}return decodeResult}decodeEnd(row,endStart){return UPCEANReader.findGuardPattern(row,endStart,!1,UPCEANReader.START_END_PATTERN,new Int32Array(UPCEANReader.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return UPCEANReader.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let length=s.length;if(length===0)return!1;let check=parseInt(s.charAt(length-1),10);return UPCEANReader.getStandardUPCEANChecksum(s.substring(0,length-1))===check}static getStandardUPCEANChecksum(s){let length=s.length,sum=0;for(let i=length-1;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-48;if(digit<0||digit>9)throw new FormatException;sum+=digit}sum*=3;for(let i=length-2;i>=0;i-=2){let digit=s.charAt(i).charCodeAt(0)-48;if(digit<0||digit>9)throw new FormatException;sum+=digit}return(1e3-sum)%10}}class EAN13Reader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(row,startRange,resultString){let counters=this.decodeMiddleCounters;counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let end=row.getSize(),rowOffset=startRange[1],lgPatternFound=0;for(let x=0;x<6&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_AND_G_PATTERNS);resultString+=String.fromCharCode(48+bestMatch%10);for(let counter of counters)rowOffset+=counter;bestMatch>=10&&(lgPatternFound|=1<<5-x)}resultString=EAN13Reader.determineFirstDigit(resultString,lgPatternFound),rowOffset=UPCEANReader.findGuardPattern(row,rowOffset,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<6&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(48+bestMatch);for(let counter of counters)rowOffset+=counter}return{rowOffset,resultString}}getBarcodeFormat(){return BarcodeFormat$1.EAN_13}static determineFirstDigit(resultString,lgPatternFound){for(let d=0;d<10;d++)if(lgPatternFound===this.FIRST_DIGIT_ENCODINGS[d])return resultString=String.fromCharCode(48+d)+resultString,resultString;throw new NotFoundException}}EAN13Reader.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class EAN8Reader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(row,startRange,resultString){const counters=this.decodeMiddleCounters;counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let end=row.getSize(),rowOffset=startRange[1];for(let x=0;x<4&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(48+bestMatch);for(let counter of counters)rowOffset+=counter}rowOffset=UPCEANReader.findGuardPattern(row,rowOffset,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<4&&rowOffset<end;x++){let bestMatch=UPCEANReader.decodeDigit(row,counters,rowOffset,UPCEANReader.L_PATTERNS);resultString+=String.fromCharCode(48+bestMatch);for(let counter of counters)rowOffset+=counter}return{rowOffset,resultString}}getBarcodeFormat(){return BarcodeFormat$1.EAN_8}}class UPCAReader extends UPCEANReader{constructor(){super(...arguments),this.ean13Reader=new EAN13Reader}getBarcodeFormat(){return BarcodeFormat$1.UPC_A}decode(image,hints){return this.maybeReturnResult(this.ean13Reader.decode(image))}decodeRow(rowNumber,row,hints){return this.maybeReturnResult(this.ean13Reader.decodeRow(rowNumber,row,hints))}decodeMiddle(row,startRange,resultString){return this.ean13Reader.decodeMiddle(row,startRange,resultString)}maybeReturnResult(result){let text=result.getText();if(text.charAt(0)==="0"){let upcaResult=new Result(text.substring(1),null,null,result.getResultPoints(),BarcodeFormat$1.UPC_A);return result.getResultMetadata()!=null&&upcaResult.putAllMetadata(result.getResultMetadata()),upcaResult}else throw new NotFoundException}reset(){this.ean13Reader.reset()}}class UPCEReader extends UPCEANReader{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(row,startRange,result){const counters=this.decodeMiddleCounters.map(x=>x);counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;const end=row.getSize();let rowOffset=startRange[1],lgPatternFound=0;for(let x=0;x<6&&rowOffset<end;x++){const bestMatch=UPCEReader.decodeDigit(row,counters,rowOffset,UPCEReader.L_AND_G_PATTERNS);result+=String.fromCharCode(48+bestMatch%10);for(let counter of counters)rowOffset+=counter;bestMatch>=10&&(lgPatternFound|=1<<5-x)}let resultString=UPCEReader.determineNumSysAndCheckDigit(result,lgPatternFound);return{rowOffset,resultString}}decodeEnd(row,endStart){return UPCEReader.findGuardPatternWithoutCounters(row,endStart,!0,UPCEReader.MIDDLE_END_PATTERN)}checkChecksum(s){return UPCEANReader.checkChecksum(UPCEReader.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(resultString,lgPatternFound){for(let numSys=0;numSys<=1;numSys++)for(let d=0;d<10;d++)if(lgPatternFound===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[numSys][d]){let prefix=String.fromCharCode(48+numSys),suffix=String.fromCharCode(48+d);return prefix+resultString+suffix}throw NotFoundException.getNotFoundInstance()}getBarcodeFormat(){return BarcodeFormat$1.UPC_E}static convertUPCEtoUPCA(upce){const upceChars=upce.slice(1,7).split("").map(x=>x.charCodeAt(0)),result=new StringBuilder;result.append(upce.charAt(0));let lastChar=upceChars[5];switch(lastChar){case 0:case 1:case 2:result.appendChars(upceChars,0,2),result.append(lastChar),result.append("0000"),result.appendChars(upceChars,2,3);break;case 3:result.appendChars(upceChars,0,3),result.append("00000"),result.appendChars(upceChars,3,2);break;case 4:result.appendChars(upceChars,0,4),result.append("00000"),result.append(upceChars[4]);break;default:result.appendChars(upceChars,0,5),result.append("0000"),result.append(lastChar);break}return upce.length>=8&&result.append(upce.charAt(7)),result.toString()}}UPCEReader.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),UPCEReader.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class MultiFormatUPCEANReader extends OneDReader{constructor(hints){super();let possibleFormats=hints==null?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS),readers=[];isNullOrUndefined(possibleFormats)?(readers.push(new EAN13Reader),readers.push(new UPCAReader),readers.push(new EAN8Reader),readers.push(new UPCEReader)):(possibleFormats.indexOf(BarcodeFormat$1.EAN_13)>-1&&readers.push(new EAN13Reader),possibleFormats.indexOf(BarcodeFormat$1.UPC_A)>-1&&readers.push(new UPCAReader),possibleFormats.indexOf(BarcodeFormat$1.EAN_8)>-1&&readers.push(new EAN8Reader),possibleFormats.indexOf(BarcodeFormat$1.UPC_E)>-1&&readers.push(new UPCEReader)),this.readers=readers}decodeRow(rowNumber,row,hints){for(let reader of this.readers)try{const result=reader.decodeRow(rowNumber,row,hints),ean13MayBeUPCA=result.getBarcodeFormat()===BarcodeFormat$1.EAN_13&&result.getText().charAt(0)==="0",possibleFormats=hints==null?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS),canReturnUPCA=possibleFormats==null||possibleFormats.includes(BarcodeFormat$1.UPC_A);if(ean13MayBeUPCA&&canReturnUPCA){const rawBytes=result.getRawBytes(),resultUPCA=new Result(result.getText().substring(1),rawBytes,rawBytes?rawBytes.length:null,result.getResultPoints(),BarcodeFormat$1.UPC_A);return resultUPCA.putAllMetadata(result.getResultMetadata()),resultUPCA}return result}catch{}throw new NotFoundException}reset(){for(let reader of this.readers)reader.reset()}}class AbstractRSSReader extends OneDReader{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(counters,finderPatterns){for(let value=0;value<finderPatterns.length;value++)if(OneDReader.patternMatchVariance(counters,finderPatterns[value],AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE)<AbstractRSSReader.MAX_AVG_VARIANCE)return value;throw new NotFoundException}static count(array){return MathUtils.sum(new Int32Array(array))}static increment(array,errors){let index=0,biggestError=errors[0];for(let i=1;i<array.length;i++)errors[i]>biggestError&&(biggestError=errors[i],index=i);array[index]++}static decrement(array,errors){let index=0,biggestError=errors[0];for(let i=1;i<array.length;i++)errors[i]<biggestError&&(biggestError=errors[i],index=i);array[index]--}static isFinderPattern(counters){let firstTwoSum=counters[0]+counters[1],sum=firstTwoSum+counters[2]+counters[3],ratio=firstTwoSum/sum;if(ratio>=AbstractRSSReader.MIN_FINDER_PATTERN_RATIO&&ratio<=AbstractRSSReader.MAX_FINDER_PATTERN_RATIO){let minCounter=Number.MAX_SAFE_INTEGER,maxCounter=Number.MIN_SAFE_INTEGER;for(let counter of counters)counter>maxCounter&&(maxCounter=counter),counter<minCounter&&(minCounter=counter);return maxCounter<10*minCounter}return!1}}AbstractRSSReader.MAX_AVG_VARIANCE=.2,AbstractRSSReader.MAX_INDIVIDUAL_VARIANCE=.45,AbstractRSSReader.MIN_FINDER_PATTERN_RATIO=.7916666666666666,AbstractRSSReader.MAX_FINDER_PATTERN_RATIO=.8928571428571429;class DataCharacter{constructor(value,checksumPortion){this.value=value,this.checksumPortion=checksumPortion}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(o){if(!(o instanceof DataCharacter))return!1;const that=o;return this.value===that.value&&this.checksumPortion===that.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class FinderPattern{constructor(value,startEnd,start,end,rowNumber){this.value=value,this.startEnd=startEnd,this.value=value,this.startEnd=startEnd,this.resultPoints=new Array,this.resultPoints.push(new ResultPoint(start,rowNumber)),this.resultPoints.push(new ResultPoint(end,rowNumber))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(o){if(!(o instanceof FinderPattern))return!1;const that=o;return this.value===that.value}hashCode(){return this.value}}class RSSUtils{constructor(){}static getRSSvalue(widths,maxWidth,noNarrow){let n=0;for(let width of widths)n+=width;let val=0,narrowMask=0,elements=widths.length;for(let bar=0;bar<elements-1;bar++){let elmWidth;for(elmWidth=1,narrowMask|=1<<bar;elmWidth<widths[bar];elmWidth++,narrowMask&=~(1<<bar)){let subVal=RSSUtils.combins(n-elmWidth-1,elements-bar-2);if(noNarrow&&narrowMask===0&&n-elmWidth-(elements-bar-1)>=elements-bar-1&&(subVal-=RSSUtils.combins(n-elmWidth-(elements-bar),elements-bar-2)),elements-bar-1>1){let lessVal=0;for(let mxwElement=n-elmWidth-(elements-bar-2);mxwElement>maxWidth;mxwElement--)lessVal+=RSSUtils.combins(n-elmWidth-mxwElement-1,elements-bar-3);subVal-=lessVal*(elements-1-bar)}else n-elmWidth>maxWidth&&subVal--;val+=subVal}n-=elmWidth}return val}static combins(n,r){let maxDenom,minDenom;n-r>r?(minDenom=r,maxDenom=n-r):(minDenom=n-r,maxDenom=r);let val=1,j=1;for(let i=n;i>maxDenom;i--)val*=i,j<=minDenom&&(val/=j,j++);for(;j<=minDenom;)val/=j,j++;return val}}class BitArrayBuilder{static buildBitArray(pairs){let charNumber=pairs.length*2-1;pairs[pairs.length-1].getRightChar()==null&&(charNumber-=1);let size=12*charNumber,binary=new BitArray(size),accPos=0,firstValue=pairs[0].getRightChar().getValue();for(let i=11;i>=0;--i)firstValue&1<<i&&binary.set(accPos),accPos++;for(let i=1;i<pairs.length;++i){let currentPair=pairs[i],leftValue=currentPair.getLeftChar().getValue();for(let j=11;j>=0;--j)leftValue&1<<j&&binary.set(accPos),accPos++;if(currentPair.getRightChar()!=null){let rightValue=currentPair.getRightChar().getValue();for(let j=11;j>=0;--j)rightValue&1<<j&&binary.set(accPos),accPos++}}return binary}}class BlockParsedResult{constructor(finished,decodedInformation){decodedInformation?this.decodedInformation=null:(this.finished=finished,this.decodedInformation=decodedInformation)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class DecodedObject{constructor(newPosition){this.newPosition=newPosition}getNewPosition(){return this.newPosition}}class DecodedChar extends DecodedObject{constructor(newPosition,value){super(newPosition),this.value=value}getValue(){return this.value}isFNC1(){return this.value===DecodedChar.FNC1}}DecodedChar.FNC1="$";class DecodedInformation extends DecodedObject{constructor(newPosition,newString,remainingValue){super(newPosition),remainingValue?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=newString}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class DecodedNumeric extends DecodedObject{constructor(newPosition,firstDigit,secondDigit){if(super(newPosition),firstDigit<0||firstDigit>10||secondDigit<0||secondDigit>10)throw new FormatException;this.firstDigit=firstDigit,this.secondDigit=secondDigit}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===DecodedNumeric.FNC1}isSecondDigitFNC1(){return this.secondDigit===DecodedNumeric.FNC1}isAnyFNC1(){return this.firstDigit===DecodedNumeric.FNC1||this.secondDigit===DecodedNumeric.FNC1}}DecodedNumeric.FNC1=10;class FieldParser{constructor(){}static parseFieldsInGeneralPurpose(rawInformation){if(!rawInformation)return null;if(rawInformation.length<2)throw new NotFoundException;let firstTwoDigits=rawInformation.substring(0,2);for(let dataLength of FieldParser.TWO_DIGIT_DATA_LENGTH)if(dataLength[0]===firstTwoDigits)return dataLength[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(2,dataLength[2],rawInformation):FieldParser.processFixedAI(2,dataLength[1],rawInformation);if(rawInformation.length<3)throw new NotFoundException;let firstThreeDigits=rawInformation.substring(0,3);for(let dataLength of FieldParser.THREE_DIGIT_DATA_LENGTH)if(dataLength[0]===firstThreeDigits)return dataLength[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(3,dataLength[2],rawInformation):FieldParser.processFixedAI(3,dataLength[1],rawInformation);for(let dataLength of FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(dataLength[0]===firstThreeDigits)return dataLength[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(4,dataLength[2],rawInformation):FieldParser.processFixedAI(4,dataLength[1],rawInformation);if(rawInformation.length<4)throw new NotFoundException;let firstFourDigits=rawInformation.substring(0,4);for(let dataLength of FieldParser.FOUR_DIGIT_DATA_LENGTH)if(dataLength[0]===firstFourDigits)return dataLength[1]===FieldParser.VARIABLE_LENGTH?FieldParser.processVariableAI(4,dataLength[2],rawInformation):FieldParser.processFixedAI(4,dataLength[1],rawInformation);throw new NotFoundException}static processFixedAI(aiSize,fieldSize,rawInformation){if(rawInformation.length<aiSize)throw new NotFoundException;let ai=rawInformation.substring(0,aiSize);if(rawInformation.length<aiSize+fieldSize)throw new NotFoundException;let field=rawInformation.substring(aiSize,aiSize+fieldSize),remaining=rawInformation.substring(aiSize+fieldSize),result="("+ai+")"+field,parsedAI=FieldParser.parseFieldsInGeneralPurpose(remaining);return parsedAI==null?result:result+parsedAI}static processVariableAI(aiSize,variableFieldSize,rawInformation){let ai=rawInformation.substring(0,aiSize),maxSize;rawInformation.length<aiSize+variableFieldSize?maxSize=rawInformation.length:maxSize=aiSize+variableFieldSize;let field=rawInformation.substring(aiSize,maxSize),remaining=rawInformation.substring(maxSize),result="("+ai+")"+field,parsedAI=FieldParser.parseFieldsInGeneralPurpose(remaining);return parsedAI==null?result:result+parsedAI}}FieldParser.VARIABLE_LENGTH=[],FieldParser.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",FieldParser.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",FieldParser.VARIABLE_LENGTH,20],["22",FieldParser.VARIABLE_LENGTH,29],["30",FieldParser.VARIABLE_LENGTH,8],["37",FieldParser.VARIABLE_LENGTH,8],["90",FieldParser.VARIABLE_LENGTH,30],["91",FieldParser.VARIABLE_LENGTH,30],["92",FieldParser.VARIABLE_LENGTH,30],["93",FieldParser.VARIABLE_LENGTH,30],["94",FieldParser.VARIABLE_LENGTH,30],["95",FieldParser.VARIABLE_LENGTH,30],["96",FieldParser.VARIABLE_LENGTH,30],["97",FieldParser.VARIABLE_LENGTH,3],["98",FieldParser.VARIABLE_LENGTH,30],["99",FieldParser.VARIABLE_LENGTH,30]],FieldParser.THREE_DIGIT_DATA_LENGTH=[["240",FieldParser.VARIABLE_LENGTH,30],["241",FieldParser.VARIABLE_LENGTH,30],["242",FieldParser.VARIABLE_LENGTH,6],["250",FieldParser.VARIABLE_LENGTH,30],["251",FieldParser.VARIABLE_LENGTH,30],["253",FieldParser.VARIABLE_LENGTH,17],["254",FieldParser.VARIABLE_LENGTH,20],["400",FieldParser.VARIABLE_LENGTH,30],["401",FieldParser.VARIABLE_LENGTH,30],["402",17],["403",FieldParser.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",FieldParser.VARIABLE_LENGTH,20],["421",FieldParser.VARIABLE_LENGTH,15],["422",3],["423",FieldParser.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],FieldParser.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",FieldParser.VARIABLE_LENGTH,15],["391",FieldParser.VARIABLE_LENGTH,18],["392",FieldParser.VARIABLE_LENGTH,15],["393",FieldParser.VARIABLE_LENGTH,18],["703",FieldParser.VARIABLE_LENGTH,30]],FieldParser.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",FieldParser.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",FieldParser.VARIABLE_LENGTH,20],["8003",FieldParser.VARIABLE_LENGTH,30],["8004",FieldParser.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",FieldParser.VARIABLE_LENGTH,30],["8008",FieldParser.VARIABLE_LENGTH,12],["8018",18],["8020",FieldParser.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",FieldParser.VARIABLE_LENGTH,70],["8200",FieldParser.VARIABLE_LENGTH,70]];class GeneralAppIdDecoder{constructor(information){this.buffer=new StringBuilder,this.information=information}decodeAllCodes(buff,initialPosition){let currentPosition=initialPosition,remaining=null;do{let info=this.decodeGeneralPurposeField(currentPosition,remaining),parsedFields=FieldParser.parseFieldsInGeneralPurpose(info.getNewString());if(parsedFields!=null&&buff.append(parsedFields),info.isRemaining()?remaining=""+info.getRemainingValue():remaining=null,currentPosition===info.getNewPosition())break;currentPosition=info.getNewPosition()}while(!0);return buff.toString()}isStillNumeric(pos){if(pos+7>this.information.getSize())return pos+4<=this.information.getSize();for(let i=pos;i<pos+3;++i)if(this.information.get(i))return!0;return this.information.get(pos+3)}decodeNumeric(pos){if(pos+7>this.information.getSize()){let numeric2=this.extractNumericValueFromBitArray(pos,4);return numeric2===0?new DecodedNumeric(this.information.getSize(),DecodedNumeric.FNC1,DecodedNumeric.FNC1):new DecodedNumeric(this.information.getSize(),numeric2-1,DecodedNumeric.FNC1)}let numeric=this.extractNumericValueFromBitArray(pos,7),digit1=(numeric-8)/11,digit2=(numeric-8)%11;return new DecodedNumeric(pos+7,digit1,digit2)}extractNumericValueFromBitArray(pos,bits){return GeneralAppIdDecoder.extractNumericValueFromBitArray(this.information,pos,bits)}static extractNumericValueFromBitArray(information,pos,bits){let value=0;for(let i=0;i<bits;++i)information.get(pos+i)&&(value|=1<<bits-i-1);return value}decodeGeneralPurposeField(pos,remaining){this.buffer.setLengthToZero(),remaining!=null&&this.buffer.append(remaining),this.current.setPosition(pos);let lastDecoded=this.parseBlocks();return lastDecoded!=null&&lastDecoded.isRemaining()?new DecodedInformation(this.current.getPosition(),this.buffer.toString(),lastDecoded.getRemainingValue()):new DecodedInformation(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let isFinished,result;do{let initialPosition=this.current.getPosition();if(this.current.isAlpha()?(result=this.parseAlphaBlock(),isFinished=result.isFinished()):this.current.isIsoIec646()?(result=this.parseIsoIec646Block(),isFinished=result.isFinished()):(result=this.parseNumericBlock(),isFinished=result.isFinished()),!(initialPosition!==this.current.getPosition())&&!isFinished)break}while(!isFinished);return result.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let numeric=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(numeric.getNewPosition()),numeric.isFirstDigitFNC1()){let information;return numeric.isSecondDigitFNC1()?information=new DecodedInformation(this.current.getPosition(),this.buffer.toString()):information=new DecodedInformation(this.current.getPosition(),this.buffer.toString(),numeric.getSecondDigit()),new BlockParsedResult(!0,information)}if(this.buffer.append(numeric.getFirstDigit()),numeric.isSecondDigitFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,information)}this.buffer.append(numeric.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new BlockParsedResult(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let iso=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(iso.getNewPosition()),iso.isFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,information)}this.buffer.append(iso.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new BlockParsedResult(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let alpha=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(alpha.getNewPosition()),alpha.isFNC1()){let information=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,information)}this.buffer.append(alpha.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new BlockParsedResult(!1)}isStillIsoIec646(pos){if(pos+5>this.information.getSize())return!1;let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue>=5&&fiveBitValue<16)return!0;if(pos+7>this.information.getSize())return!1;let sevenBitValue=this.extractNumericValueFromBitArray(pos,7);if(sevenBitValue>=64&&sevenBitValue<116)return!0;if(pos+8>this.information.getSize())return!1;let eightBitValue=this.extractNumericValueFromBitArray(pos,8);return eightBitValue>=232&&eightBitValue<253}decodeIsoIec646(pos){let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue===15)return new DecodedChar(pos+5,DecodedChar.FNC1);if(fiveBitValue>=5&&fiveBitValue<15)return new DecodedChar(pos+5,"0"+(fiveBitValue-5));let sevenBitValue=this.extractNumericValueFromBitArray(pos,7);if(sevenBitValue>=64&&sevenBitValue<90)return new DecodedChar(pos+7,""+(sevenBitValue+1));if(sevenBitValue>=90&&sevenBitValue<116)return new DecodedChar(pos+7,""+(sevenBitValue+7));let eightBitValue=this.extractNumericValueFromBitArray(pos,8),c;switch(eightBitValue){case 232:c="!";break;case 233:c='"';break;case 234:c="%";break;case 235:c="&";break;case 236:c="'";break;case 237:c="(";break;case 238:c=")";break;case 239:c="*";break;case 240:c="+";break;case 241:c=",";break;case 242:c="-";break;case 243:c=".";break;case 244:c="/";break;case 245:c=":";break;case 246:c=";";break;case 247:c="<";break;case 248:c="=";break;case 249:c=">";break;case 250:c="?";break;case 251:c="_";break;case 252:c=" ";break;default:throw new FormatException}return new DecodedChar(pos+8,c)}isStillAlpha(pos){if(pos+5>this.information.getSize())return!1;let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue>=5&&fiveBitValue<16)return!0;if(pos+6>this.information.getSize())return!1;let sixBitValue=this.extractNumericValueFromBitArray(pos,6);return sixBitValue>=16&&sixBitValue<63}decodeAlphanumeric(pos){let fiveBitValue=this.extractNumericValueFromBitArray(pos,5);if(fiveBitValue===15)return new DecodedChar(pos+5,DecodedChar.FNC1);if(fiveBitValue>=5&&fiveBitValue<15)return new DecodedChar(pos+5,"0"+(fiveBitValue-5));let sixBitValue=this.extractNumericValueFromBitArray(pos,6);if(sixBitValue>=32&&sixBitValue<58)return new DecodedChar(pos+6,""+(sixBitValue+33));let c;switch(sixBitValue){case 58:c="*";break;case 59:c=",";break;case 60:c="-";break;case 61:c=".";break;case 62:c="/";break;default:throw new IllegalStateException("Decoding invalid alphanumeric value: "+sixBitValue)}return new DecodedChar(pos+6,c)}isAlphaTo646ToAlphaLatch(pos){if(pos+1>this.information.getSize())return!1;for(let i=0;i<5&&i+pos<this.information.getSize();++i)if(i===2){if(!this.information.get(pos+2))return!1}else if(this.information.get(pos+i))return!1;return!0}isAlphaOr646ToNumericLatch(pos){if(pos+3>this.information.getSize())return!1;for(let i=pos;i<pos+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(pos){if(pos+1>this.information.getSize())return!1;for(let i=0;i<4&&i+pos<this.information.getSize();++i)if(this.information.get(pos+i))return!1;return!0}}class AbstractExpandedDecoder{constructor(information){this.information=information,this.generalDecoder=new GeneralAppIdDecoder(information)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class AI01decoder extends AbstractExpandedDecoder{constructor(information){super(information)}encodeCompressedGtin(buf,currentPos){buf.append("(01)");let initialPosition=buf.length();buf.append("9"),this.encodeCompressedGtinWithoutAI(buf,currentPos,initialPosition)}encodeCompressedGtinWithoutAI(buf,currentPos,initialBufferPosition){for(let i=0;i<4;++i){let currentBlock=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos+10*i,10);currentBlock/100===0&&buf.append("0"),currentBlock/10===0&&buf.append("0"),buf.append(currentBlock)}AI01decoder.appendCheckDigit(buf,initialBufferPosition)}static appendCheckDigit(buf,currentPos){let checkDigit=0;for(let i=0;i<13;i++){let digit=buf.charAt(i+currentPos).charCodeAt(0)-48;checkDigit+=i&1?digit:3*digit}checkDigit=10-checkDigit%10,checkDigit===10&&(checkDigit=0),buf.append(checkDigit)}}AI01decoder.GTIN_SIZE=40;class AI01AndOtherAIs extends AI01decoder{constructor(information){super(information)}parseInformation(){let buff=new StringBuilder;buff.append("(01)");let initialGtinPosition=buff.length(),firstGtinDigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01AndOtherAIs.HEADER_SIZE,4);return buff.append(firstGtinDigit),this.encodeCompressedGtinWithoutAI(buff,AI01AndOtherAIs.HEADER_SIZE+4,initialGtinPosition),this.getGeneralDecoder().decodeAllCodes(buff,AI01AndOtherAIs.HEADER_SIZE+44)}}AI01AndOtherAIs.HEADER_SIZE=4;class AnyAIDecoder extends AbstractExpandedDecoder{constructor(information){super(information)}parseInformation(){let buf=new StringBuilder;return this.getGeneralDecoder().decodeAllCodes(buf,AnyAIDecoder.HEADER_SIZE)}}AnyAIDecoder.HEADER_SIZE=5;class AI01weightDecoder extends AI01decoder{constructor(information){super(information)}encodeCompressedWeight(buf,currentPos,weightSize){let originalWeightNumeric=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos,weightSize);this.addWeightCode(buf,originalWeightNumeric);let weightNumeric=this.checkWeight(originalWeightNumeric),currentDivisor=1e5;for(let i=0;i<5;++i)weightNumeric/currentDivisor===0&&buf.append("0"),currentDivisor/=10;buf.append(weightNumeric)}}class AI013x0xDecoder extends AI01weightDecoder{constructor(information){super(information)}parseInformation(){if(this.getInformation().getSize()!=AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE+AI013x0xDecoder.WEIGHT_SIZE)throw new NotFoundException;let buf=new StringBuilder;return this.encodeCompressedGtin(buf,AI013x0xDecoder.HEADER_SIZE),this.encodeCompressedWeight(buf,AI013x0xDecoder.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE,AI013x0xDecoder.WEIGHT_SIZE),buf.toString()}}AI013x0xDecoder.HEADER_SIZE=5,AI013x0xDecoder.WEIGHT_SIZE=15;class AI013103decoder extends AI013x0xDecoder{constructor(information){super(information)}addWeightCode(buf,weight){buf.append("(3103)")}checkWeight(weight){return weight}}class AI01320xDecoder extends AI013x0xDecoder{constructor(information){super(information)}addWeightCode(buf,weight){weight<1e4?buf.append("(3202)"):buf.append("(3203)")}checkWeight(weight){return weight<1e4?weight:weight-1e4}}class AI01392xDecoder extends AI01decoder{constructor(information){super(information)}parseInformation(){if(this.getInformation().getSize()<AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;let buf=new StringBuilder;this.encodeCompressedGtin(buf,AI01392xDecoder.HEADER_SIZE);let lastAIdigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01392xDecoder.LAST_DIGIT_SIZE);buf.append("(392"),buf.append(lastAIdigit),buf.append(")");let decodedInformation=this.getGeneralDecoder().decodeGeneralPurposeField(AI01392xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01392xDecoder.LAST_DIGIT_SIZE,null);return buf.append(decodedInformation.getNewString()),buf.toString()}}AI01392xDecoder.HEADER_SIZE=8,AI01392xDecoder.LAST_DIGIT_SIZE=2;class AI01393xDecoder extends AI01decoder{constructor(information){super(information)}parseInformation(){if(this.getInformation().getSize()<AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;let buf=new StringBuilder;this.encodeCompressedGtin(buf,AI01393xDecoder.HEADER_SIZE);let lastAIdigit=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE,AI01393xDecoder.LAST_DIGIT_SIZE);buf.append("(393"),buf.append(lastAIdigit),buf.append(")");let firstThreeDigits=this.getGeneralDecoder().extractNumericValueFromBitArray(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE,AI01393xDecoder.FIRST_THREE_DIGITS_SIZE);firstThreeDigits/100==0&&buf.append("0"),firstThreeDigits/10==0&&buf.append("0"),buf.append(firstThreeDigits);let generalInformation=this.getGeneralDecoder().decodeGeneralPurposeField(AI01393xDecoder.HEADER_SIZE+AI01decoder.GTIN_SIZE+AI01393xDecoder.LAST_DIGIT_SIZE+AI01393xDecoder.FIRST_THREE_DIGITS_SIZE,null);return buf.append(generalInformation.getNewString()),buf.toString()}}AI01393xDecoder.HEADER_SIZE=8,AI01393xDecoder.LAST_DIGIT_SIZE=2,AI01393xDecoder.FIRST_THREE_DIGITS_SIZE=10;class AI013x0x1xDecoder extends AI01weightDecoder{constructor(information,firstAIdigits,dateCode){super(information),this.dateCode=dateCode,this.firstAIdigits=firstAIdigits}parseInformation(){if(this.getInformation().getSize()!=AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE+AI013x0x1xDecoder.DATE_SIZE)throw new NotFoundException;let buf=new StringBuilder;return this.encodeCompressedGtin(buf,AI013x0x1xDecoder.HEADER_SIZE),this.encodeCompressedWeight(buf,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE,AI013x0x1xDecoder.WEIGHT_SIZE),this.encodeCompressedDate(buf,AI013x0x1xDecoder.HEADER_SIZE+AI013x0x1xDecoder.GTIN_SIZE+AI013x0x1xDecoder.WEIGHT_SIZE),buf.toString()}encodeCompressedDate(buf,currentPos){let numericDate=this.getGeneralDecoder().extractNumericValueFromBitArray(currentPos,AI013x0x1xDecoder.DATE_SIZE);if(numericDate==38400)return;buf.append("("),buf.append(this.dateCode),buf.append(")");let day=numericDate%32;numericDate/=32;let month=numericDate%12+1;numericDate/=12;let year=numericDate;year/10==0&&buf.append("0"),buf.append(year),month/10==0&&buf.append("0"),buf.append(month),day/10==0&&buf.append("0"),buf.append(day)}addWeightCode(buf,weight){buf.append("("),buf.append(this.firstAIdigits),buf.append(weight/1e5),buf.append(")")}checkWeight(weight){return weight%1e5}}AI013x0x1xDecoder.HEADER_SIZE=8,AI013x0x1xDecoder.WEIGHT_SIZE=20,AI013x0x1xDecoder.DATE_SIZE=16;function createDecoder(information){try{if(information.get(1))return new AI01AndOtherAIs(information);if(!information.get(2))return new AnyAIDecoder(information);switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,4)){case 4:return new AI013103decoder(information);case 5:return new AI01320xDecoder(information)}switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,5)){case 12:return new AI01392xDecoder(information);case 13:return new AI01393xDecoder(information)}switch(GeneralAppIdDecoder.extractNumericValueFromBitArray(information,1,7)){case 56:return new AI013x0x1xDecoder(information,"310","11");case 57:return new AI013x0x1xDecoder(information,"320","11");case 58:return new AI013x0x1xDecoder(information,"310","13");case 59:return new AI013x0x1xDecoder(information,"320","13");case 60:return new AI013x0x1xDecoder(information,"310","15");case 61:return new AI013x0x1xDecoder(information,"320","15");case 62:return new AI013x0x1xDecoder(information,"310","17");case 63:return new AI013x0x1xDecoder(information,"320","17")}}catch(e){throw console.log(e),new IllegalStateException("unknown decoder: "+information)}}class ExpandedPair{constructor(leftChar,rightChar,finderPatter,mayBeLast){this.leftchar=leftChar,this.rightchar=rightChar,this.finderpattern=finderPatter,this.maybeLast=mayBeLast}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(o1,o2){return o1 instanceof ExpandedPair?ExpandedPair.equalsOrNull(o1.leftchar,o2.leftchar)&&ExpandedPair.equalsOrNull(o1.rightchar,o2.rightchar)&&ExpandedPair.equalsOrNull(o1.finderpattern,o2.finderpattern):!1}static equalsOrNull(o1,o2){return o1===null?o2===null:ExpandedPair.equals(o1,o2)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ExpandedRow{constructor(pairs,rowNumber,wasReversed){this.pairs=pairs,this.rowNumber=rowNumber,this.wasReversed=wasReversed}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(otherPairs){return this.checkEqualitity(this,otherPairs)}toString(){return"{ "+this.pairs+" }"}equals(o1,o2){return o1 instanceof ExpandedRow?this.checkEqualitity(o1,o2)&&o1.wasReversed===o2.wasReversed:!1}checkEqualitity(pair1,pair2){if(!pair1||!pair2)return;let result;return pair1.forEach((e1,i)=>{pair2.forEach(e2=>{e1.getLeftChar().getValue()===e2.getLeftChar().getValue()&&e1.getRightChar().getValue()===e2.getRightChar().getValue()&&e1.getFinderPatter().getValue()===e2.getFinderPatter().getValue()&&(result=!0)})}),result}}class RSSExpandedReader extends AbstractRSSReader{constructor(verbose){super(...arguments),this.pairs=new Array(RSSExpandedReader.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=verbose===!0}decodeRow(rowNumber,row,hints){this.pairs.length=0,this.startFromEven=!1;try{return RSSExpandedReader.constructResult(this.decodeRow2pairs(rowNumber,row))}catch(e){this.verbose&&console.log(e)}return this.pairs.length=0,this.startFromEven=!0,RSSExpandedReader.constructResult(this.decodeRow2pairs(rowNumber,row))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(rowNumber,row){let done=!1;for(;!done;)try{this.pairs.push(this.retrieveNextPair(row,this.pairs,rowNumber))}catch(error){if(error instanceof NotFoundException){if(!this.pairs.length)throw new NotFoundException;done=!0}}if(this.checkChecksum())return this.pairs;let tryStackedDecode;if(this.rows.length?tryStackedDecode=!0:tryStackedDecode=!1,this.storeRow(rowNumber,!1),tryStackedDecode){let ps=this.checkRowsBoolean(!1);if(ps!=null||(ps=this.checkRowsBoolean(!0),ps!=null))return ps}throw new NotFoundException}checkRowsBoolean(reverse){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,reverse&&(this.rows=this.rows.reverse());let ps=null;try{ps=this.checkRows(new Array,0)}catch(e){this.verbose&&console.log(e)}return reverse&&(this.rows=this.rows.reverse()),ps}checkRows(collectedRows,currentRow){for(let i=currentRow;i<this.rows.length;i++){let row=this.rows[i];this.pairs.length=0;for(let collectedRow of collectedRows)this.pairs.push(collectedRow.getPairs());if(this.pairs.push(row.getPairs()),!RSSExpandedReader.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let rs=new Array(collectedRows);rs.push(row);try{return this.checkRows(rs,i+1)}catch(e){this.verbose&&console.log(e)}}throw new NotFoundException}static isValidSequence(pairs){for(let sequence of RSSExpandedReader.FINDER_PATTERN_SEQUENCES){if(pairs.length>sequence.length)continue;let stop=!0;for(let j=0;j<pairs.length;j++)if(pairs[j].getFinderPattern().getValue()!=sequence[j]){stop=!1;break}if(stop)return!0}return!1}storeRow(rowNumber,wasReversed){let insertPos=0,prevIsSame=!1,nextIsSame=!1;for(;insertPos<this.rows.length;){let erow=this.rows[insertPos];if(erow.getRowNumber()>rowNumber){nextIsSame=erow.isEquivalent(this.pairs);break}prevIsSame=erow.isEquivalent(this.pairs),insertPos++}nextIsSame||prevIsSame||RSSExpandedReader.isPartialRow(this.pairs,this.rows)||(this.rows.push(insertPos,new ExpandedRow(this.pairs,rowNumber,wasReversed)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(pairs,rows){for(let row of rows)if(row.getPairs().length!==pairs.length){for(let p of row.getPairs())for(let pp of pairs)if(ExpandedPair.equals(p,pp))break}}static isPartialRow(pairs,rows){for(let r of rows){let allFound=!0;for(let p of pairs){let found=!1;for(let pp of r.getPairs())if(p.equals(pp)){found=!0;break}if(!found){allFound=!1;break}}if(allFound)return!0}return!1}getRows(){return this.rows}static constructResult(pairs){let binary=BitArrayBuilder.buildBitArray(pairs),resultingString=createDecoder(binary).parseInformation(),firstPoints=pairs[0].getFinderPattern().getResultPoints(),lastPoints=pairs[pairs.length-1].getFinderPattern().getResultPoints(),points=[firstPoints[0],firstPoints[1],lastPoints[0],lastPoints[1]];return new Result(resultingString,null,null,points,BarcodeFormat$1.RSS_EXPANDED,null)}checkChecksum(){let firstPair=this.pairs.get(0),checkCharacter=firstPair.getLeftChar(),firstCharacter=firstPair.getRightChar();if(firstCharacter==null)return!1;let checksum=firstCharacter.getChecksumPortion(),s=2;for(let i=1;i<this.pairs.size();++i){let currentPair=this.pairs.get(i);checksum+=currentPair.getLeftChar().getChecksumPortion(),s++;let currentRightChar=currentPair.getRightChar();currentRightChar!=null&&(checksum+=currentRightChar.getChecksumPortion(),s++)}return checksum%=211,211*(s-4)+checksum==checkCharacter.getValue()}static getNextSecondBar(row,initialPos){let currentPos;return row.get(initialPos)?(currentPos=row.getNextUnset(initialPos),currentPos=row.getNextSet(currentPos)):(currentPos=row.getNextSet(initialPos),currentPos=row.getNextUnset(currentPos)),currentPos}retrieveNextPair(row,previousPairs,rowNumber){let isOddPattern=previousPairs.length%2==0;this.startFromEven&&(isOddPattern=!isOddPattern);let pattern,keepFinding=!0,forcedOffset=-1;do this.findNextPair(row,previousPairs,forcedOffset),pattern=this.parseFoundFinderPattern(row,rowNumber,isOddPattern),pattern==null?forcedOffset=RSSExpandedReader.getNextSecondBar(row,this.startEnd[0]):keepFinding=!1;while(keepFinding);let leftChar=this.decodeDataCharacter(row,pattern,isOddPattern,!0);if(!this.isEmptyPair(previousPairs)&&previousPairs[previousPairs.length-1].mustBeLast())throw new NotFoundException;let rightChar;try{rightChar=this.decodeDataCharacter(row,pattern,isOddPattern,!1)}catch(e){rightChar=null,this.verbose&&console.log(e)}return new ExpandedPair(leftChar,rightChar,pattern,!0)}isEmptyPair(pairs){return pairs.length===0}findNextPair(row,previousPairs,forcedOffset){let counters=this.getDecodeFinderCounters();counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let width=row.getSize(),rowOffset;forcedOffset>=0?rowOffset=forcedOffset:this.isEmptyPair(previousPairs)?rowOffset=0:rowOffset=previousPairs[previousPairs.length-1].getFinderPattern().getStartEnd()[1];let searchingEvenPair=previousPairs.length%2!=0;this.startFromEven&&(searchingEvenPair=!searchingEvenPair);let isWhite=!1;for(;rowOffset<width&&(isWhite=!row.get(rowOffset),!!isWhite);)rowOffset++;let counterPosition=0,patternStart=rowOffset;for(let x=rowOffset;x<width;x++)if(row.get(x)!=isWhite)counters[counterPosition]++;else{if(counterPosition==3){if(searchingEvenPair&&RSSExpandedReader.reverseCounters(counters),RSSExpandedReader.isFinderPattern(counters)){this.startEnd[0]=patternStart,this.startEnd[1]=x;return}searchingEvenPair&&RSSExpandedReader.reverseCounters(counters),patternStart+=counters[0]+counters[1],counters[0]=counters[2],counters[1]=counters[3],counters[2]=0,counters[3]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}static reverseCounters(counters){let length=counters.length;for(let i=0;i<length/2;++i){let tmp=counters[i];counters[i]=counters[length-i-1],counters[length-i-1]=tmp}}parseFoundFinderPattern(row,rowNumber,oddPattern){let firstCounter,start,end;if(oddPattern){let firstElementStart=this.startEnd[0]-1;for(;firstElementStart>=0&&!row.get(firstElementStart);)firstElementStart--;firstElementStart++,firstCounter=this.startEnd[0]-firstElementStart,start=firstElementStart,end=this.startEnd[1]}else start=this.startEnd[0],end=row.getNextUnset(this.startEnd[1]+1),firstCounter=end-this.startEnd[1];let counters=this.getDecodeFinderCounters();System.arraycopy(counters,0,counters,1,counters.length-1),counters[0]=firstCounter;let value;try{value=this.parseFinderValue(counters,RSSExpandedReader.FINDER_PATTERNS)}catch{return null}return new FinderPattern(value,[start,end],start,end,rowNumber)}decodeDataCharacter(row,pattern,isOddPattern,leftChar){let counters=this.getDataCharacterCounters();for(let x=0;x<counters.length;x++)counters[x]=0;if(leftChar)RSSExpandedReader.recordPatternInReverse(row,pattern.getStartEnd()[0],counters);else{RSSExpandedReader.recordPattern(row,pattern.getStartEnd()[1],counters);for(let i=0,j=counters.length-1;i<j;i++,j--){let temp=counters[i];counters[i]=counters[j],counters[j]=temp}}let numModules=17,elementWidth=MathUtils.sum(new Int32Array(counters))/numModules,expectedElementWidth=(pattern.getStartEnd()[1]-pattern.getStartEnd()[0])/15;if(Math.abs(elementWidth-expectedElementWidth)/expectedElementWidth>.3)throw new NotFoundException;let oddCounts=this.getOddCounts(),evenCounts=this.getEvenCounts(),oddRoundingErrors=this.getOddRoundingErrors(),evenRoundingErrors=this.getEvenRoundingErrors();for(let i=0;i<counters.length;i++){let value2=1*counters[i]/elementWidth,count=value2+.5;if(count<1){if(value2<.3)throw new NotFoundException;count=1}else if(count>8){if(value2>8.7)throw new NotFoundException;count=8}let offset=i/2;i&1?(evenCounts[offset]=count,evenRoundingErrors[offset]=value2-count):(oddCounts[offset]=count,oddRoundingErrors[offset]=value2-count)}this.adjustOddEvenCounts(numModules);let weightRowNumber=4*pattern.getValue()+(isOddPattern?0:2)+(leftChar?0:1)-1,oddSum=0,oddChecksumPortion=0;for(let i=oddCounts.length-1;i>=0;i--){if(RSSExpandedReader.isNotA1left(pattern,isOddPattern,leftChar)){let weight=RSSExpandedReader.WEIGHTS[weightRowNumber][2*i];oddChecksumPortion+=oddCounts[i]*weight}oddSum+=oddCounts[i]}let evenChecksumPortion=0;for(let i=evenCounts.length-1;i>=0;i--)if(RSSExpandedReader.isNotA1left(pattern,isOddPattern,leftChar)){let weight=RSSExpandedReader.WEIGHTS[weightRowNumber][2*i+1];evenChecksumPortion+=evenCounts[i]*weight}let checksumPortion=oddChecksumPortion+evenChecksumPortion;if(oddSum&1||oddSum>13||oddSum<4)throw new NotFoundException;let group=(13-oddSum)/2,oddWidest=RSSExpandedReader.SYMBOL_WIDEST[group],evenWidest=9-oddWidest,vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,!0),vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,!1),tEven=RSSExpandedReader.EVEN_TOTAL_SUBSET[group],gSum=RSSExpandedReader.GSUM[group],value=vOdd*tEven+vEven+gSum;return new DataCharacter(value,checksumPortion)}static isNotA1left(pattern,isOddPattern,leftChar){return!(pattern.getValue()==0&&isOddPattern&&leftChar)}adjustOddEvenCounts(numModules){let oddSum=MathUtils.sum(new Int32Array(this.getOddCounts())),evenSum=MathUtils.sum(new Int32Array(this.getEvenCounts())),incrementOdd=!1,decrementOdd=!1;oddSum>13?decrementOdd=!0:oddSum<4&&(incrementOdd=!0);let incrementEven=!1,decrementEven=!1;evenSum>13?decrementEven=!0:evenSum<4&&(incrementEven=!0);let mismatch=oddSum+evenSum-numModules,oddParityBad=(oddSum&1)==1,evenParityBad=(evenSum&1)==0;if(mismatch==1)if(oddParityBad){if(evenParityBad)throw new NotFoundException;decrementOdd=!0}else{if(!evenParityBad)throw new NotFoundException;decrementEven=!0}else if(mismatch==-1)if(oddParityBad){if(evenParityBad)throw new NotFoundException;incrementOdd=!0}else{if(!evenParityBad)throw new NotFoundException;incrementEven=!0}else if(mismatch==0){if(oddParityBad){if(!evenParityBad)throw new NotFoundException;oddSum<evenSum?(incrementOdd=!0,decrementEven=!0):(decrementOdd=!0,incrementEven=!0)}else if(evenParityBad)throw new NotFoundException}else throw new NotFoundException;if(incrementOdd){if(decrementOdd)throw new NotFoundException;RSSExpandedReader.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(decrementOdd&&RSSExpandedReader.decrement(this.getOddCounts(),this.getOddRoundingErrors()),incrementEven){if(decrementEven)throw new NotFoundException;RSSExpandedReader.increment(this.getEvenCounts(),this.getOddRoundingErrors())}decrementEven&&RSSExpandedReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}RSSExpandedReader.SYMBOL_WIDEST=[7,5,4,3,1],RSSExpandedReader.EVEN_TOTAL_SUBSET=[4,20,52,104,204],RSSExpandedReader.GSUM=[0,348,1388,2948,3988],RSSExpandedReader.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],RSSExpandedReader.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],RSSExpandedReader.FINDER_PAT_A=0,RSSExpandedReader.FINDER_PAT_B=1,RSSExpandedReader.FINDER_PAT_C=2,RSSExpandedReader.FINDER_PAT_D=3,RSSExpandedReader.FINDER_PAT_E=4,RSSExpandedReader.FINDER_PAT_F=5,RSSExpandedReader.FINDER_PATTERN_SEQUENCES=[[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_C],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F],[RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_A,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_B,RSSExpandedReader.FINDER_PAT_C,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_D,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_E,RSSExpandedReader.FINDER_PAT_F,RSSExpandedReader.FINDER_PAT_F]],RSSExpandedReader.MAX_PAIRS=11;class Pair extends DataCharacter{constructor(value,checksumPortion,finderPattern){super(value,checksumPortion),this.count=0,this.finderPattern=finderPattern}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class RSS14Reader extends AbstractRSSReader{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(rowNumber,row,hints){const leftPair=this.decodePair(row,!1,rowNumber,hints);RSS14Reader.addOrTally(this.possibleLeftPairs,leftPair),row.reverse();let rightPair=this.decodePair(row,!0,rowNumber,hints);RSS14Reader.addOrTally(this.possibleRightPairs,rightPair),row.reverse();for(let left of this.possibleLeftPairs)if(left.getCount()>1){for(let right of this.possibleRightPairs)if(right.getCount()>1&&RSS14Reader.checkChecksum(left,right))return RSS14Reader.constructResult(left,right)}throw new NotFoundException}static addOrTally(possiblePairs,pair){if(pair==null)return;let found=!1;for(let other of possiblePairs)if(other.getValue()===pair.getValue()){other.incrementCount(),found=!0;break}found||possiblePairs.push(pair)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(leftPair,rightPair){let symbolValue=4537077*leftPair.getValue()+rightPair.getValue(),text=new String(symbolValue).toString(),buffer=new StringBuilder;for(let i=13-text.length;i>0;i--)buffer.append("0");buffer.append(text);let checkDigit=0;for(let i=0;i<13;i++){let digit=buffer.charAt(i).charCodeAt(0)-48;checkDigit+=i&1?digit:3*digit}checkDigit=10-checkDigit%10,checkDigit===10&&(checkDigit=0),buffer.append(checkDigit.toString());let leftPoints=leftPair.getFinderPattern().getResultPoints(),rightPoints=rightPair.getFinderPattern().getResultPoints();return new Result(buffer.toString(),null,0,[leftPoints[0],leftPoints[1],rightPoints[0],rightPoints[1]],BarcodeFormat$1.RSS_14,new Date().getTime())}static checkChecksum(leftPair,rightPair){let checkValue=(leftPair.getChecksumPortion()+16*rightPair.getChecksumPortion())%79,targetCheckValue=9*leftPair.getFinderPattern().getValue()+rightPair.getFinderPattern().getValue();return targetCheckValue>72&&targetCheckValue--,targetCheckValue>8&&targetCheckValue--,checkValue===targetCheckValue}decodePair(row,right,rowNumber,hints){try{let startEnd=this.findFinderPattern(row,right),pattern=this.parseFoundFinderPattern(row,rowNumber,right,startEnd),resultPointCallback=hints==null?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(resultPointCallback!=null){let center=(startEnd[0]+startEnd[1])/2;right&&(center=row.getSize()-1-center),resultPointCallback.foundPossibleResultPoint(new ResultPoint(center,rowNumber))}let outside=this.decodeDataCharacter(row,pattern,!0),inside=this.decodeDataCharacter(row,pattern,!1);return new Pair(1597*outside.getValue()+inside.getValue(),outside.getChecksumPortion()+4*inside.getChecksumPortion(),pattern)}catch{return null}}decodeDataCharacter(row,pattern,outsideChar){let counters=this.getDataCharacterCounters();for(let x=0;x<counters.length;x++)counters[x]=0;if(outsideChar)OneDReader.recordPatternInReverse(row,pattern.getStartEnd()[0],counters);else{OneDReader.recordPattern(row,pattern.getStartEnd()[1]+1,counters);for(let i=0,j=counters.length-1;i<j;i++,j--){let temp=counters[i];counters[i]=counters[j],counters[j]=temp}}let numModules=outsideChar?16:15,elementWidth=MathUtils.sum(new Int32Array(counters))/numModules,oddCounts=this.getOddCounts(),evenCounts=this.getEvenCounts(),oddRoundingErrors=this.getOddRoundingErrors(),evenRoundingErrors=this.getEvenRoundingErrors();for(let i=0;i<counters.length;i++){let value=counters[i]/elementWidth,count=Math.floor(value+.5);count<1?count=1:count>8&&(count=8);let offset=Math.floor(i/2);i&1?(evenCounts[offset]=count,evenRoundingErrors[offset]=value-count):(oddCounts[offset]=count,oddRoundingErrors[offset]=value-count)}this.adjustOddEvenCounts(outsideChar,numModules);let oddSum=0,oddChecksumPortion=0;for(let i=oddCounts.length-1;i>=0;i--)oddChecksumPortion*=9,oddChecksumPortion+=oddCounts[i],oddSum+=oddCounts[i];let evenChecksumPortion=0,evenSum=0;for(let i=evenCounts.length-1;i>=0;i--)evenChecksumPortion*=9,evenChecksumPortion+=evenCounts[i],evenSum+=evenCounts[i];let checksumPortion=oddChecksumPortion+3*evenChecksumPortion;if(outsideChar){if(oddSum&1||oddSum>12||oddSum<4)throw new NotFoundException;let group=(12-oddSum)/2,oddWidest=RSS14Reader.OUTSIDE_ODD_WIDEST[group],evenWidest=9-oddWidest,vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,!1),vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,!0),tEven=RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET[group],gSum=RSS14Reader.OUTSIDE_GSUM[group];return new DataCharacter(vOdd*tEven+vEven+gSum,checksumPortion)}else{if(evenSum&1||evenSum>10||evenSum<4)throw new NotFoundException;let group=(10-evenSum)/2,oddWidest=RSS14Reader.INSIDE_ODD_WIDEST[group],evenWidest=9-oddWidest,vOdd=RSSUtils.getRSSvalue(oddCounts,oddWidest,!0),vEven=RSSUtils.getRSSvalue(evenCounts,evenWidest,!1),tOdd=RSS14Reader.INSIDE_ODD_TOTAL_SUBSET[group],gSum=RSS14Reader.INSIDE_GSUM[group];return new DataCharacter(vEven*tOdd+vOdd+gSum,checksumPortion)}}findFinderPattern(row,rightFinderPattern){let counters=this.getDecodeFinderCounters();counters[0]=0,counters[1]=0,counters[2]=0,counters[3]=0;let width=row.getSize(),isWhite=!1,rowOffset=0;for(;rowOffset<width&&(isWhite=!row.get(rowOffset),rightFinderPattern!==isWhite);)rowOffset++;let counterPosition=0,patternStart=rowOffset;for(let x=rowOffset;x<width;x++)if(row.get(x)!==isWhite)counters[counterPosition]++;else{if(counterPosition===3){if(AbstractRSSReader.isFinderPattern(counters))return[patternStart,x];patternStart+=counters[0]+counters[1],counters[0]=counters[2],counters[1]=counters[3],counters[2]=0,counters[3]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}throw new NotFoundException}parseFoundFinderPattern(row,rowNumber,right,startEnd){let firstIsBlack=row.get(startEnd[0]),firstElementStart=startEnd[0]-1;for(;firstElementStart>=0&&firstIsBlack!==row.get(firstElementStart);)firstElementStart--;firstElementStart++;const firstCounter=startEnd[0]-firstElementStart,counters=this.getDecodeFinderCounters(),copy=new Int32Array(counters.length);System.arraycopy(counters,0,copy,1,counters.length-1),copy[0]=firstCounter;const value=this.parseFinderValue(copy,RSS14Reader.FINDER_PATTERNS);let start=firstElementStart,end=startEnd[1];return right&&(start=row.getSize()-1-start,end=row.getSize()-1-end),new FinderPattern(value,[firstElementStart,startEnd[1]],start,end,rowNumber)}adjustOddEvenCounts(outsideChar,numModules){let oddSum=MathUtils.sum(new Int32Array(this.getOddCounts())),evenSum=MathUtils.sum(new Int32Array(this.getEvenCounts())),incrementOdd=!1,decrementOdd=!1,incrementEven=!1,decrementEven=!1;outsideChar?(oddSum>12?decrementOdd=!0:oddSum<4&&(incrementOdd=!0),evenSum>12?decrementEven=!0:evenSum<4&&(incrementEven=!0)):(oddSum>11?decrementOdd=!0:oddSum<5&&(incrementOdd=!0),evenSum>10?decrementEven=!0:evenSum<4&&(incrementEven=!0));let mismatch=oddSum+evenSum-numModules,oddParityBad=(oddSum&1)===(outsideChar?1:0),evenParityBad=(evenSum&1)===1;if(mismatch===1)if(oddParityBad){if(evenParityBad)throw new NotFoundException;decrementOdd=!0}else{if(!evenParityBad)throw new NotFoundException;decrementEven=!0}else if(mismatch===-1)if(oddParityBad){if(evenParityBad)throw new NotFoundException;incrementOdd=!0}else{if(!evenParityBad)throw new NotFoundException;incrementEven=!0}else if(mismatch===0){if(oddParityBad){if(!evenParityBad)throw new NotFoundException;oddSum<evenSum?(incrementOdd=!0,decrementEven=!0):(decrementOdd=!0,incrementEven=!0)}else if(evenParityBad)throw new NotFoundException}else throw new NotFoundException;if(incrementOdd){if(decrementOdd)throw new NotFoundException;AbstractRSSReader.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(decrementOdd&&AbstractRSSReader.decrement(this.getOddCounts(),this.getOddRoundingErrors()),incrementEven){if(decrementEven)throw new NotFoundException;AbstractRSSReader.increment(this.getEvenCounts(),this.getOddRoundingErrors())}decrementEven&&AbstractRSSReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}RSS14Reader.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],RSS14Reader.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],RSS14Reader.OUTSIDE_GSUM=[0,161,961,2015,2715],RSS14Reader.INSIDE_GSUM=[0,336,1036,1516],RSS14Reader.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],RSS14Reader.INSIDE_ODD_WIDEST=[2,4,6,8],RSS14Reader.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class MultiFormatOneDReader extends OneDReader{constructor(hints,verbose){super(),this.readers=[],this.verbose=verbose===!0;const possibleFormats=hints?hints.get(DecodeHintType$1.POSSIBLE_FORMATS):null,useCode39CheckDigit=hints&&hints.get(DecodeHintType$1.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;possibleFormats?((possibleFormats.includes(BarcodeFormat$1.EAN_13)||possibleFormats.includes(BarcodeFormat$1.UPC_A)||possibleFormats.includes(BarcodeFormat$1.EAN_8)||possibleFormats.includes(BarcodeFormat$1.UPC_E))&&this.readers.push(new MultiFormatUPCEANReader(hints)),possibleFormats.includes(BarcodeFormat$1.CODE_39)&&this.readers.push(new Code39Reader(useCode39CheckDigit)),possibleFormats.includes(BarcodeFormat$1.CODE_128)&&this.readers.push(new Code128Reader),possibleFormats.includes(BarcodeFormat$1.ITF)&&this.readers.push(new ITFReader),possibleFormats.includes(BarcodeFormat$1.RSS_14)&&this.readers.push(new RSS14Reader),possibleFormats.includes(BarcodeFormat$1.RSS_EXPANDED)&&this.readers.push(new RSSExpandedReader(this.verbose))):(this.readers.push(new MultiFormatUPCEANReader(hints)),this.readers.push(new Code39Reader),this.readers.push(new MultiFormatUPCEANReader(hints)),this.readers.push(new Code128Reader),this.readers.push(new ITFReader),this.readers.push(new RSS14Reader),this.readers.push(new RSSExpandedReader(this.verbose)))}decodeRow(rowNumber,row,hints){for(let i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(rowNumber,row,hints)}catch{}throw new NotFoundException}reset(){this.readers.forEach(reader=>reader.reset())}}class BrowserBarcodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500,hints){super(new MultiFormatOneDReader(hints),timeBetweenScansMillis,hints)}}class ECBlocks{constructor(ecCodewords,ecBlocks1,ecBlocks2){this.ecCodewords=ecCodewords,this.ecBlocks=[ecBlocks1],ecBlocks2&&this.ecBlocks.push(ecBlocks2)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class ECB{constructor(count,dataCodewords){this.count=count,this.dataCodewords=dataCodewords}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Version{constructor(versionNumber,symbolSizeRows,symbolSizeColumns,dataRegionSizeRows,dataRegionSizeColumns,ecBlocks){this.versionNumber=versionNumber,this.symbolSizeRows=symbolSizeRows,this.symbolSizeColumns=symbolSizeColumns,this.dataRegionSizeRows=dataRegionSizeRows,this.dataRegionSizeColumns=dataRegionSizeColumns,this.ecBlocks=ecBlocks;let total=0;const ecCodewords=ecBlocks.getECCodewords(),ecbArray=ecBlocks.getECBlocks();for(let ecBlock of ecbArray)total+=ecBlock.getCount()*(ecBlock.getDataCodewords()+ecCodewords);this.totalCodewords=total}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(numRows,numColumns){if(numRows&1||numColumns&1)throw new FormatException;for(let version of Version.VERSIONS)if(version.symbolSizeRows===numRows&&version.symbolSizeColumns===numColumns)return version;throw new FormatException}toString(){return""+this.versionNumber}static buildVersions(){return[new Version(1,10,10,8,8,new ECBlocks(5,new ECB(1,3))),new Version(2,12,12,10,10,new ECBlocks(7,new ECB(1,5))),new Version(3,14,14,12,12,new ECBlocks(10,new ECB(1,8))),new Version(4,16,16,14,14,new ECBlocks(12,new ECB(1,12))),new Version(5,18,18,16,16,new ECBlocks(14,new ECB(1,18))),new Version(6,20,20,18,18,new ECBlocks(18,new ECB(1,22))),new Version(7,22,22,20,20,new ECBlocks(20,new ECB(1,30))),new Version(8,24,24,22,22,new ECBlocks(24,new ECB(1,36))),new Version(9,26,26,24,24,new ECBlocks(28,new ECB(1,44))),new Version(10,32,32,14,14,new ECBlocks(36,new ECB(1,62))),new Version(11,36,36,16,16,new ECBlocks(42,new ECB(1,86))),new Version(12,40,40,18,18,new ECBlocks(48,new ECB(1,114))),new Version(13,44,44,20,20,new ECBlocks(56,new ECB(1,144))),new Version(14,48,48,22,22,new ECBlocks(68,new ECB(1,174))),new Version(15,52,52,24,24,new ECBlocks(42,new ECB(2,102))),new Version(16,64,64,14,14,new ECBlocks(56,new ECB(2,140))),new Version(17,72,72,16,16,new ECBlocks(36,new ECB(4,92))),new Version(18,80,80,18,18,new ECBlocks(48,new ECB(4,114))),new Version(19,88,88,20,20,new ECBlocks(56,new ECB(4,144))),new Version(20,96,96,22,22,new ECBlocks(68,new ECB(4,174))),new Version(21,104,104,24,24,new ECBlocks(56,new ECB(6,136))),new Version(22,120,120,18,18,new ECBlocks(68,new ECB(6,175))),new Version(23,132,132,20,20,new ECBlocks(62,new ECB(8,163))),new Version(24,144,144,22,22,new ECBlocks(62,new ECB(8,156),new ECB(2,155))),new Version(25,8,18,6,16,new ECBlocks(7,new ECB(1,5))),new Version(26,8,32,6,14,new ECBlocks(11,new ECB(1,10))),new Version(27,12,26,10,24,new ECBlocks(14,new ECB(1,16))),new Version(28,12,36,10,16,new ECBlocks(18,new ECB(1,22))),new Version(29,16,36,14,16,new ECBlocks(24,new ECB(1,32))),new Version(30,16,48,14,22,new ECBlocks(28,new ECB(1,49)))]}}Version.VERSIONS=Version.buildVersions();class BitMatrixParser{constructor(bitMatrix){const dimension=bitMatrix.getHeight();if(dimension<8||dimension>144||dimension&1)throw new FormatException;this.version=BitMatrixParser.readVersion(bitMatrix),this.mappingBitMatrix=this.extractDataRegion(bitMatrix),this.readMappingMatrix=new BitMatrix(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(bitMatrix){const numRows=bitMatrix.getHeight(),numColumns=bitMatrix.getWidth();return Version.getVersionForDimensions(numRows,numColumns)}readCodewords(){const result=new Int8Array(this.version.getTotalCodewords());let resultOffset=0,row=4,column=0;const numRows=this.mappingBitMatrix.getHeight(),numColumns=this.mappingBitMatrix.getWidth();let corner1Read=!1,corner2Read=!1,corner3Read=!1,corner4Read=!1;do if(row===numRows&&column===0&&!corner1Read)result[resultOffset++]=this.readCorner1(numRows,numColumns)&255,row-=2,column+=2,corner1Read=!0;else if(row===numRows-2&&column===0&&numColumns&3&&!corner2Read)result[resultOffset++]=this.readCorner2(numRows,numColumns)&255,row-=2,column+=2,corner2Read=!0;else if(row===numRows+4&&column===2&&!(numColumns&7)&&!corner3Read)result[resultOffset++]=this.readCorner3(numRows,numColumns)&255,row-=2,column+=2,corner3Read=!0;else if(row===numRows-2&&column===0&&(numColumns&7)===4&&!corner4Read)result[resultOffset++]=this.readCorner4(numRows,numColumns)&255,row-=2,column+=2,corner4Read=!0;else{do row<numRows&&column>=0&&!this.readMappingMatrix.get(column,row)&&(result[resultOffset++]=this.readUtah(row,column,numRows,numColumns)&255),row-=2,column+=2;while(row>=0&&column<numColumns);row+=1,column+=3;do row>=0&&column<numColumns&&!this.readMappingMatrix.get(column,row)&&(result[resultOffset++]=this.readUtah(row,column,numRows,numColumns)&255),row+=2,column-=2;while(row<numRows&&column>=0);row+=3,column+=1}while(row<numRows||column<numColumns);if(resultOffset!==this.version.getTotalCodewords())throw new FormatException;return result}readModule(row,column,numRows,numColumns){return row<0&&(row+=numRows,column+=4-(numRows+4&7)),column<0&&(column+=numColumns,row+=4-(numColumns+4&7)),this.readMappingMatrix.set(column,row),this.mappingBitMatrix.get(column,row)}readUtah(row,column,numRows,numColumns){let currentByte=0;return this.readModule(row-2,column-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row-2,column-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row-1,column-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row-1,column-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row-1,column,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row,column-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row,column-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(row,column,numRows,numColumns)&&(currentByte|=1),currentByte}readCorner1(numRows,numColumns){let currentByte=0;return this.readModule(numRows-1,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-1,1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-1,2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(2,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(3,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte}readCorner2(numRows,numColumns){let currentByte=0;return this.readModule(numRows-3,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-2,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-1,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-4,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-3,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte}readCorner3(numRows,numColumns){let currentByte=0;return this.readModule(numRows-1,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-1,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-3,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-3,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte}readCorner4(numRows,numColumns){let currentByte=0;return this.readModule(numRows-3,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-2,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(numRows-1,0,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-2,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(0,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(1,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(2,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte<<=1,this.readModule(3,numColumns-1,numRows,numColumns)&&(currentByte|=1),currentByte}extractDataRegion(bitMatrix){const symbolSizeRows=this.version.getSymbolSizeRows(),symbolSizeColumns=this.version.getSymbolSizeColumns();if(bitMatrix.getHeight()!==symbolSizeRows)throw new IllegalArgumentException("Dimension of bitMatrix must match the version size");const dataRegionSizeRows=this.version.getDataRegionSizeRows(),dataRegionSizeColumns=this.version.getDataRegionSizeColumns(),numDataRegionsRow=symbolSizeRows/dataRegionSizeRows|0,numDataRegionsColumn=symbolSizeColumns/dataRegionSizeColumns|0,sizeDataRegionRow=numDataRegionsRow*dataRegionSizeRows,sizeDataRegionColumn=numDataRegionsColumn*dataRegionSizeColumns,bitMatrixWithoutAlignment=new BitMatrix(sizeDataRegionColumn,sizeDataRegionRow);for(let dataRegionRow=0;dataRegionRow<numDataRegionsRow;++dataRegionRow){const dataRegionRowOffset=dataRegionRow*dataRegionSizeRows;for(let dataRegionColumn=0;dataRegionColumn<numDataRegionsColumn;++dataRegionColumn){const dataRegionColumnOffset=dataRegionColumn*dataRegionSizeColumns;for(let i=0;i<dataRegionSizeRows;++i){const readRowOffset=dataRegionRow*(dataRegionSizeRows+2)+1+i,writeRowOffset=dataRegionRowOffset+i;for(let j=0;j<dataRegionSizeColumns;++j){const readColumnOffset=dataRegionColumn*(dataRegionSizeColumns+2)+1+j;if(bitMatrix.get(readColumnOffset,readRowOffset)){const writeColumnOffset=dataRegionColumnOffset+j;bitMatrixWithoutAlignment.set(writeColumnOffset,writeRowOffset)}}}}}return bitMatrixWithoutAlignment}}class DataBlock{constructor(numDataCodewords,codewords){this.numDataCodewords=numDataCodewords,this.codewords=codewords}static getDataBlocks(rawCodewords,version){const ecBlocks=version.getECBlocks();let totalBlocks=0;const ecBlockArray=ecBlocks.getECBlocks();for(let ecBlock of ecBlockArray)totalBlocks+=ecBlock.getCount();const result=new Array(totalBlocks);let numResultBlocks=0;for(let ecBlock of ecBlockArray)for(let i=0;i<ecBlock.getCount();i++){const numDataCodewords=ecBlock.getDataCodewords(),numBlockCodewords=ecBlocks.getECCodewords()+numDataCodewords;result[numResultBlocks++]=new DataBlock(numDataCodewords,new Uint8Array(numBlockCodewords))}const longerBlocksNumDataCodewords=result[0].codewords.length-ecBlocks.getECCodewords(),shorterBlocksNumDataCodewords=longerBlocksNumDataCodewords-1;let rawCodewordsOffset=0;for(let i=0;i<shorterBlocksNumDataCodewords;i++)for(let j=0;j<numResultBlocks;j++)result[j].codewords[i]=rawCodewords[rawCodewordsOffset++];const specialVersion=version.getVersionNumber()===24,numLongerBlocks=specialVersion?8:numResultBlocks;for(let j=0;j<numLongerBlocks;j++)result[j].codewords[longerBlocksNumDataCodewords-1]=rawCodewords[rawCodewordsOffset++];const max=result[0].codewords.length;for(let i=longerBlocksNumDataCodewords;i<max;i++)for(let j=0;j<numResultBlocks;j++){const jOffset=specialVersion?(j+8)%numResultBlocks:j,iOffset=specialVersion&&jOffset>7?i-1:i;result[jOffset].codewords[iOffset]=rawCodewords[rawCodewordsOffset++]}if(rawCodewordsOffset!==rawCodewords.length)throw new IllegalArgumentException;return result}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class BitSource{constructor(bytes){this.bytes=bytes,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(numBits){if(numBits<1||numBits>32||numBits>this.available())throw new IllegalArgumentException(""+numBits);let result=0,bitOffset=this.bitOffset,byteOffset=this.byteOffset;const bytes=this.bytes;if(bitOffset>0){const bitsLeft=8-bitOffset,toRead=numBits<bitsLeft?numBits:bitsLeft,bitsToNotRead=bitsLeft-toRead,mask=255>>8-toRead<<bitsToNotRead;result=(bytes[byteOffset]&mask)>>bitsToNotRead,numBits-=toRead,bitOffset+=toRead,bitOffset===8&&(bitOffset=0,byteOffset++)}if(numBits>0){for(;numBits>=8;)result=result<<8|bytes[byteOffset]&255,byteOffset++,numBits-=8;if(numBits>0){const bitsToNotRead=8-numBits,mask=255>>bitsToNotRead<<bitsToNotRead;result=result<<numBits|(bytes[byteOffset]&mask)>>bitsToNotRead,bitOffset+=numBits}}return this.bitOffset=bitOffset,this.byteOffset=byteOffset,result}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Mode;(function(Mode2){Mode2[Mode2.PAD_ENCODE=0]="PAD_ENCODE",Mode2[Mode2.ASCII_ENCODE=1]="ASCII_ENCODE",Mode2[Mode2.C40_ENCODE=2]="C40_ENCODE",Mode2[Mode2.TEXT_ENCODE=3]="TEXT_ENCODE",Mode2[Mode2.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",Mode2[Mode2.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",Mode2[Mode2.BASE256_ENCODE=6]="BASE256_ENCODE"})(Mode||(Mode={}));class DecodedBitStreamParser{static decode(bytes){const bits=new BitSource(bytes),result=new StringBuilder,resultTrailer=new StringBuilder,byteSegments=new Array;let mode=Mode.ASCII_ENCODE;do if(mode===Mode.ASCII_ENCODE)mode=this.decodeAsciiSegment(bits,result,resultTrailer);else{switch(mode){case Mode.C40_ENCODE:this.decodeC40Segment(bits,result);break;case Mode.TEXT_ENCODE:this.decodeTextSegment(bits,result);break;case Mode.ANSIX12_ENCODE:this.decodeAnsiX12Segment(bits,result);break;case Mode.EDIFACT_ENCODE:this.decodeEdifactSegment(bits,result);break;case Mode.BASE256_ENCODE:this.decodeBase256Segment(bits,result,byteSegments);break;default:throw new FormatException}mode=Mode.ASCII_ENCODE}while(mode!==Mode.PAD_ENCODE&&bits.available()>0);return resultTrailer.length()>0&&result.append(resultTrailer.toString()),new DecoderResult(bytes,result.toString(),byteSegments.length===0?null:byteSegments,null)}static decodeAsciiSegment(bits,result,resultTrailer){let upperShift=!1;do{let oneByte=bits.readBits(8);if(oneByte===0)throw new FormatException;if(oneByte<=128)return upperShift&&(oneByte+=128),result.append(String.fromCharCode(oneByte-1)),Mode.ASCII_ENCODE;if(oneByte===129)return Mode.PAD_ENCODE;if(oneByte<=229){const value=oneByte-130;value<10&&result.append("0"),result.append(""+value)}else switch(oneByte){case 230:return Mode.C40_ENCODE;case 231:return Mode.BASE256_ENCODE;case 232:result.append("");break;case 233:case 234:break;case 235:upperShift=!0;break;case 236:result.append("[)>05"),resultTrailer.insert(0,"");break;case 237:result.append("[)>06"),resultTrailer.insert(0,"");break;case 238:return Mode.ANSIX12_ENCODE;case 239:return Mode.TEXT_ENCODE;case 240:return Mode.EDIFACT_ENCODE;case 241:break;default:if(oneByte!==254||bits.available()!==0)throw new FormatException;break}}while(bits.available()>0);return Mode.ASCII_ENCODE}static decodeC40Segment(bits,result){let upperShift=!1;const cValues=[];let shift=0;do{if(bits.available()===8)return;const firstByte=bits.readBits(8);if(firstByte===254)return;this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(shift){case 0:if(cValue<3)shift=cValue+1;else if(cValue<this.C40_BASIC_SET_CHARS.length){const c40char=this.C40_BASIC_SET_CHARS[cValue];upperShift?(result.append(String.fromCharCode(c40char.charCodeAt(0)+128)),upperShift=!1):result.append(c40char)}else throw new FormatException;break;case 1:upperShift?(result.append(String.fromCharCode(cValue+128)),upperShift=!1):result.append(String.fromCharCode(cValue)),shift=0;break;case 2:if(cValue<this.C40_SHIFT2_SET_CHARS.length){const c40char=this.C40_SHIFT2_SET_CHARS[cValue];upperShift?(result.append(String.fromCharCode(c40char.charCodeAt(0)+128)),upperShift=!1):result.append(c40char)}else switch(cValue){case 27:result.append("");break;case 30:upperShift=!0;break;default:throw new FormatException}shift=0;break;case 3:upperShift?(result.append(String.fromCharCode(cValue+224)),upperShift=!1):result.append(String.fromCharCode(cValue+96)),shift=0;break;default:throw new FormatException}}}while(bits.available()>0)}static decodeTextSegment(bits,result){let upperShift=!1,cValues=[],shift=0;do{if(bits.available()===8)return;const firstByte=bits.readBits(8);if(firstByte===254)return;this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(shift){case 0:if(cValue<3)shift=cValue+1;else if(cValue<this.TEXT_BASIC_SET_CHARS.length){const textChar=this.TEXT_BASIC_SET_CHARS[cValue];upperShift?(result.append(String.fromCharCode(textChar.charCodeAt(0)+128)),upperShift=!1):result.append(textChar)}else throw new FormatException;break;case 1:upperShift?(result.append(String.fromCharCode(cValue+128)),upperShift=!1):result.append(String.fromCharCode(cValue)),shift=0;break;case 2:if(cValue<this.TEXT_SHIFT2_SET_CHARS.length){const textChar=this.TEXT_SHIFT2_SET_CHARS[cValue];upperShift?(result.append(String.fromCharCode(textChar.charCodeAt(0)+128)),upperShift=!1):result.append(textChar)}else switch(cValue){case 27:result.append("");break;case 30:upperShift=!0;break;default:throw new FormatException}shift=0;break;case 3:if(cValue<this.TEXT_SHIFT3_SET_CHARS.length){const textChar=this.TEXT_SHIFT3_SET_CHARS[cValue];upperShift?(result.append(String.fromCharCode(textChar.charCodeAt(0)+128)),upperShift=!1):result.append(textChar),shift=0}else throw new FormatException;break;default:throw new FormatException}}}while(bits.available()>0)}static decodeAnsiX12Segment(bits,result){const cValues=[];do{if(bits.available()===8)return;const firstByte=bits.readBits(8);if(firstByte===254)return;this.parseTwoBytes(firstByte,bits.readBits(8),cValues);for(let i=0;i<3;i++){const cValue=cValues[i];switch(cValue){case 0:result.append("\r");break;case 1:result.append("*");break;case 2:result.append(">");break;case 3:result.append(" ");break;default:if(cValue<14)result.append(String.fromCharCode(cValue+44));else if(cValue<40)result.append(String.fromCharCode(cValue+51));else throw new FormatException;break}}}while(bits.available()>0)}static parseTwoBytes(firstByte,secondByte,result){let fullBitValue=(firstByte<<8)+secondByte-1,temp=Math.floor(fullBitValue/1600);result[0]=temp,fullBitValue-=temp*1600,temp=Math.floor(fullBitValue/40),result[1]=temp,result[2]=fullBitValue-temp*40}static decodeEdifactSegment(bits,result){do{if(bits.available()<=16)return;for(let i=0;i<4;i++){let edifactValue=bits.readBits(6);if(edifactValue===31){const bitsLeft=8-bits.getBitOffset();bitsLeft!==8&&bits.readBits(bitsLeft);return}edifactValue&32||(edifactValue|=64),result.append(String.fromCharCode(edifactValue))}}while(bits.available()>0)}static decodeBase256Segment(bits,result,byteSegments){let codewordPosition=1+bits.getByteOffset();const d1=this.unrandomize255State(bits.readBits(8),codewordPosition++);let count;if(d1===0?count=bits.available()/8|0:d1<250?count=d1:count=250*(d1-249)+this.unrandomize255State(bits.readBits(8),codewordPosition++),count<0)throw new FormatException;const bytes=new Uint8Array(count);for(let i=0;i<count;i++){if(bits.available()<8)throw new FormatException;bytes[i]=this.unrandomize255State(bits.readBits(8),codewordPosition++)}byteSegments.push(bytes);try{result.append(StringEncoding.decode(bytes,StringUtils.ISO88591))}catch(uee){throw new IllegalStateException("Platform does not support required encoding: "+uee.message)}}static unrandomize255State(randomizedBase256Codeword,base256CodewordPosition){const pseudoRandomNumber=149*base256CodewordPosition%255+1,tempVariable=randomizedBase256Codeword-pseudoRandomNumber;return tempVariable>=0?tempVariable:tempVariable+256}}DecodedBitStreamParser.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],DecodedBitStreamParser.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],DecodedBitStreamParser.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],DecodedBitStreamParser.TEXT_SHIFT2_SET_CHARS=DecodedBitStreamParser.C40_SHIFT2_SET_CHARS,DecodedBitStreamParser.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~","\x7F"];class Decoder$1{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.DATA_MATRIX_FIELD_256)}decode(bits){const parser=new BitMatrixParser(bits),version=parser.getVersion(),codewords=parser.readCodewords(),dataBlocks=DataBlock.getDataBlocks(codewords,version);let totalBytes=0;for(let db of dataBlocks)totalBytes+=db.getNumDataCodewords();const resultBytes=new Uint8Array(totalBytes),dataBlocksCount=dataBlocks.length;for(let j=0;j<dataBlocksCount;j++){const dataBlock=dataBlocks[j],codewordBytes=dataBlock.getCodewords(),numDataCodewords=dataBlock.getNumDataCodewords();this.correctErrors(codewordBytes,numDataCodewords);for(let i=0;i<numDataCodewords;i++)resultBytes[i*dataBlocksCount+j]=codewordBytes[i]}return DecodedBitStreamParser.decode(resultBytes)}correctErrors(codewordBytes,numDataCodewords){const codewordsInts=new Int32Array(codewordBytes);try{this.rsDecoder.decode(codewordsInts,codewordBytes.length-numDataCodewords)}catch{throw new ChecksumException}for(let i=0;i<numDataCodewords;i++)codewordBytes[i]=codewordsInts[i]}}class Detector$1{constructor(image){this.image=image,this.rectangleDetector=new WhiteRectangleDetector(this.image)}detect(){const cornerPoints=this.rectangleDetector.detect();let points=this.detectSolid1(cornerPoints);if(points=this.detectSolid2(points),points[3]=this.correctTopRight(points),!points[3])throw new NotFoundException;points=this.shiftToModuleCenter(points);const topLeft=points[0],bottomLeft=points[1],bottomRight=points[2],topRight=points[3];let dimensionTop=this.transitionsBetween(topLeft,topRight)+1,dimensionRight=this.transitionsBetween(bottomRight,topRight)+1;(dimensionTop&1)===1&&(dimensionTop+=1),(dimensionRight&1)===1&&(dimensionRight+=1),4*dimensionTop<7*dimensionRight&&4*dimensionRight<7*dimensionTop&&(dimensionTop=dimensionRight=Math.max(dimensionTop,dimensionRight));let bits=Detector$1.sampleGrid(this.image,topLeft,bottomLeft,bottomRight,topRight,dimensionTop,dimensionRight);return new DetectorResult(bits,[topLeft,bottomLeft,bottomRight,topRight])}static shiftPoint(point,to,div){let x=(to.getX()-point.getX())/(div+1),y=(to.getY()-point.getY())/(div+1);return new ResultPoint(point.getX()+x,point.getY()+y)}static moveAway(point,fromX,fromY){let x=point.getX(),y=point.getY();return x<fromX?x-=1:x+=1,y<fromY?y-=1:y+=1,new ResultPoint(x,y)}detectSolid1(cornerPoints){let pointA=cornerPoints[0],pointB=cornerPoints[1],pointC=cornerPoints[3],pointD=cornerPoints[2],trAB=this.transitionsBetween(pointA,pointB),trBC=this.transitionsBetween(pointB,pointC),trCD=this.transitionsBetween(pointC,pointD),trDA=this.transitionsBetween(pointD,pointA),min=trAB,points=[pointD,pointA,pointB,pointC];return min>trBC&&(min=trBC,points[0]=pointA,points[1]=pointB,points[2]=pointC,points[3]=pointD),min>trCD&&(min=trCD,points[0]=pointB,points[1]=pointC,points[2]=pointD,points[3]=pointA),min>trDA&&(points[0]=pointC,points[1]=pointD,points[2]=pointA,points[3]=pointB),points}detectSolid2(points){let pointA=points[0],pointB=points[1],pointC=points[2],pointD=points[3],tr=this.transitionsBetween(pointA,pointD),pointBs=Detector$1.shiftPoint(pointB,pointC,(tr+1)*4),pointCs=Detector$1.shiftPoint(pointC,pointB,(tr+1)*4),trBA=this.transitionsBetween(pointBs,pointA),trCD=this.transitionsBetween(pointCs,pointD);return trBA<trCD?(points[0]=pointA,points[1]=pointB,points[2]=pointC,points[3]=pointD):(points[0]=pointB,points[1]=pointC,points[2]=pointD,points[3]=pointA),points}correctTopRight(points){let pointA=points[0],pointB=points[1],pointC=points[2],pointD=points[3],trTop=this.transitionsBetween(pointA,pointD),trRight=this.transitionsBetween(pointB,pointD),pointAs=Detector$1.shiftPoint(pointA,pointB,(trRight+1)*4),pointCs=Detector$1.shiftPoint(pointC,pointB,(trTop+1)*4);trTop=this.transitionsBetween(pointAs,pointD),trRight=this.transitionsBetween(pointCs,pointD);let candidate1=new ResultPoint(pointD.getX()+(pointC.getX()-pointB.getX())/(trTop+1),pointD.getY()+(pointC.getY()-pointB.getY())/(trTop+1)),candidate2=new ResultPoint(pointD.getX()+(pointA.getX()-pointB.getX())/(trRight+1),pointD.getY()+(pointA.getY()-pointB.getY())/(trRight+1));if(!this.isValid(candidate1))return this.isValid(candidate2)?candidate2:null;if(!this.isValid(candidate2))return candidate1;let sumc1=this.transitionsBetween(pointAs,candidate1)+this.transitionsBetween(pointCs,candidate1),sumc2=this.transitionsBetween(pointAs,candidate2)+this.transitionsBetween(pointCs,candidate2);return sumc1>sumc2?candidate1:candidate2}shiftToModuleCenter(points){let pointA=points[0],pointB=points[1],pointC=points[2],pointD=points[3],dimH=this.transitionsBetween(pointA,pointD)+1,dimV=this.transitionsBetween(pointC,pointD)+1,pointAs=Detector$1.shiftPoint(pointA,pointB,dimV*4),pointCs=Detector$1.shiftPoint(pointC,pointB,dimH*4);dimH=this.transitionsBetween(pointAs,pointD)+1,dimV=this.transitionsBetween(pointCs,pointD)+1,(dimH&1)===1&&(dimH+=1),(dimV&1)===1&&(dimV+=1);let centerX=(pointA.getX()+pointB.getX()+pointC.getX()+pointD.getX())/4,centerY=(pointA.getY()+pointB.getY()+pointC.getY()+pointD.getY())/4;pointA=Detector$1.moveAway(pointA,centerX,centerY),pointB=Detector$1.moveAway(pointB,centerX,centerY),pointC=Detector$1.moveAway(pointC,centerX,centerY),pointD=Detector$1.moveAway(pointD,centerX,centerY);let pointBs,pointDs;return pointAs=Detector$1.shiftPoint(pointA,pointB,dimV*4),pointAs=Detector$1.shiftPoint(pointAs,pointD,dimH*4),pointBs=Detector$1.shiftPoint(pointB,pointA,dimV*4),pointBs=Detector$1.shiftPoint(pointBs,pointC,dimH*4),pointCs=Detector$1.shiftPoint(pointC,pointD,dimV*4),pointCs=Detector$1.shiftPoint(pointCs,pointB,dimH*4),pointDs=Detector$1.shiftPoint(pointD,pointC,dimV*4),pointDs=Detector$1.shiftPoint(pointDs,pointA,dimH*4),[pointAs,pointBs,pointCs,pointDs]}isValid(p){return p.getX()>=0&&p.getX()<this.image.getWidth()&&p.getY()>0&&p.getY()<this.image.getHeight()}static sampleGrid(image,topLeft,bottomLeft,bottomRight,topRight,dimensionX,dimensionY){return GridSamplerInstance.getInstance().sampleGrid(image,dimensionX,dimensionY,.5,.5,dimensionX-.5,.5,dimensionX-.5,dimensionY-.5,.5,dimensionY-.5,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRight.getX(),bottomRight.getY(),bottomLeft.getX(),bottomLeft.getY())}transitionsBetween(from,to){let fromX=Math.trunc(from.getX()),fromY=Math.trunc(from.getY()),toX=Math.trunc(to.getX()),toY=Math.trunc(to.getY()),steep=Math.abs(toY-fromY)>Math.abs(toX-fromX);if(steep){let temp=fromX;fromX=fromY,fromY=temp,temp=toX,toX=toY,toY=temp}let dx=Math.abs(toX-fromX),dy=Math.abs(toY-fromY),error=-dx/2,ystep=fromY<toY?1:-1,xstep=fromX<toX?1:-1,transitions=0,inBlack=this.image.get(steep?fromY:fromX,steep?fromX:fromY);for(let x=fromX,y=fromY;x!==toX;x+=xstep){let isBlack=this.image.get(steep?y:x,steep?x:y);if(isBlack!==inBlack&&(transitions++,inBlack=isBlack),error+=dy,error>0){if(y===toY)break;y+=ystep,error-=dx}}return transitions}}class DataMatrixReader{constructor(){this.decoder=new Decoder$1}decode(image,hints=null){let decoderResult,points;if(hints!=null&&hints.has(DecodeHintType$1.PURE_BARCODE)){const bits=DataMatrixReader.extractPureBits(image.getBlackMatrix());decoderResult=this.decoder.decode(bits),points=DataMatrixReader.NO_POINTS}else{const detectorResult=new Detector$1(image.getBlackMatrix()).detect();decoderResult=this.decoder.decode(detectorResult.getBits()),points=detectorResult.getPoints()}const rawBytes=decoderResult.getRawBytes(),result=new Result(decoderResult.getText(),rawBytes,8*rawBytes.length,points,BarcodeFormat$1.DATA_MATRIX,System.currentTimeMillis()),byteSegments=decoderResult.getByteSegments();byteSegments!=null&&result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);const ecLevel=decoderResult.getECLevel();return ecLevel!=null&&result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel),result}reset(){}static extractPureBits(image){const leftTopBlack=image.getTopLeftOnBit(),rightBottomBlack=image.getBottomRightOnBit();if(leftTopBlack==null||rightBottomBlack==null)throw new NotFoundException;const moduleSize=this.moduleSize(leftTopBlack,image);let top=leftTopBlack[1];const bottom=rightBottomBlack[1];let left=leftTopBlack[0];const matrixWidth=(rightBottomBlack[0]-left+1)/moduleSize,matrixHeight=(bottom-top+1)/moduleSize;if(matrixWidth<=0||matrixHeight<=0)throw new NotFoundException;const nudge=moduleSize/2;top+=nudge,left+=nudge;const bits=new BitMatrix(matrixWidth,matrixHeight);for(let y=0;y<matrixHeight;y++){const iOffset=top+y*moduleSize;for(let x=0;x<matrixWidth;x++)image.get(left+x*moduleSize,iOffset)&&bits.set(x,y)}return bits}static moduleSize(leftTopBlack,image){const width=image.getWidth();let x=leftTopBlack[0];const y=leftTopBlack[1];for(;x<width&&image.get(x,y);)x++;if(x===width)throw new NotFoundException;const moduleSize=x-leftTopBlack[0];if(moduleSize===0)throw new NotFoundException;return moduleSize}}DataMatrixReader.NO_POINTS=[];class BrowserDatamatrixCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new DataMatrixReader,timeBetweenScansMillis)}}var ErrorCorrectionLevelValues;(function(ErrorCorrectionLevelValues2){ErrorCorrectionLevelValues2[ErrorCorrectionLevelValues2.L=0]="L",ErrorCorrectionLevelValues2[ErrorCorrectionLevelValues2.M=1]="M",ErrorCorrectionLevelValues2[ErrorCorrectionLevelValues2.Q=2]="Q",ErrorCorrectionLevelValues2[ErrorCorrectionLevelValues2.H=3]="H"})(ErrorCorrectionLevelValues||(ErrorCorrectionLevelValues={}));class ErrorCorrectionLevel{constructor(value,stringValue,bits){this.value=value,this.stringValue=stringValue,this.bits=bits,ErrorCorrectionLevel.FOR_BITS.set(bits,this),ErrorCorrectionLevel.FOR_VALUE.set(value,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return ErrorCorrectionLevel.L;case"M":return ErrorCorrectionLevel.M;case"Q":return ErrorCorrectionLevel.Q;case"H":return ErrorCorrectionLevel.H;default:throw new ArgumentException(s+"not available")}}toString(){return this.stringValue}equals(o){if(!(o instanceof ErrorCorrectionLevel))return!1;const other=o;return this.value===other.value}static forBits(bits){if(bits<0||bits>=ErrorCorrectionLevel.FOR_BITS.size)throw new IllegalArgumentException;return ErrorCorrectionLevel.FOR_BITS.get(bits)}}ErrorCorrectionLevel.FOR_BITS=new Map,ErrorCorrectionLevel.FOR_VALUE=new Map,ErrorCorrectionLevel.L=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.L,"L",1),ErrorCorrectionLevel.M=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.M,"M",0),ErrorCorrectionLevel.Q=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.Q,"Q",3),ErrorCorrectionLevel.H=new ErrorCorrectionLevel(ErrorCorrectionLevelValues.H,"H",2);class FormatInformation{constructor(formatInfo){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits(formatInfo>>3&3),this.dataMask=formatInfo&7}static numBitsDiffering(a,b){return Integer.bitCount(a^b)}static decodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2){const formatInfo=FormatInformation.doDecodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2);return formatInfo!==null?formatInfo:FormatInformation.doDecodeFormatInformation(maskedFormatInfo1^FormatInformation.FORMAT_INFO_MASK_QR,maskedFormatInfo2^FormatInformation.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(maskedFormatInfo1,maskedFormatInfo2){let bestDifference=Number.MAX_SAFE_INTEGER,bestFormatInfo=0;for(const decodeInfo of FormatInformation.FORMAT_INFO_DECODE_LOOKUP){const targetInfo=decodeInfo[0];if(targetInfo===maskedFormatInfo1||targetInfo===maskedFormatInfo2)return new FormatInformation(decodeInfo[1]);let bitsDifference=FormatInformation.numBitsDiffering(maskedFormatInfo1,targetInfo);bitsDifference<bestDifference&&(bestFormatInfo=decodeInfo[1],bestDifference=bitsDifference),maskedFormatInfo1!==maskedFormatInfo2&&(bitsDifference=FormatInformation.numBitsDiffering(maskedFormatInfo2,targetInfo),bitsDifference<bestDifference&&(bestFormatInfo=decodeInfo[1],bestDifference=bitsDifference))}return bestDifference<=3?new FormatInformation(bestFormatInfo):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(o){if(!(o instanceof FormatInformation))return!1;const other=o;return this.errorCorrectionLevel===other.errorCorrectionLevel&&this.dataMask===other.dataMask}}FormatInformation.FORMAT_INFO_MASK_QR=21522,FormatInformation.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ECBlocks$1{constructor(ecCodewordsPerBlock,...ecBlocks){this.ecCodewordsPerBlock=ecCodewordsPerBlock,this.ecBlocks=ecBlocks}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let total=0;const ecBlocks=this.ecBlocks;for(const ecBlock of ecBlocks)total+=ecBlock.getCount();return total}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class ECB$1{constructor(count,dataCodewords){this.count=count,this.dataCodewords=dataCodewords}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Version$1{constructor(versionNumber,alignmentPatternCenters,...ecBlocks){this.versionNumber=versionNumber,this.alignmentPatternCenters=alignmentPatternCenters,this.ecBlocks=ecBlocks;let total=0;const ecCodewords=ecBlocks[0].getECCodewordsPerBlock(),ecbArray=ecBlocks[0].getECBlocks();for(const ecBlock of ecbArray)total+=ecBlock.getCount()*(ecBlock.getDataCodewords()+ecCodewords);this.totalCodewords=total}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(ecLevel){return this.ecBlocks[ecLevel.getValue()]}static getProvisionalVersionForDimension(dimension){if(dimension%4!==1)throw new FormatException;try{return this.getVersionForNumber((dimension-17)/4)}catch{throw new FormatException}}static getVersionForNumber(versionNumber){if(versionNumber<1||versionNumber>40)throw new IllegalArgumentException;return Version$1.VERSIONS[versionNumber-1]}static decodeVersionInformation(versionBits){let bestDifference=Number.MAX_SAFE_INTEGER,bestVersion=0;for(let i=0;i<Version$1.VERSION_DECODE_INFO.length;i++){const targetVersion=Version$1.VERSION_DECODE_INFO[i];if(targetVersion===versionBits)return Version$1.getVersionForNumber(i+7);const bitsDifference=FormatInformation.numBitsDiffering(versionBits,targetVersion);bitsDifference<bestDifference&&(bestVersion=i+7,bestDifference=bitsDifference)}return bestDifference<=3?Version$1.getVersionForNumber(bestVersion):null}buildFunctionPattern(){const dimension=this.getDimensionForVersion(),bitMatrix=new BitMatrix(dimension);bitMatrix.setRegion(0,0,9,9),bitMatrix.setRegion(dimension-8,0,8,9),bitMatrix.setRegion(0,dimension-8,9,8);const max=this.alignmentPatternCenters.length;for(let x=0;x<max;x++){const i=this.alignmentPatternCenters[x]-2;for(let y=0;y<max;y++)x===0&&(y===0||y===max-1)||x===max-1&&y===0||bitMatrix.setRegion(this.alignmentPatternCenters[y]-2,i,5,5)}return bitMatrix.setRegion(6,9,1,dimension-17),bitMatrix.setRegion(9,6,dimension-17,1),this.versionNumber>6&&(bitMatrix.setRegion(dimension-11,0,3,6),bitMatrix.setRegion(0,dimension-11,6,3)),bitMatrix}toString(){return""+this.versionNumber}}Version$1.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Version$1.VERSIONS=[new Version$1(1,new Int32Array(0),new ECBlocks$1(7,new ECB$1(1,19)),new ECBlocks$1(10,new ECB$1(1,16)),new ECBlocks$1(13,new ECB$1(1,13)),new ECBlocks$1(17,new ECB$1(1,9))),new Version$1(2,Int32Array.from([6,18]),new ECBlocks$1(10,new ECB$1(1,34)),new ECBlocks$1(16,new ECB$1(1,28)),new ECBlocks$1(22,new ECB$1(1,22)),new ECBlocks$1(28,new ECB$1(1,16))),new Version$1(3,Int32Array.from([6,22]),new ECBlocks$1(15,new ECB$1(1,55)),new ECBlocks$1(26,new ECB$1(1,44)),new ECBlocks$1(18,new ECB$1(2,17)),new ECBlocks$1(22,new ECB$1(2,13))),new Version$1(4,Int32Array.from([6,26]),new ECBlocks$1(20,new ECB$1(1,80)),new ECBlocks$1(18,new ECB$1(2,32)),new ECBlocks$1(26,new ECB$1(2,24)),new ECBlocks$1(16,new ECB$1(4,9))),new Version$1(5,Int32Array.from([6,30]),new ECBlocks$1(26,new ECB$1(1,108)),new ECBlocks$1(24,new ECB$1(2,43)),new ECBlocks$1(18,new ECB$1(2,15),new ECB$1(2,16)),new ECBlocks$1(22,new ECB$1(2,11),new ECB$1(2,12))),new Version$1(6,Int32Array.from([6,34]),new ECBlocks$1(18,new ECB$1(2,68)),new ECBlocks$1(16,new ECB$1(4,27)),new ECBlocks$1(24,new ECB$1(4,19)),new ECBlocks$1(28,new ECB$1(4,15))),new Version$1(7,Int32Array.from([6,22,38]),new ECBlocks$1(20,new ECB$1(2,78)),new ECBlocks$1(18,new ECB$1(4,31)),new ECBlocks$1(18,new ECB$1(2,14),new ECB$1(4,15)),new ECBlocks$1(26,new ECB$1(4,13),new ECB$1(1,14))),new Version$1(8,Int32Array.from([6,24,42]),new ECBlocks$1(24,new ECB$1(2,97)),new ECBlocks$1(22,new ECB$1(2,38),new ECB$1(2,39)),new ECBlocks$1(22,new ECB$1(4,18),new ECB$1(2,19)),new ECBlocks$1(26,new ECB$1(4,14),new ECB$1(2,15))),new Version$1(9,Int32Array.from([6,26,46]),new ECBlocks$1(30,new ECB$1(2,116)),new ECBlocks$1(22,new ECB$1(3,36),new ECB$1(2,37)),new ECBlocks$1(20,new ECB$1(4,16),new ECB$1(4,17)),new ECBlocks$1(24,new ECB$1(4,12),new ECB$1(4,13))),new Version$1(10,Int32Array.from([6,28,50]),new ECBlocks$1(18,new ECB$1(2,68),new ECB$1(2,69)),new ECBlocks$1(26,new ECB$1(4,43),new ECB$1(1,44)),new ECBlocks$1(24,new ECB$1(6,19),new ECB$1(2,20)),new ECBlocks$1(28,new ECB$1(6,15),new ECB$1(2,16))),new Version$1(11,Int32Array.from([6,30,54]),new ECBlocks$1(20,new ECB$1(4,81)),new ECBlocks$1(30,new ECB$1(1,50),new ECB$1(4,51)),new ECBlocks$1(28,new ECB$1(4,22),new ECB$1(4,23)),new ECBlocks$1(24,new ECB$1(3,12),new ECB$1(8,13))),new Version$1(12,Int32Array.from([6,32,58]),new ECBlocks$1(24,new ECB$1(2,92),new ECB$1(2,93)),new ECBlocks$1(22,new ECB$1(6,36),new ECB$1(2,37)),new ECBlocks$1(26,new ECB$1(4,20),new ECB$1(6,21)),new ECBlocks$1(28,new ECB$1(7,14),new ECB$1(4,15))),new Version$1(13,Int32Array.from([6,34,62]),new ECBlocks$1(26,new ECB$1(4,107)),new ECBlocks$1(22,new ECB$1(8,37),new ECB$1(1,38)),new ECBlocks$1(24,new ECB$1(8,20),new ECB$1(4,21)),new ECBlocks$1(22,new ECB$1(12,11),new ECB$1(4,12))),new Version$1(14,Int32Array.from([6,26,46,66]),new ECBlocks$1(30,new ECB$1(3,115),new ECB$1(1,116)),new ECBlocks$1(24,new ECB$1(4,40),new ECB$1(5,41)),new ECBlocks$1(20,new ECB$1(11,16),new ECB$1(5,17)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(5,13))),new Version$1(15,Int32Array.from([6,26,48,70]),new ECBlocks$1(22,new ECB$1(5,87),new ECB$1(1,88)),new ECBlocks$1(24,new ECB$1(5,41),new ECB$1(5,42)),new ECBlocks$1(30,new ECB$1(5,24),new ECB$1(7,25)),new ECBlocks$1(24,new ECB$1(11,12),new ECB$1(7,13))),new Version$1(16,Int32Array.from([6,26,50,74]),new ECBlocks$1(24,new ECB$1(5,98),new ECB$1(1,99)),new ECBlocks$1(28,new ECB$1(7,45),new ECB$1(3,46)),new ECBlocks$1(24,new ECB$1(15,19),new ECB$1(2,20)),new ECBlocks$1(30,new ECB$1(3,15),new ECB$1(13,16))),new Version$1(17,Int32Array.from([6,30,54,78]),new ECBlocks$1(28,new ECB$1(1,107),new ECB$1(5,108)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(1,47)),new ECBlocks$1(28,new ECB$1(1,22),new ECB$1(15,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(17,15))),new Version$1(18,Int32Array.from([6,30,56,82]),new ECBlocks$1(30,new ECB$1(5,120),new ECB$1(1,121)),new ECBlocks$1(26,new ECB$1(9,43),new ECB$1(4,44)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(1,23)),new ECBlocks$1(28,new ECB$1(2,14),new ECB$1(19,15))),new Version$1(19,Int32Array.from([6,30,58,86]),new ECBlocks$1(28,new ECB$1(3,113),new ECB$1(4,114)),new ECBlocks$1(26,new ECB$1(3,44),new ECB$1(11,45)),new ECBlocks$1(26,new ECB$1(17,21),new ECB$1(4,22)),new ECBlocks$1(26,new ECB$1(9,13),new ECB$1(16,14))),new Version$1(20,Int32Array.from([6,34,62,90]),new ECBlocks$1(28,new ECB$1(3,107),new ECB$1(5,108)),new ECBlocks$1(26,new ECB$1(3,41),new ECB$1(13,42)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(5,25)),new ECBlocks$1(28,new ECB$1(15,15),new ECB$1(10,16))),new Version$1(21,Int32Array.from([6,28,50,72,94]),new ECBlocks$1(28,new ECB$1(4,116),new ECB$1(4,117)),new ECBlocks$1(26,new ECB$1(17,42)),new ECBlocks$1(28,new ECB$1(17,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(19,16),new ECB$1(6,17))),new Version$1(22,Int32Array.from([6,26,50,74,98]),new ECBlocks$1(28,new ECB$1(2,111),new ECB$1(7,112)),new ECBlocks$1(28,new ECB$1(17,46)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(16,25)),new ECBlocks$1(24,new ECB$1(34,13))),new Version$1(23,Int32Array.from([6,30,54,78,102]),new ECBlocks$1(30,new ECB$1(4,121),new ECB$1(5,122)),new ECBlocks$1(28,new ECB$1(4,47),new ECB$1(14,48)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(16,15),new ECB$1(14,16))),new Version$1(24,Int32Array.from([6,28,54,80,106]),new ECBlocks$1(30,new ECB$1(6,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(6,45),new ECB$1(14,46)),new ECBlocks$1(30,new ECB$1(11,24),new ECB$1(16,25)),new ECBlocks$1(30,new ECB$1(30,16),new ECB$1(2,17))),new Version$1(25,Int32Array.from([6,32,58,84,110]),new ECBlocks$1(26,new ECB$1(8,106),new ECB$1(4,107)),new ECBlocks$1(28,new ECB$1(8,47),new ECB$1(13,48)),new ECBlocks$1(30,new ECB$1(7,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(13,16))),new Version$1(26,Int32Array.from([6,30,58,86,114]),new ECBlocks$1(28,new ECB$1(10,114),new ECB$1(2,115)),new ECBlocks$1(28,new ECB$1(19,46),new ECB$1(4,47)),new ECBlocks$1(28,new ECB$1(28,22),new ECB$1(6,23)),new ECBlocks$1(30,new ECB$1(33,16),new ECB$1(4,17))),new Version$1(27,Int32Array.from([6,34,62,90,118]),new ECBlocks$1(30,new ECB$1(8,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(22,45),new ECB$1(3,46)),new ECBlocks$1(30,new ECB$1(8,23),new ECB$1(26,24)),new ECBlocks$1(30,new ECB$1(12,15),new ECB$1(28,16))),new Version$1(28,Int32Array.from([6,26,50,74,98,122]),new ECBlocks$1(30,new ECB$1(3,117),new ECB$1(10,118)),new ECBlocks$1(28,new ECB$1(3,45),new ECB$1(23,46)),new ECBlocks$1(30,new ECB$1(4,24),new ECB$1(31,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(31,16))),new Version$1(29,Int32Array.from([6,30,54,78,102,126]),new ECBlocks$1(30,new ECB$1(7,116),new ECB$1(7,117)),new ECBlocks$1(28,new ECB$1(21,45),new ECB$1(7,46)),new ECBlocks$1(30,new ECB$1(1,23),new ECB$1(37,24)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(26,16))),new Version$1(30,Int32Array.from([6,26,52,78,104,130]),new ECBlocks$1(30,new ECB$1(5,115),new ECB$1(10,116)),new ECBlocks$1(28,new ECB$1(19,47),new ECB$1(10,48)),new ECBlocks$1(30,new ECB$1(15,24),new ECB$1(25,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(25,16))),new Version$1(31,Int32Array.from([6,30,56,82,108,134]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(3,116)),new ECBlocks$1(28,new ECB$1(2,46),new ECB$1(29,47)),new ECBlocks$1(30,new ECB$1(42,24),new ECB$1(1,25)),new ECBlocks$1(30,new ECB$1(23,15),new ECB$1(28,16))),new Version$1(32,Int32Array.from([6,34,60,86,112,138]),new ECBlocks$1(30,new ECB$1(17,115)),new ECBlocks$1(28,new ECB$1(10,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(10,24),new ECB$1(35,25)),new ECBlocks$1(30,new ECB$1(19,15),new ECB$1(35,16))),new Version$1(33,Int32Array.from([6,30,58,86,114,142]),new ECBlocks$1(30,new ECB$1(17,115),new ECB$1(1,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(21,47)),new ECBlocks$1(30,new ECB$1(29,24),new ECB$1(19,25)),new ECBlocks$1(30,new ECB$1(11,15),new ECB$1(46,16))),new Version$1(34,Int32Array.from([6,34,62,90,118,146]),new ECBlocks$1(30,new ECB$1(13,115),new ECB$1(6,116)),new ECBlocks$1(28,new ECB$1(14,46),new ECB$1(23,47)),new ECBlocks$1(30,new ECB$1(44,24),new ECB$1(7,25)),new ECBlocks$1(30,new ECB$1(59,16),new ECB$1(1,17))),new Version$1(35,Int32Array.from([6,30,54,78,102,126,150]),new ECBlocks$1(30,new ECB$1(12,121),new ECB$1(7,122)),new ECBlocks$1(28,new ECB$1(12,47),new ECB$1(26,48)),new ECBlocks$1(30,new ECB$1(39,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(22,15),new ECB$1(41,16))),new Version$1(36,Int32Array.from([6,24,50,76,102,128,154]),new ECBlocks$1(30,new ECB$1(6,121),new ECB$1(14,122)),new ECBlocks$1(28,new ECB$1(6,47),new ECB$1(34,48)),new ECBlocks$1(30,new ECB$1(46,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(2,15),new ECB$1(64,16))),new Version$1(37,Int32Array.from([6,28,54,80,106,132,158]),new ECBlocks$1(30,new ECB$1(17,122),new ECB$1(4,123)),new ECBlocks$1(28,new ECB$1(29,46),new ECB$1(14,47)),new ECBlocks$1(30,new ECB$1(49,24),new ECB$1(10,25)),new ECBlocks$1(30,new ECB$1(24,15),new ECB$1(46,16))),new Version$1(38,Int32Array.from([6,32,58,84,110,136,162]),new ECBlocks$1(30,new ECB$1(4,122),new ECB$1(18,123)),new ECBlocks$1(28,new ECB$1(13,46),new ECB$1(32,47)),new ECBlocks$1(30,new ECB$1(48,24),new ECB$1(14,25)),new ECBlocks$1(30,new ECB$1(42,15),new ECB$1(32,16))),new Version$1(39,Int32Array.from([6,26,54,82,110,138,166]),new ECBlocks$1(30,new ECB$1(20,117),new ECB$1(4,118)),new ECBlocks$1(28,new ECB$1(40,47),new ECB$1(7,48)),new ECBlocks$1(30,new ECB$1(43,24),new ECB$1(22,25)),new ECBlocks$1(30,new ECB$1(10,15),new ECB$1(67,16))),new Version$1(40,Int32Array.from([6,30,58,86,114,142,170]),new ECBlocks$1(30,new ECB$1(19,118),new ECB$1(6,119)),new ECBlocks$1(28,new ECB$1(18,47),new ECB$1(31,48)),new ECBlocks$1(30,new ECB$1(34,24),new ECB$1(34,25)),new ECBlocks$1(30,new ECB$1(20,15),new ECB$1(61,16)))];var DataMaskValues;(function(DataMaskValues2){DataMaskValues2[DataMaskValues2.DATA_MASK_000=0]="DATA_MASK_000",DataMaskValues2[DataMaskValues2.DATA_MASK_001=1]="DATA_MASK_001",DataMaskValues2[DataMaskValues2.DATA_MASK_010=2]="DATA_MASK_010",DataMaskValues2[DataMaskValues2.DATA_MASK_011=3]="DATA_MASK_011",DataMaskValues2[DataMaskValues2.DATA_MASK_100=4]="DATA_MASK_100",DataMaskValues2[DataMaskValues2.DATA_MASK_101=5]="DATA_MASK_101",DataMaskValues2[DataMaskValues2.DATA_MASK_110=6]="DATA_MASK_110",DataMaskValues2[DataMaskValues2.DATA_MASK_111=7]="DATA_MASK_111"})(DataMaskValues||(DataMaskValues={}));class DataMask{constructor(value,isMasked){this.value=value,this.isMasked=isMasked}unmaskBitMatrix(bits,dimension){for(let i=0;i<dimension;i++)for(let j=0;j<dimension;j++)this.isMasked(i,j)&&bits.flip(j,i)}}DataMask.values=new Map([[DataMaskValues.DATA_MASK_000,new DataMask(DataMaskValues.DATA_MASK_000,(i,j)=>(i+j&1)===0)],[DataMaskValues.DATA_MASK_001,new DataMask(DataMaskValues.DATA_MASK_001,(i,j)=>(i&1)===0)],[DataMaskValues.DATA_MASK_010,new DataMask(DataMaskValues.DATA_MASK_010,(i,j)=>j%3===0)],[DataMaskValues.DATA_MASK_011,new DataMask(DataMaskValues.DATA_MASK_011,(i,j)=>(i+j)%3===0)],[DataMaskValues.DATA_MASK_100,new DataMask(DataMaskValues.DATA_MASK_100,(i,j)=>(Math.floor(i/2)+Math.floor(j/3)&1)===0)],[DataMaskValues.DATA_MASK_101,new DataMask(DataMaskValues.DATA_MASK_101,(i,j)=>i*j%6===0)],[DataMaskValues.DATA_MASK_110,new DataMask(DataMaskValues.DATA_MASK_110,(i,j)=>i*j%6<3)],[DataMaskValues.DATA_MASK_111,new DataMask(DataMaskValues.DATA_MASK_111,(i,j)=>(i+j+i*j%3&1)===0)]]);class BitMatrixParser$1{constructor(bitMatrix){const dimension=bitMatrix.getHeight();if(dimension<21||(dimension&3)!==1)throw new FormatException;this.bitMatrix=bitMatrix}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let formatInfoBits1=0;for(let i=0;i<6;i++)formatInfoBits1=this.copyBit(i,8,formatInfoBits1);formatInfoBits1=this.copyBit(7,8,formatInfoBits1),formatInfoBits1=this.copyBit(8,8,formatInfoBits1),formatInfoBits1=this.copyBit(8,7,formatInfoBits1);for(let j=5;j>=0;j--)formatInfoBits1=this.copyBit(8,j,formatInfoBits1);const dimension=this.bitMatrix.getHeight();let formatInfoBits2=0;const jMin=dimension-7;for(let j=dimension-1;j>=jMin;j--)formatInfoBits2=this.copyBit(8,j,formatInfoBits2);for(let i=dimension-8;i<dimension;i++)formatInfoBits2=this.copyBit(i,8,formatInfoBits2);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(formatInfoBits1,formatInfoBits2),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new FormatException}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const dimension=this.bitMatrix.getHeight(),provisionalVersion=Math.floor((dimension-17)/4);if(provisionalVersion<=6)return Version$1.getVersionForNumber(provisionalVersion);let versionBits=0;const ijMin=dimension-11;for(let j=5;j>=0;j--)for(let i=dimension-9;i>=ijMin;i--)versionBits=this.copyBit(i,j,versionBits);let theParsedVersion=Version$1.decodeVersionInformation(versionBits);if(theParsedVersion!==null&&theParsedVersion.getDimensionForVersion()===dimension)return this.parsedVersion=theParsedVersion,theParsedVersion;versionBits=0;for(let i=5;i>=0;i--)for(let j=dimension-9;j>=ijMin;j--)versionBits=this.copyBit(i,j,versionBits);if(theParsedVersion=Version$1.decodeVersionInformation(versionBits),theParsedVersion!==null&&theParsedVersion.getDimensionForVersion()===dimension)return this.parsedVersion=theParsedVersion,theParsedVersion;throw new FormatException}copyBit(i,j,versionBits){return(this.isMirror?this.bitMatrix.get(j,i):this.bitMatrix.get(i,j))?versionBits<<1|1:versionBits<<1}readCodewords(){const formatInfo=this.readFormatInformation(),version=this.readVersion(),dataMask=DataMask.values.get(formatInfo.getDataMask()),dimension=this.bitMatrix.getHeight();dataMask.unmaskBitMatrix(this.bitMatrix,dimension);const functionPattern=version.buildFunctionPattern();let readingUp=!0;const result=new Uint8Array(version.getTotalCodewords());let resultOffset=0,currentByte=0,bitsRead=0;for(let j=dimension-1;j>0;j-=2){j===6&&j--;for(let count=0;count<dimension;count++){const i=readingUp?dimension-1-count:count;for(let col=0;col<2;col++)functionPattern.get(j-col,i)||(bitsRead++,currentByte<<=1,this.bitMatrix.get(j-col,i)&&(currentByte|=1),bitsRead===8&&(result[resultOffset++]=currentByte,bitsRead=0,currentByte=0))}readingUp=!readingUp}if(resultOffset!==version.getTotalCodewords())throw new FormatException;return result}remask(){if(this.parsedFormatInfo===null)return;const dataMask=DataMask.values[this.parsedFormatInfo.getDataMask()],dimension=this.bitMatrix.getHeight();dataMask.unmaskBitMatrix(this.bitMatrix,dimension)}setMirror(isMirror){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=isMirror}mirror(){const bitMatrix=this.bitMatrix;for(let x=0,width=bitMatrix.getWidth();x<width;x++)for(let y=x+1,height=bitMatrix.getHeight();y<height;y++)bitMatrix.get(x,y)!==bitMatrix.get(y,x)&&(bitMatrix.flip(y,x),bitMatrix.flip(x,y))}}class DataBlock$1{constructor(numDataCodewords,codewords){this.numDataCodewords=numDataCodewords,this.codewords=codewords}static getDataBlocks(rawCodewords,version,ecLevel){if(rawCodewords.length!==version.getTotalCodewords())throw new IllegalArgumentException;const ecBlocks=version.getECBlocksForLevel(ecLevel);let totalBlocks=0;const ecBlockArray=ecBlocks.getECBlocks();for(const ecBlock of ecBlockArray)totalBlocks+=ecBlock.getCount();const result=new Array(totalBlocks);let numResultBlocks=0;for(const ecBlock of ecBlockArray)for(let i=0;i<ecBlock.getCount();i++){const numDataCodewords=ecBlock.getDataCodewords(),numBlockCodewords=ecBlocks.getECCodewordsPerBlock()+numDataCodewords;result[numResultBlocks++]=new DataBlock$1(numDataCodewords,new Uint8Array(numBlockCodewords))}const shorterBlocksTotalCodewords=result[0].codewords.length;let longerBlocksStartAt=result.length-1;for(;longerBlocksStartAt>=0&&result[longerBlocksStartAt].codewords.length!==shorterBlocksTotalCodewords;)longerBlocksStartAt--;longerBlocksStartAt++;const shorterBlocksNumDataCodewords=shorterBlocksTotalCodewords-ecBlocks.getECCodewordsPerBlock();let rawCodewordsOffset=0;for(let i=0;i<shorterBlocksNumDataCodewords;i++)for(let j=0;j<numResultBlocks;j++)result[j].codewords[i]=rawCodewords[rawCodewordsOffset++];for(let j=longerBlocksStartAt;j<numResultBlocks;j++)result[j].codewords[shorterBlocksNumDataCodewords]=rawCodewords[rawCodewordsOffset++];const max=result[0].codewords.length;for(let i=shorterBlocksNumDataCodewords;i<max;i++)for(let j=0;j<numResultBlocks;j++){const iOffset=j<longerBlocksStartAt?i:i+1;result[j].codewords[iOffset]=rawCodewords[rawCodewordsOffset++]}return result}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ModeValues;(function(ModeValues2){ModeValues2[ModeValues2.TERMINATOR=0]="TERMINATOR",ModeValues2[ModeValues2.NUMERIC=1]="NUMERIC",ModeValues2[ModeValues2.ALPHANUMERIC=2]="ALPHANUMERIC",ModeValues2[ModeValues2.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",ModeValues2[ModeValues2.BYTE=4]="BYTE",ModeValues2[ModeValues2.ECI=5]="ECI",ModeValues2[ModeValues2.KANJI=6]="KANJI",ModeValues2[ModeValues2.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",ModeValues2[ModeValues2.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",ModeValues2[ModeValues2.HANZI=9]="HANZI"})(ModeValues||(ModeValues={}));class Mode$1{constructor(value,stringValue,characterCountBitsForVersions,bits){this.value=value,this.stringValue=stringValue,this.characterCountBitsForVersions=characterCountBitsForVersions,this.bits=bits,Mode$1.FOR_BITS.set(bits,this),Mode$1.FOR_VALUE.set(value,this)}static forBits(bits){const mode=Mode$1.FOR_BITS.get(bits);if(mode===void 0)throw new IllegalArgumentException;return mode}getCharacterCountBits(version){const versionNumber=version.getVersionNumber();let offset;return versionNumber<=9?offset=0:versionNumber<=26?offset=1:offset=2,this.characterCountBitsForVersions[offset]}getValue(){return this.value}getBits(){return this.bits}equals(o){if(!(o instanceof Mode$1))return!1;const other=o;return this.value===other.value}toString(){return this.stringValue}}Mode$1.FOR_BITS=new Map,Mode$1.FOR_VALUE=new Map,Mode$1.TERMINATOR=new Mode$1(ModeValues.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Mode$1.NUMERIC=new Mode$1(ModeValues.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Mode$1.ALPHANUMERIC=new Mode$1(ModeValues.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Mode$1.STRUCTURED_APPEND=new Mode$1(ModeValues.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Mode$1.BYTE=new Mode$1(ModeValues.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Mode$1.ECI=new Mode$1(ModeValues.ECI,"ECI",Int32Array.from([0,0,0]),7),Mode$1.KANJI=new Mode$1(ModeValues.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Mode$1.FNC1_FIRST_POSITION=new Mode$1(ModeValues.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Mode$1.FNC1_SECOND_POSITION=new Mode$1(ModeValues.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Mode$1.HANZI=new Mode$1(ModeValues.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class DecodedBitStreamParser$1{static decode(bytes,version,ecLevel,hints){const bits=new BitSource(bytes);let result=new StringBuilder;const byteSegments=new Array;let symbolSequence=-1,parityData=-1;try{let currentCharacterSetECI=null,fc1InEffect=!1,mode;do{if(bits.available()<4)mode=Mode$1.TERMINATOR;else{const modeBits=bits.readBits(4);mode=Mode$1.forBits(modeBits)}switch(mode){case Mode$1.TERMINATOR:break;case Mode$1.FNC1_FIRST_POSITION:case Mode$1.FNC1_SECOND_POSITION:fc1InEffect=!0;break;case Mode$1.STRUCTURED_APPEND:if(bits.available()<16)throw new FormatException;symbolSequence=bits.readBits(8),parityData=bits.readBits(8);break;case Mode$1.ECI:const value=DecodedBitStreamParser$1.parseECIValue(bits);if(currentCharacterSetECI=CharacterSetECI.getCharacterSetECIByValue(value),currentCharacterSetECI===null)throw new FormatException;break;case Mode$1.HANZI:const subset=bits.readBits(4),countHanzi=bits.readBits(mode.getCharacterCountBits(version));subset===DecodedBitStreamParser$1.GB2312_SUBSET&&DecodedBitStreamParser$1.decodeHanziSegment(bits,result,countHanzi);break;default:const count=bits.readBits(mode.getCharacterCountBits(version));switch(mode){case Mode$1.NUMERIC:DecodedBitStreamParser$1.decodeNumericSegment(bits,result,count);break;case Mode$1.ALPHANUMERIC:DecodedBitStreamParser$1.decodeAlphanumericSegment(bits,result,count,fc1InEffect);break;case Mode$1.BYTE:DecodedBitStreamParser$1.decodeByteSegment(bits,result,count,currentCharacterSetECI,byteSegments,hints);break;case Mode$1.KANJI:DecodedBitStreamParser$1.decodeKanjiSegment(bits,result,count);break;default:throw new FormatException}break}}while(mode!==Mode$1.TERMINATOR)}catch{throw new FormatException}return new DecoderResult(bytes,result.toString(),byteSegments.length===0?null:byteSegments,ecLevel===null?null:ecLevel.toString(),symbolSequence,parityData)}static decodeHanziSegment(bits,result,count){if(count*13>bits.available())throw new FormatException;const buffer=new Uint8Array(2*count);let offset=0;for(;count>0;){const twoBytes=bits.readBits(13);let assembledTwoBytes=twoBytes/96<<8&4294967295|twoBytes%96;assembledTwoBytes<959?assembledTwoBytes+=41377:assembledTwoBytes+=42657,buffer[offset]=assembledTwoBytes>>8&255,buffer[offset+1]=assembledTwoBytes&255,offset+=2,count--}try{result.append(StringEncoding.decode(buffer,StringUtils.GB2312))}catch(ignored){throw new FormatException(ignored)}}static decodeKanjiSegment(bits,result,count){if(count*13>bits.available())throw new FormatException;const buffer=new Uint8Array(2*count);let offset=0;for(;count>0;){const twoBytes=bits.readBits(13);let assembledTwoBytes=twoBytes/192<<8&4294967295|twoBytes%192;assembledTwoBytes<7936?assembledTwoBytes+=33088:assembledTwoBytes+=49472,buffer[offset]=assembledTwoBytes>>8,buffer[offset+1]=assembledTwoBytes,offset+=2,count--}try{result.append(StringEncoding.decode(buffer,StringUtils.SHIFT_JIS))}catch(ignored){throw new FormatException(ignored)}}static decodeByteSegment(bits,result,count,currentCharacterSetECI,byteSegments,hints){if(8*count>bits.available())throw new FormatException;const readBytes=new Uint8Array(count);for(let i=0;i<count;i++)readBytes[i]=bits.readBits(8);let encoding;currentCharacterSetECI===null?encoding=StringUtils.guessEncoding(readBytes,hints):encoding=currentCharacterSetECI.getName();try{result.append(StringEncoding.decode(readBytes,encoding))}catch(ignored){throw new FormatException(ignored)}byteSegments.push(readBytes)}static toAlphaNumericChar(value){if(value>=DecodedBitStreamParser$1.ALPHANUMERIC_CHARS.length)throw new FormatException;return DecodedBitStreamParser$1.ALPHANUMERIC_CHARS[value]}static decodeAlphanumericSegment(bits,result,count,fc1InEffect){const start=result.length();for(;count>1;){if(bits.available()<11)throw new FormatException;const nextTwoCharsBits=bits.readBits(11);result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(nextTwoCharsBits/45))),result.append(DecodedBitStreamParser$1.toAlphaNumericChar(nextTwoCharsBits%45)),count-=2}if(count===1){if(bits.available()<6)throw new FormatException;result.append(DecodedBitStreamParser$1.toAlphaNumericChar(bits.readBits(6)))}if(fc1InEffect)for(let i=start;i<result.length();i++)result.charAt(i)==="%"&&(i<result.length()-1&&result.charAt(i+1)==="%"?result.deleteCharAt(i+1):result.setCharAt(i,""))}static decodeNumericSegment(bits,result,count){for(;count>=3;){if(bits.available()<10)throw new FormatException;const threeDigitsBits=bits.readBits(10);if(threeDigitsBits>=1e3)throw new FormatException;result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(threeDigitsBits/100))),result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(threeDigitsBits/10)%10)),result.append(DecodedBitStreamParser$1.toAlphaNumericChar(threeDigitsBits%10)),count-=3}if(count===2){if(bits.available()<7)throw new FormatException;const twoDigitsBits=bits.readBits(7);if(twoDigitsBits>=100)throw new FormatException;result.append(DecodedBitStreamParser$1.toAlphaNumericChar(Math.floor(twoDigitsBits/10))),result.append(DecodedBitStreamParser$1.toAlphaNumericChar(twoDigitsBits%10))}else if(count===1){if(bits.available()<4)throw new FormatException;const digitBits=bits.readBits(4);if(digitBits>=10)throw new FormatException;result.append(DecodedBitStreamParser$1.toAlphaNumericChar(digitBits))}}static parseECIValue(bits){const firstByte=bits.readBits(8);if(!(firstByte&128))return firstByte&127;if((firstByte&192)===128){const secondByte=bits.readBits(8);return(firstByte&63)<<8&4294967295|secondByte}if((firstByte&224)===192){const secondThirdBytes=bits.readBits(16);return(firstByte&31)<<16&4294967295|secondThirdBytes}throw new FormatException}}DecodedBitStreamParser$1.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",DecodedBitStreamParser$1.GB2312_SUBSET=1;class QRCodeDecoderMetaData{constructor(mirrored){this.mirrored=mirrored}isMirrored(){return this.mirrored}applyMirroredCorrection(points){if(!this.mirrored||points===null||points.length<3)return;const bottomLeft=points[0];points[0]=points[2],points[2]=bottomLeft}}class Decoder$2{constructor(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.QR_CODE_FIELD_256)}decodeBooleanArray(image,hints){return this.decodeBitMatrix(BitMatrix.parseFromBooleanArray(image),hints)}decodeBitMatrix(bits,hints){const parser=new BitMatrixParser$1(bits);let ex=null;try{return this.decodeBitMatrixParser(parser,hints)}catch(e){ex=e}try{parser.remask(),parser.setMirror(!0),parser.readVersion(),parser.readFormatInformation(),parser.mirror();const result=this.decodeBitMatrixParser(parser,hints);return result.setOther(new QRCodeDecoderMetaData(!0)),result}catch(e){throw ex!==null?ex:e}}decodeBitMatrixParser(parser,hints){const version=parser.readVersion(),ecLevel=parser.readFormatInformation().getErrorCorrectionLevel(),codewords=parser.readCodewords(),dataBlocks=DataBlock$1.getDataBlocks(codewords,version,ecLevel);let totalBytes=0;for(const dataBlock of dataBlocks)totalBytes+=dataBlock.getNumDataCodewords();const resultBytes=new Uint8Array(totalBytes);let resultOffset=0;for(const dataBlock of dataBlocks){const codewordBytes=dataBlock.getCodewords(),numDataCodewords=dataBlock.getNumDataCodewords();this.correctErrors(codewordBytes,numDataCodewords);for(let i=0;i<numDataCodewords;i++)resultBytes[resultOffset++]=codewordBytes[i]}return DecodedBitStreamParser$1.decode(resultBytes,version,ecLevel,hints)}correctErrors(codewordBytes,numDataCodewords){const codewordsInts=new Int32Array(codewordBytes);try{this.rsDecoder.decode(codewordsInts,codewordBytes.length-numDataCodewords)}catch{throw new ChecksumException}for(let i=0;i<numDataCodewords;i++)codewordBytes[i]=codewordsInts[i]}}class AlignmentPattern extends ResultPoint{constructor(posX,posY,estimatedModuleSize){super(posX,posY),this.estimatedModuleSize=estimatedModuleSize}aboutEquals(moduleSize,i,j){if(Math.abs(i-this.getY())<=moduleSize&&Math.abs(j-this.getX())<=moduleSize){const moduleSizeDiff=Math.abs(moduleSize-this.estimatedModuleSize);return moduleSizeDiff<=1||moduleSizeDiff<=this.estimatedModuleSize}return!1}combineEstimate(i,j,newModuleSize){const combinedX=(this.getX()+j)/2,combinedY=(this.getY()+i)/2,combinedModuleSize=(this.estimatedModuleSize+newModuleSize)/2;return new AlignmentPattern(combinedX,combinedY,combinedModuleSize)}}class AlignmentPatternFinder{constructor(image,startX,startY,width,height,moduleSize,resultPointCallback){this.image=image,this.startX=startX,this.startY=startY,this.width=width,this.height=height,this.moduleSize=moduleSize,this.resultPointCallback=resultPointCallback,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const startX=this.startX,height=this.height,width=this.width,maxJ=startX+width,middleI=this.startY+height/2,stateCount=new Int32Array(3),image=this.image;for(let iGen=0;iGen<height;iGen++){const i=middleI+(iGen&1?-Math.floor((iGen+1)/2):Math.floor((iGen+1)/2));stateCount[0]=0,stateCount[1]=0,stateCount[2]=0;let j=startX;for(;j<maxJ&&!image.get(j,i);)j++;let currentState=0;for(;j<maxJ;){if(image.get(j,i))if(currentState===1)stateCount[1]++;else if(currentState===2){if(this.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,j);if(confirmed!==null)return confirmed}stateCount[0]=stateCount[2],stateCount[1]=1,stateCount[2]=0,currentState=1}else stateCount[++currentState]++;else currentState===1&&currentState++,stateCount[currentState]++;j++}if(this.foundPatternCross(stateCount)){const confirmed=this.handlePossibleCenter(stateCount,i,maxJ);if(confirmed!==null)return confirmed}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new NotFoundException}static centerFromEnd(stateCount,end){return end-stateCount[2]-stateCount[1]/2}foundPatternCross(stateCount){const moduleSize=this.moduleSize,maxVariance=moduleSize/2;for(let i=0;i<3;i++)if(Math.abs(moduleSize-stateCount[i])>=maxVariance)return!1;return!0}crossCheckVertical(startI,centerJ,maxCount,originalStateCountTotal){const image=this.image,maxI=image.getHeight(),stateCount=this.crossCheckStateCount;stateCount[0]=0,stateCount[1]=0,stateCount[2]=0;let i=startI;for(;i>=0&&image.get(centerJ,i)&&stateCount[1]<=maxCount;)stateCount[1]++,i--;if(i<0||stateCount[1]>maxCount)return NaN;for(;i>=0&&!image.get(centerJ,i)&&stateCount[0]<=maxCount;)stateCount[0]++,i--;if(stateCount[0]>maxCount)return NaN;for(i=startI+1;i<maxI&&image.get(centerJ,i)&&stateCount[1]<=maxCount;)stateCount[1]++,i++;if(i===maxI||stateCount[1]>maxCount)return NaN;for(;i<maxI&&!image.get(centerJ,i)&&stateCount[2]<=maxCount;)stateCount[2]++,i++;if(stateCount[2]>maxCount)return NaN;const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2];return 5*Math.abs(stateCountTotal-originalStateCountTotal)>=2*originalStateCountTotal?NaN:this.foundPatternCross(stateCount)?AlignmentPatternFinder.centerFromEnd(stateCount,i):NaN}handlePossibleCenter(stateCount,i,j){const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2],centerJ=AlignmentPatternFinder.centerFromEnd(stateCount,j),centerI=this.crossCheckVertical(i,centerJ,2*stateCount[1],stateCountTotal);if(!isNaN(centerI)){const estimatedModuleSize=(stateCount[0]+stateCount[1]+stateCount[2])/3;for(const center of this.possibleCenters)if(center.aboutEquals(estimatedModuleSize,centerI,centerJ))return center.combineEstimate(centerI,centerJ,estimatedModuleSize);const point=new AlignmentPattern(centerJ,centerI,estimatedModuleSize);this.possibleCenters.push(point),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(point)}return null}}class FinderPattern$1 extends ResultPoint{constructor(posX,posY,estimatedModuleSize,count){super(posX,posY),this.estimatedModuleSize=estimatedModuleSize,this.count=count,count===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(moduleSize,i,j){if(Math.abs(i-this.getY())<=moduleSize&&Math.abs(j-this.getX())<=moduleSize){const moduleSizeDiff=Math.abs(moduleSize-this.estimatedModuleSize);return moduleSizeDiff<=1||moduleSizeDiff<=this.estimatedModuleSize}return!1}combineEstimate(i,j,newModuleSize){const combinedCount=this.count+1,combinedX=(this.count*this.getX()+j)/combinedCount,combinedY=(this.count*this.getY()+i)/combinedCount,combinedModuleSize=(this.count*this.estimatedModuleSize+newModuleSize)/combinedCount;return new FinderPattern$1(combinedX,combinedY,combinedModuleSize,combinedCount)}}class FinderPatternInfo{constructor(patternCenters){this.bottomLeft=patternCenters[0],this.topLeft=patternCenters[1],this.topRight=patternCenters[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class FinderPatternFinder{constructor(image,resultPointCallback){this.image=image,this.resultPointCallback=resultPointCallback,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=resultPointCallback}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(hints){const tryHarder=hints!=null&&hints.get(DecodeHintType$1.TRY_HARDER)!==void 0,pureBarcode=hints!=null&&hints.get(DecodeHintType$1.PURE_BARCODE)!==void 0,image=this.image,maxI=image.getHeight(),maxJ=image.getWidth();let iSkip=Math.floor(3*maxI/(4*FinderPatternFinder.MAX_MODULES));(iSkip<FinderPatternFinder.MIN_SKIP||tryHarder)&&(iSkip=FinderPatternFinder.MIN_SKIP);let done=!1;const stateCount=new Int32Array(5);for(let i=iSkip-1;i<maxI&&!done;i+=iSkip){stateCount[0]=0,stateCount[1]=0,stateCount[2]=0,stateCount[3]=0,stateCount[4]=0;let currentState=0;for(let j=0;j<maxJ;j++)if(image.get(j,i))(currentState&1)===1&&currentState++,stateCount[currentState]++;else if(currentState&1)stateCount[currentState]++;else if(currentState===4)if(FinderPatternFinder.foundPatternCross(stateCount)){if(this.handlePossibleCenter(stateCount,i,j,pureBarcode)===!0)if(iSkip=2,this.hasSkipped===!0)done=this.haveMultiplyConfirmedCenters();else{const rowSkip=this.findRowSkip();rowSkip>stateCount[2]&&(i+=rowSkip-stateCount[2]-iSkip,j=maxJ-1)}else{stateCount[0]=stateCount[2],stateCount[1]=stateCount[3],stateCount[2]=stateCount[4],stateCount[3]=1,stateCount[4]=0,currentState=3;continue}currentState=0,stateCount[0]=0,stateCount[1]=0,stateCount[2]=0,stateCount[3]=0,stateCount[4]=0}else stateCount[0]=stateCount[2],stateCount[1]=stateCount[3],stateCount[2]=stateCount[4],stateCount[3]=1,stateCount[4]=0,currentState=3;else stateCount[++currentState]++;FinderPatternFinder.foundPatternCross(stateCount)&&this.handlePossibleCenter(stateCount,i,maxJ,pureBarcode)===!0&&(iSkip=stateCount[0],this.hasSkipped&&(done=this.haveMultiplyConfirmedCenters()))}const patternInfo=this.selectBestPatterns();return ResultPoint.orderBestPatterns(patternInfo),new FinderPatternInfo(patternInfo)}static centerFromEnd(stateCount,end){return end-stateCount[4]-stateCount[3]-stateCount[2]/2}static foundPatternCross(stateCount){let totalModuleSize=0;for(let i=0;i<5;i++){const count=stateCount[i];if(count===0)return!1;totalModuleSize+=count}if(totalModuleSize<7)return!1;const moduleSize=totalModuleSize/7,maxVariance=moduleSize/2;return Math.abs(moduleSize-stateCount[0])<maxVariance&&Math.abs(moduleSize-stateCount[1])<maxVariance&&Math.abs(3*moduleSize-stateCount[2])<3*maxVariance&&Math.abs(moduleSize-stateCount[3])<maxVariance&&Math.abs(moduleSize-stateCount[4])<maxVariance}getCrossCheckStateCount(){const crossCheckStateCount=this.crossCheckStateCount;return crossCheckStateCount[0]=0,crossCheckStateCount[1]=0,crossCheckStateCount[2]=0,crossCheckStateCount[3]=0,crossCheckStateCount[4]=0,crossCheckStateCount}crossCheckDiagonal(startI,centerJ,maxCount,originalStateCountTotal){const stateCount=this.getCrossCheckStateCount();let i=0;const image=this.image;for(;startI>=i&&centerJ>=i&&image.get(centerJ-i,startI-i);)stateCount[2]++,i++;if(startI<i||centerJ<i)return!1;for(;startI>=i&&centerJ>=i&&!image.get(centerJ-i,startI-i)&&stateCount[1]<=maxCount;)stateCount[1]++,i++;if(startI<i||centerJ<i||stateCount[1]>maxCount)return!1;for(;startI>=i&&centerJ>=i&&image.get(centerJ-i,startI-i)&&stateCount[0]<=maxCount;)stateCount[0]++,i++;if(stateCount[0]>maxCount)return!1;const maxI=image.getHeight(),maxJ=image.getWidth();for(i=1;startI+i<maxI&&centerJ+i<maxJ&&image.get(centerJ+i,startI+i);)stateCount[2]++,i++;if(startI+i>=maxI||centerJ+i>=maxJ)return!1;for(;startI+i<maxI&&centerJ+i<maxJ&&!image.get(centerJ+i,startI+i)&&stateCount[3]<maxCount;)stateCount[3]++,i++;if(startI+i>=maxI||centerJ+i>=maxJ||stateCount[3]>=maxCount)return!1;for(;startI+i<maxI&&centerJ+i<maxJ&&image.get(centerJ+i,startI+i)&&stateCount[4]<maxCount;)stateCount[4]++,i++;if(stateCount[4]>=maxCount)return!1;const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+stateCount[4];return Math.abs(stateCountTotal-originalStateCountTotal)<2*originalStateCountTotal&&FinderPatternFinder.foundPatternCross(stateCount)}crossCheckVertical(startI,centerJ,maxCount,originalStateCountTotal){const image=this.image,maxI=image.getHeight(),stateCount=this.getCrossCheckStateCount();let i=startI;for(;i>=0&&image.get(centerJ,i);)stateCount[2]++,i--;if(i<0)return NaN;for(;i>=0&&!image.get(centerJ,i)&&stateCount[1]<=maxCount;)stateCount[1]++,i--;if(i<0||stateCount[1]>maxCount)return NaN;for(;i>=0&&image.get(centerJ,i)&&stateCount[0]<=maxCount;)stateCount[0]++,i--;if(stateCount[0]>maxCount)return NaN;for(i=startI+1;i<maxI&&image.get(centerJ,i);)stateCount[2]++,i++;if(i===maxI)return NaN;for(;i<maxI&&!image.get(centerJ,i)&&stateCount[3]<maxCount;)stateCount[3]++,i++;if(i===maxI||stateCount[3]>=maxCount)return NaN;for(;i<maxI&&image.get(centerJ,i)&&stateCount[4]<maxCount;)stateCount[4]++,i++;if(stateCount[4]>=maxCount)return NaN;const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+stateCount[4];return 5*Math.abs(stateCountTotal-originalStateCountTotal)>=2*originalStateCountTotal?NaN:FinderPatternFinder.foundPatternCross(stateCount)?FinderPatternFinder.centerFromEnd(stateCount,i):NaN}crossCheckHorizontal(startJ,centerI,maxCount,originalStateCountTotal){const image=this.image,maxJ=image.getWidth(),stateCount=this.getCrossCheckStateCount();let j=startJ;for(;j>=0&&image.get(j,centerI);)stateCount[2]++,j--;if(j<0)return NaN;for(;j>=0&&!image.get(j,centerI)&&stateCount[1]<=maxCount;)stateCount[1]++,j--;if(j<0||stateCount[1]>maxCount)return NaN;for(;j>=0&&image.get(j,centerI)&&stateCount[0]<=maxCount;)stateCount[0]++,j--;if(stateCount[0]>maxCount)return NaN;for(j=startJ+1;j<maxJ&&image.get(j,centerI);)stateCount[2]++,j++;if(j===maxJ)return NaN;for(;j<maxJ&&!image.get(j,centerI)&&stateCount[3]<maxCount;)stateCount[3]++,j++;if(j===maxJ||stateCount[3]>=maxCount)return NaN;for(;j<maxJ&&image.get(j,centerI)&&stateCount[4]<maxCount;)stateCount[4]++,j++;if(stateCount[4]>=maxCount)return NaN;const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+stateCount[4];return 5*Math.abs(stateCountTotal-originalStateCountTotal)>=originalStateCountTotal?NaN:FinderPatternFinder.foundPatternCross(stateCount)?FinderPatternFinder.centerFromEnd(stateCount,j):NaN}handlePossibleCenter(stateCount,i,j,pureBarcode){const stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2]+stateCount[3]+stateCount[4];let centerJ=FinderPatternFinder.centerFromEnd(stateCount,j),centerI=this.crossCheckVertical(i,Math.floor(centerJ),stateCount[2],stateCountTotal);if(!isNaN(centerI)&&(centerJ=this.crossCheckHorizontal(Math.floor(centerJ),Math.floor(centerI),stateCount[2],stateCountTotal),!isNaN(centerJ)&&(!pureBarcode||this.crossCheckDiagonal(Math.floor(centerI),Math.floor(centerJ),stateCount[2],stateCountTotal)))){const estimatedModuleSize=stateCountTotal/7;let found=!1;const possibleCenters=this.possibleCenters;for(let index=0,length=possibleCenters.length;index<length;index++){const center=possibleCenters[index];if(center.aboutEquals(estimatedModuleSize,centerI,centerJ)){possibleCenters[index]=center.combineEstimate(centerI,centerJ,estimatedModuleSize),found=!0;break}}if(!found){const point=new FinderPattern$1(centerJ,centerI,estimatedModuleSize);possibleCenters.push(point),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(point)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let firstConfirmedCenter=null;for(const center of this.possibleCenters)if(center.getCount()>=FinderPatternFinder.CENTER_QUORUM)if(firstConfirmedCenter==null)firstConfirmedCenter=center;else return this.hasSkipped=!0,Math.floor((Math.abs(firstConfirmedCenter.getX()-center.getX())-Math.abs(firstConfirmedCenter.getY()-center.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let confirmedCount=0,totalModuleSize=0;const max=this.possibleCenters.length;for(const pattern of this.possibleCenters)pattern.getCount()>=FinderPatternFinder.CENTER_QUORUM&&(confirmedCount++,totalModuleSize+=pattern.getEstimatedModuleSize());if(confirmedCount<3)return!1;const average=totalModuleSize/max;let totalDeviation=0;for(const pattern of this.possibleCenters)totalDeviation+=Math.abs(pattern.getEstimatedModuleSize()-average);return totalDeviation<=.05*totalModuleSize}selectBestPatterns(){const startSize=this.possibleCenters.length;if(startSize<3)throw new NotFoundException;const possibleCenters=this.possibleCenters;let average;if(startSize>3){let totalModuleSize=0,square=0;for(const center of this.possibleCenters){const size=center.getEstimatedModuleSize();totalModuleSize+=size,square+=size*size}average=totalModuleSize/startSize;let stdDev=Math.sqrt(square/startSize-average*average);possibleCenters.sort((center1,center2)=>{const dA=Math.abs(center2.getEstimatedModuleSize()-average),dB=Math.abs(center1.getEstimatedModuleSize()-average);return dA<dB?-1:dA>dB?1:0});const limit=Math.max(.2*average,stdDev);for(let i=0;i<possibleCenters.length&&possibleCenters.length>3;i++){const pattern=possibleCenters[i];Math.abs(pattern.getEstimatedModuleSize()-average)>limit&&(possibleCenters.splice(i,1),i--)}}if(possibleCenters.length>3){let totalModuleSize=0;for(const possibleCenter of possibleCenters)totalModuleSize+=possibleCenter.getEstimatedModuleSize();average=totalModuleSize/possibleCenters.length,possibleCenters.sort((center1,center2)=>{if(center2.getCount()===center1.getCount()){const dA=Math.abs(center2.getEstimatedModuleSize()-average),dB=Math.abs(center1.getEstimatedModuleSize()-average);return dA<dB?1:dA>dB?-1:0}else return center2.getCount()-center1.getCount()}),possibleCenters.splice(3)}return[possibleCenters[0],possibleCenters[1],possibleCenters[2]]}}FinderPatternFinder.CENTER_QUORUM=2,FinderPatternFinder.MIN_SKIP=3,FinderPatternFinder.MAX_MODULES=57;class Detector$2{constructor(image){this.image=image}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(hints){this.resultPointCallback=hints==null?null:hints.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);const info=new FinderPatternFinder(this.image,this.resultPointCallback).find(hints);return this.processFinderPatternInfo(info)}processFinderPatternInfo(info){const topLeft=info.getTopLeft(),topRight=info.getTopRight(),bottomLeft=info.getBottomLeft(),moduleSize=this.calculateModuleSize(topLeft,topRight,bottomLeft);if(moduleSize<1)throw new NotFoundException("No pattern found in proccess finder.");const dimension=Detector$2.computeDimension(topLeft,topRight,bottomLeft,moduleSize),provisionalVersion=Version$1.getProvisionalVersionForDimension(dimension),modulesBetweenFPCenters=provisionalVersion.getDimensionForVersion()-7;let alignmentPattern=null;if(provisionalVersion.getAlignmentPatternCenters().length>0){const bottomRightX=topRight.getX()-topLeft.getX()+bottomLeft.getX(),bottomRightY=topRight.getY()-topLeft.getY()+bottomLeft.getY(),correctionToTopLeft=1-3/modulesBetweenFPCenters,estAlignmentX=Math.floor(topLeft.getX()+correctionToTopLeft*(bottomRightX-topLeft.getX())),estAlignmentY=Math.floor(topLeft.getY()+correctionToTopLeft*(bottomRightY-topLeft.getY()));for(let i=4;i<=16;i<<=1)try{alignmentPattern=this.findAlignmentInRegion(moduleSize,estAlignmentX,estAlignmentY,i);break}catch(re){if(!(re instanceof NotFoundException))throw re}}const transform=Detector$2.createTransform(topLeft,topRight,bottomLeft,alignmentPattern,dimension),bits=Detector$2.sampleGrid(this.image,transform,dimension);let points;return alignmentPattern===null?points=[bottomLeft,topLeft,topRight]:points=[bottomLeft,topLeft,topRight,alignmentPattern],new DetectorResult(bits,points)}static createTransform(topLeft,topRight,bottomLeft,alignmentPattern,dimension){const dimMinusThree=dimension-3.5;let bottomRightX,bottomRightY,sourceBottomRightX,sourceBottomRightY;return alignmentPattern!==null?(bottomRightX=alignmentPattern.getX(),bottomRightY=alignmentPattern.getY(),sourceBottomRightX=dimMinusThree-3,sourceBottomRightY=sourceBottomRightX):(bottomRightX=topRight.getX()-topLeft.getX()+bottomLeft.getX(),bottomRightY=topRight.getY()-topLeft.getY()+bottomLeft.getY(),sourceBottomRightX=dimMinusThree,sourceBottomRightY=dimMinusThree),PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,dimMinusThree,3.5,sourceBottomRightX,sourceBottomRightY,3.5,dimMinusThree,topLeft.getX(),topLeft.getY(),topRight.getX(),topRight.getY(),bottomRightX,bottomRightY,bottomLeft.getX(),bottomLeft.getY())}static sampleGrid(image,transform,dimension){return GridSamplerInstance.getInstance().sampleGridWithTransform(image,dimension,dimension,transform)}static computeDimension(topLeft,topRight,bottomLeft,moduleSize){const tltrCentersDimension=MathUtils.round(ResultPoint.distance(topLeft,topRight)/moduleSize),tlblCentersDimension=MathUtils.round(ResultPoint.distance(topLeft,bottomLeft)/moduleSize);let dimension=Math.floor((tltrCentersDimension+tlblCentersDimension)/2)+7;switch(dimension&3){case 0:dimension++;break;case 2:dimension--;break;case 3:throw new NotFoundException("Dimensions could be not found.")}return dimension}calculateModuleSize(topLeft,topRight,bottomLeft){return(this.calculateModuleSizeOneWay(topLeft,topRight)+this.calculateModuleSizeOneWay(topLeft,bottomLeft))/2}calculateModuleSizeOneWay(pattern,otherPattern){const moduleSizeEst1=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(pattern.getX()),Math.floor(pattern.getY()),Math.floor(otherPattern.getX()),Math.floor(otherPattern.getY())),moduleSizeEst2=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(otherPattern.getX()),Math.floor(otherPattern.getY()),Math.floor(pattern.getX()),Math.floor(pattern.getY()));return isNaN(moduleSizeEst1)?moduleSizeEst2/7:isNaN(moduleSizeEst2)?moduleSizeEst1/7:(moduleSizeEst1+moduleSizeEst2)/14}sizeOfBlackWhiteBlackRunBothWays(fromX,fromY,toX,toY){let result=this.sizeOfBlackWhiteBlackRun(fromX,fromY,toX,toY),scale=1,otherToX=fromX-(toX-fromX);otherToX<0?(scale=fromX/(fromX-otherToX),otherToX=0):otherToX>=this.image.getWidth()&&(scale=(this.image.getWidth()-1-fromX)/(otherToX-fromX),otherToX=this.image.getWidth()-1);let otherToY=Math.floor(fromY-(toY-fromY)*scale);return scale=1,otherToY<0?(scale=fromY/(fromY-otherToY),otherToY=0):otherToY>=this.image.getHeight()&&(scale=(this.image.getHeight()-1-fromY)/(otherToY-fromY),otherToY=this.image.getHeight()-1),otherToX=Math.floor(fromX+(otherToX-fromX)*scale),result+=this.sizeOfBlackWhiteBlackRun(fromX,fromY,otherToX,otherToY),result-1}sizeOfBlackWhiteBlackRun(fromX,fromY,toX,toY){const steep=Math.abs(toY-fromY)>Math.abs(toX-fromX);if(steep){let temp=fromX;fromX=fromY,fromY=temp,temp=toX,toX=toY,toY=temp}const dx=Math.abs(toX-fromX),dy=Math.abs(toY-fromY);let error=-dx/2;const xstep=fromX<toX?1:-1,ystep=fromY<toY?1:-1;let state=0;const xLimit=toX+xstep;for(let x=fromX,y=fromY;x!==xLimit;x+=xstep){const realX=steep?y:x,realY=steep?x:y;if(state===1===this.image.get(realX,realY)){if(state===2)return MathUtils.distance(x,y,fromX,fromY);state++}if(error+=dy,error>0){if(y===toY)break;y+=ystep,error-=dx}}return state===2?MathUtils.distance(toX+xstep,toY,fromX,fromY):NaN}findAlignmentInRegion(overallEstModuleSize,estAlignmentX,estAlignmentY,allowanceFactor){const allowance=Math.floor(allowanceFactor*overallEstModuleSize),alignmentAreaLeftX=Math.max(0,estAlignmentX-allowance),alignmentAreaRightX=Math.min(this.image.getWidth()-1,estAlignmentX+allowance);if(alignmentAreaRightX-alignmentAreaLeftX<overallEstModuleSize*3)throw new NotFoundException("Alignment top exceeds estimated module size.");const alignmentAreaTopY=Math.max(0,estAlignmentY-allowance),alignmentAreaBottomY=Math.min(this.image.getHeight()-1,estAlignmentY+allowance);if(alignmentAreaBottomY-alignmentAreaTopY<overallEstModuleSize*3)throw new NotFoundException("Alignment bottom exceeds estimated module size.");return new AlignmentPatternFinder(this.image,alignmentAreaLeftX,alignmentAreaTopY,alignmentAreaRightX-alignmentAreaLeftX,alignmentAreaBottomY-alignmentAreaTopY,overallEstModuleSize,this.resultPointCallback).find()}}class QRCodeReader{constructor(){this.decoder=new Decoder$2}getDecoder(){return this.decoder}decode(image,hints){let decoderResult,points;if(hints!=null&&hints.get(DecodeHintType$1.PURE_BARCODE)!==void 0){const bits=QRCodeReader.extractPureBits(image.getBlackMatrix());decoderResult=this.decoder.decodeBitMatrix(bits,hints),points=QRCodeReader.NO_POINTS}else{const detectorResult=new Detector$2(image.getBlackMatrix()).detect(hints);decoderResult=this.decoder.decodeBitMatrix(detectorResult.getBits(),hints),points=detectorResult.getPoints()}decoderResult.getOther()instanceof QRCodeDecoderMetaData&&decoderResult.getOther().applyMirroredCorrection(points);const result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),void 0,points,BarcodeFormat$1.QR_CODE,void 0),byteSegments=decoderResult.getByteSegments();byteSegments!==null&&result.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,byteSegments);const ecLevel=decoderResult.getECLevel();return ecLevel!==null&&result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,ecLevel),decoderResult.hasStructuredAppend()&&(result.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_SEQUENCE,decoderResult.getStructuredAppendSequenceNumber()),result.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_PARITY,decoderResult.getStructuredAppendParity())),result}reset(){}static extractPureBits(image){const leftTopBlack=image.getTopLeftOnBit(),rightBottomBlack=image.getBottomRightOnBit();if(leftTopBlack===null||rightBottomBlack===null)throw new NotFoundException;const moduleSize=this.moduleSize(leftTopBlack,image);let top=leftTopBlack[1],bottom=rightBottomBlack[1],left=leftTopBlack[0],right=rightBottomBlack[0];if(left>=right||top>=bottom)throw new NotFoundException;if(bottom-top!==right-left&&(right=left+(bottom-top),right>=image.getWidth()))throw new NotFoundException;const matrixWidth=Math.round((right-left+1)/moduleSize),matrixHeight=Math.round((bottom-top+1)/moduleSize);if(matrixWidth<=0||matrixHeight<=0)throw new NotFoundException;if(matrixHeight!==matrixWidth)throw new NotFoundException;const nudge=Math.floor(moduleSize/2);top+=nudge,left+=nudge;const nudgedTooFarRight=left+Math.floor((matrixWidth-1)*moduleSize)-right;if(nudgedTooFarRight>0){if(nudgedTooFarRight>nudge)throw new NotFoundException;left-=nudgedTooFarRight}const nudgedTooFarDown=top+Math.floor((matrixHeight-1)*moduleSize)-bottom;if(nudgedTooFarDown>0){if(nudgedTooFarDown>nudge)throw new NotFoundException;top-=nudgedTooFarDown}const bits=new BitMatrix(matrixWidth,matrixHeight);for(let y=0;y<matrixHeight;y++){const iOffset=top+Math.floor(y*moduleSize);for(let x=0;x<matrixWidth;x++)image.get(left+Math.floor(x*moduleSize),iOffset)&&bits.set(x,y)}return bits}static moduleSize(leftTopBlack,image){const height=image.getHeight(),width=image.getWidth();let x=leftTopBlack[0],y=leftTopBlack[1],inBlack=!0,transitions=0;for(;x<width&&y<height;){if(inBlack!==image.get(x,y)){if(++transitions===5)break;inBlack=!inBlack}x++,y++}if(x===width||y===height)throw new NotFoundException;return(x-leftTopBlack[0])/7}}QRCodeReader.NO_POINTS=new Array;class PDF417Common{PDF417Common(){}static getBitCountSum(moduleBitCount){return MathUtils.sum(moduleBitCount)}static toIntArray(list){if(list==null||!list.length)return PDF417Common.EMPTY_INT_ARRAY;const result=new Int32Array(list.length);let i=0;for(const integer of list)result[i++]=integer;return result}static getCodeword(symbol){const i=Arrays.binarySearch(PDF417Common.SYMBOL_TABLE,symbol&262143);return i<0?-1:(PDF417Common.CODEWORD_TABLE[i]-1)%PDF417Common.NUMBER_OF_CODEWORDS}}PDF417Common.NUMBER_OF_CODEWORDS=929,PDF417Common.MAX_CODEWORDS_IN_BARCODE=PDF417Common.NUMBER_OF_CODEWORDS-1,PDF417Common.MIN_ROWS_IN_BARCODE=3,PDF417Common.MAX_ROWS_IN_BARCODE=90,PDF417Common.MODULES_IN_CODEWORD=17,PDF417Common.MODULES_IN_STOP_PATTERN=18,PDF417Common.BARS_IN_MODULE=8,PDF417Common.EMPTY_INT_ARRAY=new Int32Array([]),PDF417Common.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),PDF417Common.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class PDF417DetectorResult{constructor(bits,points){this.bits=bits,this.points=points}getBits(){return this.bits}getPoints(){return this.points}}class Detector$3{static detectMultiple(image,hints,multiple){let bitMatrix=image.getBlackMatrix(),barcodeCoordinates=Detector$3.detect(multiple,bitMatrix);return barcodeCoordinates.length||(bitMatrix=bitMatrix.clone(),bitMatrix.rotate180(),barcodeCoordinates=Detector$3.detect(multiple,bitMatrix)),new PDF417DetectorResult(bitMatrix,barcodeCoordinates)}static detect(multiple,bitMatrix){const barcodeCoordinates=new Array;let row=0,column=0,foundBarcodeInRow=!1;for(;row<bitMatrix.getHeight();){const vertices=Detector$3.findVertices(bitMatrix,row,column);if(vertices[0]==null&&vertices[3]==null){if(!foundBarcodeInRow)break;foundBarcodeInRow=!1,column=0;for(const barcodeCoordinate of barcodeCoordinates)barcodeCoordinate[1]!=null&&(row=Math.trunc(Math.max(row,barcodeCoordinate[1].getY()))),barcodeCoordinate[3]!=null&&(row=Math.max(row,Math.trunc(barcodeCoordinate[3].getY())));row+=Detector$3.ROW_STEP;continue}if(foundBarcodeInRow=!0,barcodeCoordinates.push(vertices),!multiple)break;vertices[2]!=null?(column=Math.trunc(vertices[2].getX()),row=Math.trunc(vertices[2].getY())):(column=Math.trunc(vertices[4].getX()),row=Math.trunc(vertices[4].getY()))}return barcodeCoordinates}static findVertices(matrix,startRow,startColumn){const height=matrix.getHeight(),width=matrix.getWidth(),result=new Array(8);return Detector$3.copyToResult(result,Detector$3.findRowsWithPattern(matrix,height,width,startRow,startColumn,Detector$3.START_PATTERN),Detector$3.INDEXES_START_PATTERN),result[4]!=null&&(startColumn=Math.trunc(result[4].getX()),startRow=Math.trunc(result[4].getY())),Detector$3.copyToResult(result,Detector$3.findRowsWithPattern(matrix,height,width,startRow,startColumn,Detector$3.STOP_PATTERN),Detector$3.INDEXES_STOP_PATTERN),result}static copyToResult(result,tmpResult,destinationIndexes){for(let i=0;i<destinationIndexes.length;i++)result[destinationIndexes[i]]=tmpResult[i]}static findRowsWithPattern(matrix,height,width,startRow,startColumn,pattern){const result=new Array(4);let found=!1;const counters=new Int32Array(pattern.length);for(;startRow<height;startRow+=Detector$3.ROW_STEP){let loc=Detector$3.findGuardPattern(matrix,startColumn,startRow,width,!1,pattern,counters);if(loc!=null){for(;startRow>0;){const previousRowLoc=Detector$3.findGuardPattern(matrix,startColumn,--startRow,width,!1,pattern,counters);if(previousRowLoc!=null)loc=previousRowLoc;else{startRow++;break}}result[0]=new ResultPoint(loc[0],startRow),result[1]=new ResultPoint(loc[1],startRow),found=!0;break}}let stopRow=startRow+1;if(found){let skippedRowCount=0,previousRowLoc=Int32Array.from([Math.trunc(result[0].getX()),Math.trunc(result[1].getX())]);for(;stopRow<height;stopRow++){const loc=Detector$3.findGuardPattern(matrix,previousRowLoc[0],stopRow,width,!1,pattern,counters);if(loc!=null&&Math.abs(previousRowLoc[0]-loc[0])<Detector$3.MAX_PATTERN_DRIFT&&Math.abs(previousRowLoc[1]-loc[1])<Detector$3.MAX_PATTERN_DRIFT)previousRowLoc=loc,skippedRowCount=0;else{if(skippedRowCount>Detector$3.SKIPPED_ROW_COUNT_MAX)break;skippedRowCount++}}stopRow-=skippedRowCount+1,result[2]=new ResultPoint(previousRowLoc[0],stopRow),result[3]=new ResultPoint(previousRowLoc[1],stopRow)}return stopRow-startRow<Detector$3.BARCODE_MIN_HEIGHT&&Arrays.fill(result,null),result}static findGuardPattern(matrix,column,row,width,whiteFirst,pattern,counters){Arrays.fillWithin(counters,0,counters.length,0);let patternStart=column,pixelDrift=0;for(;matrix.get(patternStart,row)&&patternStart>0&&pixelDrift++<Detector$3.MAX_PIXEL_DRIFT;)patternStart--;let x=patternStart,counterPosition=0,patternLength=pattern.length;for(let isWhite=whiteFirst;x<width;x++)if(matrix.get(x,row)!==isWhite)counters[counterPosition]++;else{if(counterPosition===patternLength-1){if(Detector$3.patternMatchVariance(counters,pattern,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE)return new Int32Array([patternStart,x]);patternStart+=counters[0]+counters[1],System.arraycopy(counters,2,counters,0,counterPosition-1),counters[counterPosition-1]=0,counters[counterPosition]=0,counterPosition--}else counterPosition++;counters[counterPosition]=1,isWhite=!isWhite}return counterPosition===patternLength-1&&Detector$3.patternMatchVariance(counters,pattern,Detector$3.MAX_INDIVIDUAL_VARIANCE)<Detector$3.MAX_AVG_VARIANCE?new Int32Array([patternStart,x-1]):null}static patternMatchVariance(counters,pattern,maxIndividualVariance){let numCounters=counters.length,total=0,patternLength=0;for(let i=0;i<numCounters;i++)total+=counters[i],patternLength+=pattern[i];if(total<patternLength)return 1/0;let unitBarWidth=total/patternLength;maxIndividualVariance*=unitBarWidth;let totalVariance=0;for(let x=0;x<numCounters;x++){let counter=counters[x],scaledPattern=pattern[x]*unitBarWidth,variance=counter>scaledPattern?counter-scaledPattern:scaledPattern-counter;if(variance>maxIndividualVariance)return 1/0;totalVariance+=variance}return totalVariance/total}}Detector$3.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Detector$3.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Detector$3.MAX_AVG_VARIANCE=.42,Detector$3.MAX_INDIVIDUAL_VARIANCE=.8,Detector$3.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Detector$3.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Detector$3.MAX_PIXEL_DRIFT=3,Detector$3.MAX_PATTERN_DRIFT=5,Detector$3.SKIPPED_ROW_COUNT_MAX=25,Detector$3.ROW_STEP=5,Detector$3.BARCODE_MIN_HEIGHT=10;class ModulusPoly{constructor(field,coefficients){if(coefficients.length===0)throw new IllegalArgumentException;this.field=field;let coefficientsLength=coefficients.length;if(coefficientsLength>1&&coefficients[0]===0){let firstNonZero=1;for(;firstNonZero<coefficientsLength&&coefficients[firstNonZero]===0;)firstNonZero++;firstNonZero===coefficientsLength?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(coefficientsLength-firstNonZero),System.arraycopy(coefficients,firstNonZero,this.coefficients,0,this.coefficients.length))}else this.coefficients=coefficients}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(degree){return this.coefficients[this.coefficients.length-1-degree]}evaluateAt(a){if(a===0)return this.getCoefficient(0);if(a===1){let sum=0;for(let coefficient of this.coefficients)sum=this.field.add(sum,coefficient);return sum}let result=this.coefficients[0],size=this.coefficients.length;for(let i=1;i<size;i++)result=this.field.add(this.field.multiply(a,result),this.coefficients[i]);return result}add(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero())return other;if(other.isZero())return this;let smallerCoefficients=this.coefficients,largerCoefficients=other.coefficients;if(smallerCoefficients.length>largerCoefficients.length){let temp=smallerCoefficients;smallerCoefficients=largerCoefficients,largerCoefficients=temp}let sumDiff=new Int32Array(largerCoefficients.length),lengthDiff=largerCoefficients.length-smallerCoefficients.length;System.arraycopy(largerCoefficients,0,sumDiff,0,lengthDiff);for(let i=lengthDiff;i<largerCoefficients.length;i++)sumDiff[i]=this.field.add(smallerCoefficients[i-lengthDiff],largerCoefficients[i]);return new ModulusPoly(this.field,sumDiff)}subtract(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");return other.isZero()?this:this.add(other.negative())}multiply(other){return other instanceof ModulusPoly?this.multiplyOther(other):this.multiplyScalar(other)}multiplyOther(other){if(!this.field.equals(other.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero()||other.isZero())return new ModulusPoly(this.field,new Int32Array([0]));let aCoefficients=this.coefficients,aLength=aCoefficients.length,bCoefficients=other.coefficients,bLength=bCoefficients.length,product=new Int32Array(aLength+bLength-1);for(let i=0;i<aLength;i++){let aCoeff=aCoefficients[i];for(let j=0;j<bLength;j++)product[i+j]=this.field.add(product[i+j],this.field.multiply(aCoeff,bCoefficients[j]))}return new ModulusPoly(this.field,product)}negative(){let size=this.coefficients.length,negativeCoefficients=new Int32Array(size);for(let i=0;i<size;i++)negativeCoefficients[i]=this.field.subtract(0,this.coefficients[i]);return new ModulusPoly(this.field,negativeCoefficients)}multiplyScalar(scalar){if(scalar===0)return new ModulusPoly(this.field,new Int32Array([0]));if(scalar===1)return this;let size=this.coefficients.length,product=new Int32Array(size);for(let i=0;i<size;i++)product[i]=this.field.multiply(this.coefficients[i],scalar);return new ModulusPoly(this.field,product)}multiplyByMonomial(degree,coefficient){if(degree<0)throw new IllegalArgumentException;if(coefficient===0)return new ModulusPoly(this.field,new Int32Array([0]));let size=this.coefficients.length,product=new Int32Array(size+degree);for(let i=0;i<size;i++)product[i]=this.field.multiply(this.coefficients[i],coefficient);return new ModulusPoly(this.field,product)}toString(){let result=new StringBuilder;for(let degree=this.getDegree();degree>=0;degree--){let coefficient=this.getCoefficient(degree);coefficient!==0&&(coefficient<0?(result.append(" - "),coefficient=-coefficient):result.length()>0&&result.append(" + "),(degree===0||coefficient!==1)&&result.append(coefficient),degree!==0&&(degree===1?result.append("x"):(result.append("x^"),result.append(degree))))}return result.toString()}}class ModulusBase{add(a,b){return(a+b)%this.modulus}subtract(a,b){return(this.modulus+a-b)%this.modulus}exp(a){return this.expTable[a]}log(a){if(a===0)throw new IllegalArgumentException;return this.logTable[a]}inverse(a){if(a===0)throw new ArithmeticException;return this.expTable[this.modulus-this.logTable[a]-1]}multiply(a,b){return a===0||b===0?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.modulus-1)]}getSize(){return this.modulus}equals(o){return o===this}}class ModulusGF extends ModulusBase{constructor(modulus,generator){super(),this.modulus=modulus,this.expTable=new Int32Array(modulus),this.logTable=new Int32Array(modulus);let x=1;for(let i=0;i<modulus;i++)this.expTable[i]=x,x=x*generator%modulus;for(let i=0;i<modulus-1;i++)this.logTable[this.expTable[i]]=i;this.zero=new ModulusPoly(this,new Int32Array([0])),this.one=new ModulusPoly(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(degree,coefficient){if(degree<0)throw new IllegalArgumentException;if(coefficient===0)return this.zero;let coefficients=new Int32Array(degree+1);return coefficients[0]=coefficient,new ModulusPoly(this,coefficients)}}ModulusGF.PDF417_GF=new ModulusGF(PDF417Common.NUMBER_OF_CODEWORDS,3);class ErrorCorrection{constructor(){this.field=ModulusGF.PDF417_GF}decode(received,numECCodewords,erasures){let poly=new ModulusPoly(this.field,received),S=new Int32Array(numECCodewords),error=!1;for(let i=numECCodewords;i>0;i--){let evaluation=poly.evaluateAt(this.field.exp(i));S[numECCodewords-i]=evaluation,evaluation!==0&&(error=!0)}if(!error)return 0;let knownErrors=this.field.getOne();if(erasures!=null)for(const erasure of erasures){let b=this.field.exp(received.length-1-erasure),term=new ModulusPoly(this.field,new Int32Array([this.field.subtract(0,b),1]));knownErrors=knownErrors.multiply(term)}let syndrome=new ModulusPoly(this.field,S),sigmaOmega=this.runEuclideanAlgorithm(this.field.buildMonomial(numECCodewords,1),syndrome,numECCodewords),sigma=sigmaOmega[0],omega=sigmaOmega[1],errorLocations=this.findErrorLocations(sigma),errorMagnitudes=this.findErrorMagnitudes(omega,sigma,errorLocations);for(let i=0;i<errorLocations.length;i++){let position=received.length-1-this.field.log(errorLocations[i]);if(position<0)throw ChecksumException.getChecksumInstance();received[position]=this.field.subtract(received[position],errorMagnitudes[i])}return errorLocations.length}runEuclideanAlgorithm(a,b,R){if(a.getDegree()<b.getDegree()){let temp=a;a=b,b=temp}let rLast=a,r=b,tLast=this.field.getZero(),t=this.field.getOne();for(;r.getDegree()>=Math.round(R/2);){let rLastLast=rLast,tLastLast=tLast;if(rLast=r,tLast=t,rLast.isZero())throw ChecksumException.getChecksumInstance();r=rLastLast;let q=this.field.getZero(),denominatorLeadingTerm=rLast.getCoefficient(rLast.getDegree()),dltInverse=this.field.inverse(denominatorLeadingTerm);for(;r.getDegree()>=rLast.getDegree()&&!r.isZero();){let degreeDiff=r.getDegree()-rLast.getDegree(),scale=this.field.multiply(r.getCoefficient(r.getDegree()),dltInverse);q=q.add(this.field.buildMonomial(degreeDiff,scale)),r=r.subtract(rLast.multiplyByMonomial(degreeDiff,scale))}t=q.multiply(tLast).subtract(tLastLast).negative()}let sigmaTildeAtZero=t.getCoefficient(0);if(sigmaTildeAtZero===0)throw ChecksumException.getChecksumInstance();let inverse=this.field.inverse(sigmaTildeAtZero),sigma=t.multiply(inverse),omega=r.multiply(inverse);return[sigma,omega]}findErrorLocations(errorLocator){let numErrors=errorLocator.getDegree(),result=new Int32Array(numErrors),e=0;for(let i=1;i<this.field.getSize()&&e<numErrors;i++)errorLocator.evaluateAt(i)===0&&(result[e]=this.field.inverse(i),e++);if(e!==numErrors)throw ChecksumException.getChecksumInstance();return result}findErrorMagnitudes(errorEvaluator,errorLocator,errorLocations){let errorLocatorDegree=errorLocator.getDegree(),formalDerivativeCoefficients=new Int32Array(errorLocatorDegree);for(let i=1;i<=errorLocatorDegree;i++)formalDerivativeCoefficients[errorLocatorDegree-i]=this.field.multiply(i,errorLocator.getCoefficient(i));let formalDerivative=new ModulusPoly(this.field,formalDerivativeCoefficients),s=errorLocations.length,result=new Int32Array(s);for(let i=0;i<s;i++){let xiInverse=this.field.inverse(errorLocations[i]),numerator=this.field.subtract(0,errorEvaluator.evaluateAt(xiInverse)),denominator=this.field.inverse(formalDerivative.evaluateAt(xiInverse));result[i]=this.field.multiply(numerator,denominator)}return result}}class BoundingBox{constructor(image,topLeft,bottomLeft,topRight,bottomRight){image instanceof BoundingBox?this.constructor_2(image):this.constructor_1(image,topLeft,bottomLeft,topRight,bottomRight)}constructor_1(image,topLeft,bottomLeft,topRight,bottomRight){const leftUnspecified=topLeft==null||bottomLeft==null,rightUnspecified=topRight==null||bottomRight==null;if(leftUnspecified&&rightUnspecified)throw new NotFoundException;leftUnspecified?(topLeft=new ResultPoint(0,topRight.getY()),bottomLeft=new ResultPoint(0,bottomRight.getY())):rightUnspecified&&(topRight=new ResultPoint(image.getWidth()-1,topLeft.getY()),bottomRight=new ResultPoint(image.getWidth()-1,bottomLeft.getY())),this.image=image,this.topLeft=topLeft,this.bottomLeft=bottomLeft,this.topRight=topRight,this.bottomRight=bottomRight,this.minX=Math.trunc(Math.min(topLeft.getX(),bottomLeft.getX())),this.maxX=Math.trunc(Math.max(topRight.getX(),bottomRight.getX())),this.minY=Math.trunc(Math.min(topLeft.getY(),topRight.getY())),this.maxY=Math.trunc(Math.max(bottomLeft.getY(),bottomRight.getY()))}constructor_2(boundingBox){this.image=boundingBox.image,this.topLeft=boundingBox.getTopLeft(),this.bottomLeft=boundingBox.getBottomLeft(),this.topRight=boundingBox.getTopRight(),this.bottomRight=boundingBox.getBottomRight(),this.minX=boundingBox.getMinX(),this.maxX=boundingBox.getMaxX(),this.minY=boundingBox.getMinY(),this.maxY=boundingBox.getMaxY()}static merge(leftBox,rightBox){return leftBox==null?rightBox:rightBox==null?leftBox:new BoundingBox(leftBox.image,leftBox.topLeft,leftBox.bottomLeft,rightBox.topRight,rightBox.bottomRight)}addMissingRows(missingStartRows,missingEndRows,isLeft){let newTopLeft=this.topLeft,newBottomLeft=this.bottomLeft,newTopRight=this.topRight,newBottomRight=this.bottomRight;if(missingStartRows>0){let top=isLeft?this.topLeft:this.topRight,newMinY=Math.trunc(top.getY()-missingStartRows);newMinY<0&&(newMinY=0);let newTop=new ResultPoint(top.getX(),newMinY);isLeft?newTopLeft=newTop:newTopRight=newTop}if(missingEndRows>0){let bottom=isLeft?this.bottomLeft:this.bottomRight,newMaxY=Math.trunc(bottom.getY()+missingEndRows);newMaxY>=this.image.getHeight()&&(newMaxY=this.image.getHeight()-1);let newBottom=new ResultPoint(bottom.getX(),newMaxY);isLeft?newBottomLeft=newBottom:newBottomRight=newBottom}return new BoundingBox(this.image,newTopLeft,newBottomLeft,newTopRight,newBottomRight)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class BarcodeMetadata{constructor(columnCount,rowCountUpperPart,rowCountLowerPart,errorCorrectionLevel){this.columnCount=columnCount,this.errorCorrectionLevel=errorCorrectionLevel,this.rowCountUpperPart=rowCountUpperPart,this.rowCountLowerPart=rowCountLowerPart,this.rowCount=rowCountUpperPart+rowCountLowerPart}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Formatter{constructor(){this.buffer=""}static form(str,arr){let i=-1;function callback(exp,p0,p1,p2,p3,p4){if(exp==="%%")return"%";if(arr[++i]===void 0)return;exp=p2?parseInt(p2.substr(1)):void 0;let base=p3?parseInt(p3.substr(1)):void 0,val;switch(p4){case"s":val=arr[i];break;case"c":val=arr[i][0];break;case"f":val=parseFloat(arr[i]).toFixed(exp);break;case"p":val=parseFloat(arr[i]).toPrecision(exp);break;case"e":val=parseFloat(arr[i]).toExponential(exp);break;case"x":val=parseInt(arr[i]).toString(base||16);break;case"d":val=parseFloat(parseInt(arr[i],base||10).toPrecision(exp)).toFixed(0);break}val=typeof val=="object"?JSON.stringify(val):(+val).toString(base);let size=parseInt(p1),ch=p1&&p1[0]+""=="0"?"0":" ";for(;val.length<size;)val=p0!==void 0?val+ch:ch+val;return val}let regex=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return str.replace(regex,callback)}format(append,...args){this.buffer+=Formatter.form(append,args)}toString(){return this.buffer}}class DetectionResultColumn{constructor(boundingBox){this.boundingBox=new BoundingBox(boundingBox),this.codewords=new Array(boundingBox.getMaxY()-boundingBox.getMinY()+1)}getCodewordNearby(imageRow){let codeword=this.getCodeword(imageRow);if(codeword!=null)return codeword;for(let i=1;i<DetectionResultColumn.MAX_NEARBY_DISTANCE;i++){let nearImageRow=this.imageRowToCodewordIndex(imageRow)-i;if(nearImageRow>=0&&(codeword=this.codewords[nearImageRow],codeword!=null)||(nearImageRow=this.imageRowToCodewordIndex(imageRow)+i,nearImageRow<this.codewords.length&&(codeword=this.codewords[nearImageRow],codeword!=null)))return codeword}return null}imageRowToCodewordIndex(imageRow){return imageRow-this.boundingBox.getMinY()}setCodeword(imageRow,codeword){this.codewords[this.imageRowToCodewordIndex(imageRow)]=codeword}getCodeword(imageRow){return this.codewords[this.imageRowToCodewordIndex(imageRow)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const formatter=new Formatter;let row=0;for(const codeword of this.codewords){if(codeword==null){formatter.format("%3d:    |   %n",row++);continue}formatter.format("%3d: %3d|%3d%n",row++,codeword.getRowNumber(),codeword.getValue())}return formatter.toString()}}DetectionResultColumn.MAX_NEARBY_DISTANCE=5;class BarcodeValue{constructor(){this.values=new Map}setValue(value){value=Math.trunc(value);let confidence=this.values.get(value);confidence==null&&(confidence=0),confidence++,this.values.set(value,confidence)}getValue(){let maxConfidence=-1,result=new Array;for(const[key,value]of this.values.entries()){const entry={getKey:()=>key,getValue:()=>value};entry.getValue()>maxConfidence?(maxConfidence=entry.getValue(),result=[],result.push(entry.getKey())):entry.getValue()===maxConfidence&&result.push(entry.getKey())}return PDF417Common.toIntArray(result)}getConfidence(value){return this.values.get(value)}}class DetectionResultRowIndicatorColumn extends DetectionResultColumn{constructor(boundingBox,isLeft){super(boundingBox),this._isLeft=isLeft}setRowNumbers(){for(let codeword of this.getCodewords())codeword?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(barcodeMetadata){let codewords=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(codewords,barcodeMetadata);let boundingBox=this.getBoundingBox(),top=this._isLeft?boundingBox.getTopLeft():boundingBox.getTopRight(),bottom=this._isLeft?boundingBox.getBottomLeft():boundingBox.getBottomRight(),firstRow=this.imageRowToCodewordIndex(Math.trunc(top.getY())),lastRow=this.imageRowToCodewordIndex(Math.trunc(bottom.getY())),barcodeRow=-1,maxRowHeight=1,currentRowHeight=0;for(let codewordsRow=firstRow;codewordsRow<lastRow;codewordsRow++){if(codewords[codewordsRow]==null)continue;let codeword=codewords[codewordsRow],rowDifference=codeword.getRowNumber()-barcodeRow;if(rowDifference===0)currentRowHeight++;else if(rowDifference===1)maxRowHeight=Math.max(maxRowHeight,currentRowHeight),currentRowHeight=1,barcodeRow=codeword.getRowNumber();else if(rowDifference<0||codeword.getRowNumber()>=barcodeMetadata.getRowCount()||rowDifference>codewordsRow)codewords[codewordsRow]=null;else{let checkedRows;maxRowHeight>2?checkedRows=(maxRowHeight-2)*rowDifference:checkedRows=rowDifference;let closePreviousCodewordFound=checkedRows>=codewordsRow;for(let i=1;i<=checkedRows&&!closePreviousCodewordFound;i++)closePreviousCodewordFound=codewords[codewordsRow-i]!=null;closePreviousCodewordFound?codewords[codewordsRow]=null:(barcodeRow=codeword.getRowNumber(),currentRowHeight=1)}}}getRowHeights(){let barcodeMetadata=this.getBarcodeMetadata();if(barcodeMetadata==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(barcodeMetadata);let result=new Int32Array(barcodeMetadata.getRowCount());for(let codeword of this.getCodewords())if(codeword!=null){let rowNumber=codeword.getRowNumber();if(rowNumber>=result.length)continue;result[rowNumber]++}return result}adjustIncompleteIndicatorColumnRowNumbers(barcodeMetadata){let boundingBox=this.getBoundingBox(),top=this._isLeft?boundingBox.getTopLeft():boundingBox.getTopRight(),bottom=this._isLeft?boundingBox.getBottomLeft():boundingBox.getBottomRight(),firstRow=this.imageRowToCodewordIndex(Math.trunc(top.getY())),lastRow=this.imageRowToCodewordIndex(Math.trunc(bottom.getY())),codewords=this.getCodewords(),barcodeRow=-1;for(let codewordsRow=firstRow;codewordsRow<lastRow;codewordsRow++){if(codewords[codewordsRow]==null)continue;let codeword=codewords[codewordsRow];codeword.setRowNumberAsRowIndicatorColumn();let rowDifference=codeword.getRowNumber()-barcodeRow;rowDifference===0||(rowDifference===1?barcodeRow=codeword.getRowNumber():codeword.getRowNumber()>=barcodeMetadata.getRowCount()?codewords[codewordsRow]=null:barcodeRow=codeword.getRowNumber())}}getBarcodeMetadata(){let codewords=this.getCodewords(),barcodeColumnCount=new BarcodeValue,barcodeRowCountUpperPart=new BarcodeValue,barcodeRowCountLowerPart=new BarcodeValue,barcodeECLevel=new BarcodeValue;for(let codeword of codewords){if(codeword==null)continue;codeword.setRowNumberAsRowIndicatorColumn();let rowIndicatorValue=codeword.getValue()%30,codewordRowNumber=codeword.getRowNumber();switch(this._isLeft||(codewordRowNumber+=2),codewordRowNumber%3){case 0:barcodeRowCountUpperPart.setValue(rowIndicatorValue*3+1);break;case 1:barcodeECLevel.setValue(rowIndicatorValue/3),barcodeRowCountLowerPart.setValue(rowIndicatorValue%3);break;case 2:barcodeColumnCount.setValue(rowIndicatorValue+1);break}}if(barcodeColumnCount.getValue().length===0||barcodeRowCountUpperPart.getValue().length===0||barcodeRowCountLowerPart.getValue().length===0||barcodeECLevel.getValue().length===0||barcodeColumnCount.getValue()[0]<1||barcodeRowCountUpperPart.getValue()[0]+barcodeRowCountLowerPart.getValue()[0]<PDF417Common.MIN_ROWS_IN_BARCODE||barcodeRowCountUpperPart.getValue()[0]+barcodeRowCountLowerPart.getValue()[0]>PDF417Common.MAX_ROWS_IN_BARCODE)return null;let barcodeMetadata=new BarcodeMetadata(barcodeColumnCount.getValue()[0],barcodeRowCountUpperPart.getValue()[0],barcodeRowCountLowerPart.getValue()[0],barcodeECLevel.getValue()[0]);return this.removeIncorrectCodewords(codewords,barcodeMetadata),barcodeMetadata}removeIncorrectCodewords(codewords,barcodeMetadata){for(let codewordRow=0;codewordRow<codewords.length;codewordRow++){let codeword=codewords[codewordRow];if(codewords[codewordRow]==null)continue;let rowIndicatorValue=codeword.getValue()%30,codewordRowNumber=codeword.getRowNumber();if(codewordRowNumber>barcodeMetadata.getRowCount()){codewords[codewordRow]=null;continue}switch(this._isLeft||(codewordRowNumber+=2),codewordRowNumber%3){case 0:rowIndicatorValue*3+1!==barcodeMetadata.getRowCountUpperPart()&&(codewords[codewordRow]=null);break;case 1:(Math.trunc(rowIndicatorValue/3)!==barcodeMetadata.getErrorCorrectionLevel()||rowIndicatorValue%3!==barcodeMetadata.getRowCountLowerPart())&&(codewords[codewordRow]=null);break;case 2:rowIndicatorValue+1!==barcodeMetadata.getColumnCount()&&(codewords[codewordRow]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class DetectionResult{constructor(barcodeMetadata,boundingBox){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=barcodeMetadata,this.barcodeColumnCount=barcodeMetadata.getColumnCount(),this.boundingBox=boundingBox,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let unadjustedCodewordCount=PDF417Common.MAX_CODEWORDS_IN_BARCODE,previousUnadjustedCount;do previousUnadjustedCount=unadjustedCodewordCount,unadjustedCodewordCount=this.adjustRowNumbersAndGetCount();while(unadjustedCodewordCount>0&&unadjustedCodewordCount<previousUnadjustedCount);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(detectionResultColumn){detectionResultColumn?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let unadjustedCount=this.adjustRowNumbersByRow();if(unadjustedCount===0)return 0;for(let barcodeColumn=1;barcodeColumn<this.barcodeColumnCount+1;barcodeColumn++){let codewords=this.detectionResultColumns[barcodeColumn].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++)codewords[codewordsRow]!=null&&(codewords[codewordsRow].hasValidRowNumber()||this.adjustRowNumbers(barcodeColumn,codewordsRow,codewords))}return unadjustedCount}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let LRIcodewords=this.detectionResultColumns[0].getCodewords(),RRIcodewords=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let codewordsRow=0;codewordsRow<LRIcodewords.length;codewordsRow++)if(LRIcodewords[codewordsRow]!=null&&RRIcodewords[codewordsRow]!=null&&LRIcodewords[codewordsRow].getRowNumber()===RRIcodewords[codewordsRow].getRowNumber())for(let barcodeColumn=1;barcodeColumn<=this.barcodeColumnCount;barcodeColumn++){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];codeword!=null&&(codeword.setRowNumber(LRIcodewords[codewordsRow].getRowNumber()),codeword.hasValidRowNumber()||(this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let unadjustedCount=0,codewords=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++){if(codewords[codewordsRow]==null)continue;let rowIndicatorRowNumber=codewords[codewordsRow].getRowNumber(),invalidRowCounts=0;for(let barcodeColumn=this.barcodeColumnCount+1;barcodeColumn>0&&invalidRowCounts<this.ADJUST_ROW_NUMBER_SKIP;barcodeColumn--){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];codeword!=null&&(invalidRowCounts=DetectionResult.adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword),codeword.hasValidRowNumber()||unadjustedCount++)}}return unadjustedCount}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let unadjustedCount=0,codewords=this.detectionResultColumns[0].getCodewords();for(let codewordsRow=0;codewordsRow<codewords.length;codewordsRow++){if(codewords[codewordsRow]==null)continue;let rowIndicatorRowNumber=codewords[codewordsRow].getRowNumber(),invalidRowCounts=0;for(let barcodeColumn=1;barcodeColumn<this.barcodeColumnCount+1&&invalidRowCounts<this.ADJUST_ROW_NUMBER_SKIP;barcodeColumn++){let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];codeword!=null&&(invalidRowCounts=DetectionResult.adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword),codeword.hasValidRowNumber()||unadjustedCount++)}}return unadjustedCount}static adjustRowNumberIfValid(rowIndicatorRowNumber,invalidRowCounts,codeword){return codeword==null||codeword.hasValidRowNumber()||(codeword.isValidRowNumber(rowIndicatorRowNumber)?(codeword.setRowNumber(rowIndicatorRowNumber),invalidRowCounts=0):++invalidRowCounts),invalidRowCounts}adjustRowNumbers(barcodeColumn,codewordsRow,codewords){if(!this.detectionResultColumns[barcodeColumn-1])return;let codeword=codewords[codewordsRow],previousColumnCodewords=this.detectionResultColumns[barcodeColumn-1].getCodewords(),nextColumnCodewords=previousColumnCodewords;this.detectionResultColumns[barcodeColumn+1]!=null&&(nextColumnCodewords=this.detectionResultColumns[barcodeColumn+1].getCodewords());let otherCodewords=new Array(14);otherCodewords[2]=previousColumnCodewords[codewordsRow],otherCodewords[3]=nextColumnCodewords[codewordsRow],codewordsRow>0&&(otherCodewords[0]=codewords[codewordsRow-1],otherCodewords[4]=previousColumnCodewords[codewordsRow-1],otherCodewords[5]=nextColumnCodewords[codewordsRow-1]),codewordsRow>1&&(otherCodewords[8]=codewords[codewordsRow-2],otherCodewords[10]=previousColumnCodewords[codewordsRow-2],otherCodewords[11]=nextColumnCodewords[codewordsRow-2]),codewordsRow<codewords.length-1&&(otherCodewords[1]=codewords[codewordsRow+1],otherCodewords[6]=previousColumnCodewords[codewordsRow+1],otherCodewords[7]=nextColumnCodewords[codewordsRow+1]),codewordsRow<codewords.length-2&&(otherCodewords[9]=codewords[codewordsRow+2],otherCodewords[12]=previousColumnCodewords[codewordsRow+2],otherCodewords[13]=nextColumnCodewords[codewordsRow+2]);for(let otherCodeword of otherCodewords)if(DetectionResult.adjustRowNumber(codeword,otherCodeword))return}static adjustRowNumber(codeword,otherCodeword){return otherCodeword==null?!1:otherCodeword.hasValidRowNumber()&&otherCodeword.getBucket()===codeword.getBucket()?(codeword.setRowNumber(otherCodeword.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(boundingBox){this.boundingBox=boundingBox}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(barcodeColumn,detectionResultColumn){this.detectionResultColumns[barcodeColumn]=detectionResultColumn}getDetectionResultColumn(barcodeColumn){return this.detectionResultColumns[barcodeColumn]}toString(){let rowIndicatorColumn=this.detectionResultColumns[0];rowIndicatorColumn==null&&(rowIndicatorColumn=this.detectionResultColumns[this.barcodeColumnCount+1]);let formatter=new Formatter;for(let codewordsRow=0;codewordsRow<rowIndicatorColumn.getCodewords().length;codewordsRow++){formatter.format("CW %3d:",codewordsRow);for(let barcodeColumn=0;barcodeColumn<this.barcodeColumnCount+2;barcodeColumn++){if(this.detectionResultColumns[barcodeColumn]==null){formatter.format("    |   ");continue}let codeword=this.detectionResultColumns[barcodeColumn].getCodewords()[codewordsRow];if(codeword==null){formatter.format("    |   ");continue}formatter.format(" %3d|%3d",codeword.getRowNumber(),codeword.getValue())}formatter.format("%n")}return formatter.toString()}}class Codeword{constructor(startX,endX,bucket,value){this.rowNumber=Codeword.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(startX),this.endX=Math.trunc(endX),this.bucket=Math.trunc(bucket),this.value=Math.trunc(value)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(rowNumber){return rowNumber!==Codeword.BARCODE_ROW_UNKNOWN&&this.bucket===rowNumber%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(rowNumber){this.rowNumber=rowNumber}toString(){return this.rowNumber+"|"+this.value}}Codeword.BARCODE_ROW_UNKNOWN=-1;class PDF417CodewordDecoder{static initialize(){for(let i=0;i<PDF417Common.SYMBOL_TABLE.length;i++){let currentSymbol=PDF417Common.SYMBOL_TABLE[i],currentBit=currentSymbol&1;for(let j=0;j<PDF417Common.BARS_IN_MODULE;j++){let size=0;for(;(currentSymbol&1)===currentBit;)size+=1,currentSymbol>>=1;currentBit=currentSymbol&1,PDF417CodewordDecoder.RATIOS_TABLE[i]||(PDF417CodewordDecoder.RATIOS_TABLE[i]=new Array(PDF417Common.BARS_IN_MODULE)),PDF417CodewordDecoder.RATIOS_TABLE[i][PDF417Common.BARS_IN_MODULE-j-1]=Math.fround(size/PDF417Common.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(moduleBitCount){let decodedValue=PDF417CodewordDecoder.getDecodedCodewordValue(PDF417CodewordDecoder.sampleBitCounts(moduleBitCount));return decodedValue!==-1?decodedValue:PDF417CodewordDecoder.getClosestDecodedValue(moduleBitCount)}static sampleBitCounts(moduleBitCount){let bitCountSum=MathUtils.sum(moduleBitCount),result=new Int32Array(PDF417Common.BARS_IN_MODULE),bitCountIndex=0,sumPreviousBits=0;for(let i=0;i<PDF417Common.MODULES_IN_CODEWORD;i++){let sampleIndex=bitCountSum/(2*PDF417Common.MODULES_IN_CODEWORD)+i*bitCountSum/PDF417Common.MODULES_IN_CODEWORD;sumPreviousBits+moduleBitCount[bitCountIndex]<=sampleIndex&&(sumPreviousBits+=moduleBitCount[bitCountIndex],bitCountIndex++),result[bitCountIndex]++}return result}static getDecodedCodewordValue(moduleBitCount){let decodedValue=PDF417CodewordDecoder.getBitValue(moduleBitCount);return PDF417Common.getCodeword(decodedValue)===-1?-1:decodedValue}static getBitValue(moduleBitCount){let result=0;for(let i=0;i<moduleBitCount.length;i++)for(let bit=0;bit<moduleBitCount[i];bit++)result=result<<1|(i%2===0?1:0);return Math.trunc(result)}static getClosestDecodedValue(moduleBitCount){let bitCountSum=MathUtils.sum(moduleBitCount),bitCountRatios=new Array(PDF417Common.BARS_IN_MODULE);if(bitCountSum>1)for(let i=0;i<bitCountRatios.length;i++)bitCountRatios[i]=Math.fround(moduleBitCount[i]/bitCountSum);let bestMatchError=Float.MAX_VALUE,bestMatch=-1;this.bSymbolTableReady||PDF417CodewordDecoder.initialize();for(let j=0;j<PDF417CodewordDecoder.RATIOS_TABLE.length;j++){let error=0,ratioTableRow=PDF417CodewordDecoder.RATIOS_TABLE[j];for(let k=0;k<PDF417Common.BARS_IN_MODULE;k++){let diff=Math.fround(ratioTableRow[k]-bitCountRatios[k]);if(error+=Math.fround(diff*diff),error>=bestMatchError)break}error<bestMatchError&&(bestMatchError=error,bestMatch=PDF417Common.SYMBOL_TABLE[j])}return bestMatch}}PDF417CodewordDecoder.bSymbolTableReady=!1,PDF417CodewordDecoder.RATIOS_TABLE=new Array(PDF417Common.SYMBOL_TABLE.length).map(x=>x=new Array(PDF417Common.BARS_IN_MODULE));class PDF417ResultMetadata{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(segmentIndex){this.segmentIndex=segmentIndex}getFileId(){return this.fileId}setFileId(fileId){this.fileId=fileId}getOptionalData(){return this.optionalData}setOptionalData(optionalData){this.optionalData=optionalData}isLastSegment(){return this.lastSegment}setLastSegment(lastSegment){this.lastSegment=lastSegment}getSegmentCount(){return this.segmentCount}setSegmentCount(segmentCount){this.segmentCount=segmentCount}getSender(){return this.sender||null}setSender(sender){this.sender=sender}getAddressee(){return this.addressee||null}setAddressee(addressee){this.addressee=addressee}getFileName(){return this.fileName}setFileName(fileName){this.fileName=fileName}getFileSize(){return this.fileSize}setFileSize(fileSize){this.fileSize=fileSize}getChecksum(){return this.checksum}setChecksum(checksum){this.checksum=checksum}getTimestamp(){return this.timestamp}setTimestamp(timestamp){this.timestamp=timestamp}}class Long{static parseLong(num,radix=void 0){return parseInt(num,radix)}}class NullPointerException extends Exception{}NullPointerException.kind="NullPointerException";class OutputStream{writeBytes(b){this.writeBytesOffset(b,0,b.length)}writeBytesOffset(b,off,len){if(b==null)throw new NullPointerException;if(off<0||off>b.length||len<0||off+len>b.length||off+len<0)throw new IndexOutOfBoundsException;if(len===0)return;for(let i=0;i<len;i++)this.write(b[off+i])}flush(){}close(){}}class OutOfMemoryError extends Exception{}class ByteArrayOutputStream extends OutputStream{constructor(size=32){if(super(),this.count=0,size<0)throw new IllegalArgumentException("Negative initial size: "+size);this.buf=new Uint8Array(size)}ensureCapacity(minCapacity){minCapacity-this.buf.length>0&&this.grow(minCapacity)}grow(minCapacity){let newCapacity=this.buf.length<<1;if(newCapacity-minCapacity<0&&(newCapacity=minCapacity),newCapacity<0){if(minCapacity<0)throw new OutOfMemoryError;newCapacity=Integer.MAX_VALUE}this.buf=Arrays.copyOfUint8Array(this.buf,newCapacity)}write(b){this.ensureCapacity(this.count+1),this.buf[this.count]=b,this.count+=1}writeBytesOffset(b,off,len){if(off<0||off>b.length||len<0||off+len-b.length>0)throw new IndexOutOfBoundsException;this.ensureCapacity(this.count+len),System.arraycopy(b,off,this.buf,this.count,len),this.count+=len}writeTo(out){out.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return Arrays.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(param){return param?typeof param=="string"?this.toString_string(param):this.toString_number(param):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(charsetName){return new String(this.buf).toString()}toString_number(hibyte){return new String(this.buf).toString()}close(){}}var Mode$2;(function(Mode2){Mode2[Mode2.ALPHA=0]="ALPHA",Mode2[Mode2.LOWER=1]="LOWER",Mode2[Mode2.MIXED=2]="MIXED",Mode2[Mode2.PUNCT=3]="PUNCT",Mode2[Mode2.ALPHA_SHIFT=4]="ALPHA_SHIFT",Mode2[Mode2.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Mode$2||(Mode$2={}));function getBigIntConstructor(){if(typeof window<"u")return window.BigInt||null;if(typeof __webpack_require__2.g<"u")return __webpack_require__2.g.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let BigInteger;function createBigInt(num){if(typeof BigInteger>"u"&&(BigInteger=getBigIntConstructor()),BigInteger===null)throw new Error("BigInt is not supported!");return BigInteger(num)}function getEXP900(){let EXP900=[];EXP900[0]=createBigInt(1);let nineHundred=createBigInt(900);EXP900[1]=nineHundred;for(let i=2;i<16;i++)EXP900[i]=EXP900[i-1]*nineHundred;return EXP900}class DecodedBitStreamParser$2{static decode(codewords,ecLevel){let result=new StringBuilder(""),encoding=CharacterSetECI.ISO8859_1;result.enableDecoding(encoding);let codeIndex=1,code=codewords[codeIndex++],resultMetadata=new PDF417ResultMetadata;for(;codeIndex<codewords[0];){switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:codeIndex=DecodedBitStreamParser$2.byteCompaction(code,codewords,encoding,codeIndex,result);break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(codewords[codeIndex++]);break;case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser$2.ECI_CHARSET:let charsetECI=CharacterSetECI.getCharacterSetECIByValue(codewords[codeIndex++]);break;case DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE:codeIndex+=2;break;case DecodedBitStreamParser$2.ECI_USER_DEFINED:codeIndex++;break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:codeIndex=DecodedBitStreamParser$2.decodeMacroBlock(codewords,codeIndex,resultMetadata);break;case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:throw new FormatException;default:codeIndex--,codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,result);break}if(codeIndex<codewords.length)code=codewords[codeIndex++];else throw FormatException.getFormatInstance()}if(result.length()===0)throw FormatException.getFormatInstance();let decoderResult=new DecoderResult(null,result.toString(),null,ecLevel);return decoderResult.setOther(resultMetadata),decoderResult}static decodeMacroBlock(codewords,codeIndex,resultMetadata){if(codeIndex+DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS>codewords[0])throw FormatException.getFormatInstance();let segmentIndexArray=new Int32Array(DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS);for(let i=0;i<DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS;i++,codeIndex++)segmentIndexArray[i]=codewords[codeIndex];resultMetadata.setSegmentIndex(Integer.parseInt(DecodedBitStreamParser$2.decodeBase900toBase10(segmentIndexArray,DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS)));let fileId=new StringBuilder;codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex,fileId),resultMetadata.setFileId(fileId.toString());let optionalFieldsStart=-1;for(codewords[codeIndex]===DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(optionalFieldsStart=codeIndex+1);codeIndex<codewords[0];)switch(codewords[codeIndex]){case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(codeIndex++,codewords[codeIndex]){case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let fileName=new StringBuilder;codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,fileName),resultMetadata.setFileName(fileName.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let sender=new StringBuilder;codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,sender),resultMetadata.setSender(sender.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let addressee=new StringBuilder;codeIndex=DecodedBitStreamParser$2.textCompaction(codewords,codeIndex+1,addressee),resultMetadata.setAddressee(addressee.toString());break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let segmentCount=new StringBuilder;codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,segmentCount),resultMetadata.setSegmentCount(Integer.parseInt(segmentCount.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let timestamp=new StringBuilder;codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,timestamp),resultMetadata.setTimestamp(Long.parseLong(timestamp.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let checksum=new StringBuilder;codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,checksum),resultMetadata.setChecksum(Integer.parseInt(checksum.toString()));break;case DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let fileSize=new StringBuilder;codeIndex=DecodedBitStreamParser$2.numericCompaction(codewords,codeIndex+1,fileSize),resultMetadata.setFileSize(Long.parseLong(fileSize.toString()));break;default:throw FormatException.getFormatInstance()}break;case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex++,resultMetadata.setLastSegment(!0);break;default:throw FormatException.getFormatInstance()}if(optionalFieldsStart!==-1){let optionalFieldsLength=codeIndex-optionalFieldsStart;resultMetadata.isLastSegment()&&optionalFieldsLength--,resultMetadata.setOptionalData(Arrays.copyOfRange(codewords,optionalFieldsStart,optionalFieldsStart+optionalFieldsLength))}return codeIndex}static textCompaction(codewords,codeIndex,result){let textCompactionData=new Int32Array((codewords[0]-codeIndex)*2),byteCompactionData=new Int32Array((codewords[0]-codeIndex)*2),index=0,end=!1;for(;codeIndex<codewords[0]&&!end;){let code=codewords[codeIndex++];if(code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)textCompactionData[index]=code/30,textCompactionData[index+1]=code%30,index+=2;else switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:textCompactionData[index++]=DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH;break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:textCompactionData[index]=DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,code=codewords[codeIndex++],byteCompactionData[index]=code,index++;break}}return DecodedBitStreamParser$2.decodeTextCompaction(textCompactionData,byteCompactionData,index,result),codeIndex}static decodeTextCompaction(textCompactionData,byteCompactionData,length,result){let subMode=Mode$2.ALPHA,priorToShiftMode=Mode$2.ALPHA,i=0;for(;i<length;){let subModeCh=textCompactionData[i],ch="";switch(subMode){case Mode$2.ALPHA:if(subModeCh<26)ch=String.fromCharCode(65+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser$2.LL:subMode=Mode$2.LOWER;break;case DecodedBitStreamParser$2.ML:subMode=Mode$2.MIXED;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode,subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break;case Mode$2.LOWER:if(subModeCh<26)ch=String.fromCharCode(97+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser$2.AS:priorToShiftMode=subMode,subMode=Mode$2.ALPHA_SHIFT;break;case DecodedBitStreamParser$2.ML:subMode=Mode$2.MIXED;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode,subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break;case Mode$2.MIXED:if(subModeCh<DecodedBitStreamParser$2.PL)ch=DecodedBitStreamParser$2.MIXED_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser$2.PL:subMode=Mode$2.PUNCT;break;case 26:ch=" ";break;case DecodedBitStreamParser$2.LL:subMode=Mode$2.LOWER;break;case DecodedBitStreamParser$2.AL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.PS:priorToShiftMode=subMode,subMode=Mode$2.PUNCT_SHIFT;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break;case Mode$2.PUNCT:if(subModeCh<DecodedBitStreamParser$2.PAL)ch=DecodedBitStreamParser$2.PUNCT_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser$2.PAL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break;case Mode$2.ALPHA_SHIFT:if(subMode=priorToShiftMode,subModeCh<26)ch=String.fromCharCode(65+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break;case Mode$2.PUNCT_SHIFT:if(subMode=priorToShiftMode,subModeCh<DecodedBitStreamParser$2.PAL)ch=DecodedBitStreamParser$2.PUNCT_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser$2.PAL:subMode=Mode$2.ALPHA;break;case DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$2.ALPHA;break}break}ch!==""&&result.append(ch),i++}}static byteCompaction(mode,codewords,encoding,codeIndex,result){let decodedBytes=new ByteArrayOutputStream,count=0,value=0,end=!1;switch(mode){case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:let byteCompactedCodewords=new Int32Array(6),nextCode=codewords[codeIndex++];for(;codeIndex<codewords[0]&&!end;)switch(byteCompactedCodewords[count++]=nextCode,value=900*value+nextCode,nextCode=codewords[codeIndex++],nextCode){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0;break;default:if(count%5===0&&count>0){for(let j=0;j<6;++j)decodedBytes.write(Number(createBigInt(value)>>createBigInt(8*(5-j))));value=0,count=0}break}codeIndex===codewords[0]&&nextCode<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH&&(byteCompactedCodewords[count++]=nextCode);for(let i=0;i<count;i++)decodedBytes.write(byteCompactedCodewords[i]);break;case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:for(;codeIndex<codewords[0]&&!end;){let code=codewords[codeIndex++];if(code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)count++,value=900*value+code;else switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0;break}if(count%5===0&&count>0){for(let j=0;j<6;++j)decodedBytes.write(Number(createBigInt(value)>>createBigInt(8*(5-j))));value=0,count=0}}break}return result.append(StringEncoding.decode(decodedBytes.toByteArray(),encoding)),codeIndex}static numericCompaction(codewords,codeIndex,result){let count=0,end=!1,numericCodewords=new Int32Array(DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS);for(;codeIndex<codewords[0]&&!end;){let code=codewords[codeIndex++];if(codeIndex===codewords[0]&&(end=!0),code<DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH)numericCodewords[count]=code,count++;else switch(code){case DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0;break}(count%DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS===0||code===DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH||end)&&count>0&&(result.append(DecodedBitStreamParser$2.decodeBase900toBase10(numericCodewords,count)),count=0)}return codeIndex}static decodeBase900toBase10(codewords,count){let result=createBigInt(0);for(let i=0;i<count;i++)result+=DecodedBitStreamParser$2.EXP900[count-i-1]*createBigInt(codewords[i]);let resultString=result.toString();if(resultString.charAt(0)!=="1")throw new FormatException;return resultString.substring(1)}}DecodedBitStreamParser$2.TEXT_COMPACTION_MODE_LATCH=900,DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH=901,DecodedBitStreamParser$2.NUMERIC_COMPACTION_MODE_LATCH=902,DecodedBitStreamParser$2.BYTE_COMPACTION_MODE_LATCH_6=924,DecodedBitStreamParser$2.ECI_USER_DEFINED=925,DecodedBitStreamParser$2.ECI_GENERAL_PURPOSE=926,DecodedBitStreamParser$2.ECI_CHARSET=927,DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,DecodedBitStreamParser$2.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,DecodedBitStreamParser$2.MACRO_PDF417_TERMINATOR=922,DecodedBitStreamParser$2.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,DecodedBitStreamParser$2.MAX_NUMERIC_CODEWORDS=15,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,DecodedBitStreamParser$2.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,DecodedBitStreamParser$2.PL=25,DecodedBitStreamParser$2.LL=27,DecodedBitStreamParser$2.AS=27,DecodedBitStreamParser$2.ML=28,DecodedBitStreamParser$2.AL=28,DecodedBitStreamParser$2.PS=29,DecodedBitStreamParser$2.PAL=29,DecodedBitStreamParser$2.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,DecodedBitStreamParser$2.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",DecodedBitStreamParser$2.EXP900=getBigIntConstructor()?getEXP900():[],DecodedBitStreamParser$2.NUMBER_OF_SEQUENCE_CODEWORDS=2;class PDF417ScanningDecoder{constructor(){}static decode(image,imageTopLeft,imageBottomLeft,imageTopRight,imageBottomRight,minCodewordWidth,maxCodewordWidth){let boundingBox=new BoundingBox(image,imageTopLeft,imageBottomLeft,imageTopRight,imageBottomRight),leftRowIndicatorColumn=null,rightRowIndicatorColumn=null,detectionResult;for(let firstPass=!0;;firstPass=!1){if(imageTopLeft!=null&&(leftRowIndicatorColumn=PDF417ScanningDecoder.getRowIndicatorColumn(image,boundingBox,imageTopLeft,!0,minCodewordWidth,maxCodewordWidth)),imageTopRight!=null&&(rightRowIndicatorColumn=PDF417ScanningDecoder.getRowIndicatorColumn(image,boundingBox,imageTopRight,!1,minCodewordWidth,maxCodewordWidth)),detectionResult=PDF417ScanningDecoder.merge(leftRowIndicatorColumn,rightRowIndicatorColumn),detectionResult==null)throw NotFoundException.getNotFoundInstance();let resultBox=detectionResult.getBoundingBox();if(firstPass&&resultBox!=null&&(resultBox.getMinY()<boundingBox.getMinY()||resultBox.getMaxY()>boundingBox.getMaxY()))boundingBox=resultBox;else break}detectionResult.setBoundingBox(boundingBox);let maxBarcodeColumn=detectionResult.getBarcodeColumnCount()+1;detectionResult.setDetectionResultColumn(0,leftRowIndicatorColumn),detectionResult.setDetectionResultColumn(maxBarcodeColumn,rightRowIndicatorColumn);let leftToRight=leftRowIndicatorColumn!=null;for(let barcodeColumnCount=1;barcodeColumnCount<=maxBarcodeColumn;barcodeColumnCount++){let barcodeColumn=leftToRight?barcodeColumnCount:maxBarcodeColumn-barcodeColumnCount;if(detectionResult.getDetectionResultColumn(barcodeColumn)!==void 0)continue;let detectionResultColumn;barcodeColumn===0||barcodeColumn===maxBarcodeColumn?detectionResultColumn=new DetectionResultRowIndicatorColumn(boundingBox,barcodeColumn===0):detectionResultColumn=new DetectionResultColumn(boundingBox),detectionResult.setDetectionResultColumn(barcodeColumn,detectionResultColumn);let startColumn=-1,previousStartColumn=startColumn;for(let imageRow=boundingBox.getMinY();imageRow<=boundingBox.getMaxY();imageRow++){if(startColumn=PDF417ScanningDecoder.getStartColumn(detectionResult,barcodeColumn,imageRow,leftToRight),startColumn<0||startColumn>boundingBox.getMaxX()){if(previousStartColumn===-1)continue;startColumn=previousStartColumn}let codeword=PDF417ScanningDecoder.detectCodeword(image,boundingBox.getMinX(),boundingBox.getMaxX(),leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth);codeword!=null&&(detectionResultColumn.setCodeword(imageRow,codeword),previousStartColumn=startColumn,minCodewordWidth=Math.min(minCodewordWidth,codeword.getWidth()),maxCodewordWidth=Math.max(maxCodewordWidth,codeword.getWidth()))}}return PDF417ScanningDecoder.createDecoderResult(detectionResult)}static merge(leftRowIndicatorColumn,rightRowIndicatorColumn){if(leftRowIndicatorColumn==null&&rightRowIndicatorColumn==null)return null;let barcodeMetadata=PDF417ScanningDecoder.getBarcodeMetadata(leftRowIndicatorColumn,rightRowIndicatorColumn);if(barcodeMetadata==null)return null;let boundingBox=BoundingBox.merge(PDF417ScanningDecoder.adjustBoundingBox(leftRowIndicatorColumn),PDF417ScanningDecoder.adjustBoundingBox(rightRowIndicatorColumn));return new DetectionResult(barcodeMetadata,boundingBox)}static adjustBoundingBox(rowIndicatorColumn){if(rowIndicatorColumn==null)return null;let rowHeights=rowIndicatorColumn.getRowHeights();if(rowHeights==null)return null;let maxRowHeight=PDF417ScanningDecoder.getMax(rowHeights),missingStartRows=0;for(let rowHeight of rowHeights)if(missingStartRows+=maxRowHeight-rowHeight,rowHeight>0)break;let codewords=rowIndicatorColumn.getCodewords();for(let row=0;missingStartRows>0&&codewords[row]==null;row++)missingStartRows--;let missingEndRows=0;for(let row=rowHeights.length-1;row>=0&&(missingEndRows+=maxRowHeight-rowHeights[row],!(rowHeights[row]>0));row--);for(let row=codewords.length-1;missingEndRows>0&&codewords[row]==null;row--)missingEndRows--;return rowIndicatorColumn.getBoundingBox().addMissingRows(missingStartRows,missingEndRows,rowIndicatorColumn.isLeft())}static getMax(values){let maxValue=-1;for(let value of values)maxValue=Math.max(maxValue,value);return maxValue}static getBarcodeMetadata(leftRowIndicatorColumn,rightRowIndicatorColumn){let leftBarcodeMetadata;if(leftRowIndicatorColumn==null||(leftBarcodeMetadata=leftRowIndicatorColumn.getBarcodeMetadata())==null)return rightRowIndicatorColumn==null?null:rightRowIndicatorColumn.getBarcodeMetadata();let rightBarcodeMetadata;return rightRowIndicatorColumn==null||(rightBarcodeMetadata=rightRowIndicatorColumn.getBarcodeMetadata())==null?leftBarcodeMetadata:leftBarcodeMetadata.getColumnCount()!==rightBarcodeMetadata.getColumnCount()&&leftBarcodeMetadata.getErrorCorrectionLevel()!==rightBarcodeMetadata.getErrorCorrectionLevel()&&leftBarcodeMetadata.getRowCount()!==rightBarcodeMetadata.getRowCount()?null:leftBarcodeMetadata}static getRowIndicatorColumn(image,boundingBox,startPoint,leftToRight,minCodewordWidth,maxCodewordWidth){let rowIndicatorColumn=new DetectionResultRowIndicatorColumn(boundingBox,leftToRight);for(let i=0;i<2;i++){let increment=i===0?1:-1,startColumn=Math.trunc(Math.trunc(startPoint.getX()));for(let imageRow=Math.trunc(Math.trunc(startPoint.getY()));imageRow<=boundingBox.getMaxY()&&imageRow>=boundingBox.getMinY();imageRow+=increment){let codeword=PDF417ScanningDecoder.detectCodeword(image,0,image.getWidth(),leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth);codeword!=null&&(rowIndicatorColumn.setCodeword(imageRow,codeword),leftToRight?startColumn=codeword.getStartX():startColumn=codeword.getEndX())}}return rowIndicatorColumn}static adjustCodewordCount(detectionResult,barcodeMatrix){let barcodeMatrix01=barcodeMatrix[0][1],numberOfCodewords=barcodeMatrix01.getValue(),calculatedNumberOfCodewords=detectionResult.getBarcodeColumnCount()*detectionResult.getBarcodeRowCount()-PDF417ScanningDecoder.getNumberOfECCodeWords(detectionResult.getBarcodeECLevel());if(numberOfCodewords.length===0){if(calculatedNumberOfCodewords<1||calculatedNumberOfCodewords>PDF417Common.MAX_CODEWORDS_IN_BARCODE)throw NotFoundException.getNotFoundInstance();barcodeMatrix01.setValue(calculatedNumberOfCodewords)}else numberOfCodewords[0]!==calculatedNumberOfCodewords&&barcodeMatrix01.setValue(calculatedNumberOfCodewords)}static createDecoderResult(detectionResult){let barcodeMatrix=PDF417ScanningDecoder.createBarcodeMatrix(detectionResult);PDF417ScanningDecoder.adjustCodewordCount(detectionResult,barcodeMatrix);let erasures=new Array,codewords=new Int32Array(detectionResult.getBarcodeRowCount()*detectionResult.getBarcodeColumnCount()),ambiguousIndexValuesList=[],ambiguousIndexesList=new Array;for(let row=0;row<detectionResult.getBarcodeRowCount();row++)for(let column=0;column<detectionResult.getBarcodeColumnCount();column++){let values=barcodeMatrix[row][column+1].getValue(),codewordIndex=row*detectionResult.getBarcodeColumnCount()+column;values.length===0?erasures.push(codewordIndex):values.length===1?codewords[codewordIndex]=values[0]:(ambiguousIndexesList.push(codewordIndex),ambiguousIndexValuesList.push(values))}let ambiguousIndexValues=new Array(ambiguousIndexValuesList.length);for(let i=0;i<ambiguousIndexValues.length;i++)ambiguousIndexValues[i]=ambiguousIndexValuesList[i];return PDF417ScanningDecoder.createDecoderResultFromAmbiguousValues(detectionResult.getBarcodeECLevel(),codewords,PDF417Common.toIntArray(erasures),PDF417Common.toIntArray(ambiguousIndexesList),ambiguousIndexValues)}static createDecoderResultFromAmbiguousValues(ecLevel,codewords,erasureArray,ambiguousIndexes,ambiguousIndexValues){let ambiguousIndexCount=new Int32Array(ambiguousIndexes.length),tries=100;for(;tries-- >0;){for(let i=0;i<ambiguousIndexCount.length;i++)codewords[ambiguousIndexes[i]]=ambiguousIndexValues[i][ambiguousIndexCount[i]];try{return PDF417ScanningDecoder.decodeCodewords(codewords,ecLevel,erasureArray)}catch(err){if(!(err instanceof ChecksumException))throw err}if(ambiguousIndexCount.length===0)throw ChecksumException.getChecksumInstance();for(let i=0;i<ambiguousIndexCount.length;i++)if(ambiguousIndexCount[i]<ambiguousIndexValues[i].length-1){ambiguousIndexCount[i]++;break}else if(ambiguousIndexCount[i]=0,i===ambiguousIndexCount.length-1)throw ChecksumException.getChecksumInstance()}throw ChecksumException.getChecksumInstance()}static createBarcodeMatrix(detectionResult){let barcodeMatrix=Array.from({length:detectionResult.getBarcodeRowCount()},()=>new Array(detectionResult.getBarcodeColumnCount()+2));for(let row=0;row<barcodeMatrix.length;row++)for(let column2=0;column2<barcodeMatrix[row].length;column2++)barcodeMatrix[row][column2]=new BarcodeValue;let column=0;for(let detectionResultColumn of detectionResult.getDetectionResultColumns()){if(detectionResultColumn!=null){for(let codeword of detectionResultColumn.getCodewords())if(codeword!=null){let rowNumber=codeword.getRowNumber();if(rowNumber>=0){if(rowNumber>=barcodeMatrix.length)continue;barcodeMatrix[rowNumber][column].setValue(codeword.getValue())}}}column++}return barcodeMatrix}static isValidBarcodeColumn(detectionResult,barcodeColumn){return barcodeColumn>=0&&barcodeColumn<=detectionResult.getBarcodeColumnCount()+1}static getStartColumn(detectionResult,barcodeColumn,imageRow,leftToRight){let offset=leftToRight?1:-1,codeword=null;if(PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset)&&(codeword=detectionResult.getDetectionResultColumn(barcodeColumn-offset).getCodeword(imageRow)),codeword!=null)return leftToRight?codeword.getEndX():codeword.getStartX();if(codeword=detectionResult.getDetectionResultColumn(barcodeColumn).getCodewordNearby(imageRow),codeword!=null)return leftToRight?codeword.getStartX():codeword.getEndX();if(PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset)&&(codeword=detectionResult.getDetectionResultColumn(barcodeColumn-offset).getCodewordNearby(imageRow)),codeword!=null)return leftToRight?codeword.getEndX():codeword.getStartX();let skippedColumns=0;for(;PDF417ScanningDecoder.isValidBarcodeColumn(detectionResult,barcodeColumn-offset);){barcodeColumn-=offset;for(let previousRowCodeword of detectionResult.getDetectionResultColumn(barcodeColumn).getCodewords())if(previousRowCodeword!=null)return(leftToRight?previousRowCodeword.getEndX():previousRowCodeword.getStartX())+offset*skippedColumns*(previousRowCodeword.getEndX()-previousRowCodeword.getStartX());skippedColumns++}return leftToRight?detectionResult.getBoundingBox().getMinX():detectionResult.getBoundingBox().getMaxX()}static detectCodeword(image,minColumn,maxColumn,leftToRight,startColumn,imageRow,minCodewordWidth,maxCodewordWidth){startColumn=PDF417ScanningDecoder.adjustCodewordStartColumn(image,minColumn,maxColumn,leftToRight,startColumn,imageRow);let moduleBitCount=PDF417ScanningDecoder.getModuleBitCount(image,minColumn,maxColumn,leftToRight,startColumn,imageRow);if(moduleBitCount==null)return null;let endColumn,codewordBitCount=MathUtils.sum(moduleBitCount);if(leftToRight)endColumn=startColumn+codewordBitCount;else{for(let i=0;i<moduleBitCount.length/2;i++){let tmpCount=moduleBitCount[i];moduleBitCount[i]=moduleBitCount[moduleBitCount.length-1-i],moduleBitCount[moduleBitCount.length-1-i]=tmpCount}endColumn=startColumn,startColumn=endColumn-codewordBitCount}if(!PDF417ScanningDecoder.checkCodewordSkew(codewordBitCount,minCodewordWidth,maxCodewordWidth))return null;let decodedValue=PDF417CodewordDecoder.getDecodedValue(moduleBitCount),codeword=PDF417Common.getCodeword(decodedValue);return codeword===-1?null:new Codeword(startColumn,endColumn,PDF417ScanningDecoder.getCodewordBucketNumber(decodedValue),codeword)}static getModuleBitCount(image,minColumn,maxColumn,leftToRight,startColumn,imageRow){let imageColumn=startColumn,moduleBitCount=new Int32Array(8),moduleNumber=0,increment=leftToRight?1:-1,previousPixelValue=leftToRight;for(;(leftToRight?imageColumn<maxColumn:imageColumn>=minColumn)&&moduleNumber<moduleBitCount.length;)image.get(imageColumn,imageRow)===previousPixelValue?(moduleBitCount[moduleNumber]++,imageColumn+=increment):(moduleNumber++,previousPixelValue=!previousPixelValue);return moduleNumber===moduleBitCount.length||imageColumn===(leftToRight?maxColumn:minColumn)&&moduleNumber===moduleBitCount.length-1?moduleBitCount:null}static getNumberOfECCodeWords(barcodeECLevel){return 2<<barcodeECLevel}static adjustCodewordStartColumn(image,minColumn,maxColumn,leftToRight,codewordStartColumn,imageRow){let correctedStartColumn=codewordStartColumn,increment=leftToRight?-1:1;for(let i=0;i<2;i++){for(;(leftToRight?correctedStartColumn>=minColumn:correctedStartColumn<maxColumn)&&leftToRight===image.get(correctedStartColumn,imageRow);){if(Math.abs(codewordStartColumn-correctedStartColumn)>PDF417ScanningDecoder.CODEWORD_SKEW_SIZE)return codewordStartColumn;correctedStartColumn+=increment}increment=-increment,leftToRight=!leftToRight}return correctedStartColumn}static checkCodewordSkew(codewordSize,minCodewordWidth,maxCodewordWidth){return minCodewordWidth-PDF417ScanningDecoder.CODEWORD_SKEW_SIZE<=codewordSize&&codewordSize<=maxCodewordWidth+PDF417ScanningDecoder.CODEWORD_SKEW_SIZE}static decodeCodewords(codewords,ecLevel,erasures){if(codewords.length===0)throw FormatException.getFormatInstance();let numECCodewords=1<<ecLevel+1,correctedErrorsCount=PDF417ScanningDecoder.correctErrors(codewords,erasures,numECCodewords);PDF417ScanningDecoder.verifyCodewordCount(codewords,numECCodewords);let decoderResult=DecodedBitStreamParser$2.decode(codewords,""+ecLevel);return decoderResult.setErrorsCorrected(correctedErrorsCount),decoderResult.setErasures(erasures.length),decoderResult}static correctErrors(codewords,erasures,numECCodewords){if(erasures!=null&&erasures.length>numECCodewords/2+PDF417ScanningDecoder.MAX_ERRORS||numECCodewords<0||numECCodewords>PDF417ScanningDecoder.MAX_EC_CODEWORDS)throw ChecksumException.getChecksumInstance();return PDF417ScanningDecoder.errorCorrection.decode(codewords,numECCodewords,erasures)}static verifyCodewordCount(codewords,numECCodewords){if(codewords.length<4)throw FormatException.getFormatInstance();let numberOfCodewords=codewords[0];if(numberOfCodewords>codewords.length)throw FormatException.getFormatInstance();if(numberOfCodewords===0)if(numECCodewords<codewords.length)codewords[0]=codewords.length-numECCodewords;else throw FormatException.getFormatInstance()}static getBitCountForCodeword(codeword){let result=new Int32Array(8),previousValue=0,i=result.length-1;for(;!((codeword&1)!==previousValue&&(previousValue=codeword&1,i--,i<0));)result[i]++,codeword>>=1;return result}static getCodewordBucketNumber(codeword){return codeword instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(codeword):this.getCodewordBucketNumber_number(codeword)}static getCodewordBucketNumber_number(codeword){return PDF417ScanningDecoder.getCodewordBucketNumber(PDF417ScanningDecoder.getBitCountForCodeword(codeword))}static getCodewordBucketNumber_Int32Array(moduleBitCount){return(moduleBitCount[0]-moduleBitCount[2]+moduleBitCount[4]-moduleBitCount[6]+9)%9}static toString(barcodeMatrix){let formatter=new Formatter;for(let row=0;row<barcodeMatrix.length;row++){formatter.format("Row %2d: ",row);for(let column=0;column<barcodeMatrix[row].length;column++){let barcodeValue=barcodeMatrix[row][column];barcodeValue.getValue().length===0?formatter.format("        ",null):formatter.format("%4d(%2d)",barcodeValue.getValue()[0],barcodeValue.getConfidence(barcodeValue.getValue()[0]))}formatter.format("%n")}return formatter.toString()}}PDF417ScanningDecoder.CODEWORD_SKEW_SIZE=2,PDF417ScanningDecoder.MAX_ERRORS=3,PDF417ScanningDecoder.MAX_EC_CODEWORDS=512,PDF417ScanningDecoder.errorCorrection=new ErrorCorrection;class PDF417Reader{decode(image,hints=null){let result=PDF417Reader.decode(image,hints,!1);if(result==null||result.length===0||result[0]==null)throw NotFoundException.getNotFoundInstance();return result[0]}decodeMultiple(image,hints=null){try{return PDF417Reader.decode(image,hints,!0)}catch(ignored){throw ignored instanceof FormatException||ignored instanceof ChecksumException?NotFoundException.getNotFoundInstance():ignored}}static decode(image,hints,multiple){const results=new Array,detectorResult=Detector$3.detectMultiple(image,hints,multiple);for(const points of detectorResult.getPoints()){const decoderResult=PDF417ScanningDecoder.decode(detectorResult.getBits(),points[4],points[5],points[6],points[7],PDF417Reader.getMinCodewordWidth(points),PDF417Reader.getMaxCodewordWidth(points)),result=new Result(decoderResult.getText(),decoderResult.getRawBytes(),void 0,points,BarcodeFormat$1.PDF_417);result.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,decoderResult.getECLevel());const pdf417ResultMetadata=decoderResult.getOther();pdf417ResultMetadata!=null&&result.putMetadata(ResultMetadataType$1.PDF417_EXTRA_METADATA,pdf417ResultMetadata),results.push(result)}return results.map(x=>x)}static getMaxWidth(p1,p2){return p1==null||p2==null?0:Math.trunc(Math.abs(p1.getX()-p2.getX()))}static getMinWidth(p1,p2){return p1==null||p2==null?Integer.MAX_VALUE:Math.trunc(Math.abs(p1.getX()-p2.getX()))}static getMaxCodewordWidth(p){return Math.floor(Math.max(Math.max(PDF417Reader.getMaxWidth(p[0],p[4]),PDF417Reader.getMaxWidth(p[6],p[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.max(PDF417Reader.getMaxWidth(p[1],p[5]),PDF417Reader.getMaxWidth(p[7],p[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(p){return Math.floor(Math.min(Math.min(PDF417Reader.getMinWidth(p[0],p[4]),PDF417Reader.getMinWidth(p[6],p[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.min(PDF417Reader.getMinWidth(p[1],p[5]),PDF417Reader.getMinWidth(p[7],p[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))}reset(){}}class ReaderException extends Exception{}ReaderException.kind="ReaderException";class MultiFormatReader{constructor(verbose,hints){this.verbose=verbose===!0,hints&&this.setHints(hints)}decode(image,hints){return hints&&this.setHints(hints),this.decodeInternal(image)}decodeWithState(image){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(image)}setHints(hints){this.hints=hints;const tryHarder=!isNullOrUndefined(hints)&&hints.get(DecodeHintType$1.TRY_HARDER)===!0,formats=isNullOrUndefined(hints)?null:hints.get(DecodeHintType$1.POSSIBLE_FORMATS),readers=new Array;if(!isNullOrUndefined(formats)){const addOneDReader=formats.some(f=>f===BarcodeFormat$1.UPC_A||f===BarcodeFormat$1.UPC_E||f===BarcodeFormat$1.EAN_13||f===BarcodeFormat$1.EAN_8||f===BarcodeFormat$1.CODABAR||f===BarcodeFormat$1.CODE_39||f===BarcodeFormat$1.CODE_93||f===BarcodeFormat$1.CODE_128||f===BarcodeFormat$1.ITF||f===BarcodeFormat$1.RSS_14||f===BarcodeFormat$1.RSS_EXPANDED);addOneDReader&&!tryHarder&&readers.push(new MultiFormatOneDReader(hints,this.verbose)),formats.includes(BarcodeFormat$1.QR_CODE)&&readers.push(new QRCodeReader),formats.includes(BarcodeFormat$1.DATA_MATRIX)&&readers.push(new DataMatrixReader),formats.includes(BarcodeFormat$1.AZTEC)&&readers.push(new AztecReader),formats.includes(BarcodeFormat$1.PDF_417)&&readers.push(new PDF417Reader),addOneDReader&&tryHarder&&readers.push(new MultiFormatOneDReader(hints,this.verbose))}readers.length===0&&(tryHarder||readers.push(new MultiFormatOneDReader(hints,this.verbose)),readers.push(new QRCodeReader),readers.push(new DataMatrixReader),readers.push(new AztecReader),readers.push(new PDF417Reader),tryHarder&&readers.push(new MultiFormatOneDReader(hints,this.verbose))),this.readers=readers}reset(){if(this.readers!==null)for(const reader of this.readers)reader.reset()}decodeInternal(image){if(this.readers===null)throw new ReaderException("No readers where selected, nothing can be read.");for(const reader of this.readers)try{return reader.decode(image,this.hints)}catch(ex){if(ex instanceof ReaderException)continue}throw new NotFoundException("No MultiFormat Readers were able to detect the code.")}}class BrowserMultiFormatReader extends BrowserCodeReader{constructor(hints=null,timeBetweenScansMillis=500){const reader=new MultiFormatReader;reader.setHints(hints),super(reader,timeBetweenScansMillis)}decodeBitmap(binaryBitmap){return this.reader.decodeWithState(binaryBitmap)}}class BrowserPDF417Reader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new PDF417Reader,timeBetweenScansMillis)}}class BrowserQRCodeReader extends BrowserCodeReader{constructor(timeBetweenScansMillis=500){super(new QRCodeReader,timeBetweenScansMillis)}}var EncodeHintType;(function(EncodeHintType2){EncodeHintType2[EncodeHintType2.ERROR_CORRECTION=0]="ERROR_CORRECTION",EncodeHintType2[EncodeHintType2.CHARACTER_SET=1]="CHARACTER_SET",EncodeHintType2[EncodeHintType2.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",EncodeHintType2[EncodeHintType2.MIN_SIZE=3]="MIN_SIZE",EncodeHintType2[EncodeHintType2.MAX_SIZE=4]="MAX_SIZE",EncodeHintType2[EncodeHintType2.MARGIN=5]="MARGIN",EncodeHintType2[EncodeHintType2.PDF417_COMPACT=6]="PDF417_COMPACT",EncodeHintType2[EncodeHintType2.PDF417_COMPACTION=7]="PDF417_COMPACTION",EncodeHintType2[EncodeHintType2.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",EncodeHintType2[EncodeHintType2.AZTEC_LAYERS=9]="AZTEC_LAYERS",EncodeHintType2[EncodeHintType2.QR_VERSION=10]="QR_VERSION"})(EncodeHintType||(EncodeHintType={}));var EncodeHintType$1=EncodeHintType;class ReedSolomonEncoder{constructor(field){this.field=field,this.cachedGenerators=[],this.cachedGenerators.push(new GenericGFPoly(field,Int32Array.from([1])))}buildGenerator(degree){const cachedGenerators=this.cachedGenerators;if(degree>=cachedGenerators.length){let lastGenerator=cachedGenerators[cachedGenerators.length-1];const field=this.field;for(let d=cachedGenerators.length;d<=degree;d++){const nextGenerator=lastGenerator.multiply(new GenericGFPoly(field,Int32Array.from([1,field.exp(d-1+field.getGeneratorBase())])));cachedGenerators.push(nextGenerator),lastGenerator=nextGenerator}}return cachedGenerators[degree]}encode(toEncode,ecBytes){if(ecBytes===0)throw new IllegalArgumentException("No error correction bytes");const dataBytes=toEncode.length-ecBytes;if(dataBytes<=0)throw new IllegalArgumentException("No data bytes provided");const generator=this.buildGenerator(ecBytes),infoCoefficients=new Int32Array(dataBytes);System.arraycopy(toEncode,0,infoCoefficients,0,dataBytes);let info=new GenericGFPoly(this.field,infoCoefficients);info=info.multiplyByMonomial(ecBytes,1);const coefficients=info.divide(generator)[1].getCoefficients(),numZeroCoefficients=ecBytes-coefficients.length;for(let i=0;i<numZeroCoefficients;i++)toEncode[dataBytes+i]=0;System.arraycopy(coefficients,0,toEncode,dataBytes+numZeroCoefficients,coefficients.length)}}class MaskUtil{constructor(){}static applyMaskPenaltyRule1(matrix){return MaskUtil.applyMaskPenaltyRule1Internal(matrix,!0)+MaskUtil.applyMaskPenaltyRule1Internal(matrix,!1)}static applyMaskPenaltyRule2(matrix){let penalty=0;const array=matrix.getArray(),width=matrix.getWidth(),height=matrix.getHeight();for(let y=0;y<height-1;y++){const arrayY=array[y];for(let x=0;x<width-1;x++){const value=arrayY[x];value===arrayY[x+1]&&value===array[y+1][x]&&value===array[y+1][x+1]&&penalty++}}return MaskUtil.N2*penalty}static applyMaskPenaltyRule3(matrix){let numPenalties=0;const array=matrix.getArray(),width=matrix.getWidth(),height=matrix.getHeight();for(let y=0;y<height;y++)for(let x=0;x<width;x++){const arrayY=array[y];x+6<width&&arrayY[x]===1&&arrayY[x+1]===0&&arrayY[x+2]===1&&arrayY[x+3]===1&&arrayY[x+4]===1&&arrayY[x+5]===0&&arrayY[x+6]===1&&(MaskUtil.isWhiteHorizontal(arrayY,x-4,x)||MaskUtil.isWhiteHorizontal(arrayY,x+7,x+11))&&numPenalties++,y+6<height&&array[y][x]===1&&array[y+1][x]===0&&array[y+2][x]===1&&array[y+3][x]===1&&array[y+4][x]===1&&array[y+5][x]===0&&array[y+6][x]===1&&(MaskUtil.isWhiteVertical(array,x,y-4,y)||MaskUtil.isWhiteVertical(array,x,y+7,y+11))&&numPenalties++}return numPenalties*MaskUtil.N3}static isWhiteHorizontal(rowArray,from,to){from=Math.max(from,0),to=Math.min(to,rowArray.length);for(let i=from;i<to;i++)if(rowArray[i]===1)return!1;return!0}static isWhiteVertical(array,col,from,to){from=Math.max(from,0),to=Math.min(to,array.length);for(let i=from;i<to;i++)if(array[i][col]===1)return!1;return!0}static applyMaskPenaltyRule4(matrix){let numDarkCells=0;const array=matrix.getArray(),width=matrix.getWidth(),height=matrix.getHeight();for(let y=0;y<height;y++){const arrayY=array[y];for(let x=0;x<width;x++)arrayY[x]===1&&numDarkCells++}const numTotalCells=matrix.getHeight()*matrix.getWidth();return Math.floor(Math.abs(numDarkCells*2-numTotalCells)*10/numTotalCells)*MaskUtil.N4}static getDataMaskBit(maskPattern,x,y){let intermediate,temp;switch(maskPattern){case 0:intermediate=y+x&1;break;case 1:intermediate=y&1;break;case 2:intermediate=x%3;break;case 3:intermediate=(y+x)%3;break;case 4:intermediate=Math.floor(y/2)+Math.floor(x/3)&1;break;case 5:temp=y*x,intermediate=(temp&1)+temp%3;break;case 6:temp=y*x,intermediate=(temp&1)+temp%3&1;break;case 7:temp=y*x,intermediate=temp%3+(y+x&1)&1;break;default:throw new IllegalArgumentException("Invalid mask pattern: "+maskPattern)}return intermediate===0}static applyMaskPenaltyRule1Internal(matrix,isHorizontal){let penalty=0;const iLimit=isHorizontal?matrix.getHeight():matrix.getWidth(),jLimit=isHorizontal?matrix.getWidth():matrix.getHeight(),array=matrix.getArray();for(let i=0;i<iLimit;i++){let numSameBitCells=0,prevBit=-1;for(let j=0;j<jLimit;j++){const bit=isHorizontal?array[i][j]:array[j][i];bit===prevBit?numSameBitCells++:(numSameBitCells>=5&&(penalty+=MaskUtil.N1+(numSameBitCells-5)),numSameBitCells=1,prevBit=bit)}numSameBitCells>=5&&(penalty+=MaskUtil.N1+(numSameBitCells-5))}return penalty}}MaskUtil.N1=3,MaskUtil.N2=3,MaskUtil.N3=40,MaskUtil.N4=10;class ByteMatrix{constructor(width,height){this.width=width,this.height=height;const bytes=new Array(height);for(let i=0;i!==height;i++)bytes[i]=new Uint8Array(width);this.bytes=bytes}getHeight(){return this.height}getWidth(){return this.width}get(x,y){return this.bytes[y][x]}getArray(){return this.bytes}setNumber(x,y,value){this.bytes[y][x]=value}setBoolean(x,y,value){this.bytes[y][x]=value?1:0}clear(value){for(const aByte of this.bytes)Arrays.fill(aByte,value)}equals(o){if(!(o instanceof ByteMatrix))return!1;const other=o;if(this.width!==other.width||this.height!==other.height)return!1;for(let y=0,height=this.height;y<height;++y){const bytesY=this.bytes[y],otherBytesY=other.bytes[y];for(let x=0,width=this.width;x<width;++x)if(bytesY[x]!==otherBytesY[x])return!1}return!0}toString(){const result=new StringBuilder;for(let y=0,height=this.height;y<height;++y){const bytesY=this.bytes[y];for(let x=0,width=this.width;x<width;++x)switch(bytesY[x]){case 0:result.append(" 0");break;case 1:result.append(" 1");break;default:result.append("  ");break}result.append(`
`)}return result.toString()}}class QRCode{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const result=new StringBuilder;return result.append(`<<
`),result.append(" mode: "),result.append(this.mode?this.mode.toString():"null"),result.append(`
 ecLevel: `),result.append(this.ecLevel?this.ecLevel.toString():"null"),result.append(`
 version: `),result.append(this.version?this.version.toString():"null"),result.append(`
 maskPattern: `),result.append(this.maskPattern.toString()),this.matrix?(result.append(`
 matrix:
`),result.append(this.matrix.toString())):result.append(`
 matrix: null
`),result.append(`>>
`),result.toString()}setMode(value){this.mode=value}setECLevel(value){this.ecLevel=value}setVersion(version){this.version=version}setMaskPattern(value){this.maskPattern=value}setMatrix(value){this.matrix=value}static isValidMaskPattern(maskPattern){return maskPattern>=0&&maskPattern<QRCode.NUM_MASK_PATTERNS}}QRCode.NUM_MASK_PATTERNS=8;class WriterException extends Exception{}WriterException.kind="WriterException";class MatrixUtil{constructor(){}static clearMatrix(matrix){matrix.clear(255)}static buildMatrix(dataBits,ecLevel,version,maskPattern,matrix){MatrixUtil.clearMatrix(matrix),MatrixUtil.embedBasicPatterns(version,matrix),MatrixUtil.embedTypeInfo(ecLevel,maskPattern,matrix),MatrixUtil.maybeEmbedVersionInfo(version,matrix),MatrixUtil.embedDataBits(dataBits,maskPattern,matrix)}static embedBasicPatterns(version,matrix){MatrixUtil.embedPositionDetectionPatternsAndSeparators(matrix),MatrixUtil.embedDarkDotAtLeftBottomCorner(matrix),MatrixUtil.maybeEmbedPositionAdjustmentPatterns(version,matrix),MatrixUtil.embedTimingPatterns(matrix)}static embedTypeInfo(ecLevel,maskPattern,matrix){const typeInfoBits=new BitArray;MatrixUtil.makeTypeInfoBits(ecLevel,maskPattern,typeInfoBits);for(let i=0,size=typeInfoBits.getSize();i<size;++i){const bit=typeInfoBits.get(typeInfoBits.getSize()-1-i),coordinates=MatrixUtil.TYPE_INFO_COORDINATES[i],x1=coordinates[0],y1=coordinates[1];if(matrix.setBoolean(x1,y1,bit),i<8){const x2=matrix.getWidth()-i-1;matrix.setBoolean(x2,8,bit)}else{const y2=matrix.getHeight()-7+(i-8);matrix.setBoolean(8,y2,bit)}}}static maybeEmbedVersionInfo(version,matrix){if(version.getVersionNumber()<7)return;const versionInfoBits=new BitArray;MatrixUtil.makeVersionInfoBits(version,versionInfoBits);let bitIndex=6*3-1;for(let i=0;i<6;++i)for(let j=0;j<3;++j){const bit=versionInfoBits.get(bitIndex);bitIndex--,matrix.setBoolean(i,matrix.getHeight()-11+j,bit),matrix.setBoolean(matrix.getHeight()-11+j,i,bit)}}static embedDataBits(dataBits,maskPattern,matrix){let bitIndex=0,direction=-1,x=matrix.getWidth()-1,y=matrix.getHeight()-1;for(;x>0;){for(x===6&&(x-=1);y>=0&&y<matrix.getHeight();){for(let i=0;i<2;++i){const xx=x-i;if(!MatrixUtil.isEmpty(matrix.get(xx,y)))continue;let bit;bitIndex<dataBits.getSize()?(bit=dataBits.get(bitIndex),++bitIndex):bit=!1,maskPattern!==255&&MaskUtil.getDataMaskBit(maskPattern,xx,y)&&(bit=!bit),matrix.setBoolean(xx,y,bit)}y+=direction}direction=-direction,y+=direction,x-=2}if(bitIndex!==dataBits.getSize())throw new WriterException("Not all bits consumed: "+bitIndex+"/"+dataBits.getSize())}static findMSBSet(value){return 32-Integer.numberOfLeadingZeros(value)}static calculateBCHCode(value,poly){if(poly===0)throw new IllegalArgumentException("0 polynomial");const msbSetInPoly=MatrixUtil.findMSBSet(poly);for(value<<=msbSetInPoly-1;MatrixUtil.findMSBSet(value)>=msbSetInPoly;)value^=poly<<MatrixUtil.findMSBSet(value)-msbSetInPoly;return value}static makeTypeInfoBits(ecLevel,maskPattern,bits){if(!QRCode.isValidMaskPattern(maskPattern))throw new WriterException("Invalid mask pattern");const typeInfo=ecLevel.getBits()<<3|maskPattern;bits.appendBits(typeInfo,5);const bchCode=MatrixUtil.calculateBCHCode(typeInfo,MatrixUtil.TYPE_INFO_POLY);bits.appendBits(bchCode,10);const maskBits=new BitArray;if(maskBits.appendBits(MatrixUtil.TYPE_INFO_MASK_PATTERN,15),bits.xor(maskBits),bits.getSize()!==15)throw new WriterException("should not happen but we got: "+bits.getSize())}static makeVersionInfoBits(version,bits){bits.appendBits(version.getVersionNumber(),6);const bchCode=MatrixUtil.calculateBCHCode(version.getVersionNumber(),MatrixUtil.VERSION_INFO_POLY);if(bits.appendBits(bchCode,12),bits.getSize()!==18)throw new WriterException("should not happen but we got: "+bits.getSize())}static isEmpty(value){return value===255}static embedTimingPatterns(matrix){for(let i=8;i<matrix.getWidth()-8;++i){const bit=(i+1)%2;MatrixUtil.isEmpty(matrix.get(i,6))&&matrix.setNumber(i,6,bit),MatrixUtil.isEmpty(matrix.get(6,i))&&matrix.setNumber(6,i,bit)}}static embedDarkDotAtLeftBottomCorner(matrix){if(matrix.get(8,matrix.getHeight()-8)===0)throw new WriterException;matrix.setNumber(8,matrix.getHeight()-8,1)}static embedHorizontalSeparationPattern(xStart,yStart,matrix){for(let x=0;x<8;++x){if(!MatrixUtil.isEmpty(matrix.get(xStart+x,yStart)))throw new WriterException;matrix.setNumber(xStart+x,yStart,0)}}static embedVerticalSeparationPattern(xStart,yStart,matrix){for(let y=0;y<7;++y){if(!MatrixUtil.isEmpty(matrix.get(xStart,yStart+y)))throw new WriterException;matrix.setNumber(xStart,yStart+y,0)}}static embedPositionAdjustmentPattern(xStart,yStart,matrix){for(let y=0;y<5;++y){const patternY=MatrixUtil.POSITION_ADJUSTMENT_PATTERN[y];for(let x=0;x<5;++x)matrix.setNumber(xStart+x,yStart+y,patternY[x])}}static embedPositionDetectionPattern(xStart,yStart,matrix){for(let y=0;y<7;++y){const patternY=MatrixUtil.POSITION_DETECTION_PATTERN[y];for(let x=0;x<7;++x)matrix.setNumber(xStart+x,yStart+y,patternY[x])}}static embedPositionDetectionPatternsAndSeparators(matrix){const pdpWidth=MatrixUtil.POSITION_DETECTION_PATTERN[0].length;MatrixUtil.embedPositionDetectionPattern(0,0,matrix),MatrixUtil.embedPositionDetectionPattern(matrix.getWidth()-pdpWidth,0,matrix),MatrixUtil.embedPositionDetectionPattern(0,matrix.getWidth()-pdpWidth,matrix);const hspWidth=8;MatrixUtil.embedHorizontalSeparationPattern(0,hspWidth-1,matrix),MatrixUtil.embedHorizontalSeparationPattern(matrix.getWidth()-hspWidth,hspWidth-1,matrix),MatrixUtil.embedHorizontalSeparationPattern(0,matrix.getWidth()-hspWidth,matrix);const vspSize=7;MatrixUtil.embedVerticalSeparationPattern(vspSize,0,matrix),MatrixUtil.embedVerticalSeparationPattern(matrix.getHeight()-vspSize-1,0,matrix),MatrixUtil.embedVerticalSeparationPattern(vspSize,matrix.getHeight()-vspSize,matrix)}static maybeEmbedPositionAdjustmentPatterns(version,matrix){if(version.getVersionNumber()<2)return;const index=version.getVersionNumber()-1,coordinates=MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[index];for(let i=0,length=coordinates.length;i!==length;i++){const y=coordinates[i];if(y>=0)for(let j=0;j!==length;j++){const x=coordinates[j];x>=0&&MatrixUtil.isEmpty(matrix.get(x,y))&&MatrixUtil.embedPositionAdjustmentPattern(x-2,y-2,matrix)}}}}MatrixUtil.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),MatrixUtil.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),MatrixUtil.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),MatrixUtil.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),MatrixUtil.VERSION_INFO_POLY=7973,MatrixUtil.TYPE_INFO_POLY=1335,MatrixUtil.TYPE_INFO_MASK_PATTERN=21522;class BlockPair{constructor(dataBytes,errorCorrectionBytes){this.dataBytes=dataBytes,this.errorCorrectionBytes=errorCorrectionBytes}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Encoder{constructor(){}static calculateMaskPenalty(matrix){return MaskUtil.applyMaskPenaltyRule1(matrix)+MaskUtil.applyMaskPenaltyRule2(matrix)+MaskUtil.applyMaskPenaltyRule3(matrix)+MaskUtil.applyMaskPenaltyRule4(matrix)}static encode(content,ecLevel,hints=null){let encoding=Encoder.DEFAULT_BYTE_MODE_ENCODING;const hasEncodingHint=hints!==null&&hints.get(EncodeHintType$1.CHARACTER_SET)!==void 0;hasEncodingHint&&(encoding=hints.get(EncodeHintType$1.CHARACTER_SET).toString());const mode=this.chooseMode(content,encoding),headerBits=new BitArray;if(mode===Mode$1.BYTE&&(hasEncodingHint||Encoder.DEFAULT_BYTE_MODE_ENCODING!==encoding)){const eci=CharacterSetECI.getCharacterSetECIByName(encoding);eci!==void 0&&this.appendECI(eci,headerBits)}this.appendModeInfo(mode,headerBits);const dataBits=new BitArray;this.appendBytes(content,mode,dataBits,encoding);let version;if(hints!==null&&hints.get(EncodeHintType$1.QR_VERSION)!==void 0){const versionNumber=Number.parseInt(hints.get(EncodeHintType$1.QR_VERSION).toString(),10);version=Version$1.getVersionForNumber(versionNumber);const bitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,version);if(!this.willFit(bitsNeeded,version,ecLevel))throw new WriterException("Data too big for requested version")}else version=this.recommendVersion(ecLevel,mode,headerBits,dataBits);const headerAndDataBits=new BitArray;headerAndDataBits.appendBitArray(headerBits);const numLetters=mode===Mode$1.BYTE?dataBits.getSizeInBytes():content.length;this.appendLengthInfo(numLetters,version,mode,headerAndDataBits),headerAndDataBits.appendBitArray(dataBits);const ecBlocks=version.getECBlocksForLevel(ecLevel),numDataBytes=version.getTotalCodewords()-ecBlocks.getTotalECCodewords();this.terminateBits(numDataBytes,headerAndDataBits);const finalBits=this.interleaveWithECBytes(headerAndDataBits,version.getTotalCodewords(),numDataBytes,ecBlocks.getNumBlocks()),qrCode=new QRCode;qrCode.setECLevel(ecLevel),qrCode.setMode(mode),qrCode.setVersion(version);const dimension=version.getDimensionForVersion(),matrix=new ByteMatrix(dimension,dimension),maskPattern=this.chooseMaskPattern(finalBits,ecLevel,version,matrix);return qrCode.setMaskPattern(maskPattern),MatrixUtil.buildMatrix(finalBits,ecLevel,version,maskPattern,matrix),qrCode.setMatrix(matrix),qrCode}static recommendVersion(ecLevel,mode,headerBits,dataBits){const provisionalBitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,Version$1.getVersionForNumber(1)),provisionalVersion=this.chooseVersion(provisionalBitsNeeded,ecLevel),bitsNeeded=this.calculateBitsNeeded(mode,headerBits,dataBits,provisionalVersion);return this.chooseVersion(bitsNeeded,ecLevel)}static calculateBitsNeeded(mode,headerBits,dataBits,version){return headerBits.getSize()+mode.getCharacterCountBits(version)+dataBits.getSize()}static getAlphanumericCode(code){return code<Encoder.ALPHANUMERIC_TABLE.length?Encoder.ALPHANUMERIC_TABLE[code]:-1}static chooseMode(content,encoding=null){if(CharacterSetECI.SJIS.getName()===encoding&&this.isOnlyDoubleByteKanji(content))return Mode$1.KANJI;let hasNumeric=!1,hasAlphanumeric=!1;for(let i=0,length=content.length;i<length;++i){const c=content.charAt(i);if(Encoder.isDigit(c))hasNumeric=!0;else if(this.getAlphanumericCode(c.charCodeAt(0))!==-1)hasAlphanumeric=!0;else return Mode$1.BYTE}return hasAlphanumeric?Mode$1.ALPHANUMERIC:hasNumeric?Mode$1.NUMERIC:Mode$1.BYTE}static isOnlyDoubleByteKanji(content){let bytes;try{bytes=StringEncoding.encode(content,CharacterSetECI.SJIS)}catch{return!1}const length=bytes.length;if(length%2!==0)return!1;for(let i=0;i<length;i+=2){const byte1=bytes[i]&255;if((byte1<129||byte1>159)&&(byte1<224||byte1>235))return!1}return!0}static chooseMaskPattern(bits,ecLevel,version,matrix){let minPenalty=Number.MAX_SAFE_INTEGER,bestMaskPattern=-1;for(let maskPattern=0;maskPattern<QRCode.NUM_MASK_PATTERNS;maskPattern++){MatrixUtil.buildMatrix(bits,ecLevel,version,maskPattern,matrix);let penalty=this.calculateMaskPenalty(matrix);penalty<minPenalty&&(minPenalty=penalty,bestMaskPattern=maskPattern)}return bestMaskPattern}static chooseVersion(numInputBits,ecLevel){for(let versionNum=1;versionNum<=40;versionNum++){const version=Version$1.getVersionForNumber(versionNum);if(Encoder.willFit(numInputBits,version,ecLevel))return version}throw new WriterException("Data too big")}static willFit(numInputBits,version,ecLevel){const numBytes=version.getTotalCodewords(),numEcBytes=version.getECBlocksForLevel(ecLevel).getTotalECCodewords(),numDataBytes=numBytes-numEcBytes,totalInputBytes=(numInputBits+7)/8;return numDataBytes>=totalInputBytes}static terminateBits(numDataBytes,bits){const capacity=numDataBytes*8;if(bits.getSize()>capacity)throw new WriterException("data bits cannot fit in the QR Code"+bits.getSize()+" > "+capacity);for(let i=0;i<4&&bits.getSize()<capacity;++i)bits.appendBit(!1);const numBitsInLastByte=bits.getSize()&7;if(numBitsInLastByte>0)for(let i=numBitsInLastByte;i<8;i++)bits.appendBit(!1);const numPaddingBytes=numDataBytes-bits.getSizeInBytes();for(let i=0;i<numPaddingBytes;++i)bits.appendBits(i&1?17:236,8);if(bits.getSize()!==capacity)throw new WriterException("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(numTotalBytes,numDataBytes,numRSBlocks,blockID,numDataBytesInBlock,numECBytesInBlock){if(blockID>=numRSBlocks)throw new WriterException("Block ID too large");const numRsBlocksInGroup2=numTotalBytes%numRSBlocks,numRsBlocksInGroup1=numRSBlocks-numRsBlocksInGroup2,numTotalBytesInGroup1=Math.floor(numTotalBytes/numRSBlocks),numTotalBytesInGroup2=numTotalBytesInGroup1+1,numDataBytesInGroup1=Math.floor(numDataBytes/numRSBlocks),numDataBytesInGroup2=numDataBytesInGroup1+1,numEcBytesInGroup1=numTotalBytesInGroup1-numDataBytesInGroup1,numEcBytesInGroup2=numTotalBytesInGroup2-numDataBytesInGroup2;if(numEcBytesInGroup1!==numEcBytesInGroup2)throw new WriterException("EC bytes mismatch");if(numRSBlocks!==numRsBlocksInGroup1+numRsBlocksInGroup2)throw new WriterException("RS blocks mismatch");if(numTotalBytes!==(numDataBytesInGroup1+numEcBytesInGroup1)*numRsBlocksInGroup1+(numDataBytesInGroup2+numEcBytesInGroup2)*numRsBlocksInGroup2)throw new WriterException("Total bytes mismatch");blockID<numRsBlocksInGroup1?(numDataBytesInBlock[0]=numDataBytesInGroup1,numECBytesInBlock[0]=numEcBytesInGroup1):(numDataBytesInBlock[0]=numDataBytesInGroup2,numECBytesInBlock[0]=numEcBytesInGroup2)}static interleaveWithECBytes(bits,numTotalBytes,numDataBytes,numRSBlocks){if(bits.getSizeInBytes()!==numDataBytes)throw new WriterException("Number of bits and data bytes does not match");let dataBytesOffset=0,maxNumDataBytes=0,maxNumEcBytes=0;const blocks=new Array;for(let i=0;i<numRSBlocks;++i){const numDataBytesInBlock=new Int32Array(1),numEcBytesInBlock=new Int32Array(1);Encoder.getNumDataBytesAndNumECBytesForBlockID(numTotalBytes,numDataBytes,numRSBlocks,i,numDataBytesInBlock,numEcBytesInBlock);const size=numDataBytesInBlock[0],dataBytes=new Uint8Array(size);bits.toBytes(8*dataBytesOffset,dataBytes,0,size);const ecBytes=Encoder.generateECBytes(dataBytes,numEcBytesInBlock[0]);blocks.push(new BlockPair(dataBytes,ecBytes)),maxNumDataBytes=Math.max(maxNumDataBytes,size),maxNumEcBytes=Math.max(maxNumEcBytes,ecBytes.length),dataBytesOffset+=numDataBytesInBlock[0]}if(numDataBytes!==dataBytesOffset)throw new WriterException("Data bytes does not match offset");const result=new BitArray;for(let i=0;i<maxNumDataBytes;++i)for(const block of blocks){const dataBytes=block.getDataBytes();i<dataBytes.length&&result.appendBits(dataBytes[i],8)}for(let i=0;i<maxNumEcBytes;++i)for(const block of blocks){const ecBytes=block.getErrorCorrectionBytes();i<ecBytes.length&&result.appendBits(ecBytes[i],8)}if(numTotalBytes!==result.getSizeInBytes())throw new WriterException("Interleaving error: "+numTotalBytes+" and "+result.getSizeInBytes()+" differ.");return result}static generateECBytes(dataBytes,numEcBytesInBlock){const numDataBytes=dataBytes.length,toEncode=new Int32Array(numDataBytes+numEcBytesInBlock);for(let i=0;i<numDataBytes;i++)toEncode[i]=dataBytes[i]&255;new ReedSolomonEncoder(GenericGF.QR_CODE_FIELD_256).encode(toEncode,numEcBytesInBlock);const ecBytes=new Uint8Array(numEcBytesInBlock);for(let i=0;i<numEcBytesInBlock;i++)ecBytes[i]=toEncode[numDataBytes+i];return ecBytes}static appendModeInfo(mode,bits){bits.appendBits(mode.getBits(),4)}static appendLengthInfo(numLetters,version,mode,bits){const numBits=mode.getCharacterCountBits(version);if(numLetters>=1<<numBits)throw new WriterException(numLetters+" is bigger than "+((1<<numBits)-1));bits.appendBits(numLetters,numBits)}static appendBytes(content,mode,bits,encoding){switch(mode){case Mode$1.NUMERIC:Encoder.appendNumericBytes(content,bits);break;case Mode$1.ALPHANUMERIC:Encoder.appendAlphanumericBytes(content,bits);break;case Mode$1.BYTE:Encoder.append8BitBytes(content,bits,encoding);break;case Mode$1.KANJI:Encoder.appendKanjiBytes(content,bits);break;default:throw new WriterException("Invalid mode: "+mode)}}static getDigit(singleCharacter){return singleCharacter.charCodeAt(0)-48}static isDigit(singleCharacter){const cn=Encoder.getDigit(singleCharacter);return cn>=0&&cn<=9}static appendNumericBytes(content,bits){const length=content.length;let i=0;for(;i<length;){const num1=Encoder.getDigit(content.charAt(i));if(i+2<length){const num2=Encoder.getDigit(content.charAt(i+1)),num3=Encoder.getDigit(content.charAt(i+2));bits.appendBits(num1*100+num2*10+num3,10),i+=3}else if(i+1<length){const num2=Encoder.getDigit(content.charAt(i+1));bits.appendBits(num1*10+num2,7),i+=2}else bits.appendBits(num1,4),i++}}static appendAlphanumericBytes(content,bits){const length=content.length;let i=0;for(;i<length;){const code1=Encoder.getAlphanumericCode(content.charCodeAt(i));if(code1===-1)throw new WriterException;if(i+1<length){const code2=Encoder.getAlphanumericCode(content.charCodeAt(i+1));if(code2===-1)throw new WriterException;bits.appendBits(code1*45+code2,11),i+=2}else bits.appendBits(code1,6),i++}}static append8BitBytes(content,bits,encoding){let bytes;try{bytes=StringEncoding.encode(content,encoding)}catch(uee){throw new WriterException(uee)}for(let i=0,length=bytes.length;i!==length;i++){const b=bytes[i];bits.appendBits(b,8)}}static appendKanjiBytes(content,bits){let bytes;try{bytes=StringEncoding.encode(content,CharacterSetECI.SJIS)}catch(uee){throw new WriterException(uee)}const length=bytes.length;for(let i=0;i<length;i+=2){const byte1=bytes[i]&255,byte2=bytes[i+1]&255,code=byte1<<8&4294967295|byte2;let subtracted=-1;if(code>=33088&&code<=40956?subtracted=code-33088:code>=57408&&code<=60351&&(subtracted=code-49472),subtracted===-1)throw new WriterException("Invalid byte sequence");const encoded=(subtracted>>8)*192+(subtracted&255);bits.appendBits(encoded,13)}}static appendECI(eci,bits){bits.appendBits(Mode$1.ECI.getBits(),4),bits.appendBits(eci.getValue(),8)}}Encoder.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Encoder.DEFAULT_BYTE_MODE_ENCODING=CharacterSetECI.UTF8.getName();class BrowserQRCodeSvgWriter{write(contents,width,height,hints=null){if(contents.length===0)throw new IllegalArgumentException("Found empty contents");if(width<0||height<0)throw new IllegalArgumentException("Requested dimensions are too small: "+width+"x"+height);let errorCorrectionLevel=ErrorCorrectionLevel.L,quietZone=BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE;hints!==null&&(hints.get(EncodeHintType$1.ERROR_CORRECTION)!==void 0&&(errorCorrectionLevel=ErrorCorrectionLevel.fromString(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString())),hints.get(EncodeHintType$1.MARGIN)!==void 0&&(quietZone=Number.parseInt(hints.get(EncodeHintType$1.MARGIN).toString(),10)));const code=Encoder.encode(contents,errorCorrectionLevel,hints);return this.renderResult(code,width,height,quietZone)}writeToDom(containerElement,contents,width,height,hints=null){typeof containerElement=="string"&&(containerElement=document.querySelector(containerElement));const svgElement=this.write(contents,width,height,hints);containerElement&&containerElement.appendChild(svgElement)}renderResult(code,width,height,quietZone){const input=code.getMatrix();if(input===null)throw new IllegalStateException;const inputWidth=input.getWidth(),inputHeight=input.getHeight(),qrWidth=inputWidth+quietZone*2,qrHeight=inputHeight+quietZone*2,outputWidth=Math.max(width,qrWidth),outputHeight=Math.max(height,qrHeight),multiple=Math.min(Math.floor(outputWidth/qrWidth),Math.floor(outputHeight/qrHeight)),leftPadding=Math.floor((outputWidth-inputWidth*multiple)/2),topPadding=Math.floor((outputHeight-inputHeight*multiple)/2),svgElement=this.createSVGElement(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple)for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple)if(input.get(inputX,inputY)===1){const svgRectElement=this.createSvgRectElement(outputX,outputY,multiple,multiple);svgElement.appendChild(svgRectElement)}return svgElement}createSVGElement(w,h){const svgElement=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,"svg");return svgElement.setAttributeNS(null,"height",w.toString()),svgElement.setAttributeNS(null,"width",h.toString()),svgElement}createSvgRectElement(x,y,w,h){const rect=document.createElementNS(BrowserQRCodeSvgWriter.SVG_NS,"rect");return rect.setAttributeNS(null,"x",x.toString()),rect.setAttributeNS(null,"y",y.toString()),rect.setAttributeNS(null,"height",w.toString()),rect.setAttributeNS(null,"width",h.toString()),rect.setAttributeNS(null,"fill","#000000"),rect}}BrowserQRCodeSvgWriter.QUIET_ZONE_SIZE=4,BrowserQRCodeSvgWriter.SVG_NS="http://www.w3.org/2000/svg";class QRCodeWriter{encode(contents,format,width,height,hints){if(contents.length===0)throw new IllegalArgumentException("Found empty contents");if(format!==BarcodeFormat$1.QR_CODE)throw new IllegalArgumentException("Can only encode QR_CODE, but got "+format);if(width<0||height<0)throw new IllegalArgumentException(`Requested dimensions are too small: ${width}x${height}`);let errorCorrectionLevel=ErrorCorrectionLevel.L,quietZone=QRCodeWriter.QUIET_ZONE_SIZE;hints!==null&&(hints.get(EncodeHintType$1.ERROR_CORRECTION)!==void 0&&(errorCorrectionLevel=ErrorCorrectionLevel.fromString(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString())),hints.get(EncodeHintType$1.MARGIN)!==void 0&&(quietZone=Number.parseInt(hints.get(EncodeHintType$1.MARGIN).toString(),10)));const code=Encoder.encode(contents,errorCorrectionLevel,hints);return QRCodeWriter.renderResult(code,width,height,quietZone)}static renderResult(code,width,height,quietZone){const input=code.getMatrix();if(input===null)throw new IllegalStateException;const inputWidth=input.getWidth(),inputHeight=input.getHeight(),qrWidth=inputWidth+quietZone*2,qrHeight=inputHeight+quietZone*2,outputWidth=Math.max(width,qrWidth),outputHeight=Math.max(height,qrHeight),multiple=Math.min(Math.floor(outputWidth/qrWidth),Math.floor(outputHeight/qrHeight)),leftPadding=Math.floor((outputWidth-inputWidth*multiple)/2),topPadding=Math.floor((outputHeight-inputHeight*multiple)/2),output=new BitMatrix(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple)for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple)input.get(inputX,inputY)===1&&output.setRegion(outputX,outputY,multiple,multiple);return output}}QRCodeWriter.QUIET_ZONE_SIZE=4;class MultiFormatWriter{encode(contents,format,width,height,hints){let writer;switch(format){case BarcodeFormat$1.QR_CODE:writer=new QRCodeWriter;break;default:throw new IllegalArgumentException("No encoder available for format "+format)}return writer.encode(contents,format,width,height,hints)}}class PlanarYUVLuminanceSource extends LuminanceSource{constructor(yuvData,dataWidth,dataHeight,left,top,width,height,reverseHorizontal){if(super(width,height),this.yuvData=yuvData,this.dataWidth=dataWidth,this.dataHeight=dataHeight,this.left=left,this.top=top,left+width>dataWidth||top+height>dataHeight)throw new IllegalArgumentException("Crop rectangle does not fit within image data.");reverseHorizontal&&this.reverseHorizontal(width,height)}getRow(y,row){if(y<0||y>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+y);const width=this.getWidth();(row==null||row.length<width)&&(row=new Uint8ClampedArray(width));const offset=(y+this.top)*this.dataWidth+this.left;return System.arraycopy(this.yuvData,offset,row,0,width),row}getMatrix(){const width=this.getWidth(),height=this.getHeight();if(width===this.dataWidth&&height===this.dataHeight)return this.yuvData;const area=width*height,matrix=new Uint8ClampedArray(area);let inputOffset=this.top*this.dataWidth+this.left;if(width===this.dataWidth)return System.arraycopy(this.yuvData,inputOffset,matrix,0,area),matrix;for(let y=0;y<height;y++){const outputOffset=y*width;System.arraycopy(this.yuvData,inputOffset,matrix,outputOffset,width),inputOffset+=this.dataWidth}return matrix}isCropSupported(){return!0}crop(left,top,width,height){return new PlanarYUVLuminanceSource(this.yuvData,this.dataWidth,this.dataHeight,this.left+left,this.top+top,width,height,!1)}renderThumbnail(){const width=this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR,height=this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR,pixels=new Int32Array(width*height),yuv=this.yuvData;let inputOffset=this.top*this.dataWidth+this.left;for(let y=0;y<height;y++){const outputOffset=y*width;for(let x=0;x<width;x++){const grey=yuv[inputOffset+x*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR]&255;pixels[outputOffset+x]=4278190080|grey*65793}inputOffset+=this.dataWidth*PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}return pixels}getThumbnailWidth(){return this.getWidth()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(width,height){const yuvData=this.yuvData;for(let y=0,rowStart=this.top*this.dataWidth+this.left;y<height;y++,rowStart+=this.dataWidth){const middle=rowStart+width/2;for(let x1=rowStart,x2=rowStart+width-1;x1<middle;x1++,x2--){const temp=yuvData[x1];yuvData[x1]=yuvData[x2],yuvData[x2]=temp}}}invert(){return new InvertedLuminanceSource(this)}}PlanarYUVLuminanceSource.THUMBNAIL_SCALE_FACTOR=2;class RGBLuminanceSource extends LuminanceSource{constructor(luminances,width,height,dataWidth,dataHeight,left,top){if(super(width,height),this.dataWidth=dataWidth,this.dataHeight=dataHeight,this.left=left,this.top=top,luminances.BYTES_PER_ELEMENT===4){const size=width*height,luminancesUint8Array=new Uint8ClampedArray(size);for(let offset=0;offset<size;offset++){const pixel=luminances[offset],r=pixel>>16&255,g2=pixel>>7&510,b=pixel&255;luminancesUint8Array[offset]=(r+g2+b)/4&255}this.luminances=luminancesUint8Array}else this.luminances=luminances;if(dataWidth===void 0&&(this.dataWidth=width),dataHeight===void 0&&(this.dataHeight=height),left===void 0&&(this.left=0),top===void 0&&(this.top=0),this.left+width>this.dataWidth||this.top+height>this.dataHeight)throw new IllegalArgumentException("Crop rectangle does not fit within image data.")}getRow(y,row){if(y<0||y>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+y);const width=this.getWidth();(row==null||row.length<width)&&(row=new Uint8ClampedArray(width));const offset=(y+this.top)*this.dataWidth+this.left;return System.arraycopy(this.luminances,offset,row,0,width),row}getMatrix(){const width=this.getWidth(),height=this.getHeight();if(width===this.dataWidth&&height===this.dataHeight)return this.luminances;const area=width*height,matrix=new Uint8ClampedArray(area);let inputOffset=this.top*this.dataWidth+this.left;if(width===this.dataWidth)return System.arraycopy(this.luminances,inputOffset,matrix,0,area),matrix;for(let y=0;y<height;y++){const outputOffset=y*width;System.arraycopy(this.luminances,inputOffset,matrix,outputOffset,width),inputOffset+=this.dataWidth}return matrix}isCropSupported(){return!0}crop(left,top,width,height){return new RGBLuminanceSource(this.luminances,width,height,this.dataWidth,this.dataHeight,this.left+left,this.top+top)}invert(){return new InvertedLuminanceSource(this)}}class Charset extends CharacterSetECI{static forName(name){return this.getCharacterSetECIByName(name)}}class StandardCharsets{}StandardCharsets.ISO_8859_1=CharacterSetECI.ISO8859_1;class AztecCode{isCompact(){return this.compact}setCompact(compact){this.compact=compact}getSize(){return this.size}setSize(size){this.size=size}getLayers(){return this.layers}setLayers(layers){this.layers=layers}getCodeWords(){return this.codeWords}setCodeWords(codeWords){this.codeWords=codeWords}getMatrix(){return this.matrix}setMatrix(matrix){this.matrix=matrix}}class Collections{static singletonList(item){return[item]}static min(collection,comparator){return collection.sort(comparator)[0]}}class Token{constructor(previous){this.previous=previous}getPrevious(){return this.previous}}class SimpleToken extends Token{constructor(previous,value,bitCount){super(previous),this.value=value,this.bitCount=bitCount}appendTo(bitArray,text){bitArray.appendBits(this.value,this.bitCount)}add(value,bitCount){return new SimpleToken(this,value,bitCount)}addBinaryShift(start,byteCount){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new SimpleToken(this,start,byteCount)}toString(){let value=this.value&(1<<this.bitCount)-1;return value|=1<<this.bitCount,"<"+Integer.toBinaryString(value|1<<this.bitCount).substring(1)+">"}}class BinaryShiftToken extends SimpleToken{constructor(previous,binaryShiftStart,binaryShiftByteCount){super(previous,0,0),this.binaryShiftStart=binaryShiftStart,this.binaryShiftByteCount=binaryShiftByteCount}appendTo(bitArray,text){for(let i=0;i<this.binaryShiftByteCount;i++)(i===0||i===31&&this.binaryShiftByteCount<=62)&&(bitArray.appendBits(31,5),this.binaryShiftByteCount>62?bitArray.appendBits(this.binaryShiftByteCount-31,16):i===0?bitArray.appendBits(Math.min(this.binaryShiftByteCount,31),5):bitArray.appendBits(this.binaryShiftByteCount-31,5)),bitArray.appendBits(text[this.binaryShiftStart+i],8)}addBinaryShift(start,byteCount){return new BinaryShiftToken(this,start,byteCount)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function addBinaryShift(token,start,byteCount){return new BinaryShiftToken(token,start,byteCount)}function add(token,value,bitCount){return new SimpleToken(token,value,bitCount)}const MODE_NAMES=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],MODE_UPPER=0,MODE_LOWER=1,MODE_DIGIT=2,MODE_MIXED=3,MODE_PUNCT=4,EMPTY_TOKEN=new SimpleToken(null,0,0),LATCH_TABLE=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function static_SHIFT_TABLE(SHIFT_TABLE2){for(let table of SHIFT_TABLE2)Arrays.fill(table,-1);return SHIFT_TABLE2[MODE_UPPER][MODE_PUNCT]=0,SHIFT_TABLE2[MODE_LOWER][MODE_PUNCT]=0,SHIFT_TABLE2[MODE_LOWER][MODE_UPPER]=28,SHIFT_TABLE2[MODE_MIXED][MODE_PUNCT]=0,SHIFT_TABLE2[MODE_DIGIT][MODE_PUNCT]=0,SHIFT_TABLE2[MODE_DIGIT][MODE_UPPER]=15,SHIFT_TABLE2}const SHIFT_TABLE=static_SHIFT_TABLE(Arrays.createInt32Array(6,6));class State{constructor(token,mode,binaryBytes,bitCount){this.token=token,this.mode=mode,this.binaryShiftByteCount=binaryBytes,this.bitCount=bitCount}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(mode,value){let bitCount=this.bitCount,token=this.token;if(mode!==this.mode){let latch=LATCH_TABLE[this.mode][mode];token=add(token,latch&65535,latch>>16),bitCount+=latch>>16}let latchModeBitCount=mode===MODE_DIGIT?4:5;return token=add(token,value,latchModeBitCount),new State(token,mode,0,bitCount+latchModeBitCount)}shiftAndAppend(mode,value){let token=this.token,thisModeBitCount=this.mode===MODE_DIGIT?4:5;return token=add(token,SHIFT_TABLE[this.mode][mode],thisModeBitCount),token=add(token,value,5),new State(token,this.mode,0,this.bitCount+thisModeBitCount+5)}addBinaryShiftChar(index){let token=this.token,mode=this.mode,bitCount=this.bitCount;if(this.mode===MODE_PUNCT||this.mode===MODE_DIGIT){let latch=LATCH_TABLE[mode][MODE_UPPER];token=add(token,latch&65535,latch>>16),bitCount+=latch>>16,mode=MODE_UPPER}let deltaBitCount=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,result=new State(token,mode,this.binaryShiftByteCount+1,bitCount+deltaBitCount);return result.binaryShiftByteCount===2078&&(result=result.endBinaryShift(index+1)),result}endBinaryShift(index){if(this.binaryShiftByteCount===0)return this;let token=this.token;return token=addBinaryShift(token,index-this.binaryShiftByteCount,this.binaryShiftByteCount),new State(token,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(other){let newModeBitCount=this.bitCount+(LATCH_TABLE[this.mode][other.mode]>>16);return this.binaryShiftByteCount<other.binaryShiftByteCount?newModeBitCount+=State.calculateBinaryShiftCost(other)-State.calculateBinaryShiftCost(this):this.binaryShiftByteCount>other.binaryShiftByteCount&&other.binaryShiftByteCount>0&&(newModeBitCount+=10),newModeBitCount<=other.bitCount}toBitArray(text){let symbols=[];for(let token=this.endBinaryShift(text.length).token;token!==null;token=token.getPrevious())symbols.unshift(token);let bitArray=new BitArray;for(const symbol of symbols)symbol.appendTo(bitArray,text);return bitArray}toString(){return StringUtils.format("%s bits=%d bytes=%d",MODE_NAMES[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(state){return state.binaryShiftByteCount>62?21:state.binaryShiftByteCount>31?20:state.binaryShiftByteCount>0?10:0}}State.INITIAL_STATE=new State(EMPTY_TOKEN,MODE_UPPER,0,0);function static_CHAR_MAP(CHAR_MAP2){const spaceCharCode=StringUtils.getCharCode(" "),pointCharCode=StringUtils.getCharCode("."),commaCharCode=StringUtils.getCharCode(",");CHAR_MAP2[MODE_UPPER][spaceCharCode]=1;const zUpperCharCode=StringUtils.getCharCode("Z"),aUpperCharCode=StringUtils.getCharCode("A");for(let c=aUpperCharCode;c<=zUpperCharCode;c++)CHAR_MAP2[MODE_UPPER][c]=c-aUpperCharCode+2;CHAR_MAP2[MODE_LOWER][spaceCharCode]=1;const zLowerCharCode=StringUtils.getCharCode("z"),aLowerCharCode=StringUtils.getCharCode("a");for(let c=aLowerCharCode;c<=zLowerCharCode;c++)CHAR_MAP2[MODE_LOWER][c]=c-aLowerCharCode+2;CHAR_MAP2[MODE_DIGIT][spaceCharCode]=1;const nineCharCode=StringUtils.getCharCode("9"),zeroCharCode=StringUtils.getCharCode("0");for(let c=zeroCharCode;c<=nineCharCode;c++)CHAR_MAP2[MODE_DIGIT][c]=c-zeroCharCode+2;CHAR_MAP2[MODE_DIGIT][commaCharCode]=12,CHAR_MAP2[MODE_DIGIT][pointCharCode]=13;const mixedTable=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","\x7F"];for(let i=0;i<mixedTable.length;i++)CHAR_MAP2[MODE_MIXED][StringUtils.getCharCode(mixedTable[i])]=i;const punctTable=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let i=0;i<punctTable.length;i++)StringUtils.getCharCode(punctTable[i])>0&&(CHAR_MAP2[MODE_PUNCT][StringUtils.getCharCode(punctTable[i])]=i);return CHAR_MAP2}const CHAR_MAP=static_CHAR_MAP(Arrays.createInt32Array(5,256));class HighLevelEncoder{constructor(text){this.text=text}encode(){const spaceCharCode=StringUtils.getCharCode(" "),lineBreakCharCode=StringUtils.getCharCode(`
`);let states=Collections.singletonList(State.INITIAL_STATE);for(let index=0;index<this.text.length;index++){let pairCode,nextChar=index+1<this.text.length?this.text[index+1]:0;switch(this.text[index]){case StringUtils.getCharCode("\r"):pairCode=nextChar===lineBreakCharCode?2:0;break;case StringUtils.getCharCode("."):pairCode=nextChar===spaceCharCode?3:0;break;case StringUtils.getCharCode(","):pairCode=nextChar===spaceCharCode?4:0;break;case StringUtils.getCharCode(":"):pairCode=nextChar===spaceCharCode?5:0;break;default:pairCode=0}pairCode>0?(states=HighLevelEncoder.updateStateListForPair(states,index,pairCode),index++):states=this.updateStateListForChar(states,index)}return Collections.min(states,(a,b)=>a.getBitCount()-b.getBitCount()).toBitArray(this.text)}updateStateListForChar(states,index){const result=[];for(let state of states)this.updateStateForChar(state,index,result);return HighLevelEncoder.simplifyStates(result)}updateStateForChar(state,index,result){let ch=this.text[index]&255,charInCurrentTable=CHAR_MAP[state.getMode()][ch]>0,stateNoBinary=null;for(let mode=0;mode<=MODE_PUNCT;mode++){let charInMode=CHAR_MAP[mode][ch];if(charInMode>0){if(stateNoBinary==null&&(stateNoBinary=state.endBinaryShift(index)),!charInCurrentTable||mode===state.getMode()||mode===MODE_DIGIT){const latchState=stateNoBinary.latchAndAppend(mode,charInMode);result.push(latchState)}if(!charInCurrentTable&&SHIFT_TABLE[state.getMode()][mode]>=0){const shiftState=stateNoBinary.shiftAndAppend(mode,charInMode);result.push(shiftState)}}}if(state.getBinaryShiftByteCount()>0||CHAR_MAP[state.getMode()][ch]===0){let binaryState=state.addBinaryShiftChar(index);result.push(binaryState)}}static updateStateListForPair(states,index,pairCode){const result=[];for(let state of states)this.updateStateForPair(state,index,pairCode,result);return this.simplifyStates(result)}static updateStateForPair(state,index,pairCode,result){let stateNoBinary=state.endBinaryShift(index);if(result.push(stateNoBinary.latchAndAppend(MODE_PUNCT,pairCode)),state.getMode()!==MODE_PUNCT&&result.push(stateNoBinary.shiftAndAppend(MODE_PUNCT,pairCode)),pairCode===3||pairCode===4){let digitState=stateNoBinary.latchAndAppend(MODE_DIGIT,16-pairCode).latchAndAppend(MODE_DIGIT,1);result.push(digitState)}if(state.getBinaryShiftByteCount()>0){let binaryState=state.addBinaryShiftChar(index).addBinaryShiftChar(index+1);result.push(binaryState)}}static simplifyStates(states){let result=[];for(const newState of states){let add2=!0;for(const oldState of result){if(oldState.isBetterThanOrEqualTo(newState)){add2=!1;break}newState.isBetterThanOrEqualTo(oldState)&&(result=result.filter(x=>x!==oldState))}add2&&result.push(newState)}return result}}class Encoder$1{constructor(){}static encodeBytes(data){return Encoder$1.encode(data,Encoder$1.DEFAULT_EC_PERCENT,Encoder$1.DEFAULT_AZTEC_LAYERS)}static encode(data,minECCPercent,userSpecifiedLayers){let bits=new HighLevelEncoder(data).encode(),eccBits=Integer.truncDivision(bits.getSize()*minECCPercent,100)+11,totalSizeBits=bits.getSize()+eccBits,compact,layers,totalBitsInLayer,wordSize,stuffedBits;if(userSpecifiedLayers!==Encoder$1.DEFAULT_AZTEC_LAYERS){if(compact=userSpecifiedLayers<0,layers=Math.abs(userSpecifiedLayers),layers>(compact?Encoder$1.MAX_NB_BITS_COMPACT:Encoder$1.MAX_NB_BITS))throw new IllegalArgumentException(StringUtils.format("Illegal value %s for layers",userSpecifiedLayers));totalBitsInLayer=Encoder$1.totalBitsInLayer(layers,compact),wordSize=Encoder$1.WORD_SIZE[layers];let usableBitsInLayers=totalBitsInLayer-totalBitsInLayer%wordSize;if(stuffedBits=Encoder$1.stuffBits(bits,wordSize),stuffedBits.getSize()+eccBits>usableBitsInLayers)throw new IllegalArgumentException("Data to large for user specified layer");if(compact&&stuffedBits.getSize()>wordSize*64)throw new IllegalArgumentException("Data to large for user specified layer")}else{wordSize=0,stuffedBits=null;for(let i=0;;i++){if(i>Encoder$1.MAX_NB_BITS)throw new IllegalArgumentException("Data too large for an Aztec code");if(compact=i<=3,layers=compact?i+1:i,totalBitsInLayer=Encoder$1.totalBitsInLayer(layers,compact),totalSizeBits>totalBitsInLayer)continue;(stuffedBits==null||wordSize!==Encoder$1.WORD_SIZE[layers])&&(wordSize=Encoder$1.WORD_SIZE[layers],stuffedBits=Encoder$1.stuffBits(bits,wordSize));let usableBitsInLayers=totalBitsInLayer-totalBitsInLayer%wordSize;if(!(compact&&stuffedBits.getSize()>wordSize*64)&&stuffedBits.getSize()+eccBits<=usableBitsInLayers)break}}let messageBits=Encoder$1.generateCheckWords(stuffedBits,totalBitsInLayer,wordSize),messageSizeInWords=stuffedBits.getSize()/wordSize,modeMessage=Encoder$1.generateModeMessage(compact,layers,messageSizeInWords),baseMatrixSize=(compact?11:14)+layers*4,alignmentMap=new Int32Array(baseMatrixSize),matrixSize;if(compact){matrixSize=baseMatrixSize;for(let i=0;i<alignmentMap.length;i++)alignmentMap[i]=i}else{matrixSize=baseMatrixSize+1+2*Integer.truncDivision(Integer.truncDivision(baseMatrixSize,2)-1,15);let origCenter=Integer.truncDivision(baseMatrixSize,2),center=Integer.truncDivision(matrixSize,2);for(let i=0;i<origCenter;i++){let newOffset=i+Integer.truncDivision(i,15);alignmentMap[origCenter-i-1]=center-newOffset-1,alignmentMap[origCenter+i]=center+newOffset+1}}let matrix=new BitMatrix(matrixSize);for(let i=0,rowOffset=0;i<layers;i++){let rowSize=(layers-i)*4+(compact?9:12);for(let j=0;j<rowSize;j++){let columnOffset=j*2;for(let k=0;k<2;k++)messageBits.get(rowOffset+columnOffset+k)&&matrix.set(alignmentMap[i*2+k],alignmentMap[i*2+j]),messageBits.get(rowOffset+rowSize*2+columnOffset+k)&&matrix.set(alignmentMap[i*2+j],alignmentMap[baseMatrixSize-1-i*2-k]),messageBits.get(rowOffset+rowSize*4+columnOffset+k)&&matrix.set(alignmentMap[baseMatrixSize-1-i*2-k],alignmentMap[baseMatrixSize-1-i*2-j]),messageBits.get(rowOffset+rowSize*6+columnOffset+k)&&matrix.set(alignmentMap[baseMatrixSize-1-i*2-j],alignmentMap[i*2+k])}rowOffset+=rowSize*8}if(Encoder$1.drawModeMessage(matrix,compact,matrixSize,modeMessage),compact)Encoder$1.drawBullsEye(matrix,Integer.truncDivision(matrixSize,2),5);else{Encoder$1.drawBullsEye(matrix,Integer.truncDivision(matrixSize,2),7);for(let i=0,j=0;i<Integer.truncDivision(baseMatrixSize,2)-1;i+=15,j+=16)for(let k=Integer.truncDivision(matrixSize,2)&1;k<matrixSize;k+=2)matrix.set(Integer.truncDivision(matrixSize,2)-j,k),matrix.set(Integer.truncDivision(matrixSize,2)+j,k),matrix.set(k,Integer.truncDivision(matrixSize,2)-j),matrix.set(k,Integer.truncDivision(matrixSize,2)+j)}let aztec=new AztecCode;return aztec.setCompact(compact),aztec.setSize(matrixSize),aztec.setLayers(layers),aztec.setCodeWords(messageSizeInWords),aztec.setMatrix(matrix),aztec}static drawBullsEye(matrix,center,size){for(let i=0;i<size;i+=2)for(let j=center-i;j<=center+i;j++)matrix.set(j,center-i),matrix.set(j,center+i),matrix.set(center-i,j),matrix.set(center+i,j);matrix.set(center-size,center-size),matrix.set(center-size+1,center-size),matrix.set(center-size,center-size+1),matrix.set(center+size,center-size),matrix.set(center+size,center-size+1),matrix.set(center+size,center+size-1)}static generateModeMessage(compact,layers,messageSizeInWords){let modeMessage=new BitArray;return compact?(modeMessage.appendBits(layers-1,2),modeMessage.appendBits(messageSizeInWords-1,6),modeMessage=Encoder$1.generateCheckWords(modeMessage,28,4)):(modeMessage.appendBits(layers-1,5),modeMessage.appendBits(messageSizeInWords-1,11),modeMessage=Encoder$1.generateCheckWords(modeMessage,40,4)),modeMessage}static drawModeMessage(matrix,compact,matrixSize,modeMessage){let center=Integer.truncDivision(matrixSize,2);if(compact)for(let i=0;i<7;i++){let offset=center-3+i;modeMessage.get(i)&&matrix.set(offset,center-5),modeMessage.get(i+7)&&matrix.set(center+5,offset),modeMessage.get(20-i)&&matrix.set(offset,center+5),modeMessage.get(27-i)&&matrix.set(center-5,offset)}else for(let i=0;i<10;i++){let offset=center-5+i+Integer.truncDivision(i,5);modeMessage.get(i)&&matrix.set(offset,center-7),modeMessage.get(i+10)&&matrix.set(center+7,offset),modeMessage.get(29-i)&&matrix.set(offset,center+7),modeMessage.get(39-i)&&matrix.set(center-7,offset)}}static generateCheckWords(bitArray,totalBits,wordSize){let messageSizeInWords=bitArray.getSize()/wordSize,rs=new ReedSolomonEncoder(Encoder$1.getGF(wordSize)),totalWords=Integer.truncDivision(totalBits,wordSize),messageWords=Encoder$1.bitsToWords(bitArray,wordSize,totalWords);rs.encode(messageWords,totalWords-messageSizeInWords);let startPad=totalBits%wordSize,messageBits=new BitArray;messageBits.appendBits(0,startPad);for(const messageWord of Array.from(messageWords))messageBits.appendBits(messageWord,wordSize);return messageBits}static bitsToWords(stuffedBits,wordSize,totalWords){let message=new Int32Array(totalWords),i,n;for(i=0,n=stuffedBits.getSize()/wordSize;i<n;i++){let value=0;for(let j=0;j<wordSize;j++)value|=stuffedBits.get(i*wordSize+j)?1<<wordSize-j-1:0;message[i]=value}return message}static getGF(wordSize){switch(wordSize){case 4:return GenericGF.AZTEC_PARAM;case 6:return GenericGF.AZTEC_DATA_6;case 8:return GenericGF.AZTEC_DATA_8;case 10:return GenericGF.AZTEC_DATA_10;case 12:return GenericGF.AZTEC_DATA_12;default:throw new IllegalArgumentException("Unsupported word size "+wordSize)}}static stuffBits(bits,wordSize){let out=new BitArray,n=bits.getSize(),mask=(1<<wordSize)-2;for(let i=0;i<n;i+=wordSize){let word=0;for(let j=0;j<wordSize;j++)(i+j>=n||bits.get(i+j))&&(word|=1<<wordSize-1-j);(word&mask)===mask?(out.appendBits(word&mask,wordSize),i--):word&mask?out.appendBits(word,wordSize):(out.appendBits(word|1,wordSize),i--)}return out}static totalBitsInLayer(layers,compact){return((compact?88:112)+16*layers)*layers}}Encoder$1.DEFAULT_EC_PERCENT=33,Encoder$1.DEFAULT_AZTEC_LAYERS=0,Encoder$1.MAX_NB_BITS=32,Encoder$1.MAX_NB_BITS_COMPACT=4,Encoder$1.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class AztecWriter{encode(contents,format,width,height){return this.encodeWithHints(contents,format,width,height,null)}encodeWithHints(contents,format,width,height,hints){let charset=StandardCharsets.ISO_8859_1,eccPercent=Encoder$1.DEFAULT_EC_PERCENT,layers=Encoder$1.DEFAULT_AZTEC_LAYERS;return hints!=null&&(hints.has(EncodeHintType$1.CHARACTER_SET)&&(charset=Charset.forName(hints.get(EncodeHintType$1.CHARACTER_SET).toString())),hints.has(EncodeHintType$1.ERROR_CORRECTION)&&(eccPercent=Integer.parseInt(hints.get(EncodeHintType$1.ERROR_CORRECTION).toString())),hints.has(EncodeHintType$1.AZTEC_LAYERS)&&(layers=Integer.parseInt(hints.get(EncodeHintType$1.AZTEC_LAYERS).toString()))),AztecWriter.encodeLayers(contents,format,width,height,charset,eccPercent,layers)}static encodeLayers(contents,format,width,height,charset,eccPercent,layers){if(format!==BarcodeFormat$1.AZTEC)throw new IllegalArgumentException("Can only encode AZTEC, but got "+format);let aztec=Encoder$1.encode(StringUtils.getBytes(contents,charset),eccPercent,layers);return AztecWriter.renderResult(aztec,width,height)}static renderResult(code,width,height){let input=code.getMatrix();if(input==null)throw new IllegalStateException;let inputWidth=input.getWidth(),inputHeight=input.getHeight(),outputWidth=Math.max(width,inputWidth),outputHeight=Math.max(height,inputHeight),multiple=Math.min(outputWidth/inputWidth,outputHeight/inputHeight),leftPadding=(outputWidth-inputWidth*multiple)/2,topPadding=(outputHeight-inputHeight*multiple)/2,output=new BitMatrix(outputWidth,outputHeight);for(let inputY=0,outputY=topPadding;inputY<inputHeight;inputY++,outputY+=multiple)for(let inputX=0,outputX=leftPadding;inputX<inputWidth;inputX++,outputX+=multiple)input.get(inputX,inputY)&&output.setRegion(outputX,outputY,multiple,multiple);return output}}exports2.AbstractExpandedDecoder=AbstractExpandedDecoder,exports2.ArgumentException=ArgumentException,exports2.ArithmeticException=ArithmeticException,exports2.AztecCode=AztecCode,exports2.AztecCodeReader=AztecReader,exports2.AztecCodeWriter=AztecWriter,exports2.AztecDecoder=Decoder,exports2.AztecDetector=Detector,exports2.AztecDetectorResult=AztecDetectorResult,exports2.AztecEncoder=Encoder$1,exports2.AztecHighLevelEncoder=HighLevelEncoder,exports2.AztecPoint=Point,exports2.BarcodeFormat=BarcodeFormat$1,exports2.Binarizer=Binarizer,exports2.BinaryBitmap=BinaryBitmap,exports2.BitArray=BitArray,exports2.BitMatrix=BitMatrix,exports2.BitSource=BitSource,exports2.BrowserAztecCodeReader=BrowserAztecCodeReader,exports2.BrowserBarcodeReader=BrowserBarcodeReader,exports2.BrowserCodeReader=BrowserCodeReader,exports2.BrowserDatamatrixCodeReader=BrowserDatamatrixCodeReader,exports2.BrowserMultiFormatReader=BrowserMultiFormatReader,exports2.BrowserPDF417Reader=BrowserPDF417Reader,exports2.BrowserQRCodeReader=BrowserQRCodeReader,exports2.BrowserQRCodeSvgWriter=BrowserQRCodeSvgWriter,exports2.CharacterSetECI=CharacterSetECI,exports2.ChecksumException=ChecksumException,exports2.Code128Reader=Code128Reader,exports2.Code39Reader=Code39Reader,exports2.DataMatrixDecodedBitStreamParser=DecodedBitStreamParser,exports2.DataMatrixReader=DataMatrixReader,exports2.DecodeHintType=DecodeHintType$1,exports2.DecoderResult=DecoderResult,exports2.DefaultGridSampler=DefaultGridSampler,exports2.DetectorResult=DetectorResult,exports2.EAN13Reader=EAN13Reader,exports2.EncodeHintType=EncodeHintType$1,exports2.Exception=Exception,exports2.FormatException=FormatException,exports2.GenericGF=GenericGF,exports2.GenericGFPoly=GenericGFPoly,exports2.GlobalHistogramBinarizer=GlobalHistogramBinarizer,exports2.GridSampler=GridSampler,exports2.GridSamplerInstance=GridSamplerInstance,exports2.HTMLCanvasElementLuminanceSource=HTMLCanvasElementLuminanceSource,exports2.HybridBinarizer=HybridBinarizer,exports2.ITFReader=ITFReader,exports2.IllegalArgumentException=IllegalArgumentException,exports2.IllegalStateException=IllegalStateException,exports2.InvertedLuminanceSource=InvertedLuminanceSource,exports2.LuminanceSource=LuminanceSource,exports2.MathUtils=MathUtils,exports2.MultiFormatOneDReader=MultiFormatOneDReader,exports2.MultiFormatReader=MultiFormatReader,exports2.MultiFormatWriter=MultiFormatWriter,exports2.NotFoundException=NotFoundException,exports2.OneDReader=OneDReader,exports2.PDF417DecodedBitStreamParser=DecodedBitStreamParser$2,exports2.PDF417DecoderErrorCorrection=ErrorCorrection,exports2.PDF417Reader=PDF417Reader,exports2.PDF417ResultMetadata=PDF417ResultMetadata,exports2.PerspectiveTransform=PerspectiveTransform,exports2.PlanarYUVLuminanceSource=PlanarYUVLuminanceSource,exports2.QRCodeByteMatrix=ByteMatrix,exports2.QRCodeDataMask=DataMask,exports2.QRCodeDecodedBitStreamParser=DecodedBitStreamParser$1,exports2.QRCodeDecoderErrorCorrectionLevel=ErrorCorrectionLevel,exports2.QRCodeDecoderFormatInformation=FormatInformation,exports2.QRCodeEncoder=Encoder,exports2.QRCodeEncoderQRCode=QRCode,exports2.QRCodeMaskUtil=MaskUtil,exports2.QRCodeMatrixUtil=MatrixUtil,exports2.QRCodeMode=Mode$1,exports2.QRCodeReader=QRCodeReader,exports2.QRCodeVersion=Version$1,exports2.QRCodeWriter=QRCodeWriter,exports2.RGBLuminanceSource=RGBLuminanceSource,exports2.RSS14Reader=RSS14Reader,exports2.RSSExpandedReader=RSSExpandedReader,exports2.ReaderException=ReaderException,exports2.ReedSolomonDecoder=ReedSolomonDecoder,exports2.ReedSolomonEncoder=ReedSolomonEncoder,exports2.ReedSolomonException=ReedSolomonException,exports2.Result=Result,exports2.ResultMetadataType=ResultMetadataType$1,exports2.ResultPoint=ResultPoint,exports2.StringUtils=StringUtils,exports2.UnsupportedOperationException=UnsupportedOperationException,exports2.VideoInputDevice=VideoInputDevice,exports2.WhiteRectangleDetector=WhiteRectangleDetector,exports2.WriterException=WriterException,exports2.ZXingArrays=Arrays,exports2.ZXingCharset=Charset,exports2.ZXingInteger=Integer,exports2.ZXingStandardCharsets=StandardCharsets,exports2.ZXingStringBuilder=StringBuilder,exports2.ZXingStringEncoding=StringEncoding,exports2.ZXingSystem=System,exports2.createAbstractExpandedDecoder=createDecoder,Object.defineProperty(exports2,"__esModule",{value:!0})})}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==void 0)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}(()=>{var getProto=Object.getPrototypeOf?obj=>Object.getPrototypeOf(obj):obj=>obj.__proto__,leafPrototypes;__webpack_require__.t=function(value,mode){if(mode&1&&(value=this(value)),mode&8||typeof value=="object"&&value&&(mode&4&&value.__esModule||mode&16&&typeof value.then=="function"))return value;var ns=Object.create(null);__webpack_require__.r(ns);var def={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var current=mode&2&&value;typeof current=="object"&&!~leafPrototypes.indexOf(current);current=getProto(current))Object.getOwnPropertyNames(current).forEach(key=>def[key]=()=>value[key]);return def.default=()=>value,__webpack_require__.d(ns,def),ns}})(),__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{compressImage:()=>compressImage,fetchInstallReferrerUri:()=>fetchInstallReferrerUri,fetchUrlAsRfc2397:()=>fetchUrlAsRfc2397,insertStorage:()=>insertStorage,isNativePlatform:()=>isNativePlatform,openBrowserPage:()=>openBrowserPage,opfsList:()=>opfsList,opfsRead:()=>opfsRead,opfsRemove:()=>opfsRemove,opfsWrite:()=>opfsWrite,popupText:()=>popupText,printCurrentPage:()=>printCurrentPage,resolveDataUrl:()=>resolveDataUrl,saveFile:()=>saveFile,selectBarcode:()=>selectBarcode,selectClipboard:()=>selectClipboard,selectFile:()=>selectFile,selectStorage:()=>selectStorage,shareFiles:()=>shareFiles,shareText:()=>shareText});function h$wrapBuffer(buf,unalignedOk,offset,length){if(!unalignedOk&&offset&&offset%8!==0)throw"h$wrapBuffer: offset not aligned:"+offset;if(!buf||!(buf instanceof ArrayBuffer))throw"h$wrapBuffer: not an ArrayBuffer";return offset||(offset=0),(!length||length<0)&&(length=buf.byteLength-offset),{buf,len:length,i3:offset%4?null:new Int32Array(buf,offset,length>>2),u8:new Uint8Array(buf,offset,length),u1:offset%2?null:new Uint16Array(buf,offset,length>>1),f3:offset%4?null:new Float32Array(buf,offset,length>>2),f6:offset%8?null:new Float64Array(buf,offset,length>>3),dv:new DataView(buf,offset,length)}}function h$byteArrayToBase64String(off,len,ba){for(var bin="",u8=ba.u8,end=off+len,i=off;i<end;i++)bin+=String.fromCharCode(u8[i]);return window.btoa(bin)}function h$newByteArrayFromBase64String(base64){for(var bin=window.atob(base64),ba=h$newByteArray(bin.length),u8=ba.u8,i=0;i<bin.length;i++)u8[i]=bin.charCodeAt(i);return ba}function h$newByteArray(len){var len0=Math.max(h$roundUpToMultipleOf(len,8),8),buf=new ArrayBuffer(len0);return{buf,len,i3:new Int32Array(buf),u8:new Uint8Array(buf),u1:new Uint16Array(buf),f3:new Float32Array(buf),f6:new Float64Array(buf),dv:new DataView(buf)}}function h$roundUpToMultipleOf(n,m){var rem=n%m;return rem===0?n:n-rem+m}[h$wrapBuffer,h$byteArrayToBase64String,h$newByteArrayFromBase64String,h$newByteArray,h$roundUpToMultipleOf].forEach(function(f){globalThis[f.name]||(globalThis[f.name]=f)});var compressor=__webpack_require__(453),loader=__webpack_require__(428);(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var a=HTMLElement;window.HTMLElement=function(){return Reflect.construct(a,[],this.constructor)},HTMLElement.prototype=a.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,a)}})();var dist=__webpack_require__(268),definitions=__webpack_require__(674);const Filesystem=(0,dist.F3)("Filesystem",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,522)).then(m=>new m.FilesystemWeb)}),OttRemitPlayInstallReferrer=(0,dist.F3)("OttRemitPlayInstallReferrer",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,389)).then(m=>new m.OttRemitPlayInstallReferrerWeb)}),WebviewPrint=(0,dist.F3)("WebviewPrint",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,208)).then(m=>new m.WebviewPrintWeb)});var data_uri_to_buffer_dist=__webpack_require__(40);const Preferences=(0,dist.F3)("Preferences",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,817)).then(m=>new m.PreferencesWeb)});class ClipboardWeb extends dist.E_{async write(options){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(options.string!==void 0)await this.writeText(options.string);else if(options.url)await this.writeText(options.url);else if(options.image)if(typeof ClipboardItem<"u")try{const blob=await(await fetch(options.image)).blob(),clipboardItemInput=new ClipboardItem({[blob.type]:blob});await navigator.clipboard.write([clipboardItemInput])}catch{throw new Error("Failed to write image")}else throw this.unavailable("Writing images to the clipboard is not supported in this browser");else throw new Error("Nothing to write")}async read(){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(typeof ClipboardItem<"u")try{const clipboardItems=await navigator.clipboard.read(),type=clipboardItems[0].types[0],clipboardBlob=await clipboardItems[0].getType(type);return{value:await this._getBlobData(clipboardBlob,type),type}}catch{return this.readText()}else return this.readText()}async readText(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.readText)throw this.unavailable("Reading from clipboard not supported in this browser");return{value:await navigator.clipboard.readText(),type:"text/plain"}}async writeText(text){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.writeText)throw this.unavailable("Writting to clipboard not supported in this browser");await navigator.clipboard.writeText(text)}_getBlobData(clipboardBlob,type){return new Promise((resolve,reject)=>{const reader=new FileReader;type.includes("image")?reader.readAsDataURL(clipboardBlob):reader.readAsText(clipboardBlob),reader.onloadend=()=>{const r=reader.result;resolve(r)},reader.onerror=e=>{reject(e)}})}}const Clipboard=(0,dist.F3)("Clipboard",{web:()=>new ClipboardWeb}),Browser=(0,dist.F3)("Browser",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,531)).then(m=>new m.BrowserWeb)}),Share=(0,dist.F3)("Share",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,878)).then(m=>new m.ShareWeb)}),Toast=(0,dist.F3)("Toast",{web:()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,722)).then(m=>new m.ToastWeb)});var esm=__webpack_require__(863),FileSaver_min=__webpack_require__(287),esm_definitions=__webpack_require__(518);const barcodeScannerCss=[{selector:".scanner-container-display",css:"display: block;"},{selector:".scanner-dialog",css:"display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);"},{selector:".scanner-dialog-inner",css:"background-color: #fefefe; margin: 2% auto; padding: 20px; border: 1px solid #888; width: 96%;"},{selector:".close-button",css:"color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;"},{selector:".close-button:hover",css:"color: #222;"},{selector:".scanner-container-full-width",css:"width: 100%;"}];function applyCss(cssRules){const styleId="custom-style-os-cap-barcode";let styleElement=document.getElementById(styleId);if(styleElement||(styleElement=document.createElement("style"),styleElement.type="text/css",styleElement.id=styleId,document.head.appendChild(styleElement)),styleElement.sheet){for(;styleElement.sheet.cssRules.length;)styleElement.sheet.deleteRule(0);for(const{selector,css}of cssRules)styleElement.sheet.insertRule(`${selector} { ${css} }`)}else{styleElement.textContent="";for(const{selector,css}of cssRules)styleElement.textContent+=`${selector} { ${css} }`}}const CapacitorBarcodeScannerImpl=(0,dist.F3)("CapacitorBarcodeScanner",{web:()=>(applyCss(barcodeScannerCss),Promise.resolve().then(__webpack_require__.bind(__webpack_require__,302)).then(m=>new m.CapacitorBarcodeScannerWeb))});class CapacitorBarcodeScanner{static async scanBarcode(options){return options.scanInstructions=options.scanInstructions||" ",options.scanButton=options.scanButton||!1,options.scanText=options.scanText||" ",options.cameraDirection=options.cameraDirection||esm_definitions.V7.BACK,options.scanOrientation=options.scanOrientation||esm_definitions.UO.ADAPTIVE,CapacitorBarcodeScannerImpl.scanBarcode(options)}}async function printCurrentPage(name){return await WebviewPrint.print({name})}async function selectStorage(key){const{value}=await Preferences.get({key});return value}async function insertStorage(key,value){return await Preferences.set({key,value})}async function compressImage(prevImage,maxSizeKb){let opts={quality:.2};return maxSizeKb&&(opts={quality:Math.min(.2,maxSizeKb/prevImage.size),maxWidth:768,maxHeight:768}),await new Promise((resolve,reject)=>{new compressor(prevImage,{mimeType:"image/jpeg",success:resolve,error:reject,...opts})})}async function selectClipboard(opts={}){const{value}=await Clipboard.read();return await resolveDataUrl(value,opts)}async function selectFile(file,opts={}){const value=await new Promise((resolve,reject)=>{var fr=new FileReader;fr.onload=()=>{resolve(fr.result)},fr.onerror=reject,fr.readAsDataURL(file)});return await resolveDataUrl(value,opts)}async function resolveDataUrl(value,opts={}){try{const{buffer:u8a,typeFull:mime}=(0,data_uri_to_buffer_dist.C)(value);let blob=new Blob([u8a],{type:mime});if(mime.startsWith("image")){let maxSizeKb=null;opts.maxSizeKb&&(maxSizeKb=opts.maxSizeKb),blob=await compressImage(blob,maxSizeKb)}if(opts.opfsDir&&opts.opfsFile){const rfc2397=await new Promise((resolve,reject)=>{var fr=new FileReader;fr.onload=()=>{resolve(fr.result)},fr.onerror=reject,fr.readAsDataURL(blob)});await opfsWrite(rfc2397,opts)}return URL.createObjectURL(blob)}catch{return value}}async function opfsWrite(value,{opfsDir,opfsFile}){try{const stream=await(await(await(await navigator.storage.getDirectory()).getDirectoryHandle(opfsDir,{create:!0})).getFileHandle(opfsFile,{create:!0})).createWritable();await stream.write(value),await stream.close()}catch(e){console.log("OPFS write failure: "+e.toString()+" dir: "+opfsDir+" file: "+opfsFile)}return null}async function opfsRead({opfsDir,opfsFile}){try{const uri=await(await(await(await(await navigator.storage.getDirectory()).getDirectoryHandle(opfsDir)).getFileHandle(opfsFile)).getFile()).text();return await resolveDataUrl(uri)}catch(e){return console.log("OPFS read failure: "+e.toString()+" dir: "+opfsDir+" file: "+opfsFile),null}}async function opfsList(opfsDir){try{const res=[],dir=await(await navigator.storage.getDirectory()).getDirectoryHandle(opfsDir);for await(let opfsFile of dir.keys())res.push(opfsFile);return res}catch(e){return console.log("OPFS list failure: "+e.toString()+" dir: "+opfsDir),[]}}async function opfsRemove({opfsDir,opfsFile}){try{await(await(await(await navigator.storage.getDirectory()).getDirectoryHandle(opfsDir)).getFileHandle(opfsFile)).remove()}catch(e){console.log("OPFS remove failure: "+e.toString()+" dir: "+opfsDir+" file: "+opfsFile)}return null}async function openBrowserPage(url){try{return await Browser.open({url,windowName:"_blank"})}catch{return window.open(url,"_blank").focus()}}async function shareText(text){const{value}=await Share.canShare();return value?await Share.share({text}):await navigator.clipboard.writeText(text)}async function popupText(text){return await Toast.show({text})}async function selectBarcode(){if(!dist.Ii.isNativePlatform()){const devices=await esm.j9.getCameras();if(!(devices&&devices.length))throw new Error("Camera not found!")}const{ScanResult}=await CapacitorBarcodeScanner.scanBarcode({hint:esm_definitions.Gm.ALL});return ScanResult}async function saveFile(name,mime,ab){const u8a=new Uint8Array(ab);if(dist.Ii.isNativePlatform()){const b64=await u8aToB64(u8a),{uri}=await Filesystem.writeFile({path:name,data:b64,directory:definitions.__.Documents});return uri}else{const blob=new Blob([u8a],{type:mime});return await(0,FileSaver_min.saveAs)(blob,name),null}}async function u8aToB64(u8a){const b64=await new Promise((resolve,reject)=>{const fr=new FileReader;fr.onload=()=>{resolve(fr.result)},fr.onerror=reject,fr.readAsDataURL(new Blob([u8a]))});return b64.slice(b64.indexOf(",")+1)}async function shareFiles(files){if(dist.Ii.isNativePlatform()){const{value}=await Share.share({files});return value}else return null}function isNativePlatform(){return dist.Ii.isNativePlatform()}async function fetchUrlAsRfc2397(url){const imgBlob=await(await fetch(url)).blob(),rfc2397=await new Promise((resolve,reject)=>{var fr=new FileReader;fr.onload=()=>{resolve(fr.result)},fr.onerror=reject,fr.readAsDataURL(imgBlob)});return new TextEncoder().encode(rfc2397).buffer}async function fetchInstallReferrerUri(){const{referrerUrl}=await OttRemitPlayInstallReferrer.getReferrerDetails();return referrerUrl}(0,loader.defineCustomElements)(window)})(),h$miso_functora=__webpack_exports__})();
